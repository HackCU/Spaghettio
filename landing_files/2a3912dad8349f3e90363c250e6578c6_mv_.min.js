var duo={templates:{ab:'<!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e <html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Duolingo</title>{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}<link rel="stylesheet" href="/ab/nv.d3.css" /><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /><script src="/ab/jquery-2.1.1.min.js">\x3c/script><script type="text/javascript"> function setOption(experiment, option) { document.getElementById(\'update-form-experiment\').setAttribute(\'value\', experiment); document.getElementById(\'update-form-index\').setAttribute(\'value\', option); document.getElementById(\'update-form\').submit(); return false; } // If this page was reached via POST, this will clear that fact so that refreshing does not resubmit. // Note that there is a bug in chrome where the Resubmission confirmation dialog will show but a GET request will actually be sent. window.history.replaceState(null, null, window.location.href); $(document).ready(function() { var hash = (window.location.hash).replace(\'#\',\'\').split(\'_\'); if (hash.length > 1) { $(\'.tab-opt\').removeClass(\'active\'); $(\'.tab-opt[data-panel="\'+hash[0]+\'"]\').addClass(\'active\'); if (hash[1] != \'in\') $(\'#logged_in_checkbox\').removeAttr(\'checked\'); refilter(); } $(\'.even-row\').removeClass(\'even-row\'); $(\'.ab-tests tr:visible:even\').addClass(\'even-row\'); $(\'.tab-opt\').click(function(e) { $(\'.tab-opt\').removeClass(\'active\'); $(e.currentTarget).addClass(\'active\'); refilter(); }); $(\'.tgl-flip\').change(function() { refilter(); }); function refilter() { $(\'tr\').show(); var filterMethod = $(\'.tab-opt.active\').data(\'panel\'); if (filterMethod != \'all\') { $(\'tr[data-platform!="\'+filterMethod+\'"]\').hide(); } $(\'tr[data-loggedin=\' + !$(\'#logged_in_checkbox\').is(\':checked\') + \']\').hide(); window.location.hash = filterMethod + \'_\' + ($(\'#logged_in_checkbox\').is(\':checked\') ? \'in\' : \'out\'); $(\'.even-row\').removeClass(\'even-row\'); $(\'.ab-tests tr:visible:even\').addClass(\'even-row\'); } }); \x3c/script></head><body><div id="site"><div id="wrapper"><div id="app"><main class="main-center"><section class="page-main"><h2>AB TESTS {{#experiment}} : {{experiment}} set to {{option}}{{/experiment}}</h2><div class="experiment-tabs"><ul class="tabs big experiment nav-tabs"><li class="tab-opt active" data-panel="all"><a>All</a></li><li class="tab-opt" data-panel="web"><a>Web</a></li><li class="tab-opt" data-panel="android"><a>Android</a></li><li class="tab-opt" data-panel="ios"><a>iOS</a></li><li class="tab-opt" data-panel="engine"><a>Engine</a></li></ul></div><div class=\'toggle-logged-in\'><input class=\'tgl tgl-flip\' id=\'logged_in_checkbox\' type=\'checkbox\' checked="checked"><label class=\'tgl-btn\' data-tg-off=\'Logged out\' data-tg-on=\'Logged in\' for=\'logged_in_checkbox\'></label></div><table id="logged-in" class="ab-tests table active">{{#experiments}}<tr class="ab-test" data-platform="{{platform}}" data-loggedin=true><td>{{name}}</td><td>{{#show_metrics}}<a class="metrics" href="/diagnostics/metrics?experiment={{name}}&baseline={{baseline}}&login_state=loggedin{{#platform_web}}&platform=web{{/platform_web}}{{#platform_android}}&platform=android{{/platform_android}}{{#platform_ios}}&platform=ios{{/platform_ios}}{{#platform_windows}}&platform=windows{{/platform_windows}}">Metrics</a>{{/show_metrics}}</td><td><div class="options">{{#options}}{{#picked}}<span class="picked">{{/picked}}<a href="/diagnostics/ab" onclick="javascript:return setOption(\'{{name}}\', {{index}});">{{option}}</a>{{#picked}}</span>{{/picked}}{{/options}}</div></td></tr>{{/experiments}}{{#logged_out_experiments}}<tr class="ab-test" data-platform="{{platform}}" data-loggedin=false><td>{{name}}</td><td>{{#show_metrics}}<a class="metrics" href="/diagnostics/metrics?experiment={{name}}&baseline={{baseline}}&login_state=loggedout{{#platform_web}}&platform=web{{/platform_web}}{{#platform_android}}&platform=android{{/platform_android}}{{#platform_ios}}&platform=ios{{/platform_ios}}{{#platform_windows}}&platform=windows{{/platform_windows}}">Metrics</a>{{/show_metrics}}</td><td><div class="options">{{#options}}{{#picked}}<span class="picked">{{/picked}}<a href="/diagnostics/ab" onclick="javascript:return setOption(\'{{name}}\', {{index}});">{{option}}</a>{{#picked}}</span>{{/picked}}{{/options}}</div></td></tr>{{/logged_out_experiments}}</table><form id="update-form" method="post"><input type="hidden" id="update-form-experiment" name="experiment"/><input type="hidden" id="update-form-index" name="option_index"/></form></section></main></div></div></div></body></html> ',
about:"",account:'<div id="account-content" class="settings-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1>{{#_i}}Account settings{{/_i}}</h1><ul class="list-settings"><li><label class="label">{{#_i}}Username{{/_i}}</label><div class="input"><input style="width: 334px;" class="large" id="username" name="username" type="text" value="{{username}}"{{#experimental}} disabled{{/experimental}}></div></li><li><label class="label">{{#_i}}Email{{/_i}}</label><div class="input"><input style="width: 334px;" class="large" id="email" name="email" size="30" type="text" value="{{email}}"{{#experimental}} disabled{{/experimental}}></div></li><li><label class="label">{{#_i}}Microphone{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="microphone_on" name="microphone" type="radio" value="true" {{#microphone}}checked{{/microphone}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="microphone_off" name="microphone" type="radio" value="false" {{^microphone}}checked{{/microphone}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Speaker{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="speaker_on" name="speaker" type="radio" value="true" {{#speaker}}checked{{/speaker}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="speaker_off" name="speaker" type="radio" value="false" {{^speaker}}checked{{/speaker}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Voice autoplay{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="autoplay_on" name="autoplay" type="radio" value="true" {{#autoplay}}checked{{/autoplay}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="autoplay_off" name="autoplay" type="radio" value="false" {{^autoplay}}checked{{/autoplay}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Sound effects{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="sound_effects_on" name="sound_effects" type="radio" value="true" {{#sound_effects}}checked{{/sound_effects}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="sound_effects_off" name="sound_effects" type="radio" value="false" {{^sound_effects}}checked{{/sound_effects}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Profile picture{{/_i}}</label><div class="input"><div class="avatar-large left" style="margin-right: 15px;">{{>avatar_large}}</div><form id="avatar-upload" action="/avatars" method="post" enctype="multipart/form-data"><input type="hidden" name="user_id" value="{{id}}"><input id="image-file" type="file" name="image" class=""><br/>{{#_i}}maximum image size is 1 MB{{/_i}}</form></div></li>{{^experimental}}<li><div class="input"><a href="/settings/deactivate">{{#_i}}Deactivate my account{{/_i}}</a></div></li>{{/experimental}}{{#experimental}}{{#testbed_experiments}}<li class="testbed-experiments"><label class="label">Experiment: {{name}}</label><div class="input"><ul class="radio-buttons">{{#options}}<li><label><input class="border" name="{{name}}" type="radio" data-index="{{index}}" {{#current}}checked{{/current}}> {{value}}</label></li>{{/options}}</ul></div></li>{{/testbed_experiments}}{{/experimental}}{{#can_debug_localization}}<li><label class="label">Localization debug mode</label><div class="input"><button class="btn toggle-localization-debug">{{#localization_debug_on}} Turn off {{/localization_debug_on}}{{^localization_debug_on}} Turn on {{/localization_debug_on}}</button><p class="gray">Allows you to ctrl+click or cmd+click on any text on the site to view in localization editor</p></div></li>{{/can_debug_localization}}</ul></div> ',
"admin-dashboard":'<main class="main-center"><section class="page-main"><div id="admin-dashboard" class="admin-dashboard"><div class="admin-buttons"><span style="display:block;"><span class="search-input-box"><input type="text" id="search-user" name="search-user" placeholder="enter a username"/></span><span class="icon icon-search-gray get-summary" data-toggle="tooltip" data-original-title="view user diagnostics" data-delay="250"></span></span><span style="display:block"><span class="icon icon-smilie-bad show-bans" data-toggle="tooltip" data-original-title="shadowbanned users"></span></span></div><h1 style="padding-top:20px; margin-bottom: -4px;">Admin Dashboard</h1><span class="dropdown"><button data-toggle="dropdown" class="btn btn-standard btn-outline admin-dropdown"><span id="selected-view-option">Recent Moderator Activity</span><span class="icon icon-arrow-down-gray"></span></button><ul class="dropdown-menu"><li class="view-option" data-view-area="manage-moderators"><a>Manage Moderators</a></li><li class="view-option" data-view-area="moderator-activity"><a>Recent Moderator Activity</a></li><li class="view-option" data-view-area="lingot-store-activity"><a>Lingot Store Activity</a></li></ul></span><div class="view-area" id="manage-moderators"></div><div class="view-area" id="moderator-activity"><ul class="nav-tabs"><li class=\'show-deletes active\'><a href="javascript:;">Deletes</a></li><li class=\'show-comments\'><a href="javascript:;">Comments</a></li></ul><div class="panel" id="moderation-log"></div><div class="panel" id="comment-log"></div></div><div class="view-area" id="lingot-store-activity"></div><div id="banned-modal"></div></div></section></main> ',
"alert-modal":'<div class="modal fade in" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><h4 class="modal-title">{{^title}}{{#custom_title}}{{#untrack_student}}{{#_i}}Stop tracking {{student_email}}?{{/_i}}{{/untrack_student}}{{#alert}}{{#_i}}Uh-oh.{{/_i}}{{/alert}}{{/custom_title}}{{^custom_title}}{{#_i}}Heads up!{{/_i}}{{/custom_title}}{{/title}}{{#title}}{{#_ivar}}title{{/_ivar}}{{/title}}</h4></div><div class="modal-body">{{#custom_message}}{{message}}{{/custom_message}}{{^custom_message}}{{#leave_group}}{{#_i}}This will cause you to leave \'{{oldGroupName}}\'. Would you like to switch to this team?{{/_i}}{{/leave_group}}{{#rate_limit}}{{#_i}}Whoa! You\'re rating these sentences pretty fast! Make sure to read the sentence carefully before clicking "Looks good" or "Looks wrong".{{/_i}}{{/rate_limit}}{{#promote_warning}}{{#_i}}There can only be one Captain at a time. By promoting this user, you are giving up your title. Are you sure you want to do this?{{/_i}}{{/promote_warning}}{{#coach_warning}}{{#_i}}You will need to meet a custom goal (of {{coach_goal}} XP) every day to extend your streak.{{/_i}}{{/coach_warning}}{{#untrack_student}}{{#_i}}If they want to share their progress with you again, they can go to their Progress Sharing settings.{{/_i}}{{/untrack_student}}{{#bulk_untrack_students}}{{#_i}}Are you sure you want to stop tracking these students?{{/_i}} {{#_i}}If they want to share their progress with you again, they can go to their Progress Sharing settings.{{/_i}}{{/bulk_untrack_students}}{{#add_observer}}<span class="small-margin-right">{{#_i}}You are authorizing <b>{{observer_email}}</b> to track your Duolingo progress.{{/_i}}</span>{{^from_settings}}<span>{{#_i}}You can always change this in your "Progress Sharing" settings.{{/_i}}</span>{{/from_settings}}{{/add_observer}}{{#remove_observer}}{{#_i}}<b>{{observer_email}}</b> will no longer be able to track your Duolingo progress.{{/_i}}{{/remove_observer}}{{#invalid_email}}{{#_i}}You entered an invalid email address.{{/_i}}{{/invalid_email}}{{#observee_limit}}{{#_i}}This teacher is tracking the progress of too many students.{{/_i}}{{/observee_limit}}{{/custom_message}}</div><div class="modal-footer">{{#confirm}}<button data-bb-handler="cancel" type="button" class="btn btn-standard btn-outline btn-default modal-close">{{#_i}}Cancel{{/_i}}</button><button data-bb-handler="okay" type="button" class="btn margin-left btn-primary modal-success">{{#_i}}OK{{/_i}}</button>{{/confirm}}{{#alert}}<button data-bb-handler="cancel" type="button" class="btn btn-primary modal-close">{{#_i}}OK{{/_i}}</button>{{/alert}}{{#test_confirm}}<button data-bb-handler="cancel" type="button" class="btn btn-standard btn-outline btn-default modal-close">{{#_i}}Not right now{{/_i}}</button><button data-bb-handler="okay" type="button" class="btn margin-left btn-primary modal-success">{{#_i}}Start quiz{{/_i}}</button>{{/test_confirm}}{{#custom_type}}<button data-bb-handler="cancel" type="button" class="btn btn-standard btn-outline btn-default modal-close">{{#_iv}}{{cancel_text}}{{/_iv}}</button><button data-bb-handler="okay" type="button" class="btn margin-left btn-primary modal-success">{{#_iv}}{{okay_text}}{{/_iv}}</button>{{/custom_type}}</div></div></div></div>',
"all-ui-string-list":'<h1>{{target_language_string}} UI Strings</h1><div id="ui-strings" class="all-comments"></div>',"android-splash":'{{#old_android}}<div class="mobile-splash ancient-android"><div class="content"><div class="topbar-brand white"></div><br /><div class="text">{{#_i}}Learn a language and<br />have fun. All for free.{{/_i}}</div><br /><a class="btn get-android" href="https://play.google.com/store/apps/details?id=com.duolingo">{{#_i}}Get the Android app{{/_i}}</a></div><div style="bottom:0px; width: 100%;"><img width="250px" height="178px" class="duo" style="margin: 0 auto;" src="/images/android_splash_duo.png"></div></div>{{/old_android}}{{^old_android}}<div class="mobile-splash" style="display: none;"><div class="text-content"><div class="topbar-brand white"></div><p>{{#_i}}Learn a language and<br />have fun. All for free.{{/_i}}</p><a class="btn get-android" href="https://play.google.com/store/apps/details?id=com.duolingo">{{#_i}}Get the Android app{{/_i}}</a><a class="desktop-link" href="javascript:;">{{#_i}}View desktop site{{/_i}}</a></div><div class="owl-container" style="bottom: -6px;"><img class="" style="margin: 0 auto; position:relative;" src="/images/android_splash_duo.png"></div></div>{{/old_android}}',
"assign-translation":' <h1>Re-assign translation</h1> Translation: <a href="/translation/{{translation_id}}">{{document_title}}</a><br>Target language: {{target_language_name}}<form action="/diagnostics/assign_translation/{{translation_id}}" method="post"><br>Enter username(s) of trusted translators who should be assigned to work on this translation. Multiple usernames can be separated by commas. <br><br><input type="text" name="users" value="{{assigned_usernames}}"><input type="submit"></form> Available trusted translators for {{source_language_name}}->{{target_language_name}}: <ul>{{#trusted_translators}}<li>{{username}}{{/trusted_translators}}</ul>',
avatar_large:'{{^deactivated}}<a href="/{{username}}" class="avatar avatar-large {{#show_badges}}{{#expert}}expert{{/expert}} {{#admin}}expert{{/admin}} {{#mod}}moderator{{/mod}}{{/show_badges}} " {{#mod}}data-toggle="tooltip" title="{{#_i}}Moderator{{/_i}}"{{/mod}}{{#admin}}data-toggle="tooltip" title="{{#_i}}Admin{{/_i}}"{{/admin}} >{{#avatar}}{{#default_avatar}}<img src="{{avatar}}/xlarge">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}<img src="https://www.duolingo.com/avatars/{{id}}/xlarge" class="avatar">{{/default_avatar}}{{/avatar}}<span class="ring"></span>{{#admin}}<span class="avatar-badge admin"><span class="icon icon-star-white-tiny"></span></span>{{/admin}}{{#mod}}<span class="avatar-badge moderator"><span class="icon-shield-white-tiny icon"></span></span>{{/mod}}</a>{{/deactivated}}{{#deactivated}}<span class="has-twipsy avatar-large" title="{{#_i}}[deactivated user]{{/_i}}"><img src="https://www.duolingo.com/avatars/deactivated_user/xlarge" class="avatar"></span>{{/deactivated}} ',
avatar_medium:'{{^deactivated}}<a href="/{{username}}" class="avatar avatar-medium {{#show_badges}}{{#expert}}expert{{/expert}} {{#admin}}expert{{/admin}} {{#mod}}moderator{{/mod}}{{/show_badges}}" {{#show_badges}}{{#mod}}data-toggle="tooltip" title="{{#_i}}Moderator{{/_i}}"{{/mod}}{{#admin}}data-toggle="tooltip" title="{{#_i}}Admin{{/_i}}"{{/admin}}{{/show_badges}} >{{#lazy_avatars}}{{#avatar}}<img class="lazy" src="https://s3.amazonaws.com/duolingo-images/avatar/default_2/xlarge" data-original="{{#default_avatar}}{{avatar}}/xlarge{{/default_avatar}}" width="50" height="50">{{/avatar}}{{^avatar}}<img class="lazy" src="https://s3.amazonaws.com/duolingo-images/avatar/default_2/xlarge" data-original="{{#default_avatar}}https://www.duolingo.com/avatars/{{id}}/xlarge{{/default_avatar}}" width="50" height="50">{{/avatar}}{{/lazy_avatars}}{{^lazy_avatars}}{{#avatar}}{{#default_avatar}}<img src="{{avatar}}/xlarge">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}<img src="https://www.duolingo.com/avatars/{{id}}/xlarge">{{/default_avatar}}{{/avatar}}{{/lazy_avatars}}<span class="ring"></span>{{#show_badges}}{{#admin}}<span class="avatar-badge admin"><span class="icon icon-star-white-tiny"></span></span>{{/admin}}{{#mod}}<span class="avatar-badge moderator"><span class="icon-shield-white-tiny icon"></span></span>{{/mod}}{{/show_badges}}</a>{{/deactivated}}{{#deactivated}}<span class="avatar avatar-medium" title="{{#_i}}[deactivated user]{{/_i}}"><img src="https://s3.amazonaws.com/duolingo-images/avatar/default_2/xlarge"></span>{{/deactivated}} ',
avatar_micro:'{{^deactivated}}<a href="/{{username}}" class="avatar avatar-micro" title="{{username}}">{{#avatar}}<img src="{{avatar}}/medium">{{/avatar}}{{^avatar}}<img src="http://www.duolingo.com/avatars/{{id}}/medium" class="avatar">{{/avatar}}<span class="ring"></span></a>{{/deactivated}}{{#deactivated}}<span class="has-twipsy avatar-micro" title="{{#_i}}[deactivated user]{{/_i}}"><img src="http://www.duolingo.com/avatars/deactivated_user/small" class="avatar"></span>{{/deactivated}} ',avatar_small:'{{^deactivated}}<a {{^trial_account}}href="/{{username}}"{{/trial_account}} class="avatar avatar-small {{#is_admin}}expert{{/is_admin}}" {{^trial_account}}title="{{username}}"{{/trial_account}}>{{#lazy_avatars}}{{#avatar}}<img class="lazy" src="https://s3.amazonaws.com/duolingo-images/avatar/default_2/large" data-original="{{#default_avatar}}{{avatar}}/large{{/default_avatar}}" width="50" height="50">{{/avatar}}{{^avatar}}<img class="lazy" src="https://s3.amazonaws.com/duolingo-images/avatar/default_2/large" data-original="{{#default_avatar}}http://www.duolingo.com/avatars/{{id}}/large{{/default_avatar}}" width="50" height="50">{{/avatar}}{{/lazy_avatars}}{{^lazy_avatars}}{{#avatar}}{{#default_avatar}}<img src="{{avatar}}/large">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}<img src="http://www.duolingo.com/avatars/{{id}}/large" class="avatar">{{/default_avatar}}{{/avatar}}{{/lazy_avatars}}<span class="ring"></span></a>{{/deactivated}}{{#deactivated}}<span class="has-twipsy avatar-small" title="{{#_i}}[deactivated user]{{/_i}}"><img src="http://www.duolingo.com/avatars/deactivated_user/small" class="avatar"></span>{{/deactivated}} ',
avatar_small_session:'{{^deactivated}}<a href="/{{username}}" target="_blank" class="has-twipsy avatar-small" title="{{username}}">{{#avatar}}{{#default_avatar}}<img src="{{avatar}}/small" class="avatar">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}}<img src="http://www.duolingo.com/avatars/{{id}}/small" class="avatar">{{/default_avatar}}{{/avatar}}</a>{{/deactivated}}{{#deactivated}}<span target="_blank" class="has-twipsy avatar-small" title="{{#_i}}[deactivated user]{{/_i}}"><img src="http://www.duolingo.com/avatars/deactivated_user/small" class="avatar"></span>{{/deactivated}} ',
avatar_xlarge:'{{^deactivated}}<a href="/{{username}}" class="avatar avatar-xlarge" title="{{username}}">{{#avatar}}{{#default_avatar}}<img src="{{avatar}}/xlarge">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}<img src="http://www.duolingo.com/avatars/{{id}}/xlarge" class="avatar">{{/default_avatar}}{{/avatar}}<span class="ring"></span></a>{{/deactivated}}{{#deactivated}}<span class="has-twipsy avatar-xlarge" title="{{#_i}}[deactivated user]{{/_i}}"><img src="http://www.duolingo.com/avatars/deactivated_user/xlarge" class="avatar"></span>{{/deactivated}} ',
"awesome-modal":'<div class="modal {{#finished_tree}}conquer-modal{{/finished_tree}} slide-in"><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div>{{^finished_tree}}{{#level_event}}<div class="modal-header"><h1>{{#_i}}Great! You leveled up!{{/_i}}</h1></div><div class="modal-body"><div class="level-up-badge-container" style="text-align: center; margin-bottom: 30px;"><span class="level-badge-big {{language}}"><span class="inner">{{new_level}}</span><span class="pennant"></span></span></div></div>{{/level_event}}{{/finished_tree}}{{#finished_tree}}<div class="modal-body conquer-modal-body"><div class="finished-owl"><div class="owl owl-trophy-xl {{language}}"></div><div class="share-buttons"><a class="btn btn-blue" href="http://twitter.com/intent/tweet?url=https://www.duolingo.com&text= {{#_i}}I conquered {{#_ivar}}language_string{{/_ivar}}!{{/_i}}&hashtags=duolingo " target="_blank"><span class="icon icon-twitter-white-small"></span>{{#_i}}Tweet{{/_i}}</a><a id="facebook-post-action" class="btn btn-fbblue facebook" data-shared="{{#_i}}Shared{{/_i}}" href="javascript:;"><span class="icon icon-fb-white-small"></span>{{#_i}}Share{{/_i}}</a></div></div><div class="finished-text"><h1>{{#_i}}You\'ve conquered the {{#_ivar}}language_string{{/_ivar}} skill tree!{{/_i}}</h1><p>{{#_i}}First of all, you\'re awesome! You\'ve completed the {{#_ivar}}language_string{{/_ivar}} skill tree! Second of all, we\'d like to take this time to thank you sincerely for your lengthy participation on Duolingo. So in honor of you, here is a very special trophy in which to show our gratitude.{{/_i}}</p><p>{{#_i}}But don\'t stop now, maintain your knowledge and keep your <strong>word strength full</strong> by continuing to practice.{{/_i}}</p><div class="strengthen-example {{^immersion_enabled}}no-immersion{{/immersion_enabled}}"></div>{{#immersion_enabled}}<p>{{#_i}}If you\'d like a bit more of a challenge, try translating our <a class="blue" href="/translations">real world articles</a> to put all your hard work to good use!{{/_i}}</p>{{/immersion_enabled}}<span class="sinc">{{#_i}}Sincerely,{{/_i}}</span><div class="signature"></div></div></div>{{/finished_tree}}{{^finished_tree}}<div class="modal-footer"><button class="btn btn-green continue right">{{#_i}}Continue{{/_i}}</button><button class="btn btn-blue share left relative">{{#_i}}Share{{/_i}}<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel"><li>{{#level_event}}<a href="http://twitter.com/intent/tweet?url=https://www.duolingo.com&text= {{#_i}}I reached Level {{new_level}} {{#_ivar}}language_string{{/_ivar}}!{{/_i}} &hashtags=duolingo" target="_blank">{{#_i}}Share on Twitter{{/_i}}</a>{{/level_event}}</li><li><a id="facebook-post-action" class="facebook" data-shared="{{#_i}}Shared on Facebook{{/_i}}" href="javascript:;">{{#_i}}Share on Facebook{{/_i}}</a></li><li class="divider"></li><li><span><label><input id="fb-auto-post" class="border" type="checkbox" {{#auto_facebook_post}}checked="checked"{{/auto_facebook_post}}/> {{#_i}}Automatically share on Facebook{{/_i}}</label></span></li></ul></button></div>{{/finished_tree}}</div> ',
blame:'{{#wrong_language}}{{#_i}}You typed in {{#_ivar}}ui_language_name{{/_ivar}}, not {{#_ivar}}language_name{{/_ivar}}.{{/_i}}{{/wrong_language}}{{#missing}}{{#_i}}You missed a word.{{/_i}}{{/missing}}{{#third-person-s}}{{#additional_info}}{{#_i}}"{{verb}}" turns into "{{third}}" after the third person singular.{{/_i}}{{/additional_info}}{{/third-person-s}}{{#rev-third-person-s}}{{#additional_info}}{{#_i}}"{{verb}}" turns into "{{third}}" <i>only</i> after the third person singular.{{/_i}}{{/additional_info}}{{/rev-third-person-s}}{{#verb_agr}}{{#additional_info}}{{#_i}}You used the {{wrong_form}} form "{{wrong_usage}}" instead of the {{correct_form}} form "{{correct_usage}}".{{/_i}}{{/additional_info}}{{/verb_agr}}{{#desadj}}{{#additional_info}}{{#_i}}"Des" changes to "de" when there is an adjective before the noun.{{/_i}}{{/additional_info}}{{/desadj}}{{#missing_article}}{{#additional_info}}{{#_i}}You need the article "{{article}}" here.{{/_i}}{{/additional_info}}{{/missing_article}}{{#missing_pronoun}}{{#additional_info}}{{#_i}}In English, you cannot leave out the personal pronoun here.{{/_i}}{{/additional_info}}{{/missing_pronoun}}{{#conjunction_word_order}}{{#additional_info}}{{#_i}}Pay attention to the word order after "{{conjunction}}".{{/_i}}{{/additional_info}}{{/conjunction_word_order}}{{#possessive_s}}{{#_i}}Pay attention to the apostrophe that means possession here.{{/_i}}{{/possessive_s}}{{#cest}}{{#_i}}Use "c\'est" before nouns with articles (un/une, le/la) or possessives (mon/ma).{{/_i}}{{/cest}}{{#he-il}}{{#_i}}Here, the French "il" means "it", not "he".{{/_i}}{{/he-il}}{{#he-ce}}{{#_i}}Here, the French "c\'est" means "it is", not "he is".{{/_i}}{{/he-ce}}{{#il-faut}}{{#_i}}The French "il faut" means "it is necessary" not "he must".{{/_i}}{{/il-faut}}{{#no_gerund}} Unlike English, German has no "-ing" form. So "Ich esse" means "I eat" <strong>and</strong> "I am eating". {{/no_gerund}}{{#iolo}}{{#_i}}The first person pronoun in Italian is "io", not "lo".{{/_i}}{{/iolo}}{{#cheater}}{{#_i}}Did you come up with this yourself or did you paste it from another site...?{{/_i}}{{/cheater}}{{#maedchen_plural}}{{#_i}}Careful! "Die M\u00e4dchen" is actually the plural of "das M\u00e4dchen".{{/_i}}{{/maedchen_plural}}{{#lehrer_plural}}{{#_i}}Careful! "Die Lehrer" is actually the plural of "der Lehrer".{{/_i}}{{/lehrer_plural}}{{#del}}{{#_i}}In Spanish, "de" and "el" must always combine to "del".{{/_i}}{{/del}}{{#maedchen}}{{#_i}}Careful! "M\u00e4dchen" actually takes a neutral article, like most nouns that end in "chen".{{/_i}}{{/maedchen}}{{#number}}{{#additional_info}}{{#sg_correct}}{{#_i}}You used the plural "{{wrong_form}}" here, instead of the singular "{{correct_form}}".{{/_i}}{{/sg_correct}}{{^sg_correct}}{{#_i}}You used the singular "{{wrong_form}}" here, instead of the plural "{{correct_form}}".{{/_i}}{{/sg_correct}}{{/additional_info}}{{/number}}{{#rev_sie}}{{#additional_info}}{{#_i}}"{{sie_usage}}" is used as the formal "you" here, not as "{{wrong_usage}}".{{/_i}}{{/additional_info}}{{/rev_sie}}{{#article_def_indef}}{{#additional_info}}{{#def_correct}}{{#_i}}You used the indefinite "{{wrong_form}}" here, instead of the definite "{{correct_form}}".{{/_i}}{{/def_correct}}{{^def_correct}}{{#_i}}You used the definite "{{wrong_form}}" here, instead of the indefinite "{{correct_form}}".{{/_i}}{{/def_correct}}{{/additional_info}}{{/article_def_indef}}{{#gender}}{{^additional_info}}{{#_i}}Pay attention to the gender.{{/_i}}{{/additional_info}}{{#additional_info}}{{#gender_correct}}{{#gender_wrong}}{{#_i}}"{{noun}}" is {{gender_correct_string}}, not {{gender_wrong_string}}.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{^gender_correct}}{{#gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{^gender_wrong}}{{#_i}}Pay attention to the gender.{{/_i}}{{/gender_wrong}}{{/gender_correct}}{{/additional_info}}{{/gender}}{{#case_gender}}{{#additional_info}}{{#case_correct}}{{#gender_correct}}{{#_i}}In {{case_correct_string}} case, use "{{article_correct}}" for {{gender_correct_string}} nouns like "{{noun}}"{{/_i}}{{/gender_correct}}{{^gender_correct}}{{#_i}}Pay attention to case and gender.{{/_i}}{{/gender_correct}}{{/case_correct}}{{/additional_info}}{{/case_gender}}{{#nom_gender}}{{#additional_info}}{{#_i}}For {{gender_correct_string}} nouns like "{{noun}}", use "{{article_correct}}".{{/_i}}{{/additional_info}}{{/nom_gender}}{{#circumflex}}{{#_i}}Pay attention to the circumflex.{{/_i}}{{/circumflex}}{{#accent}}{{#_i}}Pay attention to the accents.{{/_i}}{{/accent}}{{#casing}}{{#_i}}Pay attention to the capitalization.{{/_i}}{{/casing}}{{#rev_rev_sie}}{{#additional_info}} "{{sie_usage}}" is only used as the formal "you" when it is capitalized. {{/additional_info}}{{/rev_rev_sie}}{{#casing_sie}}{{#additional_info}}{{#_i}}When used as the formal "you", "{{sie_usage}}" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_sie}}{{#casing_ihr}}{{#additional_info}}{{#_i}}When used as the formal "your", "{{ihr_usage}}" needs to be capitalized.{{/_i}}{{/additional_info}}{{/casing_ihr}}{{#casing_noun}}{{#_i}}All nouns are capitalized in German.{{/_i}}{{/casing_noun}}{{#enie}}{{#_i}}Pay attention to the \u00f1 character.{{/_i}}{{/enie}}{{#dieresis}}{{#_i}}Pay attention to the \u00fc character.{{/_i}}{{/dieresis}}{{#cedille}}{{#_i}}Pay attention to the \u00e7 character.{{/_i}}{{/cedille}}{{#umlaut}}{{#_i}}Pay attention to the umlauts.{{/_i}}{{/umlaut}}{{#eszett}}{{#_i}}Pay attention to the \u00df character.{{/_i}}{{/eszett}}{{#typo}}{{#additional_info}}{{#_i}}You have {{#pluralize}}a typo,typos,{{num_highlights}}{{/pluralize}} in your answer.{{/_i}}{{/additional_info}}{{/typo}}{{#missing_space}}{{#_i}}You missed a space.{{/_i}}{{/missing_space}}{{#extra_space}}{{#_i}}You have an extra space.{{/_i}}{{/extra_space}}{{#an_a}}{{#_i}}Use "an" before words that start with a vowel.{{/_i}}{{/an_a}}{{#apo_space}}{{#_i}}There should be no spaces around apostrophes.{{/_i}}{{/apo_space}}{{#hyphen_space}}{{#_i}}There should be no spaces around hyphens.{{/_i}}{{/hyphen_space}}{{#report_message}}{{#additional_info}}{{message}}{{/additional_info}}{{/report_message}}{{#latin}}{{#additional_info}}{{#_i}}Remember to use the {{#_ivar}}sentence_language_name{{/_ivar}} keyboard.{{/_i}}{{/additional_info}}{{/latin}} ',
"blame-popover":'<div id="blame-1" class="popover above blame-popover animated slide-in"><div class="inner"><div class="icon-warning"></div></div></div> ',"buzzfeed-document":' {{! This is not a normal JS-rendered template. It is rendered in the back end when a BuzzFeed document is uploaded, and is used to populate the \'original_template\' field in the Document. }}<div class="buzzfeed-article"><h1>{{title}}</h1>{{#description}}{{{description}}}{{/description}}{{#sub_buzz}}<div class="sub-buzz">{{#has_title}}<h1>{{#number}}{{number}}. {{/number}}{{title}}</h1>{{/has_title}}{{#multiple_images}}<table><tr>{{#images}}<td>{{{image_translation}}}{{#have_image_description}}{{{description}}}{{/have_image_description}}</td>{{^last}}<td class="separator-cell"></td>{{/last}}{{/images}}</tr></table>{{/multiple_images}}{{^multiple_images}}{{#image_translation}}{{{image_translation}}}{{/image_translation}}{{/multiple_images}}{{#has_description}}{{{description}}}{{/has_description}}{{#embedded_video_html}}{{{embedded_video_html}}}{{/embedded_video_html}}{{! is this right? }}{{#link_url}}<div><a href="{{link_url}}">{{link_url}}</a></div>{{/link_url}}{{#tweet_data}}<div class="tweet"><div class="tweet-inner"><table><tr><td>{{#profile_image_url}}<img class="tweet-avatar" src="{{profile_image_url}}">{{/profile_image_url}}</td><td>{{#from_user_name}}<div class="tweet-author-fullname">{{from_user_name}}</div>{{/from_user_name}}{{#from_user}}<span class="tweet-author-username">@{{from_user}}</span>{{/from_user}}</td></tr></table><div class="tweet-content"><p>{{tweet_translation}}</p>{{#image_translation}}{{{image_translation}}}{{/image_translation}}</div></div></div>{{/tweet_data}}</div>{{/sub_buzz}}</div> ',
"buzzfeed-manual-report-publication":'<form action="/translations/report_buzzfeed_publication" method="post"> Translation ID: <input type="text" name="translation_id"> URL: <input type="text" name="url"><br>JSON: <br><textarea rows="10" cols="80" name="json"></textarea><br><input type="submit"></form>',"buzzfeed-manual-upload":'<form action="/translations/upload_buzzfeed_translation" method="post"> Enter BuzzFeed JSON here: <br><textarea rows="10" cols="80" name="json"></textarea><br><input type="submit"></form>',
"buzzfeed-test-upload":'<form> This page lets you upload BuzzFeed URLs for test purposes (for example, evaluating a candidate proofreader). <br><br> Translations uploaded this way will be shown as uploaded by DuoBot (not BuzzFeed), and will <b>not</b> be sent to BuzzFeed automatically when completed. <br><br> Enter URL: <input type="text" name="url" size="128" value="{{url}}"><br><br> Target languages: {{#available_target_languages}}<input type="checkbox" name="{{target_lang}}" value="1" {{#checked}}checked{{/checked}}>{{target_lang}} &nbsp;&nbsp; {{/available_target_languages}}<br><br><input type="submit"></form>{{#url}}{{#could_not_load}} Could not load URL. {{/could_not_load}}{{^could_not_load}}{{^num_target_languages}} Must specify at least one target language. {{/num_target_languages}}{{#num_target_languages}} Links to translations: <ul>{{#target_languages}}<li>{{target_lang}}: <a href="/translation/{{translation_id}}">http://www.duolingo.com/translation/{{translation_id}}</a>{{/target_languages}}</ul>{{/num_target_languages}}{{/could_not_load}}{{/url}} ',
certificate_v0:'<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><title>{{#_i}}Certificate{{/_i}} {{id}}</title><style type="text/css" media="screen"> body { font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif; background: url("/images/certifications/bg.png"); color: #3f3f3f; -webkit-font-smoothing: antialiased; } .spacer { position: absolute; width: 100%; height: 100%; min-width: 940px; min-height: 800px; } .clearfix:before, .clearfix:after { content: " "; /* 1 */ display: table; /* 2 */ } .clearfix:after { clear: both; } .clearfix { *zoom: 1; } .certification { width: 880px; padding: 10px; -webkit-border-radius: 10px; -moz-border-radius: 10px; border-radius: 10px; -webkit-box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.1); -moz-box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.1); box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.1); background: white; position: absolute; left: 50%; top: 50%; margin: -360px 0 0 -450px; } .certification .inner { padding: 60px; min-height: 500px; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; border: 1px solid #e6e6e6; } .badge { width: 182px; height: 180px; position: absolute; background: url("/images/certifications/badge.png"); top: 60px; right: 60px; } h1 { font-size: 36px; font-weight: 300; margin: 90px 0 10px 0; width: 580px; } h2 { font-size: 28px; color: #b8b8b8; font-weight: 500; margin: 0 0 65px 0; } h3 { font-size: 20px; font-weight: 300; margin: 0; line-height: 30px; } .row { } .col-left { width: 350px; float: left; } .col-right { width: 350px; float: right; } .notes { color: #a3a3a3; font-size: 14px; } .notes strong { text-transform: uppercase; font-size: 12px; font-weight: normal; display: block; margin: 5px 0 5px 0; } .line { border-top: 1px solid #e5e5e5; padding: 15px 0 0 0; color: #a3a3a3; font-size: 14px; } .date { height: 65px; display: table-cell; vertical-align: bottom; font-size: 20px; font-weight: 300; padding-bottom: 15px; } .meta { width: 900px; position: absolute; text-align: center; left: 0; bottom: -60px; } .btn { height: 28px; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; -ms-box-sizing: border-box; box-sizing: border-box; position: relative; background-color: #f8f8f8; background-image: -webkit-gradient(linear,left top,left bottom,from(#fff),to(#dedede)); background-image: -moz-linear-gradient(top,#fff,#dedede); background-image: -o-linear-gradient(top,#fff,#dedede); background-image: -ms-linear-gradient(top,#fff,#dedede); background-image: linear-gradient(top,#fff,#dedede); border: #ccc solid 1px; -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; color: #333; font-weight: 600; text-shadow: 0 1px 0 rgba(255,255,255,.5); -webkit-user-select: none; -moz-user-select: none; -o-user-select: none; cursor: pointer; overflow: hidden; display: inline-block; vertical-align: top; zoom: 1; font-size: 13px; line-height: 26px; padding: 0 10px; text-decoration: none; margin: 0 5px 0 0; } .btn:focus, .btn:hover, .btn:active { border-color: #bbb; background-color: #f8f8f8; background-image: -webkit-gradient(linear,left top,left bottom,from(#f8f8f8),to(#d9d9d9)); background-image: -moz-linear-gradient(top,#f8f8f8,#d9d9d9); background-image: -o-linear-gradient(top,#f8f8f8,#d9d9d9); background-image: -ms-linear-gradient(top,#f8f8f8,#d9d9d9); background-image: linear-gradient(top,#f8f8f8,#d9d9d9); -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; } .btn:active { -webkit-box-shadow: inset 0 3px 7px rgba(0,0,0,0.1); -moz-box-shadow: inset 0 3px 7px rgba(0,0,0,0.1); box-shadow: inset 0 3px 7px rgba(0,0,0,0.1); } .fb-icon { width: 7px; height: 14px; background: url("/images/certifications/fb.png"); display: inline-block; vertical-align: middle; margin: -2px 10px 0 0; } @page { size: letter landscape; margin: 2cm; } .preview { color: #ce272d; font-size: 20px; }</style></head><body style="margin: 0; padding: 0;"><div class="spacer"><div class="certification"><div class="inner">{{#preview}}<div class="preview">{{#_i}}Preview only!{{/_i}}</div>{{/preview}}{{^preview}}<a href="https://www.duolingo.com"><img src="/images/certifications/duolingo-logo.png" class="logo"/></a>{{/preview}}<div class="badge"></div><h1>{{#_i}}Certificate of Achievement{{/_i}}</h1><h2>{{#_i}}<i>for</i> {{fullname}}{{/_i}} {{#_i}}(identity not verified){{/_i}}</h2><div class="row clearfix" style="margin-bottom: 70px;"><div class="col-left" style="width: 500px"><h3>{{#_i}}Successful completion of the Duolingo {{#_ivar}}language_string{{/_ivar}} exam with a score of: <strong>{{score}}/5.0{{/_i}}</strong></h3></div></div><div class="row clearfix"><div class="col-left"><img src="/images/certifications/signature.png"/><div class="line">Luis von Ahn, CEO</div></div><div class="col-right"><div class="date">{{date}}</div><div class="line">{{#_i}}Date{{/_i}}</div></div></div></div><div class="meta">\x3c!-- <a target="_blank" href="/certs/{{id}}/pdf" class="btn">{{#_i}}Download as PDF{{/_i}}</a> --\x3e{{#show_share_buttons}}<a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fduolingo.com/certs/{{id}}" class="btn"><div class="fb-icon"></div>{{#_i}}Share{{/_i}}</a><a href="https://twitter.com/share" class="twitter-share-button" data-text="{{#_i}}I scored {{score}}/5.0 for my Duolingo {{language_string}} certificate:{{/_i}}" data-via="duolingo" data-size="large" data-count="none">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?\'http\':\'https\';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+\'://platform.twitter.com/widgets.js\';fjs.parentNode.insertBefore(js,fjs);}}(document, \'script\', \'twitter-wjs\');\x3c/script>{{/show_share_buttons}}</div></div></div></body></html>',
certificates:'<div id="certificates-content"><span class="store-icon store-icon-progress right" style="margin: -20px;"></span><h1>{{#_i}}Quiz History{{/_i}}</h1><div class="sub-text gray">{{#_i}}To take another progress quiz, you can visit the <a href="/show_store">lingot store.</a>{{/_i}}</div>{{#quiz_scores}}<h5 class="gray"><span class="flag flag-{{language}} flag-svg-small left"></span> {{#_iv}}{{language_string}}||capitalized{{/_iv}}</h5><table class="list-certificates table">{{#scores}}<tr><td class="result" dir="auto"><span class="score">{{score}}</span>/5.0 </td><td>{{datetime}}</td></tr>{{/scores}}</table>{{/quiz_scores}}</div> ',
"certification-intro":'<div class="practice-intro-screen"><div class="owl owl-sporty"></div><div class="speech-bubble arrow-left"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner">{{^recent_score}}<h2 style="font-size: 20px;">{{#_i}}Best of luck on your quiz!{{/_i}}</h2><p style="margin: 0 0 20px 0;">{{#_i}}We will keep track of your scores so you can see your progress over time!{{/_i}}</p>{{/recent_score}}{{#recent_score}}<h2 style="font-size: 20px;">{{#_i}}Last time you took the quiz, you scored <span class="bold">{{score}}/5.0</span>{{/_i}}</h2><h2 style="font-size: 20px;">{{#_i}}Let\'s try to beat that!{{/_i}}</h2>{{/recent_score}}</div></div></div><div class="block-input-row "><div class="col-left"></div><div class="col-right"></div></div>',
coach_settings:'<button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1 class="with-subheading">{{#_i}}Daily Goal settings{{/_i}}</h1><div class="sub-text gray">{{#_i}}Coach here!{{/_i}} {{#_i}}Selecting a daily goal will help you stay motivated while learning a language.{{/_i}} {{#_i}}You can change your goal at any time.{{/_i}}</div><div class="coach-settings"><span class="owl owl-coach-small left"></span><span class="coach-goal-chooser left"><ul class="goal-chooser"><li><label class="btn btn-standard btn-small btn-outline daily-goal-option"><input type="radio" name="daily_goal" data-goal="1"/> <span class="title">{{#_i}}Basic{{/_i}}</span> <span class="xp-text">{{#_i}}1 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-small btn-outline daily-goal-option"><input type="radio" name="daily_goal" data-goal="10"/> <span class="title">{{#_i}}Casual{{/_i}}</span> <span class="xp-text">{{#_i}}10 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-small btn-outline daily-goal-option"><input type="radio" name="daily_goal" data-goal="20"/> <span class="title">{{#_i}}Regular{{/_i}}</span> <span class="xp-text">{{#_i}}20 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-small btn-outline daily-goal-option"><input type="radio" name="daily_goal" data-goal="30"/> <span class="title">{{#_i}}Serious{{/_i}}</span> <span class="xp-text">{{#_i}}30 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-small btn-outline daily-goal-option"><input type="radio" name="daily_goal" data-goal="50"/> <span class="title">{{#_i}}Insane{{/_i}}</span> <span class="xp-text">{{#_i}}50 XP per day{{/_i}}</span></label></li></ul></span></div>',
"collapsed-event":'{{#events}}<div id="collapsed-event-{{id}}"></div>{{/events}} ',comment:'{{^document_comment}}<main class="main-center"><section class="page-main"><header class="discussion-header">{{#logged_in}}{{^trial_account}}<button id="watch" class="btn right btn-green {{#watching}}checkmark{{/watching}}">{{#watching}}{{#_i}}Following discussion{{/_i}}{{/watching}}{{^watching}}{{#_i}}Follow discussion{{/_i}}{{/watching}}</button>{{/trial_account}}{{/logged_in}}{{#topic}}<h3 class="gray"><a href="/topic/{{id}}" class=""><span class="icon icon-arrow-back-gray"></span> <bdi>{{#_i}}Topic:{{/_i}} {{#_ivar}}name{{/_ivar}} {{#different_ui}}({{#_iv}}{{from_language_name}}{{/_iv}}){{/different_ui}}</bdi></a></h3>{{/topic}}</header>{{/document_comment}}{{#removed}}<div class="locked-discussion-message right"></span>{{#_i}}This discussion is deleted.{{/_i}}</div>{{/removed}}<div class="hidden post-comment" id="edit-modal" style="padding-bottom: 20px;"></div><div class="discussion-main">{{^document_comment}}{{#sentence_comment}}{{#show_tts}}<span id="speaker-audio-1-button" class="speaker-small"><span class="listen-button-small icon icon-speaker-small {{#rtl}}img-flipped{{/rtl}}"></span></span>{{/show_tts}}{{/sentence_comment}}{{^sentence_comment}}<span class="avatar-poster">{{#user}}{{>avatar_medium}}{{/user}}</span>{{/sentence_comment}}{{/document_comment}}<h1 class="{{#sentence_comment}}sentence-comment{{/sentence_comment}}" {{#document_comment}}style="padding-bottom: 20px"{{/document_comment}}>{{#sentence_comment}}"<span class="title"><bdi>{{format_title}}</bdi></span>"{{/sentence_comment}}{{^sentence_comment}}<bdi>{{title}}</bdi>{{/sentence_comment}}</h1>{{^document_comment}}{{^sentence_comment}}{{#user}}{{^deactivated}}<div class="header-subline"><a href="/{{username}}" class="username">{{username}}</a> {{>user_flair}}</div>{{/deactivated}}{{#deactivated}}<div class="header-subline">{{#_i}}Posted {{#pretty_date}}{{datetime_string}}{{/pretty_date}} by [deactivated user]{{/_i}}</div>{{/deactivated}}{{/user}}{{/sentence_comment}}<div class="discussion-main-body"><bdi>{{#message}}{{^sentence_comment}}{{^deleted}}{{{processed_message}}}{{/deleted}}{{#deleted}}{{#_i}}[deleted]{{/_i}} {{/deleted}}{{/sentence_comment}}{{/message}}</bdi>{{#sentence_comment}}<p><strong><span {{#rtl}}style="float: right; padding-left: 5px"{{/rtl}}>{{#_i}}Translation:{{/_i}}</span></strong> <span class="trans translation-source" dir="auto">{{translation}}</span></p>{{/sentence_comment}}</div><div class="discussion-action-buttons right">{{^sentence_comment}}{{^removed}}{{#editable}}{{^frozen}}<a href="javascript:;" class="edit-comment">{{#_i}}Edit{{/_i}}</a>{{/frozen}}{{/editable}}{{#deletable}}<a href="javascript:;" class="delete-comment">{{#_i}}Delete{{/_i}}</a>{{/deletable}}{{/removed}}{{#show_dropdown}}<div class="dropdown admin"><div data-toggle="dropdown" class="">{{#_i}}Moderate{{/_i}} <span class="icon icon-arrow-down-gray"></span></div><ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel">{{#make_sticky}}{{#sticky}}<li><a href="javascript:;" class="make-unsticky">{{#_i}}Make Unsticky{{/_i}}</a></li>{{/sticky}}{{^sticky}}<li><a href="javascript:;" class="make-sticky">{{#_i}}Make Sticky{{/_i}}</a></li>{{/sticky}}{{/make_sticky}}{{#freeze_thread}}{{^frozen}}<li><a href="javascript:;" class="freeze-thread">{{#_i}}Lock Discussion{{/_i}}</a></li>{{/frozen}}{{#frozen}}<li><a href="javascript:;" class="unfreeze-thread">{{#_i}}Unlock Discussion{{/_i}}</a></li>{{/frozen}}{{/freeze_thread}}{{^removed}}{{#delete_thread}}<li><a href="javascript:;" class="delete-thread">{{#_i}}Delete Discussion{{/_i}}</a></li>{{/delete_thread}}{{/removed}}</ul></div>{{/show_dropdown}}{{#logged_in}}{{^trial_account}}<span>{{#rupees}}<a href="javascript:;" class="give-love">{{#_i}}Give Lingot{{/_i}}</a>{{/rupees}}{{#love}}<span><span class="icon icon-lingot-small"></span><span class="love-number">{{love}}</span></span>{{/love}}</span>{{/trial_account}}{{/logged_in}}{{/sentence_comment}}{{#sentence_comment}}{{#delete_thread}}{{^removed}}<a href="javascript:;" class="edit-comment">{{#_i}}Edit{{/_i}}</a><a href="javascript:;" class="delete-comment">{{#_i}}Delete{{/_i}}</a>{{/removed}}<div class="dropdown admin"><div data-toggle="dropdown" class="">{{#_i}}Moderate{{/_i}} <span class="icon icon-arrow-down-gray"></span></div><ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel">{{^removed}}<li><a href="javascript:;" class="delete-thread">{{#_i}}Delete Discussion{{/_i}}</a></li>{{/removed}}{{^frozen}}<li><a href="javascript:;" class="freeze-thread">{{#_i}}Lock Discussion{{/_i}}</a></li>{{/frozen}}{{#frozen}}<li><a href="javascript:;" class="unfreeze-thread">{{#_i}}Unlock Discussion{{/_i}}</a></li>{{/frozen}}</ul></div>{{/delete_thread}}{{#editor_url}}<a target="_blank" href="{{editor_url}}">{{#_i}}Find in Incubator{{/_i}}</a>{{/editor_url}}{{/sentence_comment}}</div><div class="discussion-main-detail">{{#logged_in}}{{^trial_account}}<div class="vote-module-small"><div class="vote-count {{#user_upvoted}}active-upvoted{{/user_upvoted}} {{#user_downvoted}}active-downvoted{{/user_downvoted}}">{{votes}}</div><button class="btn btn-custom vote-up" id="comment-{{id}}-upvote"><span class="icon icon-vote-up-small {{#user_upvoted}}active{{/user_upvoted}}"></span></button><button class="btn btn-custom vote-down" id="comment-{{id}}-downvote"><span class="icon icon-vote-down-small {{#user_downvoted}}active{{/user_downvoted}}"></span></button></div>{{/trial_account}}{{/logged_in}}{{#pretty_date}}{{datetime_string}}{{/pretty_date}}</div>{{/document_comment}}{{#logged_in}}{{^trial_account}}{{^frozen}}<div class="discussion-main-new-comment">{{#logged_in_user}}<span class="left">{{>avatar_medium}}</span>{{/logged_in_user}}<textarea placeholder="{{#num_comments}}{{#_i}}Leave a new comment{{/_i}}{{/num_comments}} {{^num_comments}}{{#_i}}Start the discussion{{/_i}}{{/num_comments}}" class="textarea-block textarea-autogrow" id="post-text-box" dir="auto"></textarea><div class="save-message hidden">{{#_i}}Comment posted!{{/_i}}</div><div class="action-buttons hidden" id="post-button"><button class="btn btn-green" id="post-comment">{{#_i}}Post{{/_i}}</button><button class="btn btn-standard cancel-update-comment">{{#_i}}Cancel{{/_i}}</button></div></div>{{/frozen}}{{/trial_account}}{{/logged_in}}</div>{{#trial_account}}<div class="trial-account-overlay"></div>{{/trial_account}}<div class="discussion-comments"><h2>{{#num_comments}}{{#_i}}{{num_comments}} {{#pluralize}}Comment,Comments,{{num_comments}}{{/pluralize}}{{/_i}}{{/num_comments}}{{^num_comments}}{{#_i}}No one has commented yet.{{/_i}}{{/num_comments}}{{#document_comment}}<span><button id="watch" class="btn right btn-green {{#watching}}checkmark{{/watching}} document-discussion-follow-btn">{{#watching}}{{#_i}}Following discussion{{/_i}}{{/watching}}{{^watching}}{{#_i}}Follow discussion{{/_i}}{{/watching}}</button></span>{{/document_comment}}{{#frozen}}<div class="locked-discussion-message"><span class="icon-lock icon"></span>{{#_i}}This discussion is locked.{{/_i}}</div>{{/frozen}}</h2><ul class="discussion-comments-list outside {{#trial_account}}trial-comments{{/trial_account}}">{{#comments}}{{^removed}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/removed}}{{#removed}}{{#deleted}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/deleted}}{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/undeletable}}{{/deleted}}{{/removed}}{{/comments}}{{#num_hidden}}<li class="show-toggle comment" id="show-toggle"><a href="javascript:;" class="show-bad-comment">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{#undeletable}}{{^num_hidden}}<li class="show-toggle comment" id="show-toggle"><a href="javascript:;" class="show-bad-comment">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{/undeletable}}</ul></div>{{^document_comment}}</section>{{>footer}}</main>{{/document_comment}} ',
"comment-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{^translation}}{{#comment_thread_id}}{{#terminal}}{{#_i}}commented on <a href="/comment/{{comment_thread_id}}" style="font-weight: 700;"><bdi>{{comment_title}}</bdi></a>{{/_i}}{{/terminal}}{{^terminal}}{{#_i}}posted <a href="/comment/{{comment_thread_id}}" style="font-weight: 700;"><bdi>{{comment_title}}</bdi></a>{{/_i}}{{/terminal}}{{/comment_thread_id}}{{/translation}}{{#translation}}{{#_i}}commented on <a href="/translation/{{translation}}" style="font-weight: 700;">a translation</a>{{/_i}}{{/translation}}{{#blurb}}<span class="blurb">\u201c<bdi>{{blurb}}</bdi>\u201d</span>{{/blurb}}</p>{{>event-footer}} ',
"comment-list":'<ul id="comments" class="list-discussions">{{#comments}}<li id="comment-{{id}}" class="list-discussion-item"></li>{{/comments}}{{^comments}}{{#followed_tab}}<li class="list-discussion-item"><p class="gray" style="padding-right: 80px; text-align: center;">{{#_i}}You are not following any discussions.{{/_i}}</p></li>{{/followed_tab}}{{^followed_tab}}{{#has_subscriptions}}<li class="list-discussion-item">{{#_i}}There are no discussions here yet. Be the first to post something!{{/_i}}</li>{{/has_subscriptions}}{{^has_subscriptions}}{{#logged_in}}{{^trial_account}}<li class="list-discussion-item"><p class="gray" style="padding-right: 80px; text-align: center;">{{#_i}}You are not subscribed to any topics.{{/_i}}</p></li>{{/trial_account}}{{#trial_account}}<li class="list-discussion-item"><p class="gray" style="padding-right: 80px; text-align: center;">{{#_i}}There are no discussions here yet.{{/_i}}</p></li>{{/trial_account}}{{/logged_in}}{{^logged_in}}<li class="list-discussion-item"><p class="gray" style="padding-right: 80px; text-align: center;">{{#_i}}There are no discussions here yet.{{/_i}}</p></li>{{/logged_in}}{{/has_subscriptions}}{{/followed_tab}}{{/comments}}{{#more}}{{#infinite_scrolling}}<div class="gray-spinner"></div>{{/infinite_scrolling}}{{^infinite_scrolling}}<button id="load-more-comments" class="btn" style="margin-top: 20px">{{#_i}}load more{{/_i}}</button>{{/infinite_scrolling}}{{/more}}</ul>',
"community-search":'<h5 style="margin-top: 20px">{{#results_count}}{{#_i}}{{results_count}} {{#pluralize}}result,results,{{results_count}}{{/pluralize}}{{/_i}}{{/results_count}}{{^results_count}}{{#_i}}0 results{{/_i}}{{/results_count}}</h5><ul style="" class="discussion-search-results">{{#comments}}<li><a href="/comment/{{parent_id}}">{{topic_name}}: {{parent_title}}</a><div>"...{{{extract}}}..."</div></li>{{/comments}}</ul>{{#has_more}}<button id="load-more-comments" class="btn" style="margin-top: 20px">{{#_i}}load more{{/_i}}</button>{{/has_more}} ',
"compact-comment":'{{#user}}{{>avatar_large}}{{/user}}<span class="icon icon-comment-medium {{#rtl}}pseudo-bg-flipped{{/rtl}}">{{num_comments}}</span><header class="list-discussion-item-header">{{#sticky}}<div class="sticky-discussion-message">{{#_i}}Sticky{{/_i}}</div>{{/sticky}}<a href="/comment/{{id}}" class="comment"><bdi>{{title}}</bdi></a></header><footer class="list-discussion-item-footer"><div class="vote-module-small"><div class="vote-count {{#user_upvoted}}active-upvoted{{/user_upvoted}} {{#user_downvoted}}active-downvoted{{/user_downvoted}}">{{votes}}</div>{{#logged_in}}{{^trial_account}}<button class="btn btn-custom vote-up" id="comment-{{id}}-upvote"><span class="icon icon-vote-up-small {{#user_upvoted}}active{{/user_upvoted}}"></span></button><button class="btn btn-custom vote-down" id="comment-{{id}}-downvote"><span class="icon icon-vote-down-small {{#user_downvoted}}active{{/user_downvoted}}"></span></button>{{/trial_account}}{{/logged_in}}</div><span class="full-footer">{{#pretty_date}}{{datetime_string}}{{/pretty_date}}{{#user}}{{^deactivated}} {{#_i}}by <a href="/{{username}}" class="">{{username}}{{/_i}}</a>{{/deactivated}}{{#deactivated}} {{#_i}}by [deactivated user]{{/_i}}{{/deactivated}}{{/user}}{{#front_page}}{{#topic}} {{#_i}}in <a href="/topic/{{id}}" class="blue">{{#_iv}}{{name}}{{/_iv}} {{#different_ui}}({{#_iv}}{{from_language_name}}{{/_iv}}){{/different_ui}}</a>{{/_i}}{{/topic}}{{/front_page}}</span><span class="compact-footer">{{#pretty_date}}{{datetime_string}}{{/pretty_date}}</span></footer> ',
"compact-ui-string":'<td><a href="/ui_strings/{{id}}">{{index}}</a></td><td style="word-break:break-all;"><a href="/ui_strings/{{id}}">{{source_text}}</a></td><td style="word-break:break-all;">{{target_text}}</td>',"correct-solutions":'<div class="correct-solution-box">{{#correct}}{{#blame}}{{#closest_translation}}<h5>{{#_i}}Correct solution:{{/_i}}</h5><div class="input-meta"><div class="another-correct-solution"><div class="solution-item translation-source translation_source">{{closest_translation}}</div></div></div>{{/closest_translation}}{{^closest_translation}}{{#correct_solutions}}<h5>{{#solution_translation}}<div class="translation-headline">{{#_i}}Translation:{{/_i}}</div>{{/solution_translation}}{{#_i}}Correct solution:{{/_i}}</h5><div class="input-meta"><div class="correct-solution-gray"><div class="solution-item translation-source translation_source">{{.}}</div></div>{{#solution_translation}}<div class="translation">{{solution_translation}}</div>{{/solution_translation}}</div>{{/correct_solutions}}{{/closest_translation}}{{/blame}}{{^blame}}{{#solution_translation}}<h5>{{#_i}}Translation:{{/_i}}</h5><div class="input-meta"><div class="another-correct-solution"><div class="solution-item translation-source translation_source">{{solution_translation}}</div></div></div>{{/solution_translation}}{{#display_translation}}<h5>{{#_i}}Another correct solution:{{/_i}}</h5><div class="input-meta"><div class="another-correct-solution"><div class="solution-item translation-source translation_source">{{display_translation}}</div></div></div>{{/display_translation}}{{/blame}}{{/correct}}{{#incorrect}}{{#has_solutions}}{{^closest_translation}}<h5>{{^wrong_language}}{{#solution_translation}}<div class="translation-headline">{{#_i}}Translation:{{/_i}}</div>{{/solution_translation}}{{/wrong_language}}{{#_i}}Correct {{#pluralize}}solution, solutions,{{num_solutions}}{{/pluralize}}:{{/_i}}</h5><div class="input-meta"><div class="correct-solution">{{#correct_solutions}}<div class="solution-item translation_source">{{.}}</div>{{/correct_solutions}}</div>{{^wrong_language}}{{#solution_translation}}<div class="translation">{{solution_translation}}</div>{{/solution_translation}}{{/wrong_language}}</div>{{/closest_translation}}{{#closest_translation}}{{^display_translation}}<h5>{{#_i}}Correct solution:{{/_i}}</h5><div class="input-meta"><div class="correct-solution"><div class="solution-item translation-source translation_source">{{closest_translation}}</div></div></div>{{/display_translation}}{{#display_translation}}<h5>{{#_i}}Correct solutions:{{/_i}}</h5><div class="input-meta"><div class="correct-solution"><div class="solution-item translation-source translation_source">{{closest_translation}}</div><div class="solution-item translation-source translation_source">{{display_translation}}</div></div></div>{{/display_translation}}{{/closest_translation}}{{/has_solutions}}{{/incorrect}}{{^correct}}{{#speak_challenge}}{{#solution_translation}}<h5>{{#_i}}Translation:{{/_i}}</h5><div class="input-meta"><div class="another-correct-solution"><div class="solution-item translation-source translation_source">{{solution_translation}}</div></div></div>{{/solution_translation}}{{/speak_challenge}}{{/correct}}</div> ',
"course-list":'<main class="main-standard"><section class="page-main"><div class="from-language-selector">{{#_i}}I speak:{{/_i}}<label class="grey-select "><select class="from-language-dropdown"><option data-id="all" data-abbrev="all">{{#_i}}All languages{{/_i}}</option>{{#all_source_languages}}<option data-id="{{id}}" data-abbrev="{{abbrev}}">{{#_i}}{{#_iv}}{{language_name}}{{/_iv}}||list of ui languages{{/_i}}</option>{{/all_source_languages}}</select></label></div><h1 class="course-list-headline">{{#_i}}Duolingo Language Courses{{/_i}}</h1><hr/><div class="list-course-cards">{{#rows}}{{#directions}}{{#attributes}}<div class="course-card {{learning_language}}"><a href="/course/{{learning_language_id}}/{{from_language_id}}/{{#_i}}Learn-{{#_iv}}{{learning_language_name}}{{/_iv}}-Online{{/_i}}">{{#learning}}<div class="course-learning-badge"><span class="icon icon-check-white-small"></span> {{#_i}}LEARNING{{/_i}}</div>{{/learning}}<div class="course-card-header course-page-illustration-{{learning_language}} gradient"><div class="small-course-illustration layer-1"></div><div class="small-course-illustration layer-2"></div><div class="small-course-illustration layer-3"></div><div class="small-course-illustration layer-4"></div><div class="learn-count">{{#in_progress}}{{#_i}}Hatching: {{progress}}% done{{/_i}}{{/in_progress}}{{#in_beta}}{{#_i}}In Beta: {{num_learners_string}} {{#pluralize}}learner,learners,{{num_learners}}{{/pluralize}}{{/_i}}{{/in_beta}}{{#released}}{{#_i}}{{num_learners_string}} {{#pluralize}}learner,learners,{{num_learners}}{{/pluralize}}{{/_i}}{{/released}}</div></div><div class="course-card-footer"><span class="flag flag-svg-medium flag-{{learning_language}}"></span>{{#_i}}<strong>{{#_iv}}{{learning_language_name}}{{/_iv}}</strong>for {{#_iv}}{{from_language_name}}{{/_iv}} speakers{{/_i}}</div></a></div>{{/attributes}}{{/directions}}{{/rows}}</div><hr/><div class="course-incubator-ad"><span class="course-list-illustration"></span><h2 class="bold">{{#_i}}Language courses made by the people{{/_i}}</h2><p style="margin-bottom: 30px;">{{#_i}}The Duolingo Incubator gives bilinguists the power to share their knowledge with people all over the world. Are you up to the challenge?{{/_i}}</p><a href="http://incubator.duolingo.com" target="_blank" class="btn btn-blue btn-lg">{{#_i}}Contribute to a course{{/_i}}</a></div></section><div class="footer-centered">{{>footer}}</div></main> ',
"course-page":'<main class="main-full-width course-page {{learning_language}}"><section class="page-main"><div class="course-page-splash gradient {{#course_button_experiment2_true}}bigger-button{{/course_button_experiment2_true}}"><div class="course-page-header"><a href="/courses/{{^from_all}}{{from_language_id}}{{/from_all}}{{#from_all}}all{{/from_all}}" class="show-all-courses"><span class="icon icon-back-dark {{#rtl}}img-flipped{{/rtl}}"></span>{{#_i}}All courses{{/_i}}</a><span class="flag flag-{{learning_language}} flag-svg-small right"></span></div><div class="course-page-illustration-container"><div class="course-page-illustration course-page-illustration-{{learning_language}}" data-limit-y="15"><div class="layer parallax-layer layer-1" data-depth= "-0.12" ></div><div class="layer parallax-layer layer-2" data-depth= "-0.07" ></div><div class="layer parallax-layer layer-3" data-depth= "0.0325" data-invert-x="true"></div><div class="layer parallax-layer layer-4" data-depth= "0.0325" data-invert-x="true"></div></div></div><div class="course-page-body">{{#phase_1}}{{#estimated_beta_date_string}}<h2>{{#_i}}Estimated launch:{{/_i}} {{estimated_beta_date_string}}</h2>{{/estimated_beta_date_string}}<h1>{{#_i}}{{#_iv}}{{learning_language_name}}{{/_iv}} for {{#_iv}}{{from_language_name}}{{/_iv}} speakers{{/_i}}</h1><div class="sub-head"><button class="btn btn-white btn-solid subscribe{{#logged_in}} btn-course-notify{{#user_subscribed}} success{{/user_subscribed}}{{/logged_in}}{{^logged_in}} email-subscribe{{/logged_in}}" data-subscribed="{{#_i}}We\u2019ll notify you{{/_i}}" data-unsubscribed="{{#_i}}Notify me when available{{/_i}}" data-track-click="course subscribe"><span class="subscribe-text"></span><input id="email-input" placeholder="{{#_i}}Email address{{/_i}}" class="email-input" type="text" tabindex="-1" style="display: none"/></button><button class="btn btn-white btn-solid confirm-email-subscribe hidden">{{#_i}}Submit{{/_i}}</button><div class="error-toast hidden"></div><span class="course-notify-count">{{subscriber_count}}</span></div>{{/phase_1}}{{^phase_1}}<h2>{{#_i}}{{num_learners_string}} {{#pluralize}}Learner,Learners,{{num_learners}}{{/pluralize}}{{/_i}}{{#learning}}<div class="course-learning-badge"><span class="icon icon-check-white-small margin-left"></span> {{#_i}}LEARNING{{/_i}}</div>{{/learning}}</h2><h1 class="{{#curr_learning_language}}current{{/curr_learning_language}}{{#learning}}{{^curr_learning_language}}switch{{/curr_learning_language}}{{/learning}}">{{#_i}}{{#_iv}}{{learning_language_name}}{{/_iv}} for {{#_iv}}{{from_language_name}}{{/_iv}} speakers{{/_i}}</h1><div class="sub-head">{{#logged_in}}{{#ui_language_matches}}{{#learning}}{{^curr_learning_language}}<button class="btn btn-white btn-outline switch-learning-language margin-left">{{#_i}}Switch to course{{/_i}}</button>{{/curr_learning_language}}{{/learning}}{{^learning}}<button class="btn btn-white btn-solid switch-learning-language" data-track-click="course begin loggedin">{{#_i}}Start course{{/_i}}</button>{{/learning}}{{/ui_language_matches}}{{^ui_language_matches}}<button class="btn btn-white btn-outline switch-ui-language" data-track-click="course switch loggedin">{{#_i}}Switch to course{{/_i}}</button>{{/ui_language_matches}}{{/logged_in}}{{^logged_in}}<button class="btn btn-white btn-solid register" data-track-click="course begin loggedout">{{^course_button_experiment2_true}}{{#_i}}Start learning{{/_i}}{{/course_button_experiment2_true}}{{#course_button_experiment2_true}}{{#_i}}Start learning for free{{/_i}}{{/course_button_experiment2_true}}</button>{{/logged_in}}</div>{{/phase_1}}</div>{{#course_data}}<a href="{{link}}" target="_blank" class="copyright-link">{{#_iv}}{{blurb}}{{/_iv}}</a>{{/course_data}}</div><h2 class="bold">{{^course_title_experiment_true}}{{#_i}}About the course{{/_i}}{{/course_title_experiment_true}}{{#course_title_experiment_true}}{{#_i}}About the {{#_iv}}{{learning_language_name}}{{/_iv}} course{{/_i}}{{/course_title_experiment_true}}</h2><p class="course-about" style="margin-bottom: 40px;">{{#course_data}}{{#_iv}}{{{description}}}{{/_iv}}{{/course_data}}</p>{{^phase_3}}<h2 class="bold">{{#_i}}Course progress{{/_i}}</h2><div class="course-progress-container"><div class="course-progress-section"><div class="course-bar-background"><div class="bubble bubble-left"></div><div class="bubble bubble-center"></div><div class="bubble bubble-right"></div></div><div class="course-bar-container"><div class="bar" style="width: {{overall_progress}}%">\x3c!-- <div class="bar-message"> The {{from_language_name}} team is {{normalized_progress}}% done{{#beating_average}} and beating the average by <strong>{{compare_to_avg}} days!</strong>{{/beating_average}}{{^beating_average}}!{{/beating_average}}</div> --\x3e</div><div class="bubble bubble-left"></div>{{#phase_2}}<div class="bubble bubble-center"></div>{{/phase_2}}<div class="course-phase-label course-phase-label-left completed"><strong>{{#_i}}Hatching: {{normalized_progress}}% done{{/_i}}</strong></div><div class="course-phase-owl course-phase-label-left completed"><span class="owl owl-mini owl-egg"></span></div><div class="course-phase-label course-phase-label-center {{#in_beta}}completed{{/in_beta}}"><strong>{{#_i}}In beta{{/_i}}</strong></div><div class="course-phase-owl course-phase-label-center {{#in_beta}}completed{{/in_beta}}"><span class="owl owl-mini owl-egg-hatching{{^phase_2}}-black{{/phase_2}}"></span></div><div class="course-phase-label course-phase-label-right"><strong>{{#_i}}Stable{{/_i}}</strong></div><div class="course-phase-owl course-phase-label-right"><span class="owl owl-mini owl-egg-hatched-black"></span></div></div></div></div>{{/phase_3}}{{#has_contributors}}<h2 class="bold">{{#_i}}Course contributors{{/_i}}</h2><div class="course-contributors num-{{num_contributors}} {{#course_contributors_experiment_true}}smaller{{/course_contributors_experiment_true}}">{{#rows}}<div class="contributor-row">{{#contributors}}<div class="contributor">{{#course_contributors_experiment_true}}<div class="wrapper">{{>avatar_large}}<h2 class="bold"><a href="/{{username}}">{{username}}</a></h2><span class="location">{{#location}}<span class="icon-location-small icon"></span>{{location}}{{/location}}</span></div><div class="contributor-footer"><span class="icon icon-hammer {{#rtl}}img-flipped{{/rtl}}"></span>{{#_i}}Contributed {{contrib_percent}}%{{/_i}}</div>{{/course_contributors_experiment_true}}{{^course_contributors_experiment_true}}<div class="wrapper">{{>avatar_xlarge}}<h2 class="bold"><a href="/{{username}}">{{username}}</a></h2><p>{{bio}}</p><span class="location">{{#location}}<span class="icon-location-small icon"></span>{{location}}{{/location}}</span></div><div class="contributor-footer"><div class="col-left"><span class="circle-hammer {{#rtl}}img-flipped{{/rtl}}"><span class="icon icon-hammer"></span></span></div><div class="col-right">{{#_i}}Contributed {{contrib_percent}}%{{/_i}}</div></div>{{/course_contributors_experiment_true}}</div>{{/contributors}}</div>{{/rows}}</div>{{/has_contributors}}</section><div class="footer-centered">{{>footer}}</div></main><div id="registration-modal-container"></div> ',
"course-title":"Duolingo{{#course_title_experiment_true}}: {{#_i}}Learn {{#_iv}}{{learning_language_name}}{{/_iv}} for Free{{/_i}}{{/course_title_experiment_true}} ","create-profile-nag":'<div class="player-inner"><section class="player-container slide-in"><img src="/images/safe.svg"><h1 class="session-end">{{#_i}}Save your progress{{/_i}}</h1>{{^ultimatum}}<h2 class="session-end">{{#_i}}You\'ll need a Duolingo profile to save your progress{{/_i}}</h2>{{/ultimatum}}{{#ultimatum}}<h2 class="session-end">{{#_i}}You\'ll need a Duolingo profile to unlock more skills{{/_i}}</h2>{{/ultimatum}}<button class="btn btn-lg btn-green create" data-track-click="trial account session end nag create">{{#_i}}Create Profile{{/_i}}</button>{{^ultimatum}}<a href="javascript:;" class="later" data-track-click="trial account session end nag later">{{#_i}}Create an account later{{/_i}}</a>{{/ultimatum}}{{#ultimatum}}<a href="javascript:;" class="discard" data-track-click="trial account session end nag discard">{{#_i}}Discard my progress{{/_i}}</a>{{/ultimatum}}</section></div><div class="register-modal"></div> ',
"current-wiki-translation-minimal":'<html><title>Duolingo: {{title}}</title><body><meta http-equiv="refresh" content="0; url=/translation/{{translation_id}}">{{#document_paragraphs}}<p>{{#sentences}}{{^index}}<h1>{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}{{#sentence_tokens}}{{token}}{{/sentence_tokens}}{{/cur_translation}}</h1>{{#has_images}}<img src="{{first_image_url}}" class="image-thumb">{{/has_images}}{{^has_images}}<img src="/images/owl-waving-gray.png" class="image-thumb"/>{{/has_images}}{{/index}}{{#index}}{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}{{#sentence_tokens}}{{token}}{{/sentence_tokens}}{{/cur_translation}}{{/index}}{{/sentences}}</p>{{/document_paragraphs}}</body></html>',
deactivate:'<h1>{{#_i}}Deactivate my account{{/_i}}</h1><p>{{#_i}}Hooooold up\u2014 are you sure you want to do this?{{/_i}}</p><p>{{#_i}}Duolingo teaches you how to live, love, and speak another language. If you leave, you might just never be able to reach your full potential in life.{{/_i}}</p><form action="/deactivate" method="POST"><button id="deactivate_submit_button" type="submit" class="btn btn-red margin-right">{{#_i}}Deactivate my account{{/_i}}</button><button id="deactivate_cancel_button" type="reset" class="btn btn-standard">{{#_i}}Cancel{{/_i}}</button></form><button id="do-not-push" class="hidden"></button> ',
"diagnose-buzzfeed-status":'<title>BuzzFeed translation status</title><form> Earliest upload date (inclusive): <input type="text" name="start_date" value="{{start_date}}"><br>Latest upload date (exclusive): <input type="text" name="end_date" value="{{end_date}}"><br><input type="submit"></form>{{num_translations}} translation(s) uploaded between {{start_date}} (inclusive) and {{end_date}} (exclusive). <ul><li>{{num_not_loaded}} not yet loaded into database <li>{{num_in_progress}} in progress <li>{{num_disabled}} manually disabled <li>{{num_published}} published </ul> Translations that have been manually disabled are rendered in <strike>strikethrough</strike>. <br><br> All times are US/Eastern. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Title</th><th>Target language</th><th>Status</th><th>Upload date</th><th>Publication date</th></tr></thead><tbody>{{#jobs}}<tr><td>{{^disabled}}<a href="/translation/{{translation_id}}">{{title}}</a>{{#admin}}<a href="/diagnostics/wiki_translation/{{translation_id}}">(diagnostics)</a>{{/admin}}{{/disabled}}{{#disabled}}<strike>{{title}}</strike>{{/disabled}}</td><td>{{target_language}}</td><td>{{^loaded}}<span style="border: 1px solid #000; background-color: red">&nbsp;&nbsp;&nbsp;</span> Not loaded {{/loaded}}{{#loaded}}{{#disabled}}<span style="border: 1px solid #000; background-color: black">&nbsp;&nbsp;&nbsp;</span> Disabled {{/disabled}}{{^disabled}}{{^publication_date}}<span style="border: 1px solid #000; background-color: blue">&nbsp;&nbsp;&nbsp;</span> In progress {{/publication_date}}{{#publication_date}}<span style="border: 1px solid #000; background-color: green">&nbsp;&nbsp;&nbsp;</span> Published {{/publication_date}}{{/disabled}}{{/loaded}}</td><td>{{upload_date}}</td><td>{{#publication_date}}{{publication_date}}{{/publication_date}}{{^publication_date}} N/A {{/publication_date}}</td></tr>{{/jobs}}</tbody></table> ',
"diagnose-challenge-stats":'<style> .challenge_table > tbody > tr:nth-child(2n+2) { background: #eee }</style><form><b>Language direction:</b><select name="direction">{{#directions}}<option value="{{learning_lang}}_{{from_lang}}" {{#selected}}selected{{/selected}}>{{learning_lang}}<-{{from_lang}}</option>{{/directions}}</select><br><b>Lesson:</b><select name="lesson">{{#lessons}}<option name="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/lessons}}</select><br><b>Device:</b><select name="device">{{#devices}}<option name="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/devices}}</select><br><b>Sort Key:</b><select name="sort_key">{{#sort_keys}}<option name="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/sort_keys}}</select><br><input type="checkbox" name="include_partial_lessons" value="1" {{#include_partial_lessons}}checked{{/include_partial_lessons}}> Include partially-completed lessons <br><br><input type="submit" value="Submit"></form><hr><h1>Statistics for selected lesson</h1><table class="challenge_table" border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Challenge type</th><th>Sentence or lexeme</th><th style="border-left: 1px solid gray">#(times seen)</th><th>#(times correct)</th><th>%correct</th><th style="border-left: 1px solid gray">#(times seen)</th><th>avg. response time</th><th style="border-left: 1px solid gray">#(reports)</th><th>report ratio</th><th style="border-left: 1px solid gray">Common wrong answers</th></tr></thead><tbody>{{#challenges}}<tr><td><pre>{{challenge_type}}</pre></td><td><pre>{{#sentence}}{{sentence}}{{/sentence}}{{^sentence}}{{#lexeme}}{{lexeme}}{{/lexeme}}{{^lexeme}}[{{generator_id}}]{{/lexeme}}{{/sentence}}</pre>{{#debug}}<pre>{{generator_id}}</pre>{{/debug}}</td><td style="border-left: 1px solid gray">{{times_seen}}</td><td>{{times_correct}}</td><td>{{percent_correct}}</td><td style="border-left: 1px solid gray">{{response_time_count}}</td><td>{{response_time_mean}}</td><td style="border-left: 1px solid gray">{{num_reports}}</td><td>{{report_ratio}}</td><td style="border-left: 1px solid gray"><table>{{#wrong_answers}}<tr><td style="width: 120px;"><pre>{{answer}}</pre></td><td><small>{{blame}}</small></td><td>{{count}}</td></tr>{{/wrong_answers}}</table>{{#wrong_answers_url}}<a href="{{url}}">show more</a>{{/wrong_answers_url}}</td></tr>{{/challenges}}</tbody></table> ',
"diagnose-immersion-preferences":' <h1>Document progress states</h1>{{#progress_states}}{{#preferred}}{{state}}<form name="{{id}}" action="/translations/set_document_type_preference?progress_state={{state}}&preferred=false" method="post">{{id}}<input type="submit" value="remove" name="{{id}}"></form>{{/preferred}}{{^preferred}}{{state}}<form action="/translations/set_document_type_preference?progress_state={{state}}&preferred=true" method="post">{{id}}<input type="submit" value="add"></form>{{/preferred}}{{/progress_states}}<h1>Document categories</h1>{{#categories}}{{#preferred}}<form name="{{id}}" action="/translations/set_document_type_preference?category={{id}}&preferred=false" method="post">{{label}}<input type="submit" value="remove" name="{{id}}"></form>{{/preferred}}{{^preferred}}<form action="/translations/set_document_type_preference?category={{id}}&preferred=true" method="post">{{label}}<input type="submit" value="add"></form>{{/preferred}}{{/categories}}<form action="/translations/prefer_all_document_categories" method="post"><input type="submit" value="Prefer documents from all categories"></form> ',
"diagnose-learning-curves":'<h1>Learning curves</h1><form><br>{{>lesson-selector}}<br><br><input type="submit" value="Submit"></form></form><h2>KCs</h2>{{!TODO: produce nice graphs rather than tables.}}{{#kc_stats}}<h3>{{kc}}/<h3><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Trial</th><th>Error rate</th><th>#Samples</th></tr></thead><tbody>{{#learning_curve}}<tr><td>{{trial}}</td><td>{{error_rate}}</td><td>{{num_examples}}</td></tr>{{/learning_curve}}</tbody></table>{{/kc_stats}} ',
"diagnose-paid-translations":'<h1>Paid translations that are not yet done</h1><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Title</th><th>Target language</th><th>Upload date</th><th>Due date</th><th>Time left</th><th>Progress</th><th>Assigned translator(s)</th></tr></thead><tbody>{{#translations}}<tr><td><a href="/translation/{{translation_id}}">{{document_title}}</a> (<a href="/diagnostics/wiki_translation/{{translation_id}}">diagnostics</a>) </td><td>{{target_language}}</td><td>{{upload_date}}</td><td>{{due_date}}</td><td>{{hours}} {{#pluralize}}hour,hours,{{hours}}{{/pluralize}}, {{minutes}} {{#pluralize}}minute,minutes,{{minutes}}{{/pluralize}}</td><td>{{num_sentences_done}}/{{num_sentences}}</td><td>{{#assigned_translators}}<a href="/{{username}}">{{username}}</a>&nbsp; {{/assigned_translators}} (<a href="/diagnostics/assign_translation/{{translation_id}}">re-assign</a>) </td></tr>{{/translations}}</tbody></table><br><br>All dates are US/Eastern. ',
"diagnose-published-translation":'<head><style> img { max-width: 400px; }</style></head>{{^buzzfeed_url}} Translation {{translation_id}} has not been published by BuzzFeed. {{/buzzfeed_url}}{{#buzzfeed_url}}<table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th><a href="/translation/{{translation_id}}">Duolingo version</a></th><th><a href="{{buzzfeed_url}}">BuzzFeed version</a></th></tr></thead><tbody><tr><td valign="top" width="50%">{{{duolingo_html}}}</td><td valign="top" width="50%">{{{buzzfeed_html}}}</td></tr></tbody></table>{{/buzzfeed_url}} ',
"diagnose-published-translations":' <form> Start date (inclusive): <input type="text" name="start_date" value="{{start_date}}"><br>End date (exclusive): <input type="text" name="end_date" value="{{end_date}}"><br><input type="submit"></form> Average cost per word: {{cost_per_word}}<ul>{{#translation_directions}}<li>{{source_language}}->{{target_language}}: {{cost_per_word}}{{/translation_directions}}</ul><h1>Summary statistics</h1> All translation directions: <ul><li>Number of translations published: {{num_published_translations}}<li>Total number of words: {{num_words}}<li>Number of words translated from scratch by trusted users: {{num_words_scratch}} ({{word_percent_scratch}}%) <li>Number of words in sentences edited by trusted users: {{num_words_in_edited_sentence}} ({{word_percent_in_edited_sentence}}%) <li>Number of words approved by trusted users: {{num_words_approved}} ({{word_percent_approved}}%) <li>Total number of characters: {{num_chars}}<li>Number of characters translated from scratch by trusted users: {{num_chars_scratch}} ({{char_percent_scratch}}%) <li>Number of characters edited by trusted users: {{num_chars_edited}} ({{char_percent_edited}}%) <li>Number of characters in a sentence edited by trusted users, but left alone: {{num_chars_left_alone}} ({{char_percent_left_alone}}%) <li>Number of characters approved by trusted users: {{num_chars_approved}} ({{char_percent_approved}}%) <li>Average cost per word: {{cost_per_word}}</ul>{{#translation_directions}}<br>{{source_language}} -> {{target_language}}: <ul><li>Number of translations published: {{num_published_translations}}<li>Total number of words: {{num_words}}<li>Number of words translated from scratch by trusted users: {{num_words_scratch}} ({{word_percent_scratch}}%) <li>Number of words in sentences edited by trusted users: {{num_words_in_edited_sentence}} ({{word_percent_in_edited_sentence}}%) <li>Number of words approved by trusted users: {{num_words_approved}} ({{word_percent_approved}}%) <li>Total number of characters: {{num_chars}}<li>Number of characters translated from scratch by trusted users: {{num_chars_scratch}} ({{char_percent_scratch}}%) <li>Number of characters edited by trusted users: {{num_chars_edited}} ({{char_percent_edited}}%) <li>Number of characters in a sentence edited by trusted users, but left alone: {{num_chars_left_alone}} ({{char_percent_left_alone}}%) <li>Number of characters approved by trusted users: {{num_chars_approved}} ({{char_percent_approved}}%) <li>Average cost per word: {{cost_per_word}}</ul>{{/translation_directions}}<h1>Published translations</h1><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Title</th><th>Target language</th><th>Trusted translator(s)</th><th>Publication date</th><th>Num. words</th><th>Word breakdown</th><th>Num. chars</th><th>Char breakdown</th><th>Cost per word</th><th>Quality evaluation</th></tr></thead><tbody>{{#published_translations}}<tr><td><a href="/translation/{{translation_id}}">{{document_title}}</a> (<a href="/diagnostics/trusted_translation/{{translation_id}}">TT diff</a>) {{#buzzfeed_url}} (<a href="{{buzzfeed_url}}">BuzzFeed version</a>) (<a href="/diagnostics/published_translation/{{translation_id}}">BF diff</a>) {{/buzzfeed_url}}</td><td>{{target_language}}</td><td>{{#trusted_translators}}<a href="/{{username}}">{{username}}</a>{{/trusted_translators}}{{^trusted_translators}} N/A {{/trusted_translators}}</td><td>{{publication_date}}</td><td>{{num_words}}</td><td>{{word_percent_scratch}}% scratch / {{word_percent_in_edited_sentence}}% in-edited / {{word_percent_approved}}% approved </td><td>{{num_chars}}</td><td>{{char_percent_scratch}}% scratch / {{char_percent_edited}}% edited / {{char_percent_left_alone}}% left-alone / {{char_percent_approved}}% approved </td><td>{{cost_per_word}}</td><td>{{#evaluating_username}} Sent to {{evaluating_username}}{{/evaluating_username}}{{#eval_username}}<form action="/translation_quality_eval/{{translation_id}}" method="post"><input type="submit" value="Send to {{eval_username}} for review (${{eval_price}})"></form>{{/eval_username}}</td></tr>{{/published_translations}}</tbody></table>',
"diagnose-session-generator":' <head><style> .candidate_table col:nth-child(2n+5) { background: #ddd } .candidate_table col:nth-child(2n+6) { background: #eee }</style></head><form>{{>lesson-selector}}<br><b>Session type:</b><select name="session_type">{{#session_types}}<option value="{{type}}" {{#selected}}selected{{/selected}}>{{type}}</option>{{/session_types}}</select><br><b>Device:</b><select name="device">{{#devices}}<option value="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/devices}}</select><br><b>Username:</b><input type="text" name="username" value="{{username}}"><br><b>History (JSON string):</b><input type="text" name="history" value="{{history}}"><br><b>KC states (JSON string):</b><input type="text" name="kc_states" value="{{kc_states}}"><br><input type="checkbox" name="return_trace" value="1" {{#return_trace}}checked{{/return_trace}}>Include algorithm trace (bypasses lesson cache) <br><br><input type="submit" value="Submit"></form><hr><br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Challenge type</th><th>Sentence or Lexeme</th><th>Failure rate</th></tr></thead><tbody>{{#session_elements}}<tr><td><pre>{{type}}</pre></td><td><pre>{{#sentence}}{{sentence}}{{/sentence}}{{^sentence}}{{#lexeme}}{{lexeme}}{{/lexeme}}{{^lexeme}}[{{generator_id}}]{{/lexeme}}{{/sentence}}</pre>{{#is_form}}<pre>(Options: [{{#options}}{{display_value}}{{^last}}, {{/last}}{{/options}}])</pre>{{/is_form}}</td><td>{{num_failed}}/{{num_total}} ({{percent_failed}}%) </td></tr>{{/session_elements}}</tbody></table><br>Session length: {{session_length}}{{#return_trace}}<h1>Algorithm trace</h1>{{#steps}}<h2>SessionGeneratorState before picking element {{index}}</h2>{{#state}}<table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Variable</th><th>Value</th></tr></thead><tbody><tr><td>Lexemes introduced in lesson so far (<tt>learning_words</tt>)</td><td>{{#learning_words}}{{lexeme_string}}<br>{{/learning_words}}</td></tr><tr><td>Strong lexemes (<tt>strong_lexeme_ids</tt>)</td><td>{{#strong_words}}{{lexeme_string}}<br>{{/strong_words}}</td></tr><tr><td>Lexemes left to teach (<tt>left_to_teach</tt>)</td><td>{{#left_to_teach}}{{lexeme_string}}<br>{{/left_to_teach}}</td></tr></tbody></table>{{/state}}<br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Challenge type</th><th>#(times picked)</th><th>Max total</th><th>Max remaining</th></tr></thead><tbody>{{#challenge_types}}<tr><td>{{challenge_type}}</th><td>{{num_times_picked}}</th><td>{{max_total}}</th><td>{{max_remaining}}</th></tr>{{/challenge_types}}</tbody></table><h2>Candidates for SessionElement {{index}}</h2><table class="candidate_table" border="1" rules="groups" cellpadding=10><col><col><col><col>{{#features}}<col>{{/features}}<thead bgcolor="aaddff"><tr><th>Score</th><th>Challenge type</th><th>Weight</th><th>Sentence or Lexeme</th>{{#features}}<th>{{feature_name}}</th>{{/features}}</tr></thead>{{#score_groups}}<tbody>{{#candidates}}<tr {{#selected}}bgcolor="limegreen"{{/selected}}><td>{{#first}}<pre>{{score}}</pre>{{/first}}</td><td><pre>{{type}}</pre></td><td>{{#weight}}<pre>{{weight}}</pre>{{/weight}}</td><td><pre>{{#sentence}}{{sentence}}{{/sentence}}{{^sentence}}{{#lexeme}}{{lexeme}}{{/lexeme}}{{^lexeme}}[{{generator_id}}]{{/lexeme}}{{/sentence}}</pre></td>{{#feature_values}}<td>{{#nonzero}}{{contrib}}{{/nonzero}}</td>{{/feature_values}}</tr>{{/candidates}}</tbody>{{/score_groups}}</table>{{/steps}}<h2>Feature statistics</h2> Statistics are for all candidate challenges, for all steps of the algorithm. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Feature</th><th>%(non-zero values)</th><th>Average contribution (value*coefficient)</th><th>Median contribution</th></tr></thead><tbody>{{#features}}<tr><td>{{feature_name}}</td><td>{{percent_nonzero}}</td><td>{{average_contribution}}</td><td>{{median_contribution}}</td></tr>{{/features}}</tbody></table>{{/return_trace}}',
"diagnose-session-generator-optimizer":' <h1>Coefficients for feature-based session generation</h1><form><b>Feature set:</b><select name="feature_set">{{#feature_sets}}<option value="{{value}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/feature_sets}}</select><input type="submit" value="Submit"></form><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Feature</th><th>Coefficient</th></tr></thead><tbody>{{#coefficients}}<tr><td>{{feature}}</td><td>{{coefficient}}</td></tr>{{/coefficients}}</tbody></table><br>Number of rounds: {{num_rounds}}',
"diagnose-translation-quality":'<html><title>Translation quality metrics</title><h1>Translation quality metrics</h1><form> Select AB test: <select name="experiment">{{#ab_tests}}<option value="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/ab_tests}}</select><br><br>Start date: <input type="text" name="start" {{#start}}value="{{start}}"{{/start}}><br>End date: <input type="text" name="end" {{#end}}value="{{end}}"{{/end}}><br>(Start and end dates are inclusive.) <br>{{#filters}}<br>{{name}}: <select name="{{name}}">{{#values}}<option value="{{value}}" {{#selected}}selected{{/selected}}>{{text}}</option>{{/values}}</select>{{/filters}}<br><br><input type="submit" value="Submit"></form><hr>{{#experiment}}<table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Variable</th>{{#options}}<th>{{option}}</th>{{/options}}</tr></thead><tbody><tr><td>Num. original submissions</td>{{#options}}<td>{{num_original_submissions}}</td>{{/options}}</tr><tr><td>Num. live original submissions</td>{{#options}}<td>{{num_live_original_submissions}} ({{percent_live_original_submissions}}%)</td>{{/options}}</tr><tr><td>Num. edits</td>{{#options}}<td>{{num_edits}}</td>{{/options}}</tr><tr><td>Num. live edits</td>{{#options}}<td>{{num_live_edits}} ({{percent_live_edits}}%)</td>{{/options}}</tr><tr><td>Num. sentence translations (edits or original submissions)</td>{{#options}}<td>{{num_sentence_translations}}</td>{{/options}}</tr><tr><td>Num. live sentence translations</td>{{#options}}<td>{{num_live_sentence_translations}} ({{percent_live_sentence_translations}}%)</td>{{/options}}</tr><tr><td>Total ratings</td>{{#options}}<td>{{total_ratings}}</td>{{/options}}</tr><tr><td>Total positive ratings</td>{{#options}}<td>{{total_pos_ratings}} ({{percent_positive_ratings}}%)</td>{{/options}}</tr><tr><td>Num. sentence translations rated</td>{{#options}}<td>{{num_sentence_translations_rated}}</td>{{/options}}</tr><tr><td>Avg. fraction of ratings that were positive</td>{{#options}}<td>{{avg_frac_positive}}</td>{{/options}}</tr><tr><td>Avg. estimated probability that translation is "good"</td>{{#options}}<td>{{avg_cur_prob_good}}</td>{{/options}}</tr><tr><td>Avg. estimated normalized edit distance</td>{{#options}}<td>{{avg_expected_edit_distance}}</td>{{/options}}</tr></tbody></table>{{/experiment}}</html>',
"diagnose-translation-ranker":'<form><br>Translation direction: <select name="direction">{{#directions}}<option name="{{source}}_{{target}}" {{#selected}}selected{{/selected}}>{{source}}->{{target}}</option>{{/directions}}</select><br>Sort order: <select name="sort">{{#sorts}}<option name="{{sort}}" {{#selected}}selected{{/selected}}>{{sort}}</option>{{/sorts}}</select><br><br>Progress states: {{#progress_states}}<br><input type="checkbox" name="progress_state_{{state}}" {{#checked}}checked{{/checked}}>{{label}}{{/progress_states}}<br><br><input type="submit"></form>{{#have_ranked_translations}}<hr><br>Showing first {{limit}} documents, out of {{total_documents}} total. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><th>Title</th><th>Progress state</th><th>Category</th><th>Score</th></thead>{{#ranked_translations}}<tr><td>{{title}}</td><td>{{progress_state}}</td><td>{{category}}</td><td>{{score}}</td></tr>{{/ranked_translations}}</table>{{/have_ranked_translations}}',
"diagnose-translation-search":'<form><br>Translation direction: <select name="direction">{{#directions}}<option name="{{source}}_{{target}}" {{#selected}}selected{{/selected}}>{{source}}->{{target}}</option>{{/directions}}</select><br>Sort order: <select name="sort">{{#sorts}}<option name="{{sort}}" {{#selected}}selected{{/selected}}>{{sort}}</option>{{/sorts}}</select><br><br>Progress states: {{#progress_states}}<br><input type="checkbox" name="progress_state_{{state}}" {{#checked}}checked{{/checked}}>{{label}}{{/progress_states}}<br><br><input type="submit"></form>{{#have_ranked_translations}}<hr><br>Showing first {{limit}} documents, out of {{total_documents}} total. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><th>Title</th><th>Progress state</th><th>Category</th><th>Score</th></thead>{{#ranked_translations}}<tr><td>{{title}}</td><td>{{progress_state}}</td><td>{{category}}</td><td>{{score}}</td></tr>{{/ranked_translations}}</table>{{/have_ranked_translations}}',
"diagnose-trusted-translation":' <h1>Details for translation of <i>{{document_title}}</i> from {{document_language}} into {{target_language}}.</h1><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th style="width:34%">Original sentence</th><th style="width:33%">User translation</th><th style="width:33%">Trusted translation</th></tr></thead><tbody>{{#sentences}}<tr><td>{{source_text}}</td><td>{{#diff}}{{#equal}}{{old_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{old_text}}</span>{{/equal}}{{/diff}}{{^diff}}{{#user_text}}{{user_text}}{{/user_text}}{{^user_text}} [None] {{/user_text}}{{/diff}}</td><td>{{#diff}}{{#equal}}{{new_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{new_text}}</span>{{/equal}}{{/diff}}{{^diff}}{{#trusted_text}}{{trusted_text}}{{/trusted_text}}{{^trusted_text}} [None] {{/trusted_text}}{{/diff}}</td></tr>{{/sentences}}</tbody></table> ',
"diagnose-user-performance-model":' <h1>User performance model</h1><form> Username: <input type="text" name="username" value="{{username}}"><br>{{>lesson-selector}}<br><br><input type="submit" value="Submit"></form></form><h2>Predicted performance of {{username}} by challenge type</h2><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Challenge type</th><th>Prior Pr[correct]</th></tr></thead><tbody>{{#element_types}}<tr><td>{{element_type}}</td><td><a href="/diagnostics/user_performance_model_query?username={{username}}&element_type={{element_type}}&learning_lang={{learning_lang}}&from_lang={{from_lang}}&skill_id={{skill_id}}&lesson_number={{lesson_number}}">{{prior_prob}}</td></tr>{{/element_types}}</tbody></table><br><h2>Model parameters for {{username}}</h2><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Logistic model feature</th><th>Coefficient (log odds)</th></tr></thead><tbody>{{#parameters}}<tr><td>{{feature_name}}</td><td>{{coefficient}}</td></tr>{{/parameters}}</tbody></table><br><h2>Model parameters for top 50 challenges of {{lesson_name}} (excluding select challenges)</h2><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Challenge type</th><th>Sentence or lexeme</th><th>Learning coefficient</th><th>Difficulty coefficient</th><th>Pr[{{username}} gets challenge correct]</th><th>Pr[a new user gets challenge correct]</th><th>Empirical success rate (including partially-finished lessons)</th></tr></thead><tbody>{{#challenges}}<tr><td><pre>{{element_type}}</pre></td><td><pre>{{#sentence}}{{sentence}}{{/sentence}}{{^sentence}}{{#lexeme}}{{lexeme}}{{/lexeme}}{{^lexeme}}[{{generator_id}}]{{/lexeme}}{{/sentence}}</pre></td><td>{{learning_coefficient}} [{{learning_coefficient_lower}}, {{learning_coefficient_upper}}]</td><td>{{difficulty_coefficient}}</td><td><a href="/diagnostics/user_performance_model_query?generator_id={{generator_id}}&username={{username}}&element_type={{element_type}}&learning_lang={{learning_lang}}&from_lang={{from_lang}}&skill_id={{skill_id}}&lesson_number={{lesson_number}}">{{prob_user_correct}}</a></td><td><a href="/diagnostics/user_performance_model_query?generator_id={{generator_id}}&username=DuoBot&element_type={{element_type}}&learning_lang={{learning_lang}}&from_lang={{from_lang}}&skill_id={{skill_id}}&lesson_number={{lesson_number}}">{{prob_new_user_correct}}</a></td><td>{{correct_rate}}</td></tr>{{/challenges}}</tbody></table> ',
"diagnose-user-translations":'<a name="top"><form> View all translations for user: <input type="text" name="user" {{#username}}value="{{username}}"{{/username}}> <input type="submit" value="Submit"></form>{{#username}}{{^user_id}} User {{username}} not found in database. {{/user_id}}{{#user_id}}<b>{{username}}</b> has contributed: <ul>{{#directions}}<li><a href="/diagnostics/user_translations?user={{username}}&source_lang={{source_language}}&target_lang={{target_language}}">{{num_translations}} {{source_language}}->{{target_language}} translation(s)</a> (reputation tier {{reputation_tier}}) {{/directions}}</ul> Showing only {{source_lang}}->{{target_lang}} translations below. <hr><h1>Summary</h1><b>{{username}}</b> has contributed {{count_for_direction}} {{source_lang}}->{{target_lang}} translation(s) since {{wiki_translation_launch_date}}, the date when wiki translations were launched to all users. {{#not_showing_all}}<br><br>Showing translations {{begin_index}}-{{end_index}} of {{count_for_direction}}. Jump to page: {{#pages}}&nbsp;<a style="{{#current}}font-weight:bold{{/current}}" href="/diagnostics/user_translations?user={{username}}&page={{page}}&per_page={{per_page}}">{{page}}</a>{{/pages}}{{/not_showing_all}}<ul><li>{{num_live}} translation(s) are live. <li>{{num_non_live}} translations(s) have been reverted or edited by other users. <li>{{num_deleted}} translation(s) have been deleted by an admin. {{#ban_lift_date}}<li><b>{{username}} is banned from doing wiki translations until {{ban_lift_date}}</b>{{/ban_lift_date}}{{#shadow_banned}}<li><b>{{username}} was on shadow-banned by {{admin_username}} on {{shadow_ban_date}}</b>{{/shadow_banned}}</ul> Jump to <ul><li><a href="#original_translations">{{num_original_translations}} original translation(s)</a><li><a href="#edits">{{num_edits}} edits of another user\'s translation</a><li><a href="#abuse_reports">{{num_abuse_reports}} user(s) who {{username}} has reported for abuse</a></ul><h1>Disciplinary actions</h1><form action="/wiki_translations/revert_all/{{user_id}}" method="post"><input type="submit" name="submit" value="REVERT all live translations/edits from this user"></form><form action="/wiki_translations/temporarily_ban_user/{{user_id}}" method="post"><input type="submit" name="submit" value="TEMPORARILY BAN this user for 1 week, and take away their translation points (the user will know they have been banned)"></form><form action="/wiki_translations/undo_downvotes/{{user_id}}" method="post"><input type="submit" name="submit" value="UNDO all downvotes from this user"></form><a name="original_translations"><h1>{{num_original_translations}} original translation(s)</h1> Translations that are live are shown in black. <span style="color:gray">Translations that have been reverted or edited by another user are gray.</span><br><br><a href="#top">Back to top</a><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Date</th><th>Source sentence</th><th>Translation from {{username}}</th></tr></thead><tbody>{{#original_translations}}<tr><td>{{date}}</td><td><a href="/translation/{{translation_id}}$index={{sentence_index}}">{{source_sentence}}</a></td><td><span style="{{^live}}gray{{/live}}">{{target_sentence}}</span></td></tr>{{/original_translations}}</tbody></table><a name="edits"><h1>{{num_edits}} edit(s)</h1><a href="#top">Back to top</a><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Date</th><th>Source sentence</th><th>Previous translation</th><th>Translation from {{username}}</th></tr></thead><tbody>{{#edits}}<tr><td>{{date}}</td><td><a href="/translation/{{translation_id}}">{{source_sentence}}</a></td><td>{{#diff}}{{#equal}}{{old_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{old_text}}</span>{{/equal}}{{/diff}}</td><td><span style="{{^live}}color:gray{{/live}}">{{#diff}}{{#equal}}{{new_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{new_text}}</span>{{/equal}}{{/diff}}</span></td></tr>{{/edits}}</tbody></table><a name="abuse_reports"><h1>{{num_abuse_reports}} abuse report(s)</h1>{{username}} has reported the following translators for abuse: {{#num_abuse_reports}}<ol>{{#reported_translators}}<li><a href="/diagnostics/user_translations?user={{reported_username}}">{{reported_username}}</a>{{/reported_translators}}</ol>{{/num_abuse_reports}}<h1>Translation quality model parameters (for {{source_lang}}->{{target_lang}})</h1><form> Number of words in sentence: <input type="text" name="sentence_num_words" value="{{sentence_num_words}}"><input type="submit" value="Submit"><input type="hidden" name="user" value="{{username}}"></form><form action="/wiki_translations/set_user_translation_quality_params/{{user_id}}/{{source_lang}}/{{target_lang}}" method="post">{{#quality_params}}<br>{{name}}: <input type="text" name="{{name}}" value="{{value}}">{{/quality_params}}<br><input type="submit" value="Overwrite parameters (don\'t do this unless you know what you are doing!)"></form>{{/user_id}}{{/username}} ',
"diagnose-user-vocab-bucketing":" <h1>User vocab. bucketing for users learning {{learning_language}} from {{ui_language}}</h1>{{#buckets}}<h2>Vocab size between {{min_lexemes}} and {{max_lexemes}}</h2>{{#lexeme_dist}}{{> table}}{{/lexeme_dist}}{{/buckets}}","diagnose-why-offensive":'<form> Enter URL: <input type="text" name="url" size="128" value="{{url}}"><input type="submit"></form>{{#url}}{{#could_not_load}} Could not load URL. {{/could_not_load}}{{^could_not_load}}<br>Detected language: {{language}}<br>Offensive words: <ul>{{#offensive_words}}<li>{{word}}{{/offensive_words}}</ul>{{/could_not_load}}{{/url}} ',
"diagnose-wiki-document-sentence":'<html><body><h1>Details for translation <a href="/diagnostics/wiki_translation/{{translation_id}}">{{translation_id}}</a>, DocumentSentence {{document_sentence_id}}</h1><br>Source sentence: <i>{{source_sent_text}}</i><h2>Revision history</h2>{{#revisions_table}}{{> table}}{{/revisions_table}}<br><b>Watchers:</b> {{#watchers}}{{name}} {{/watchers}}<form action="/add_wiki_translation_revision/{{translation_id}}/{{document_sentence_id}}" method="post"><br>Add revision: <input type="text" name="translation" size=100><input type="submit" name="submit" value="Submit"></form></body></html> ',
"diagnose-wiki-translation":'<html><body><h1>Details for translation of <i>{{document_title}}</i> from {{document_language}} into {{target_language}}. </h1>{{^disabled}}<form action="/wiki_translations/{{translation_id}}/disable" method="post"><input type="submit" name="submit" value="Disable this translation (remove it from Immersion and return a 404 if anyone goes to it)"></form>{{/disabled}}{{#disabled}}<form action="/wiki_translations/{{translation_id}}/enable" method="post"> This translation has been disabled. <input type="submit" name="submit" value="Re-enable it"></form>{{/disabled}}{{num_sents_started}}/{{num_sents}} sentence(s) have a user-submitted translation. <br>{{num_sents_trusted}}/{{num_sents}} sentence(s) have a <b>trusted</b> translation. <br><br>Progress state in DB: {{#have_db_progress_state}}{{db_progress_state}}{{/have_db_progress_state}}{{^have_db_progress_state}}<i>None</i>{{/have_db_progress_state}}<br>Computed progress state: {{computed_progress_state}}<br>Flesch-Kincaid grade level: {{flesch_kincaid_grade_level}}{{#indexed}}<br>Content rating: {{content_rating_name}}<br>{{#content_rating}}<form action="/wiki_translations/{{translation_id}}/set_content_rating" method="post"><input type="hidden" name="rating" value="0"><input type="submit" name="submit" value="Set content rating to G"></form>{{/content_rating}}{{^content_rating}}<form action="/wiki_translations/{{translation_id}}/set_content_rating" method="post"><input type="hidden" name="rating" value="2"><input type="submit" name="submit" value="Set content rating to PG-13"></form>{{/content_rating}}{{/indexed}}{{^indexed}}<br>Translation is not in elasticsearch index! {{/indexed}}<h2>Document sentences</h2>{{#document_sentence_table}}{{> table}}{{/document_sentence_table}}<h2>Watchers</h2>{{#watchers}}<br>{{name}}{{/watchers}}{{#indexed}}<h2>Elasticsearch JSON</h2><pre>{{elasticsearch_json}}</pre>{{/indexed}}</body></html> ',
"diagnose-wrong-answers":'<style> .challenge_table > tbody > tr:nth-child(2n+2) { background: #eee }</style><h1>Common wrong answers</h1>{{#generator}} Sentence or lexeme: <pre>{{#sentence}}{{sentence}}{{/sentence}}{{^sentence}}{{#lexeme}}{{lexeme}}{{/lexeme}}{{^lexeme}}[{{generator_id}}]{{/lexeme}}{{/sentence}}</pre>{{/generator}} Challenge type: <pre>{{challenge_type}}</pre><table class="challenge_table" border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Wrong answer</th><th>Blame</th><th>#(times seen)</th><th>%(times seen)</th></tr></thead><tbody>{{#wrong_answers}}<tr><td><pre>{{answer}}</pre></td><td>{{blame}}</td><td>{{count}}</td><td>{{ratio}}</td></tr>{{/wrong_answers}}</tbody></table> ',
direction:'<div id="profile-content" class="settings-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><h1>{{#_i}}Language{{/_i}}<div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div></h1><ul class="list-settings language-direction"><li><label class="label">{{#_i}}Learning Language{{/_i}}</label><div class="input"><label class="blue-select no-focus smaller fixed-width"><select name="language_direction" id="language_direction" {{#experimental}} disabled{{/experimental}}>{{#language_directions}}<option value="{{value}}" {{#selected}}selected="selected"{{/selected}}>{{prompt}}</option>{{/language_directions}}</select></label></div></li><li id="chinese-script-choice" class="{{^is_chinese}}hidden{{/is_chinese}}"><label class="label">{{#_i}}Script{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="simplified" name="locale" type="radio" data-language="zs" value="zs" {{^traditional}}checked{{/traditional}}> \u7b80\u4f53 </label></li><li><label><input class="border" id="traditional" name="locale" type="radio" data-language="zs" value="zt" {{#traditional}}checked{{/traditional}}> \u7e41\u9ad4 </label></li></ul></div></li><li><div class="input"><div style="margin: 10px 0 0 0;"><a href="/courses" class="btn btn-blue">{{#_i}}See all language courses{{/_i}}</a></div>{{^trial_account}}<div style="margin: 30px 0 0 0;"><a href="/settings/reset_lang">{{#_i}}Reset or remove languages{{/_i}}</a></div>{{/trial_account}}</div></li></ul></div> ',
"discussion-page":'<div id="discussion-modal" class="discussion-modal-wrapper fade hidden"><div class="close-modal-background"></div><div class="modal player-discussion"><div id="close-discussion-modal" class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div><div class="modal-body">{{#logged_in}}{{^trial_account}}<header class="discussion-header" style="padding: 0 0 20px 0;">{{#comment}}{{#num_comments}}<button id="watch" class="btn right btn-green {{#following}}checkmark{{/following}}">{{#following}}{{#_i}}Following Discussion{{/_i}}{{/following}}{{^following}}{{#_i}}Follow Discussion{{/_i}}{{/following}}</button>{{/num_comments}}{{/comment}}{{#admin_user}}<h3 class="gray" style="margin: 10px 0 0 0;"><a href="/comment/{{#comment}}{{id}}{{/comment}}">{{#_i}}View the discussion{{/_i}}</a></h3>{{/admin_user}}</header>{{/trial_account}}{{/logged_in}}<div class="discussion-main" style="margin-bottom: 50px;"><div class="original-post"><h1 style="margin-bottom: 15px;"><span id="speaker-audio-1-button" class="speaker-small"><span class="listen-button-small icon icon-speaker-small {{#rtl}}img-flipped{{/rtl}}"></span></span> "<span class="title translation-source">{{text}}</span>" </h1><div class="discussion-main-body" style=""><p><span class="float-label"><strong>{{#_i}}Translation:{{/_i}}</strong></span> <span class="trans">{{translation}}</span></p></div></div>{{#logged_in}}{{^trial_account}}{{^frozen}}{{^disable_commenting}}<div class="discussion-main-new-comment">{{#logged_in_user}}<span class="left">{{>avatar_medium}}</span>{{/logged_in_user}}<textarea placeholder="{{#_i}}Discuss this sentence with others{{/_i}}" style="" class="comment-box textarea-block textarea-autogrow" id="post-text-box" name="post"></textarea><div id="comment-fields"><div class="player-discuss-guide hidden warning-message more-margin-bottom"><p style="margin: 0;">{{#_i}}Stop the clutter! Please do not report mistakes here and <strong>read the comments below</strong> before posting.{{/_i}}</p></div><span class="hidden" id="post-button"><input id="post-comment" type="submit" class="btn btn-green margin-right" value="{{#_i}}Post Comment{{/_i}}"></span><span class="hidden" id="post-button"><input type="reset" class="btn btn-standard cancel-update-comment" value="{{#_i}}Cancel{{/_i}}"></span></div></div>{{/disable_commenting}}{{/frozen}}{{/trial_account}}{{/logged_in}}</div><div class="discussion-comments"><h2>{{#comment}}{{num_comments}} {{#pluralize}}{{#_i}}Comment{{/_i}},{{#_i}}Comments{{/_i}},{{num_comments}}{{/pluralize}}{{/comment}}{{^comment}}{{#_i}}No one has commented yet.{{/_i}}{{/comment}}{{#frozen}}<div class="locked-discussion-message"><span class="icon-lock icon"></span>{{#_i}}This discussion is locked.{{/_i}}</div>{{/frozen}}</h2><ul id="comments" class="discussion-comments-list">{{#comments}}{{^removed}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/removed}}{{#removed}}{{#deleted}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/deleted}}{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/undeletable}}{{/deleted}}{{/removed}}{{/comments}}{{#comment}}<li class="show-toggle comment" id="show-toggle"><a href="javascript:;" class="show-bad-comment">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/comment}}</ul></div></div></div></div> ',
"document-instructions":"{{#view_original}}{{#no_sentence_selected}}<h1>{{#_i}}Click a sentence to help translate it{{/_i}}</h1>{{/no_sentence_selected}}{{#untranslated_sentence_selected}}<h1>{{#_i}}Translate this sentence and get {{num_points_for_original_translation}} {{#pluralize}}XP,XP,{{num_points_for_original_translation}}{{/pluralize}}{{/_i}}</h1>{{/untranslated_sentence_selected}}{{#translated_sentence_selected}}<h1>{{#_i}}Rate or edit this translation{{/_i}}</h1>{{/translated_sentence_selected}}{{#translation_from_self_selected}}<h1>{{#_i}}Thank you for your translation!{{/_i}}</h1>{{/translation_from_self_selected}}{{/view_original}} ",
dragon_outfit_description:"{{#_i}}Duo would love to celebrate the Lunar New Year with this festive costume.{{/_i}} ",dragon_outfit_title:"{{#_i}}Dragon Costume{{/_i}} ",event:"<li>{{datetime}}: {{username}}</li>","event-comments":'<ul class="stream-item-comment-list">{{#has_comments}}{{#comments}}<li><span class="left small-margin-right"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}:</a></span><bdi>{{{processed_message}}}</bdi><span class="stream-item-time"></span></li>{{/comments}}{{/has_comments}}{{#logged_in}}{{^trial_account}}{{^is_blocked}}<li><div class="stream-item-comment-new"><div class="col-input"><textarea id="comment-box-{{id}}" class="post textarea-white textarea-block textarea-autogrow" placeholder="{{#_i}}New comment{{/_i}}" style="" dir="auto"></textarea></div><div class="col-btn"><button class="btn btn-green post-event-comment">{{#_i}}Post{{/_i}}</button></div></div></li>{{/is_blocked}}{{/trial_account}}{{/logged_in}}</ul> ',
"event-context-menu":'{{#channel}}<span class="icon icon-gear-small event-context" data-channel="{{channel}}" data-channel-source="{{channel_source}}" data-channel-subscribed="true"><ul class="dropdown-menu even-context-menu hidden"><li class="subscribed"><span>{{#_i}}You are following {{channel_display}}{{/_i}}</span></li><li class="unsubscribed"><span>{{#_i}}You are not following {{channel_display}}{{/_i}}</span></li><li class="divider"></li><li class="subscribed"><a class="unfollow-channel" href="javascript:;">{{#_i}}Unfollow {{channel_display}}{{/_i}}</a></li><li class="unsubscribed"><a class="follow-channel" href="javascript:;">{{#_i}}Follow {{channel_display}}{{/_i}}</a></li></ul></span>{{/channel}} ',
"event-footer":'{{^stream_post}}<div class="stream-comments {{^has_comments}}hidden{{/has_comments}}"></div>{{/stream_post}}{{>event-context-menu}}<ul class="stream-item-social-links">{{#deletable}}<li><a href="javascript:;" class="delete-stream-post">{{#_i}}Delete{{/_i}}</a></li>{{/deletable}}{{#logged_in}}{{^trial_account}}{{^is_blocked}}<li class="upvotes"><a href="javascript:;" class="vote {{#user_liked}}liked{{/user_liked}}" {{#likes}} data-toggle="tooltip" data-original-title= {{#liked_short_list}}{{#one}}"{{item_one}}"{{/one}}{{#two}}"{{#_i}}{{item_one}} and {{item_two}}{{/_i}}"{{/two}}{{#three}}"{{#_i}}{{item_one}}}, {{item_two}} and {{item_three}}{{/_i}}"{{/three}}{{#more}}"{{#_i}}{{item_one}}, {{item_two}} and {{remainder}} {{#pluralize}}other,others,{{remainder}}{{/pluralize}}{{/_i}}"{{/more}}{{/liked_short_list}}{{/likes}}>{{#user_liked}}{{#_i}}Liked{{/_i}}{{/user_liked}}{{^user_liked}}{{#_i}}Like{{/_i}}{{/user_liked}} {{#likes}}({{likes}}){{/likes}}</a></li>{{^comment_data}}{{^stream_post}}<li class="show-comments"><a href="javascript:;">{{#_i}}Comment{{/_i}}</a></li>{{/stream_post}}{{/comment_data}}{{/is_blocked}}{{/trial_account}}{{/logged_in}}{{^logged_in}}{{#likes}}<li class="upvotes"><span class="gray" data-toggle="tooltip" data-original-title={{#liked_short_list}}{{#one}}"{{item_one}}"{{/one}}{{#two}}"{{#_i}}{{item_one}} and {{item_two}}{{/_i}}"{{/two}}{{#three}}"{{#_i}}{{item_one}}}, {{item_two}} and {{item_three}}{{/_i}}"{{/three}}{{#more}}"{{#_i}}{{item_one}}, {{item_two}} and {{remainder}} {{#pluralize}}other,others,{{remainder}}{{/pluralize}}{{/_i}}"{{/more}}{{/liked_short_list}}>{{#_i}}{{likes}} {{#pluralize}}like,likes,{{likes}}{{/pluralize}}{{/_i}}</span></li>{{/likes}}{{/logged_in}}{{#is_blocked}}{{#likes}}<li class="upvotes"><span class="gray" data-toggle="tooltip" data-original-title={{#liked_short_list}}{{#one}}"{{item_one}}"{{/one}}{{#two}}"{{#_i}}{{item_one}} and {{item_two}}{{/_i}}"{{/two}}{{#three}}"{{#_i}}{{item_one}}}, {{item_two}} and {{item_three}}{{/_i}}"{{/three}}{{#more}}"{{#_i}}{{item_one}}, {{item_two}} and {{remainder}} {{#pluralize}}other,others,{{remainder}}{{/pluralize}}{{/_i}}"{{/more}}{{/liked_short_list}}>{{#_i}}{{likes}} {{#pluralize}}like,likes,{{likes}}{{/pluralize}}{{/_i}}</span></li>{{/likes}}{{/is_blocked}}</ul> ',
events:'<ul class="activity-stream">{{#logged_in}}{{^current_user_profile}}{{^is_blocking}}{{^is_blocked_by}}{{^viewer_trial_account}}<li class="stream-item">{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><ul class="stream-item-comment-list" style="margin-top: -10px;"><li><div class="post-activity stream-item-comment-new"><div class="col-input"><textarea id=\'stream-post\' style="" class="post textarea-white textarea-block textarea-autogrow" placeholder="{{#_i}}Write to {{username}}{{/_i}}" dir="auto"></textarea></div><div class="col-btn"><button id="stream-post-btn" class="btn btn-green">{{#_i}}Post{{/_i}}</button></div></div></li></ul></li>{{/viewer_trial_account}}{{/is_blocked_by}}{{/is_blocking}}{{/current_user_profile}}{{/logged_in}}{{#error}}<li>There is an error retrieving your stream.</li>{{/error}}</ul>{{#more_events}}<a id="more-stream" class="btn" href="javascript:;">{{#_i}}load more{{/_i}}</a>{{/more_events}} ',
"exam-progress-bar":'<div class="progress-bar-dynamic left simplified-bar" style="width: 340px;">{{#confidence}}<div class="bar" style="width: {{confidence}}%;"></div>{{/confidence}}</div>',"example-name-element":'<h1>{{#_i}}<strong>Remember</strong> this word{{/_i}}</h1><span id="big-speaker"></span><h3>{{phrase}} {{#hint}} = {{hint}}{{/hint}}</h3>{{>name-images}}',"facebook-description":"{{#_i}}With Duolingo you learn a language for free, while helping to translate the web.{{/_i}} ","fake-textarea":'<bdi><div id="graded-text-input" class="textarea-block textarea-lg textarea-translate fake-textarea">{{#user_avatar}}{{>avatar_small}}{{/user_avatar}}{{text}}{{#unknown}}<a href="javascript:;" class="suggest-edit edit-icon immediate-edit">{{#_i}}Edit{{/_i}}</a>{{/unknown}}</div></bdi>{{#unknown}}<span class="edit-final-panel">{{#completed_translation}}<a href="javascript:;" style="margin: 0 15px 0 0;" class="show-final-translation switch-final-icon">{{#_i}}Show final translation{{/_i}}</a>{{/completed_translation}}<a href="javascript:;" class="suggest-edit edit-icon" style="display: none">{{#_i}}Edit{{/_i}}</a></span>{{/unknown}}{{#unknown}}<a href="javascript:;" class="save-edit btn right primary" style="display: none; margin: 5px 0 0 5px;">{{#_i}}Save{{/_i}}</a> <a href="javascript:;" class="cancel-edit btn right" style="display: none; margin: 5px 0 0 0">{{#_i}}Cancel{{/_i}}</a>{{/unknown}} ',
feedback_response:'<html><head>{{#css}}<link rel="stylesheet" href="{{.}}" type="text/css" media="screen" />{{/css}}<style type="text/css"> body { background: white; font-size: 13px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #404040; padding: 10px 10px 10px 20px; }</style></head><body><div id="success" style="background-color:white"><strong>{{#_i}}Thanks for your feedback!{{/_i}}</strong><br/>{{#logged_in}}{{#_i}}Our team will look into your suggestions and we will get back to you if we have further questions.{{/_i}}</div>{{/logged_in}}{{^logged_in}}{{#_i}}Our team will look into your suggestions.{{/_i}}</div>{{/logged_in}}</body></html>',
finishers:'<!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e <html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Duolingo: Get Tested</title>{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}<style> p { background:#fff; } .cloudy { background: url(\'/images/clouds.png\') no-repeat; background-position: 0px 200px; } h2 { font-weight:normal !important;}</style><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /></head><body><div id="site"><div id="wrapper"><div id="app" class="study">{{#valid}}<div class="cloudy">{{#completed}}<h1>You completed the test!</h1><div class="summary"><p>Thanks for taking the <strong>{{display_language}} webCAPE exam</strong>. Your score is:</p><p class="center signup-box" style="font-size:5em"><strong>{{score}}</strong></p><p>At many colleges and universities, this score qualifies you to place into {{#sem1}}<strong>first semester {{display_language}}</strong>. {{/sem1}}{{#sem2}}<strong>second semester {{display_language}}</strong>. Nice job! {{/sem2}}{{#sem3}}<strong>third semester {{display_language}}</strong>. Congratulations! {{/sem3}}{{#sem4}}<strong>fourth semester {{display_language}}</strong> <em>or higher</em>. Amazing! {{/sem4}}</p></div>{{^sem1}}<div style="margin-bottom:20px;"><img style="margin:auto;" src="/images/owl-graduated.png"/></div><div class="center signup-box"><a class="btn xlarge primary signup" href="/">&laquo; Back to Duolingo</a></div>{{/sem1}}<div class="summary"><p style="color:#777;">Note: While many universities use webCAPE for placement, a high score here does not guarantee you university credit.</p></div>{{/completed}}{{^completed}}<h1>Get tested.</h1><h2 class="offset">Take a university placement exam on us!</h2>{{#in_progress}}<div class="summary"><p>Welcome back, <strong>{{username}}</strong>!</p><p>It looks like you may have already started the <strong>{{display_language}} exam</strong>. Please click the button below to finish the test and get your results!</p></div><div class="center signup-box"><a class="btn xlarge primary signup" href="{{webcape_test_url}}">Click here to continue</a></div>{{/in_progress}}{{^in_progress}}<div class="summary">\x3c!-- <p>Congratulations again for conquering the <strong>Duolingo {{display_language}} tree</strong>.</p> --\x3e<p>To really flex your new linguistic muscles, we are inviting you to take the <strong>{{display_language}} webCAPE exam</strong> &mdash; a standard placement test used by more than a thousand colleges and universities &mdash; and we\'ll foot the bill. Just click the link below to get started.</p><p>The test is <strong>multiple-choice</strong> and usually takes <strong>15-30 minutes</strong>. Your participation helps our research team understand how effective Duolingo is for you and your {{display_language}}-learning peers. Thanks!</p></div><div class="center signup-box"><a class="btn xlarge primary signup" href="{{webcape_test_url}}">Click here to get started</a></div><div class="summary"><p style="color:#777;">Note: while many universities use webCAPE scores for placement, a high score does not guarantee you university credit.</p></div>{{/in_progress}}{{/completed}}</div>{{/valid}}{{^valid}}<h1>Oops!</h1><h2 class="offset">There seems to have been an error.</h2><div class="summary"><p>If you received an email invitation to take the webCAPE exam, but are seeing this message instead, we must have goofed up.</p><p>Please contact <a href="mailto:&#x62;&#x75;&#x72;&#x72;&#x40;&#x64;&#x75;&#x6F;&#x6C;&#x69;&#x6E;&#x67;&#x6F;&#x2E;&#x63;&#x6F;&#x6D;">burr@duolingo.com</a>, and we\'ll get it sorted out.</p></div><img style="margin:auto;" src="/images/owl-standing-crying.png"/>{{/valid}}</div></div></div></body></html> ',
"flagged-translations":'<h1>Translations flagged as abusive by users, but not disabled ({{num_flagged_non_disabled}})</h1><ul>{{#flagged_non_disabled}}<li><a href="/translation/{{translation_id}}">{{document_title}}</a>{{/flagged_non_disabled}}</ul><h1>Disabled translations ({{num_disabled}})</h1><ul>{{#disabled}}<li><a href="/translation/{{translation_id}}">{{document_title}}</a>{{/disabled}}</ul> ',flashcards:'<div class="close" data-dismiss="modal"></div><div class="modal-header {{^card}}{{^num_incorrect}}perfect{{/num_incorrect}}{{/card}}">{{#card}}<h1>{{#_i}}Do you know the translation?{{/_i}}</h1><h3>{{#_i}}Use your spacebar or click to reveal the translation{{/_i}}</h3>{{/card}}{{^card}}{{^num_incorrect}}<h1>{{#_i}}Awesome job!{{/_i}}</h1><h3>{{#_i}}It looks like you knew all the words!{{/_i}}</h3>{{/num_incorrect}}{{#num_incorrect}}<h1>{{#_i}}Keep practicing!{{/_i}}</h1><h3>{{#_i}}{{#pluralize}}Here is the {{num_incorrect}} word you didn\'t know,Here are the {{num_incorrect}} words you didn\'t know,{{num_incorrect}}{{/pluralize}}{{/_i}}</h3>{{/num_incorrect}}{{/card}}</div><div class="modal-body"><div id="js-flip" class="flip-container"><div id="old-container" class="old card-container"></div><div id="current-container" class="current card-container">{{#card}}<div class="card"><div class="face front"><span class="flip">{{#_i}}Flip{{/_i}}</span><span class="icon icon-flip"></span><span class="flashcard-word"><span class="flag flag-svg-small flag-{{learning_language}}"></span>{{word}}</span></div><div class="face back"><span class="flip">{{#_i}}Flip{{/_i}}</span><span class="icon icon-flip"></span><span class="flashcard-word"><span class="flag flag-svg-small flag-{{ui_language}}"></span>{{translation}}</span><div class="response"><a class="wrong"><span class="icon icon-red-arrow-left"></span><span>{{#_i}}I was wrong{{/_i}}</span></a><a class="correct"><span>{{#_i}}I was right{{/_i}}</span><span class="icon icon-red-arrow-right"></span></a></div></div></div>{{/card}}{{^card}}{{#num_incorrect}}<div class="card"><div class="face review"><table class="flashcards-review">{{#incorrect_words}}<tr><td>{{word}}</td><td>{{translation}}}</td></tr>{{/incorrect_words}}</table></div></div>{{/num_incorrect}}{{/card}}</div></div>{{#card}}<div class="dot-indicator"><ul>{{#dots}}<li class="dot"></li>{{/dots}}</ul></div>{{/card}}</div>',
"flashcards-modal":'<div id="flashcards" class="modal hidden fade"></div>',"follow-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#following_short_list}}{{#one}}{{#_i}}started following {{#item_one}}<a href="/{{username}}">{{username}}</a>{{/item_one}}{{/_i}}{{/one}}{{#two}}{{#_i}}started following {{#item_one}}<a href="/{{username}}">{{username}}</a>{{/item_one}} and {{#item_two}}<a href="/{{username}}">{{username}}</a>{{/item_two}}{{/_i}}{{/two}}{{#three}}{{#_i}}started following {{#item_one}}<a href="/{{username}}">{{username}}</a>{{/item_one}}, {{#item_two}}<a href="/{{username}}">{{username}}</a>{{/item_two}} and {{#item_three}}<a href="/{{username}}">{{username}}</a>{{/item_three}}{{/_i}}{{/three}}{{#more}}{{#_i}}started following {{#item_one}}<a href="/{{username}}">{{username}}</a>{{/item_one}}, {{#item_two}}<a href="/{{username}}">{{username}}</a>{{/item_two}} and {{remainder}} {{#pluralize}}other,others,{{remainder}}{{/pluralize}}{{/_i}}{{/more}}{{/following_short_list}}</p>{{>event-footer}} ',
footer:'<div class="footer-main"><ul class="nav-footer"><li><a href="/info" tabindex="100">{{#_i}}About{{/_i}}</a></li>{{^logged_in}}<li><a href="https://schools.duolingo.com/" tabindex="101">{{#_i}}Schools{{/_i}}</a></li>{{/logged_in}}<li><a href="https://testcenter.duolingo.com/" tabindex="102">Test Center</a></li><li><a href="/mobile" tabindex="103">{{#_i}}Mobile{{/_i}}</a></li><li><a href="http://gear.duolingo.com" tabindex="104" target="_blank">{{#_i}}Gear{{/_i}}</a></li>{{#logged_in}}<li><a href="/help" tabindex="105">{{#_i}}Help{{/_i}}</a></li><li><a href="/guidelines" tabindex="106">{{#_i}}Guidelines{{/_i}}</a></li>{{/logged_in}}<li><a href="/jobs" tabindex="107">{{#_i}}Jobs{{/_i}}</a></li><li><a href="/terms" tabindex="108">{{#_i}}Terms{{/_i}}</a></li><li><a href="/privacy" tabindex="109">{{#_i}}Privacy{{/_i}}</a></li><li><a href="http://twitter.com/duolingo" tabindex="130"><span class="icon icon-twitter-small"></span></a></li><li><a href="http://facebook.com/duolingo" tabindex="140"><span class="icon icon-fb-small"></span></a></li></ul></div> ',
forgot:'<main class="main-center-narrow"><section class="page-main"><form action="" method="post" id="forgot-form"><input type="hidden" name="came_from" value="{{came_from}}"/><h1>{{#_i}}Forgot password{{/_i}}</h1><p class="center" style="margin: -20px 0 30px 0;">{{#_i}}We will send you instructions on how to reset your password by email.{{/_i}}</p><div class="row-inputandbutton"><div class="col-input"><input class="input-block" placeholder="{{#_i}}Email{{/_i}}" id="email" name="email" size="30" type="text" value="{{email}}"></div><div class="col-btn"><input type="submit" class="btn btn-blue" style="" value="{{#_i}}Submit{{/_i}}"/></div></div><div class="warning-message hidden" id=\'email-error\' style="float: left; margin-top: 20px;">{{#_i}}Enter a correct email address{{/_i}}</div><div class="warning-message hidden" id=\'not-found-email\' style="float: left; margin-top: 20px">{{#_i}}Account not found{{/_i}}</div></form><div id="form_txt_good" class="form_msg hidden"><h1 style="font-size: 42px;">{{#_i}}Thank you!{{/_i}}</h1><h2 style="text-align: center; margin: 0;">{{#_i}}Please check your email.{{/_i}}</h2></div></section></main><style type="text/css" media="screen"> .forgot-password { display: none; }</style> ',
"form-element":'<div class="challenge-judge"><h1 class="player">{{#_i}}Select the missing word{{/_i}}</h1><h2 class="player" dir="auto">{{#tokens}}{{#word}}{{display_value}}{{/word}}{{^word}}<label class="blue-select"><select name="mediumSelect" id="options_{{i}}"><option class="placeholder" value="">{{#_i}}Select word{{/_i}}</option>{{#options}}<option value="{{value}}">{{display_value}}</option>{{/options}}</select></label>{{/word}}{{/tokens}}</h2></div>',formal_outfit_description:"{{#_i}}Learn in style. Duo has always been a sharp guy, now he'll look sharp too.{{/_i}} ",
formal_outfit_title:"{{#_i}}Formal Attire{{/_i}} ","friend-find":'<div class="search-users global-search"><div class="row-inputandbutton"><div class="col-input"><span class="icon icon-search-gray"></span><input id="search-learners" type="text" class="search search-input input-block" placeholder="{{#_i}}Name or email{{/_i}}"/></div><div class="col-btn"><button class="search-for-friends btn btn-small btn-blue right">{{#_i}}Search{{/_i}}</button></div></div></div><div id="list-results" class="list-leaderboard"><ul id="search-learners-results" class="list-users-small global-search-list leaderboard-search-list">{{>user-search-results}}</ul></div> ',
friend_passed_you:"{{#_i}}{{username}} just passed you on Duolingo.{{/_i}}","friendship-item":'<li>{{>avatar_small}}<a href="/{{username}}" class="username">{{username}}</a>{{#logged_in}}{{^is_user}}{{#is_being_blocked}}<button class="btn btn-small right" disabled="disabled">{{#_i}}Blocked{{/_i}}</button>{{/is_being_blocked}}{{^is_a_blocker}}{{^trial_account}}<a class="follow-button btn right btn-small btn-standard {{#is_following}}success{{/is_following}}" data-user="{{id}}" data-follow-text="{{#_i}}Follow{{/_i}}" data-unfollow-text="{{#_i}}Following{{/_i}}">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</a>{{/trial_account}}{{/is_a_blocker}}{{/is_user}}{{/logged_in}}</li> ',
"friendship-list":'<ul class="list-users-small">{{#shown_friends}}{{>friendship-item}}{{/shown_friends}}</ul>',glass_authorize:'<!DOCTYPE html><html><head><title>Duolingo</title><link rel="stylesheet" type="text/css" href="/glass/webview.css"><style type="text/css"> .{{start_panel}}-panel { display: block; }</style></head><body><div class="wrap"><div class="panel splash-panel"><img class="logo" src="/glass/logo.svg"><button class="splash-button login-button">Sign in</button><button class="splash-button register-button">Create account</button><h3>Or 1-tap sign in</h3><div class="half-width"><div class="left-container"><button id="gplusSignIn" class="google-button"><img src="/glass/google.svg"><span>Google</span></button></div></div><div class="half-width"><div class="right-container"><button class="facebook-button"><img src="/glass/facebook.svg"><span>Facebook</span></button></div></div></div><div class="panel login-panel"><h3>Enter your details</h3><input class="username" type="text" placeholder="Username"><input class="password" type="password" placeholder="Password"><div class="half-width"><div class="left-container"><button class="cancel-button">Cancel</button></div></div><div class="half-width"><div class="right-container"><button class="signin-button">Sign in</button></div></div></div><div class="panel register-panel"><h3>I want to learn...</h3><select><option value="es" selected>Spanish</option><option value="fr">French</option><option value="de">German</option><option value="it">Italian</option><option value="pt">Portuguese</option></select><h3>Enter your details</h3><input class="email" type="text" placeholder="Email"><input class="username" type="text" placeholder="Username"><input class="password" type="password" placeholder="Password"><div class="half-width"><div class="left-container"><button class="cancel-button">Cancel</button></div></div><div class="half-width"><div class="right-container"><button class="signin-button">Create</button></div></div></div><div class="panel language-panel"><h3>I want to learn...</h3><select><option value="es" selected>Spanish</option><option value="fr">French</option><option value="de">German</option><option value="it">Italian</option><option value="pt">Portuguese</option></select><div class="half-width"><div class="left-container"><button class="cancel-button">Cancel</button></div></div><div class="half-width"><div class="right-container"><button class="signin-button">Sign in</button></div></div></div><div class="panel success-panel {{^authorized}}hidden{{/authorized}}"><p>You\'re now signed in on Glass.</p><p>Say "ok glass, learn a language" to begin.</p></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">\x3c/script><script type="text/javascript"> var userToken = \'{{userToken}}\'; var socialPlatform = \'{{#social_platform}}{{social_platform}}{{/social_platform}}\'; var socialEmail = \'{{#social_email}}{{social_email}}{{/social_email}}\'; var socialId = \'{{#social_id}}{{social_id}}{{/social_id}}\'; \x3c/script><script type="text/javascript" src="/glass/webview.js">\x3c/script></body></html> ',
"global-sidebar":'{{#no_sentence_selected}}<div class="instructions"><ul id="document-sidebar-tabs" class="tabs nav-tabs"><li id="show-legend" {{^show_contributors}}class="active"{{/show_contributors}}><a href="javascript:;">{{#_i}}Legend{{/_i}}</a></li><li id="show-translators" {{#show_contributors}}class="active"{{/show_contributors}}><a href="javascript:;">{{#_i}}Contributors{{/_i}}</a></li></ul><div id="document-info" {{#show_contributors}}class="hidden"{{/show_contributors}}><ul class="document-info color-key-list"><li><span class="legend-circle not-yet-translated">{{#_i}}Aa{{/_i}}</span><span class="legend-text">{{#_i}}Not yet translated{{/_i}}</span><li><span class="legend-circle needs-checking">{{#_i}}Aa{{/_i}}</span><span class="legend-text">{{#_i}}Translation needs checking{{/_i}}</span><li><span class="legend-circle checked-by-community">{{#_i}}Aa{{/_i}}</span><span class="legend-text">{{#_i}}Checked by the community{{/_i}}</span><li><span class="legend-circle checked-by-user">{{#_i}}Aa{{/_i}}</span><span class="legend-text">{{#_i}}Translated or checked by you{{/_i}}</span></ul><ul class="document-info-list">{{#document_url}}<li><a href="{{document_url}}" class="username" target="_blank"> <span class="icon icon-link"></span><span class="label">{{display_url}}/...</a></span></li>{{/document_url}}{{#user_can_download_translation}}<li><a href="/translate_jobs/{{translate_job_id}}/export{{#export_args}}?{{export_args}}{{/export_args}}" data-bypass class="download-article"><span class="icon icon-download"></span><span class="label">{{#_i}}Download current translation{{/_i}}</span></a></li>{{/user_can_download_translation}}{{#user_reported_inappropriate}}<li><span class="reported-article">{{#_i}}You have reported this article.{{/_i}}</span></li>{{/user_reported_inappropriate}}{{^user_reported_inappropriate}}{{^paid_translation}}<li><a href="javascript:;" id="report-inappropriate" class="report-article"><span class="icon icon-flag-micro"></span><span class="label">{{#_i}}Report article{{/_i}}</span></a></li>{{/paid_translation}}{{/user_reported_inappropriate}}<li><a href="javascript:;" class="show-shortcuts"><span class="icon icon-keyboard"></span><span class="label">{{#_i}}Keyboard shortcuts{{/_i}}</span></a></li>{{#user_can_disable_translation}}<li>{{^translation_disabled}}<a href="javascript:;" id="disable-translation" class="remove-article"><span class="label">{{#_i}}Remove article{{/_i}}</a></span>{{/translation_disabled}}{{#translation_disabled}}<a href="javascript:;" id="enable-translation" class="remove-article"><span class="label">{{#_i}}Re-enable article{{/_i}}</span></a>{{/translation_disabled}}</li>{{/user_can_disable_translation}}</ul></div><div id="translation-contributors" {{^show_contributors}}class="hidden"{{/show_contributors}}></div></div>{{/no_sentence_selected}} ',
grade:'{{#session_element}}{{#attributes}}{{#covert}}<h1>{{#_i}}Answer submitted.{{/_i}}</h1><div class="additional-msg left">{{#_i}}Click "Continue" to go on to the next question.{{/_i}}</div>{{/covert}}{{^covert}}{{#correct}}{{#mic_off}}{{#message}}<span class="badge-correct-big left bounce-in"><span class="icon icon-correct-big"></span></span><h1>{{#_i}}Microphone is off{{/_i}}</h1><div class="additional-msg">{{#_i}}You can always turn it back on in the settings page.{{/_i}}</div>{{/message}}{{/mic_off}}{{^mic_off}}{{#points_per_correct}}<span class="icon icon-clock-medium bounce-in"></span>{{/points_per_correct}}{{^points_per_correct}}<span class="badge-correct-big left bounce-in"><span class="icon icon-correct-big"></span></span>{{/points_per_correct}}{{^blame}}{{^points_per_correct}}{{#hover_trial}}<h1>{{#_i}}Good job!{{/_i}}</h1>{{/hover_trial}}{{^hover_trial}}{{^web_speech}}<h1>{{#_i}}You are correct{{/_i}}</h1>{{/web_speech}}{{#web_speech}}{{#perfect}}<h1>{{#_i}}You are correct{{/_i}}</h1>{{/perfect}}{{^perfect}}<h1>{{#_i}}Woot, you are almost correct.{{/_i}}</h1>{{#reverse_speak}}<h2><span class="float-label"><strong>{{#_i}}Translation:{{/_i}}</strong></span> <bdi>{{value}}</bdi></h2>{{/reverse_speak}}{{/perfect}}{{/web_speech}}{{/hover_trial}}{{#reverse_speak}}{{^web_speech}}{{#value}}<h2>{{#_i}}We heard "{{value}}"{{/_i}}</h2>{{/value}}{{/web_speech}}{{/reverse_speak}}{{/points_per_correct}}{{#points_per_correct}}{{^web_speech}}<h1>{{#_i}}Correct.{{/_i}} <span class="lighter">{{#_i}}You got extra time and points!{{/_i}}</span></h1>{{/web_speech}}{{#web_speech}}{{#perfect}}<h1>{{#_i}}Correct.{{/_i}} <span class="lighter">{{#_i}}You got extra time and points!{{/_i}}</span></h1>{{/perfect}}{{^perfect}}<h1>{{#_i}}Almost correct!{{/_i}}</h1>{{#reverse_speak}}<h2><strong>{{#_i}}Translation:{{/_i}}</strong> <bdi>{{value}}</bdi></h2>{{/reverse_speak}}{{/perfect}}{{/web_speech}}{{/points_per_correct}}{{/blame}}{{#blame}}<h1>{{#_i}}Almost correct!{{/_i}} <span class="lighter">{{#closest_translation}}<bdi>{{closest_translation}}</bdi>{{/closest_translation}}{{^closest_translation}}<bdi>{{^solution_string}}{{#correct_solutions}}{{.}}{{/correct_solutions}}{{/solution_string}} {{#solution_string}}{{solution_string}}{{/solution_string}}</bdi>{{/closest_translation}}</span></h1>{{/blame}}{{#solution_translation}}<h2><span class="float-label"><strong>{{#_i}}Translation:{{/_i}}</strong></span> <bdi>{{solution_translation}}</bdi></h2>{{/solution_translation}}{{#display_translation}}<h2><span class="float-label"><strong>{{#_i}}Another correct solution:{{/_i}}</strong></span> <bdi>{{display_translation}}</bdi></h2>{{/display_translation}}{{>grade-discuss}}{{/mic_off}}{{/correct}}{{#incorrect}}{{#try_again}}{{#listen}}<h1>{{#_i}}Oops, it doesn\'t seem to be in {{#_ivar}}language_name{{/_ivar}}.{{/_i}}</h1><div class="additional-msg left">{{#_i}}Please try again.{{/_i}}</div>{{/listen}}{{^web_speech}}{{#speak}}{{#odd}}<h1>{{#_i}}Oops, I couldn\u2019t understand what you said{{/_i}}</h1>{{/odd}}{{^odd}}<h1>{{#_i}}I can\'t hear you very well{{/_i}}</h1>{{/odd}}<div class="additional-msg left">{{#_i}}Please record again (try speaking slower){{/_i}}</div>{{/speak}}{{#reverse_speak}}<h1>{{#_i}}Oops, that seems wrong. You can try again.{{/_i}}</h1><div class="additional-msg left">{{#_i}}Please record again (try speaking slower and make sure to speak in {{#_ivar}}target_language_name{{/_ivar}}){{/_i}}</div>{{/reverse_speak}}{{/web_speech}}{{#web_speech}}{{#empty}}<h1>{{#_i}}I can\'t hear you very well{{/_i}}</h1>{{/empty}}{{^empty}}<h1>{{#_i}}Oops, that seems wrong. You can try again.{{/_i}}</h1>{{/empty}}<div class="additional-msg left">{{#_i}}Please record again (try speaking slower){{/_i}}</div>{{/web_speech}}{{#translate}}<span class="badge-wrong-big bounce-in left"><span class="icon icon-wrong-big"></span></span><h1>{{#_i}}Oops, that\u2019s wrong! You can try again.{{/_i}}</h1><div class="additional-msg left">{{#_i}}Or skip to the correct solution.{{/_i}}</div>{{/translate}}{{/try_again}}{{^try_again}}{{#next_time}}{{#skipped}}<h1>{{#_i}}Try again next time!{{/_i}}</h1>{{/skipped}}{{^skipped}}<h1>{{#_i}}Let\'s move on from this one for now.{{/_i}}</h1>{{/skipped}}{{#closest_translation}}<h2><span class="float-label"><strong>{{#_i}}Translation:{{/_i}}</strong></span> <bdi>{{closest_translation}}</bdi></h2>{{/closest_translation}}{{>grade-discuss}}{{/next_time}}{{^next_time}}<span class="badge-wrong-big bounce-in left"><span class="icon icon-wrong-big"></span></span><h1>{{^closest_translation}}{{#_i}}Correct {{#pluralize}}solution,solutions,{{num_solutions}}{{/pluralize}}:{{/_i}}<span class="lighter"><bdi>{{^solution_string}}{{#correct_solutions}}{{.}}{{/correct_solutions}}{{/solution_string}} {{#solution_string}}{{solution_string}}{{/solution_string}}</bdi></span>{{/closest_translation}}{{#closest_translation}}{{^display_translation}}{{#_i}}Correct solution:{{/_i}} <span class="lighter"><bdi>{{closest_translation}}</bdi></span>{{/display_translation}}{{#display_translation}}{{#_i}}Correct solutions:{{/_i}} <span class="lighter">\u2022 <bdi>{{closest_translation}}</bdi><br/>\u2022 <bdi>{{display_translation}}</bdi></span>{{/display_translation}}{{/closest_translation}}</h1>{{#solution_translation}}<h2><span class="float-label"><strong>{{#_i}}Translation:{{/_i}}</strong></span> <bdi>{{solution_translation}}</bdi></h2>{{/solution_translation}}{{>grade-discuss}}{{/next_time}}{{/try_again}}{{/incorrect}}{{/covert}}{{/attributes}}{{/session_element}} ',
"grade-discuss":'<div class="clearfix">{{^session_welcome}}{{^mic_off}}{{^try_again}}<span id="show-report-options" class="margin-right btn btn-small btn-faded btn-outline {{#correct}}btn-green{{/correct}} {{#incorrect}}btn-red{{/incorrect}}">{{#_i}}Report a Problem{{/_i}}<ul class="even-context-menu report-options hidden" id="report-options">{{>report-options}}<li><input id="submit-problem" type="submit" class="btn right margin-left btn-green update-comment" value="{{#_i}}Submit{{/_i}}" style=""><input id="cancel-report" type="submit" class="btn right btn-standard update-comment" data-dismiss="modal" value="{{#_i}}Cancel{{/_i}}" style=""></li></ul></span>{{#social_enabled}}{{#has_discussion}}<button id="discussion-toggle" class="btn btn-faded btn-small btn-outline {{#correct}}btn-green{{/correct}} {{#incorrect}}btn-red{{/incorrect}}">{{#_i}}Discuss sentence{{/_i}} {{#num_comments}}({{num_comments}}){{/num_comments}}</button><div id="solution-suggested" class="save-message-new solution-submitted hidden">{{#_i}}Thanks for your report!{{/_i}}</div><span id="discussion-modal-container"></span>{{/has_discussion}}{{/social_enabled}}{{/try_again}}{{/mic_off}}{{/session_welcome}}</div> ',
group:'<main class="main-full-width"><section class="page-main group-page"><div class="group-header group-color-{{color}}"><ul class="group-action"><li>{{#user_pending_invite}}<button class="btn btn-white btn-outline accept-invite" data-invite-id="{{invitation_id}}">{{#_i}}Accept invite{{/_i}}</button>{{/user_pending_invite}}{{^user_pending_invite}}{{#is_open}}{{^in_group}}{{^group_full}}<button class="btn btn-white btn-outline join-group">{{#_i}}Join team{{/_i}}</button>{{/group_full}}{{/in_group}}{{/is_open}}{{^is_open}}{{^in_group}}{{^is_admin}}\x3c!-- <button class="btn btn-white btn-outline request-join">{{#_i}}Request Membership{{/_i}}</button> --\x3e{{/is_admin}}{{#is_admin}}{{^group_full}}<button class="btn btn-white btn-outline join-group">{{#_i}}Join team{{/_i}}</button>{{/group_full}}{{/is_admin}}{{/in_group}}{{/is_open}}{{#in_group}}{{#show_invite}}<button class="btn btn-white btn-outline invite-players">{{#_i}}Invite Players{{/_i}}</button>{{/show_invite}}{{/in_group}}{{/user_pending_invite}}{{#group_full}}{{^in_group}}{{^user_pending_invite}}<div class="group-status-badge">{{#_i}}This team is full{{/_i}}</div>{{/user_pending_invite}}{{/in_group}}{{/group_full}}</li>{{#in_group}}<li><div class="dropdown gear-dropdown"><div data-toggle="dropdown" class="white-circle"><span class="icon icon-gear-dropdown"></span></div><ul class="dropdown-menu arrow-top-right" role="menu" aria-labelledby="dLabel"><li><a class="leave-group">{{#_i}}Leave team{{/_i}}</a></li></ul></div></li>{{/in_group}}</ul><div class="group-meta"><span class="group-avatar-icon medium group-avatar-icon-{{icon_index}}"></span><h1 class="group-name {{#location}}push-up{{/location}} {{#description}}push-up{{/description}}">{{name}}</h1><ul class="group-scores"><li>{{#_i}}Score this week: <strong>{{group_week_xp}} XP</strong>{{/_i}}</li><li>{{#_i}}Daily goal: <strong>{{daily_goal}} XP</strong>{{/_i}}<span class="time-left"><span class="icon icon-clock-small-white" data-toggle="tooltip" title=" {{#num_minutes}}{{#_i}}Daily goal: {{num_minutes}}{{#pluralize}}m left,m left,{{num_minutes}}{{/pluralize}}{{/_i}}{{/num_minutes}}{{#num_hours}}{{#_i}}Daily goal: {{num_hours}}{{#pluralize}}h left,h left,{{num_hours}}{{/pluralize}}{{/_i}}{{/num_hours}} "></span></span></li></ul>{{#description}}<h2 class="group-description">{{description}}</h2>{{/description}}{{#location}}<h2 class="group-location"><span class="icon icon-location-small-white"></span> {{location}}</h2>{{/location}}</div><ul class="nav-tabs group-tabs"><li class="group-tab active" data-tab="members">{{#_i}}Players{{/_i}}</li><li class="group-tab" data-tab="trees">{{#_i}}Team trees{{/_i}}</li>\x3c!-- <li class="group-tab" data-tab="discussion">Discussion</li><li class="group-tab" data-tab="achievements">Achievements</li> --\x3e{{#is_owner}}<li class="group-tab" data-tab="admin">{{#_i}}Admin{{/_i}}</li>{{/is_owner}}</ul></div>\x3c!--<button class="btn btn-primary get-members">Show Members</button><button class="btn btn-primary join-group">Join Group</button><button class="btn btn-primary leave-group">Leave Group</button>--\x3e<div id="members" class="panel team-members"><div class="panel-header"><h3>{{#_i}}Team players: {{num_members}}{{/_i}}</h3></div><table class="table table-striped full-team-table"><thead><th style="width: 30%">{{#_i}}Username{{/_i}}</th><th style="width: 20%">{{#_i}}Real name{{/_i}}</th><th style="width: 38%"><ul class="daily-progress-header" data-title="{{#_i}}Today{{/_i}}"><li>{{#_i}}Mo{{/_i}}</li><li>{{#_i}}Tu{{/_i}}</li><li>{{#_i}}We{{/_i}}</li><li>{{#_i}}Th{{/_i}}</li><li>{{#_i}}Fr{{/_i}}</li><li>{{#_i}}Sa{{/_i}}</li><li>{{#_i}}Su{{/_i}}</li></ul></th><th style="width: 12%" class="">{{#_i}}XP/Week{{/_i}}</th></thead><tbody>{{#members}}<tr data-user-id="{{user_id}}"><td><div class="small-avatar-with-flag">{{>avatar_small}}<span class="flag flag-{{learning_language}}-micro"></span></div><a href="/{{username}}" class="username">{{username}}</a>{{#owner_badge}}<span class="team-badge-admin">{{#_i}}CAPTAIN{{/_i}}</span>{{/owner_badge}}</td><td>{{fullname}}</td><td><ul class="daily-goal-bar">{{#weekly_progress}}<li><span class="daily-goal-marker {{#met_goal}}{{met_goal}}{{/met_goal}} {{^met_goal}}{{#day_finished}}{{met_goal}}{{/day_finished}}{{#today}}yellow-completion{{/today}}{{/met_goal}}" data-toggle="tooltip" title="{{day_xp}} {{#_i}}XP{{/_i}}">{{#met_goal}}<span class="icon icon-mini-check"></span>{{/met_goal}}{{^met_goal}}<span class="icon icon-mini-x"></span>{{/met_goal}}</span></li>{{/weekly_progress}}</ul></td><td>{{#_i}}{{weekly_xp}} XP{{/_i}}</td></tr>{{/members}}{{#admins}}{{^is_member}}<tr data-user-id="{{user_id}}"><td><div class="small-avatar-with-flag">{{>avatar_small}}<span class="flag flag-{{learning_language}}-micro"></span></div><a href="/{{username}}" class="username">{{username}}</a><span class="team-badge-admin">{{#_i}}CAPTAIN{{/_i}}</span></td><td>{{fullname}}</td><td><span class="gray">{{#_i}}Not participating{{/_i}}</span></td><td>--</td></tr>{{/is_member}}{{/admins}}{{#invited_users}}<tr style="\x3c!-- opacity: 0.5 --\x3e" data-user-id="{{user_id}}"><td><div class="small-avatar-with-flag">{{>avatar_small}}</div><a href="/{{username}}" class="username">{{username}}</a></td><td>{{fullname}}</td><td><span class="team-badge-invited">{{#_i}}INVITED{{/_i}}</span></td><td>--</td></tr>{{/invited_users}}</tbody></table></div><div id="trees" class="panel team-trees hidden"><h3>{{#_i}}Trees{{/_i}}</h3></div><div id="discussion" class="panel team-discussion hidden"><div id="group-discussion"></div></div><div id="achievements" class="panel team-achievements hidden"><h3>{{#_i}}Achievements{{/_i}}</h3></div>{{#is_owner}}<div id="admin" class="panel team-admin-panel hidden"><div id="admin-panel"></div></div>{{/is_owner}}<div id="invite-more" class="modal hidden fade"></div></section></main>{{#show_notification}}<div class="notification-container"><div class="notification-box"><div class="notification-table"><div class="col-left">{{^full}}<span class="notification-success-circle"><span class="icon-check-white-small icon"></span></span>{{/full}}{{#full}}<span class="notification-warning-circle"><span class="icon-x-white-small icon"></span></span>{{/full}}</div><div class="col-right">{{#join_team}}{{#_i}}You successfully joined this team.{{/_i}}{{/join_team}}{{#leave_team}}{{#_i}}You have successfully left this team.{{/_i}}{{/leave_team}}{{#invite_user}}{{#_i}}You have invited {{invited_info}} to join your team.{{/_i}}{{/invite_user}}{{#invite_users}}{{#_i}}You have invited {{invited_info}} {{#pluralize}}user,users,{{invited_info}}{{/pluralize}}.{{/_i}}{{/invite_users}}{{#created}}{{#_i}}You have successfully created this team.{{/_i}}{{/created}}{{#full}}{{#_i}}This team is full.{{/_i}}{{/full}}</div></div></div></div>{{/show_notification}}<div class="footer-centered">{{>footer}}</div> ',
"group-admin":'<div class="panel-header"><button class="right btn btn-green submit" type="submit" disabled="disabled">{{#_i}}Save changes{{/_i}}</button><h3>{{#_i}}Team settings{{/_i}}</h3></div><div class="settings-pane"><ul class="pane-center"><li><h5>{{#_i}}Banner{{/_i}}</h5><div class="change-banner-row"><span id="banner-preview" class="group-color-{{color}} left"><span id="banner-icon-preview" class="group-avatar-icon small group-avatar-icon-{{icon_index}}"></span></span><button class="btn btn-standard btn-outline change-banner">{{#_i}}Change banner{{/_i}}</button></div><input class="large" id="group_color" name="group_color" size="30" type="hidden" value="{{color}}"><input class="large" id="icon_index" name="icon_index" size="30" type="hidden" value="{{icon_index}}"></li><li><div style="position:relative"><div class="groups-error-flag name-taken hidden admin-page"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is already taken.{{/_i}}</div><div class="groups-error-flag too-long hidden admin-page"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is too long.{{/_i}}</div><div class="groups-error-flag name-invalid hidden admin-page"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is invalid.{{/_i}}</div></div><h5>{{#_i}}Name{{/_i}}</h5><input class="input-block" id="group_name" name="group_name" size="30" type="text" value="{{name}}"></li><li><h5>{{#_i}}Description{{/_i}}</h5><textarea class="input-block" style="padding-top: 5px;" id="group_description" placeholder="{{#_i}}In 140 characters or less{{/_i}}" name="group_description" rows="3" cols="40">{{description}}</textarea></li><li><h5>{{#_i}}Location{{/_i}}</h5><input class="input-block" placeholder="{{#_i}}Where are you at?{{/_i}}" id="location" name="location" size="30" type="text" value="{{location}}"></li><li><h5>{{#_i}}Invite policy{{/_i}}</h5><table class="table table-striped"><tr><td><label class=""><input id="invites" type="checkbox" {{#users_can_invite}}checked="checked"{{/users_can_invite}} class="border">{{#_i}}Players can invite other players.{{/_i}}</label></td></tr></table></li><li><h5>{{#_i}}Visibility{{/_i}}</h5><table class="table table-striped privacy-table"><tr><td><label data-toggle="tooltip" title="{{#_i}}Everyone can see the team{{/_i}}"><input id="is_visible_true" class="border" name="visibility" type="radio" data-is-visible="true" {{#is_visible}}checked{{/is_visible}}> <strong>{{#_i}}Public{{/_i}}</strong></label></td><td><label {{#is_open}}class="disabled"{{/is_open}} data-toggle="tooltip" title="{{#_i}}Nobody can see the team{{/_i}}"><input id="is_visible_false" class="border" name="visibility" type="radio" data-is-visible="false" {{^is_visible}}checked{{/is_visible}}> <strong>{{#_i}}Secret{{/_i}}</strong></label></td></tr></table></li><li><h5>{{#_i}}Join Policy{{/_i}}</h5><table class="table table-striped privacy-table"><tr><td><label {{^is_visible}}class="disabled"{{/is_visible}} data-toggle="tooltip" title="{{#_i}}Everybody can join{{/_i}}"><input id="is_open_true" class="border" name="join_policy" type="radio" data-is-open="true" {{#is_open}}checked{{/is_open}}> <strong>{{#_i}}Open to join{{/_i}}</strong></label></td><td><label data-toggle="tooltip" title="{{#_i}}Membership is invitation only{{/_i}}"><input id="is_open_false" class="border" name="join_policy" type="radio" data-is-open="false" {{^is_open}}checked{{/is_open}}> <strong>{{#_i}}Invite only{{/_i}}</strong></label></td></tr></table></li><li><h5>{{#_i}}Daily goal{{/_i}}</h5><table class="table table-striped daily-goal-table"><tr><td style="width: 55%"><label><input type="radio" name="daily-goal" data-goal="10"/> <strong>{{#_i}}Casual||team_goal{{/_i}}</strong></label></td><td class="xp">{{#_i}}10 XP (~5 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" checked name="daily-goal" data-goal="20"/> <strong>{{#_i}}Regular||team_goal{{/_i}}</strong></label></td><td class="xp">{{#_i}}20 XP (~10 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" name="daily-goal" data-goal="30"/> <strong>{{#_i}}Serious||team_goal{{/_i}}</strong></label></td><td class="xp">{{#_i}}30 XP (~15 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" name="daily-goal" data-goal="custom"/> <strong>{{#_i}}Custom||team_goal{{/_i}}</strong></label></td><td class="xp"><input class="input-small custom-daily-goal-input" id="daily_goal" name="daily_goal" size="30" type="text" value="{{daily_goal}}">{{#_i}}XP{{/_i}}</td></tr></table></li>{{#is_owner}}<li><h5>{{#_i}}Deactivate{{/_i}}</h5>{{#is_enabled}}<button class="btn btn-standard btn-outline btn-small deactivate" style="margin-top: 3px;">{{#_i}}Deactivate team{{/_i}}</button>{{/is_enabled}}{{^is_enabled}}<span class="warning">{{#_i}}Team is deactivated{{/_i}}</span><button class="btn btn-standard btn-outline btn-small reactivate margin-left">{{#_i}}Reactivate team{{/_i}}</button>{{/is_enabled}}</li>{{/is_owner}}</ul></div><hr/><h3 class="group-headline">{{#_i}}Captain{{/_i}}</h3><table class="table table-striped full-team-table" style="margin-bottom: 40px;">{{#admins}}<tr data-userid="{{user_id}}"><td>{{>avatar_small}} <a href="/{{username}}" class="username">{{username}}</a></td></tr>{{/admins}}</table><hr/><h3 class="group-headline">{{#_i}}Players{{/_i}}</h3><table class="table table-striped full-team-table">{{#members}}<tr class="curr-member" data-userid="{{user_id}}"><td>{{>avatar_small}} <a href="/{{username}}" class="username">{{username}}</a></td><td>{{^self}}<button class="btn btn-red remove-user right">{{#_i}}Kick out{{/_i}}</button>{{#is_owner}}<button class="btn btn-blue promote-user margin-right right">{{#_i}}Promote to Captain{{/_i}}</button>{{/is_owner}}{{/self}}</td></tr>{{/members}}</table><div id="change-banner" class="modal hidden fade"></div> ',
"group-discussion":'<span class="comment-rankings">{{#logged_in}}<button id="ask-question" class="btn btn-green right btn-more-padding">{{#_i}}New Discussion{{/_i}}</button>{{/logged_in}}<div class="search-topics"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="{{#_i}}Search{{/_i}}" class="search-box" id="search-comments" maxlength="50"/><div class="clear-button btn" style="display : none">x</div></div><h1>{{#_i}}{{#_iv}}{{name}}{{/_iv}} Discussions{{/_i}}</h1><ul class="nav-tabs"><li class="active" data-tab="hot" id="hot"><a href="javascript:;">{{#_i}}Popular||list-sort{{/_i}}</a></li><li data-tab="new" id="new"><a href="javascript:;">{{#_i}}New||list-sort{{/_i}}</a></li>{{#show_active}}<li data-tab="active" id="active"><a href="javascript:;">{{#_i}}Active{{/_i}} (Mod)</a></li>{{/show_active}}</ul><div class="comment-search"></div><div class="comment-main"><div id="hot-tab" class="panel"></div><div id="new-tab" class="panel hidden unordered-content"></div><div id="comments" class=""></div><i id="no-results" class="hidden">{{#_i}}No results found.{{/_i}}</i></div></span><div class="post-comment hidden" id="question-fields"></div>',
"group-intro":'<main class="main-full-width"><section class="page-main"><div class="group-intro-header {{#no_groups}}{{#can_create}}shift-illustration{{/can_create}}{{/no_groups}}">{{^no_groups}}{{#can_create}}<button class="btn btn-white btn-outline right create-group extra-social-button">{{#_i}}Create new team{{/_i}}</button>{{/can_create}}{{/no_groups}}<h1>{{#_i}}Team up with your friends or classmates{{/_i}}</h1><h2>{{#_i}}Teams are a new way to learn with others and stay motivated{{/_i}}</h2></div><div class="join-group-pane"></div>\x3c!-- <div class="group-up-reasons"><h4>Here\u2019s how teams work:</h4><ul class="standard-list"><li>Teams have a max size of 50 players</li><li>You can only be part of one team but you can be an admin in multiple teams</li><li>Team admins can set a daily XP goal for their players and everyone can see a neat overview of the progress</li><li>Teams have a shared score that accumulates throughout the week and gets reset on Sunday</li><li>Team trees show everyone\u2019s progress in a given language by placing their avatar in a row next to the skills</li><li>Every team has its own discussion board</li><li>Team players work together to earn unique achievements for their teams</li></ul></div> --\x3e</section><div id="team-modal" class="hidden fade modal-container"></div></main>',
"group-invite-modal":'<div class="create-team-modal-wrapper"><div class="modal create-team-modal"><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div><div class="modal-body">{{^invite_more}}{{^banner_only}}<ul class="nav-tabs small"><li class="switch-page active" data-page=\'1\'><button>{{#_i}}1: Create{{/_i}}</button></li><li class="switch-page inactive" data-page=\'2\'><button>{{#_i}}2: Customize{{/_i}}</button></li><li class="switch-page inactive" data-page=\'3\'><button>{{#_i}}3: Goal{{/_i}}</button></li><li class="switch-page inactive" data-page=\'4\'><button>{{#_i}}4: Invite{{/_i}}</button></li></ul>{{/banner_only}}{{/invite_more}}<div class="modal-page page-1"><h2>{{#_i}}Create new team{{/_i}}</h2><div class="relative create-group-box"><h5>{{#_i}}Team name{{/_i}}</h5><input class="group-name input-block" type="text" placeholder="{{#_i}}Enter a team name{{/_i}}"><div class="groups-error-flag no-name hidden"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}Please enter a team name{{/_i}}</div><div class="groups-error-flag name-taken hidden"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is already taken.{{/_i}}</div><div class="groups-error-flag too-long hidden"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is too long.{{/_i}}</div><div class="groups-error-flag name-invalid hidden"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}This name is invalid.{{/_i}}</div></div><h5>{{#_i}}Team privacy{{/_i}}</h5><table class="table table-striped privacy-table margin-bottom"><tr><td class="privacy-label"><label><input class="border" id="public" name="defaults" type="radio" value="open" checked="checked"> <strong>{{#_i}}Public{{/_i}}</strong></label></td><td class="gray">{{#_i}}Everyone can see the team and join.{{/_i}}</td></tr><tr><td class="privacy-label"><label><input class="border" id="invite" name="defaults" type="radio" value="closed"> <strong>{{#_i}}Invite only{{/_i}}</strong></label></td><td class="gray">{{#_i}}Players need an invite to join.{{/_i}}</td></tr><tr><td class="privacy-label"><label><input class="border" id="secret" name="defaults" type="radio" value="class"> <strong>{{#_i}}Classroom{{/_i}}</strong></label></td><td class="gray">{{#_i}}Nobody can see it and it\'s invite only.{{/_i}}</td></tr></table>{{#already_in_group}}<h5>{{#_i}}You can only be on one team{{/_i}}</h5><table class="table table-striped privacy-table margin-bottom"><tr><td colspan="2"><label class="gray"><input id="join_team" class="border gray" style="font-size: 1em; margin: 0px 10px 0 0px;" id="" name="auto_join" type="checkbox" value="">{{#_i}}Leave team \'{{#group}}{{name}}{{/group}}\' and join this team.{{/_i}}<div class="neutral-message margin-top already-in-group hidden">{{#_i}}Note: You\u2019ll still remain an admin if you were one before.{{/_i}}</div></label></td></tr></table>{{/already_in_group}}{{^already_in_group}}<input id="join_team" class="border gray" style="display: none; font-size: 1em; margin: 0px 10px 0 0px;" id="" checked name="auto_join" type="checkbox" value="">{{/already_in_group}}<button class="btn btn-green btn-block next-page continue" disabled="disabled">{{#_i}}Continue{{/_i}}</button></div><div class="modal-page page-2 hidden"><h2>{{#_i}}Customize team banner{{/_i}}</h2><h5>{{#_i}}Choose a color{{/_i}}</h5><div class="color-list"><button class="btn color-option group-color-blue" data-color="blue"></button><button class="btn color-option group-color-green " data-color="green"></button><button class="btn color-option group-color-orange" data-color="orange"></button><button class="btn color-option group-color-red" data-color="red"></button><button class="btn color-option group-color-purple" data-color="purple"></button><button class="btn color-option group-color-gray-dark" data-color="gray-dark"></button></div><h5>{{#_i}}Choose an icon{{/_i}}</h5><ul id="icon-selector" class="group-icon-list">{{#icons}}<li class="icon-option" data-index={{.}}><span class="group-avatar-icon small group-avatar-icon-{{.}}"></span></li>{{/icons}}</ul><button class="btn btn-green btn-block save-continue next-page" disabled="disabled">{{#banner_only}}{{#_i}}Done{{/_i}}{{/banner_only}}{{^banner_only}}{{#_i}}Continue{{/_i}}{{/banner_only}}</button></div><div class="modal-page page-3 hidden"><h2>{{#_i}}Choose a daily goal{{/_i}}</h2><h5>{{#_i}}Daily XP goal per person{{/_i}}</h5><table class="table table-striped daily-goal-table more-margin-bottom"><tr><td style="width: 55%"><label><input type="radio" name="daily_goal_modal" data-goal="10"/> <strong>{{#_i}}Casual||team_goal{{/_i}}</strong></label></td><td class="gray">{{#_i}}10 XP (~5 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" checked name="daily_goal_modal" data-goal="20"/> <strong>{{#_i}}Regular||team_goal{{/_i}}</strong></label></td><td class="gray">{{#_i}}20 XP (~10 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" name="daily_goal_modal" data-goal="30"/> <strong>{{#_i}}Serious||team_goal{{/_i}}</strong></label></td><td class="gray">{{#_i}}30 XP (~15 minutes){{/_i}}</td></tr><tr><td><label><input type="radio" name="daily_goal_modal" data-goal="custom"/> <strong>{{#_i}}Custom||team_goal{{/_i}}</strong></label></td><td class="xp"><input class="input-small custom-daily-goal-input" id="daily_goal" name="daily_goal" size="30" type="text" value="50">{{#_i}}XP{{/_i}}</td><div style="position:relative;"><div class="groups-error-flag no-goal hidden"><span class="groups-arrow-left-container"><span class="arrow"></span></span>{{#_i}}Please enter a valid goal.{{/_i}}</div></div></tr></table><button class="btn btn-green btn-block next-page">{{#_i}}Continue{{/_i}}</button></div><div class="modal-page page-4 {{^invite_more}}hidden{{/invite_more}}"><h2>{{#_i}}Invite others to join the team{{/_i}}</h2><div class="invite-box"><h5><span class="invites-left">{{#invite_more}}{{#_i}}<span id="num_invites">{{num_invites_remaining}}</span> {{#pluralize}}invite,invites,{{num_invites_remaining}}{{/pluralize}} left{{/_i}}{{/invite_more}}</span>{{#_i}}Enter <strong>usernames</strong> or <strong>email addresses</strong>:{{/_i}}</h5><ul id="invite-list"></ul><ul class="user-list">{{#people}}<li class="checkbox"><label><input class="invitee border" type="checkbox" data-username="{{lower_username}}">{{>avatar_small}} <span class="">{{username}}</span></label></li>{{/people}}<div class="search-results"></div></ul></div><div class="invite-box-footer"><div class="pane-left">{{^invite_more}}<button class="btn btn-outline btn-block btn-standard left invite-later">{{#_i}}Skip this step{{/_i}}</button>{{/invite_more}}{{#invite_more}}<button class="btn btn-outline btn-block btn-standard left" data-dismiss="modal">{{#_i}}Cancel{{/_i}}</button>{{/invite_more}}</div><div class="pane-right"><button class="btn btn-green btn-block left send-invites">{{^invite_more}}{{#_i}}Send invites and finish{{/_i}}{{/invite_more}}{{#invite_more}}{{#_i}}Send invites{{/_i}}{{/invite_more}}</button></div></div></div></div></div></div> ',
"group-leaderboard":'{{#multiple_boards}}<div class="box-colored less-padding white">{{/multiple_boards}}{{#leaderboard}}<a href="/team/{{group_id}}" class="group-widget-header group-color-{{color}}"><span class="icon icon-arrow-white-medium"></span><span class="group-avatar-icon small group-avatar-icon-{{icon_index}}"></span><strong>{{name}}</strong>{{#_i}}Score this week: {{group_week_xp}} XP{{/_i}}</a>{{/leaderboard}}<div class="light-team-table-wrapper"><table class="table table-striped light-team-table"><thead><tr><th style="width: 80%;">{{#_i}}Username{{/_i}}</th><th>{{#leaderboard}}<span class="icon icon-clock-small-black" style="opacity: 0.2; margin-left: 1px;" data-toggle="tooltip" title=" {{#num_minutes}}{{#_i}}Daily goal: {{num_minutes}}{{#pluralize}}m left,m left,{{num_minutes}}{{/pluralize}}{{/_i}}{{/num_minutes}}{{#num_hours}}{{#_i}}Daily goal: {{num_hours}}{{#pluralize}}h left,h left,{{num_hours}}{{/pluralize}}{{/_i}}{{/num_hours}} "></span>{{/leaderboard}}</th><th>{{#_i}}Week{{/_i}}</th></tr></thead><tbody>{{#leaderboard}}{{#leaderboard_info}}<tr><td class="user"><div class="small-avatar-with-flag">{{>avatar_small}}<span class="flag flag-{{learning_language}}-micro"></span></div><a href="/{{username}}" class="username">{{username}}</a></td><td><span data-toggle="tooltip" title="{{#_i}}{{xp_today}}/{{daily_goal}} XP{{/_i}}" class="daily-goal-marker {{#met_goal}}true{{/met_goal}}{{^met_goal}}yellow-completion{{/met_goal}}">{{#met_goal}}<span class="icon icon-mini-check"></span>{{/met_goal}}</span></td><td>{{weekly_xp}} {{#_i}}XP{{/_i}}</td></tr>{{/leaderboard_info}}{{/leaderboard}}</tbody></table></div>{{^multiple_boards}}<ul class="group-leaderboard-action"><li><a href="/team" class="btn btn-standard btn-outline btn-block">{{#_i}}Switch team{{/_i}}</a></li>{{#show_manage}}<li><a href="/manageTeams" class="btn btn-outline btn-standard btn-block">{{#_i}}Show all teams you manage{{/_i}}</a></li>{{/show_manage}}</ul>{{/multiple_boards}}{{#multiple_boards}}</div>{{/multiple_boards}} ',
"group-list":'\x3c!-- <div class="search-topics"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="Search" class="search-box" id="search-comments" maxlength="50"><div class="clear-button btn" style="display : none">x</div></div> --\x3e{{^no_groups}}<div class="join-group-header"><button class="btn btn-standard btn-outline right find-fb-groups extra-social-button"><span class="icon-fb-black-small icon"></span>{{#_i}}Connect to find more teams{{/_i}}</button><h4>{{#_i}}Join your friends\u2019 team:{{/_i}}</h4></div>{{/no_groups}}<ul class="list-groups-slider">{{#page}}{{#groups}}<li class="group-card"><a href="/team/{{id}}" class="group-card-head group-color-{{color}}"><span class="group-avatar-icon small group-avatar-icon-{{icon_index}}"></span><strong>{{name}}</strong>{{#_i}}Players: {{member_count}}{{/_i}}</a><ul class="group-card-list-players">{{#display_members}}<li data-toggle="tooltip" title="{{username}}"><div class="avatar-with-badge">{{>avatar_medium}}{{#fbf}}<span class="facebook-badge"><span class="icon icon-fb-white-small"></span></span>{{/fbf}}</div></li>{{/display_members}}{{#has_extras}}<li><span class="more" data-id="{{id}}">+{{extra_members}}</span></li>{{/has_extras}}</ul><div class="group-card-footer">{{^invitation_id}}<button class="btn btn-outline btn-standard btn-block join-group" data-group-id="{{id}}">{{#_i}}Join team{{/_i}}</button>{{/invitation_id}}{{#invitation_id}}<button class="btn btn-outline btn-standard btn-block accept-invite" data-group-id="{{id}}" data-invitation-id="{{invitation_id}}">{{#_i}}Accept invite{{/_i}}</button>{{/invitation_id}}</div><div class="extra-users more-users-{{id}} modal fade hidden"><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div><h2>{{#_i}}All players in {{name}}{{/_i}}</h2><div class="light-team-table-wrapper"><table class="table table-striped light-team-table"><thead><th>{{#_i}}Username{{/_i}}</th><th>{{#_i}}Real name{{/_i}}</th></thead><tbody>{{#members}}<tr><td><div class="small-avatar-with-flag">{{>avatar_small}}<span class="flag flag-{{learning_language}}-micro"></span></div><a href="/{{username}}" class="username"><strong>{{username}}</strong></a></td><td>{{fullname}}</td></tr>{{/members}}</tbody></table></div></div></li>{{/groups}}{{/page}}{{^no_groups}}<button class="previous btn btn-blue btn-outline group-prev"><span class="icon icon-arrow-blue-left-small"></span></button><button class="next btn btn-blue btn-outline group-next"><span class="icon icon-arrow-blue-right-small"></span></button>{{/no_groups}}</ul>{{#no_groups}}<div class="no-friend-groups"><div class="inner">{{#_i}}Your Duolingo friends haven\u2019t teamed up yet{{/_i}}<strong>{{#_i}}Check if your Facebook friends have created a team {{#can_create}}or create your own!{{/can_create}}{{/_i}}</strong><button class="btn btn-fbblue margin-left find-fb-groups"><span class="icon-fb-white-small icon"></span>{{#_i}}Connect to Facebook{{/_i}}</button> {{#can_create}}<button class="btn btn-green margin-left create-group"></span>{{#_i}}Create new team{{/_i}}</button>{{/can_create}}</div></div>{{/no_groups}} ',
"group-manager":'<main class="main-standard"><section class="page-main" style="padding: 40px;"><div class="manage-groups-header">{{#can_create}}<a href="/team" class="right btn-white btn-outline btn">{{#_i}}Create new team{{/_i}}</a>{{/can_create}}<h1>{{#_i}}Manage your teams{{/_i}}</h1></div><h4>{{#_i}}You are administrating these teams:{{/_i}}</h4><ul class="list-group-leaderboards"></ul></section></main>',"group-tree":'<div class="tree-container"><div class="panel-header"><div class="direction-selector" style="text-align: center;"><h3 style="position: absolute">{{#_i}}Team trees{{/_i}}</h3><label class="grey-select direction-select"><select class="direction-dropdown">{{#supported_directions}}<option data-direction="{{learning_language_abbrev}}">{{#_i}}Learning {{#_iv}}{{learning_language}}{{/_iv}}{{/_i}}</option>{{/supported_directions}}</select></label></div></div><table class="table table-striped skill-tree-table"><thead><th>{{#_i}}Row{{/_i}}</th><th style="text-align: center;">{{#_i}}Skill tree{{/_i}}</th><th style="text-align: right;">{{#_i}}Players{{/_i}}</th></thead>{{#tree}}<tr><td class="skill-row-col"><strong class="number">{{row_num}}</strong> \x3c!-- {{skill_names}} --\x3e</td><td class="skill-icon-col">{{#skills}}<span data-toggle="tooltip" title="{{#_ivar}}name{{/_ivar}}" class="skill-icon xsmall {{#unlocked_row}}unlocked {{icon_color}}{{/unlocked_row}} {{^unlocked_row}}locked{{/unlocked_row}}"><span class="skill-icon-image skill-icon-{{icon_idx}}"></span></span>{{/skills}}</td><td class="skill-users-col"><ul class="users">{{#has_more}}<li><a href="javascript:;" class="more" data-row="{{row_num}}">+{{num_more}}</a></li>{{/has_more}}{{#display_users}}<li><div data-toggle="tooltip" title="{{username}}">{{>avatar_small}}</div></li>{{/display_users}}</ul><div class="extra-users more-users-{{row_num}} modal fade hidden"><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div><h2>{{#_i}}All players in row {{row_num}}{{/_i}}</h2><div class="light-team-table-wrapper"><table class="table table-striped light-team-table"><thead><th>{{#_i}}Username{{/_i}}</th><th>{{#_i}}Real name{{/_i}}</th><th>{{#_i}}XP/Week{{/_i}}</th></thead><tbody>{{#users}}<tr><td><div class="small-avatar-with-flag">{{>avatar_small}}<span class="flag flag-{{learning_language}}-micro"></span></div><a href="/{{username}}" class="username"><strong>{{username}}</strong></a></td><td>{{fullname}}</td><td>{{weekly_xp}} XP</td></tr>{{/users}}</tbody></table></div></div></td></tr>{{/tree}}</table></div>',
"group-user-search":'{{#search_results}}<li class="checkbox"><label><input type="checkbox" class="border invitee" data-username="{{lower_username}}"><span class="avatar avatar-small"> {{#avatar}}{{#default_avatar}}<img src="{{avatar}}/xlarge">{{/default_avatar}}{{/avatar}}{{^avatar}}{{#default_avatar}}<img src="https://www.duolingo.com/avatars/{{id}}/xlarge">{{/default_avatar}}{{/avatar}}</span> <span class="blue">{{username}}</span></label></li>{{/search_results}}',guidelines:'<h1>{{#_i}}Community Guidelines{{/_i}}</h1><ul class="guidelines"><li><h4>{{#_i}}Duolingo is a global community of language learners||Uppercase guidelines header{{/_i}}</h4><p>{{#_i}}We believe that everyone should have access to free language education. Our guidelines are meant to build a mutual understanding of what being a part of this community is all about. We will take action if any of these guidelines are not upheld, so please read carefully.{{/_i}}</p></li><li><h4>{{#_i}}Always be Respectful||Uppercase guidelines header{{/_i}}</h4><p>{{#_i}}We come together from across the world at varying language levels with the same goal in mind - to learn. Curiosity, questioning, and cultural understanding are something we celebrate. Be respectful of others and where they\u2019re coming from.{{/_i}}</p></li><li><h4>{{#_i}}Help and support across all skill levels||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}We are all in this together. Learning a language is hard and takes a lot of courage and dedication. If someone uses incorrect grammar or has a question you think has an obvious answer, kindly and calmly help them out. Heckling and being straight up mean doesn\u2019t help anyone learn. Can\u2019t say it nicely? Don\u2019t weigh in.{{/_i}}</p></li><li><h4>{{#_i}}Embrace and share regional language differences||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}A language can have many words, accents and ways to say the same thing. We think that\u2019s one of the wonders of languages. Approach these conversations with an open mind and attitude.{{/_i}}</p></li><li><h4>{{#_i}}Think before you share||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}We care about your safety. Speaking another language is inherently social, but please beware of swapping or posting any private information that could be misused. That includes your phone number, date of birth, address, what time you\u2019ll be at home, or other personal information that could put your privacy at risk. Simply put: don\u2019t over-share.{{/_i}}</p></li></ul><hr/><h1>{{#_i}}Please don\u2019t use Duolingo to...{{/_i}}</h1><ul class="guidelines"><li><h4>{{#_i}}Make people uncomfortable with your words and actions||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}Duolingo is a safe place to learn a language. Unwanted attention of any kind will not be tolerated, that includes harassment, abuse, stalking, and making sexual remarks. Rule of thumb- if you are making someone feel uncomfortable then you shouldn\u2019t be doing it. We take these reports seriously and will delete your account if such activity is verified by our team.{{/_i}}</p></li><li><h4>{{#_i}}Spam the forum or people\u2019s streams||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}Leaving a trail of irrelevant links in forums or on people\u2019s streams will get your account deleted. We promise.{{/_i}}</p></li><li><h4>{{#_i}}Write inflammatory comments||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}Hateful, obscene and off-topic comments don\u2019t contribute to learning. Cursing doesn\u2019t either (let people discover those words in the wild). Leave them out of the language discussions.{{/_i}}</p></li><li><h4>{{#_i}}To Summarize||Uppercase guidelines header{{/_i}}</h4> <p>{{#_i}}By following these guidelines we\u2019ll all contribute to building an interesting and helpful language conversation and community. What happens if you can\u2019t follow these guidelines or our <a href="/terms">terms of service</a>? You might get a notice from us or find your account deleted.{{/_i}}</p></li></ul>',
heart_refill_description:"{{#_i}}Allows you to regain one heart lost during a lesson.{{/_i}}",heart_refill_title:"{{#_i}}Heart Refill{{/_i}}",help:'<div id="help" class="about-pages"><h1>{{#_i}}Help{{/_i}}</h1><ul class="issues"><li><h3>{{#_i}}How can I navigate lessons with the keyboard?{{/_i}}</h3><table class="table table-striped table-test"><tr><td class="shortcut"><span class="key-button shortcut">enter</span></td><td>{{#_i}}Submit your answer, continue onto next screen{{/_i}}</td></tr><tr><td class="shortcut"><span class="key-button-number">1</span><span class="key-button-number">2</span><span class="key-button-number">3</span></td><td>{{#_i}}Select multiple choice answers with corresponding numbers{{/_i}}</td></tr><tr><td class="shortcut"><span class="key-button-arrow">\u25bc</span><span class="key-button-arrow">\u25b2</span><td>{{#_i}}Move through choices in dropdown list{{/_i}}</td></tr><tr><td class="shortcut"><span class="key-button">ctrl</span><span class="plus">+</span><span class="key-button">space</span><td>{{#_i}}Replay audio{{/_i}}</td></tr><tr><td class="shortcut"><span class="key-button">ctrl</span><span class="plus">+</span><span class="key-button">space</span><span class="plus">+</span><span class="key-button">shift</span><td>{{#_i}}Replay audio slower{{/_i}}</td></tr></table></li><hr/><li>{{#_i}}<h3>I have previous experience with a language. How can I skip the basics?</h3> <p>If you have previous experience with a language and feel that lessons are too easy, there are several ways to advance more quickly. To test out of individual skills (e.g. Basics 1), press the button in the top right corner of any skill page that says \u201cTest out of this skill.\u201d If you can pass this test, you will instantly learn the skill.</p>{{/_i}}<p>{{#_i}}If you would rather test out of many skills at once, you can click on the padlocks found throughout your skill tree on the Home page. Passing this test will unlock all skills in the tree up to that point.{{/_i}}</p></li>{{^learning_language_en}}<hr/><li><h3>{{#_i}}How can I add new languages?{{/_i}}</h3> <p>{{#_i}}Feeling adventurous enough to learn more than one language at a time? Click the flag icon you see in the top left corner of Duolingo and choose an additional language that you would like to learn from the drop down. Adding additional languages will not make you lose progress in existing languages.{{/_i}}</p><p>{{#_i}}Use this dropdown whenever you want to switch between the languages that you are learning.{{/_i}}</p>{{/learning_language_en}}<hr/><li><h3>{{#_i}}What are skill points and levels?{{/_i}}</h3> <p>{{#_i}}You earn skill points any time you perform a task that improves your language skills. These tasks include finishing a lesson, translating sentences, and rating others\u2019 translations.{{/_i}}</p><p>{{#_i}}You reach new levels once you accumulate the necessary number of skill points for each level. There are currently 25 levels, and you can always see how close you are to reaching the next level on your Home page.{{/_i}}</p></li><hr/><li>{{#_i}}<h3>My speech input is not working. What can I do?</h3> <p>Duolingo requires the Adobe Flash plugin to accept speech input, so first ensure that you have Flash installed. If Flash is installed but speech input is still not working, try refreshing the web page in your browser. If this does not fix the problem, try closing and reopening the browser. If none of these solutions work, make sure you do not have any browser extensions installed that would block the Flash plugin. Some extensions known to interfere with Flash include Ghostery, Adblock, Flashblock, and DNT.</p>{{/_i}}</li><hr/><li>{{#_i}}<h3>My sound is not working. What can I do?</h3> <p>First, ensure that your volume is turned up and that sound is working properly elsewhere on your computer. If the sound only appears to be broken in Duolingo\'s lessons, try refreshing the web page in the browser. If this does not fix the problem, try closing and reopening the browser.</p>{{/_i}}</li><hr/><div class="gray" style="text-align: center;margin: 40px 0 20px 0;">{{#_i}}Still unsure about something?{{/_i}}</div><div class="centered-button-container"><a href="javascript:;" class="btn btn-blue switch-troubleshoot">{{#_i}}Ask the <strong>Community</strong>{{/_i}}</a>{{^hide_zendesk}}<div class="centered-text">{{#_i}}<span>or</span>{{/_i}}</div><a onClick="Zenbox.show(); return false;" class="btn btn-green">{{#_i}}Contact Us{{/_i}}</a>{{/hide_zendesk}}</div></ol></div>',
"hint-verb-table-content":'<table border="0" cellspacing="0" cellpadding="0" class="table table-bordered green-head table-striped verb-table {{language}}"><thead><tr><th>{{#_i}}Person{{/_i}}</th>{{#tenses}}<th>{{#_ivar}}tense_string{{/_ivar}}</th>{{/tenses}}</tr></thead><tbody>{{#table}}<tr><td class="person"><span>{{pronoun}}</span></td>{{#row}}<td><span>{{{word}}}</span></td>{{/row}}</tr>{{/table}}</tbody></table>{{#more_tables}}<a class="more-tenses" href="javascript:;">{{#_i}}Show more tenses{{/_i}} \u2192</a>{{/more_tables}}',
"hints-link":'<span class="hints-link"></span>',"hints-sentence":'<span class="hints-sentence popover-well"></span>',"hints-table":'{{#hint_table}}<span class="hint-table hint-popover {{position}} {{#explanation}}animated fadeInUp{{/explanation}}"><div class="inner ">{{#explanation}}<div class="explanation hint-explanation hidden"><h4>{{{title}}}</h4><p>{{{details}}}</p><span class="btn btn-primary btn-small right dismiss">{{#_i}}Dismiss{{/_i}}</span></div>{{/explanation}}<div class="content"><table><thead>{{^separable}}<tr>{{#headers}}{{^selected}}<th>{{token}}</th>{{/selected}}{{#selected}}<th class="selected">{{token}}</th>{{/selected}}{{/headers}}</tr>{{/separable}}{{#separable}}<tr><th colspan="3">{{#headers}}{{^selected}}<span>{{token}}</span>{{/selected}}{{#selected}}<span class="selected">{{token}}</span>{{/selected}}{{/headers}}</th></tr>{{/separable}}</thead><tbody>{{#rows}}<tr {{#hide}}class="hidden"{{/hide}}>{{#cells}}<td {{#colspan}}colspan="{{colspan}}"{{/colspan}}>{{#prettify_hint}}{{hint}}{{/prettify_hint}} </td>{{#show_reverse_verb_table}}{{#has_infinitives}}<td class="conjugate"><span class="btn btn-blue btn-small conjugate-small" data-infinitives="{{infinitives_string}}">{{#_i}}C{{/_i}}</span></td>{{/has_infinitives}}{{/show_reverse_verb_table}}{{/cells}}</tr>{{/rows}}{{#gender}}<tr><td class="gender" colspan="{{max_colspan}}">{{#_i}}Gender:{{/_i}} <strong>{{#_ivar}}gender{{/_ivar}}</strong></td></tr>{{/gender}}{{#new_word}}<tr><td class="new-word" colspan="{{max_colspan}}">{{#_i}}New word{{/_i}}</td></tr>{{/new_word}}</tbody></table>{{#show_verb_table}}<div class="hint-footer"><div class="footer-container">{{#explanation}}<span class="btn btn-green conjugate btn-small">{{#_i}}Conjugate{{/_i}}</span><span class="btn btn-primary explain btn-small">{{#_i}}Explain{{/_i}}</span>{{/explanation}}{{^explanation}}<span class="btn btn-green conjugate btn-small">{{#_i}}Conjugate{{/_i}}</span>{{/explanation}}</div></div>{{/show_verb_table}}{{^show_verb_table}}{{#explanation}}<div class="hint-footer"><div class="footer-container"><span class="btn btn-primary explain btn-small">{{#_i}}Explain{{/_i}}</span></div></div>{{/explanation}}{{/show_verb_table}}{{#more_hints}}<div class="more-hints"><span class="icon icon-arrow-down-gray"></span></div>{{/more_hints}}</div></div></span>{{#render_verb_table_div}}<div class="modal verb-table-modal" style="display: none"><div class="close" data-dismiss="modal"></div><div class="modal-body"></div></div>{{/render_verb_table_div}}{{/hint_table}}',
"hints-token":'<span class="token-wrapper popover-wrapper">{{^in_link}}<span class="{{#is_space}}space{{/is_space}} {{^is_space}}non-space{{/is_space}} token {{class_name}} {{style_classes}}" id="token_{{index}}" data-token-index="{{index}}">{{#highlighted}}<strong>{{value}}</strong>{{/highlighted}}{{^highlighted}}{{#bold}}<b>{{/bold}}{{value}}{{#bold}}</b>{{/bold}}{{/highlighted}}</span>{{/in_link}}{{#in_link}}<a target="_blank" href="{{url}}"><span class="token" id="token_{{index}}">{{value}}</span></a>{{/in_link}}{{>hints-table}}</span>',
"hints-token-test":'<span class="token-wrapper popover-wrapper">{{^in_link}}<span class="token {{class_name}}" id="token_{{index}}">{{value}}</span>{{/in_link}}{{#in_link}}<a target="_blank" href="{{url}}"><span class="token" id="token_{{index}}">{{value}}</span></a>{{/in_link}}<span class="hint-table hint-popover"><div class="inner"><div class="content"><table border="0" cellspacing="0" cellpadding="0"><tr><td>{{#_i}}You can\u2019t peek in a test!{{/_i}}</td></tr></table></div></div></span></span>',
"hints-verb-table":'{{#title}}<h2>{{#_i}}Verb:{{/_i}}{{#pre_infinitives}}<a data-infinitive="{{.}}" href="javascript:;">{{.}}</a> / {{/pre_infinitives}}<strong class="infinitive-selected">{{current_infinitive}}</strong>{{#post_infinitives}} / <a data-infinitive="{{.}}" href="javascript:;">{{.}}</a>{{/post_infinitives}}</h2>{{/title}}{{#current_infinitive_data}}<div class="infinitive-tab" data-infinitive="{{infinitive}}"><ul id="settings-tab" class="nav-tabs tabs"><li class="active" data-table="indicative"><a href="javascript:;">{{#_i}}Indicative{{/_i}}</a></li>{{#has_subjunctive}}<li data-table="subjunctive"><a href="javascript:;">{{#_i}}Subjunctive{{/_i}}</a></li>{{/has_subjunctive}}{{#has_conditional}}<li data-table="subjunctive"><a href="javascript:;">{{#_i}}Conditional{{/_i}}</a></li>{{/has_conditional}}{{#has_others}}<li data-table="others"><a href="javascript:;">{{#_i}}Others{{/_i}}</a></li>{{/has_others}}</ul>{{#tables}}<div id="indicative-tables" class="verb-tables">{{#indicative}}{{>hint-verb-table-content}}{{/indicative}}</div><div id="subjunctive-tables" class="verb-tables" style="display: none;">{{#subjunctive}}{{>hint-verb-table-content}}{{/subjunctive}}{{#conditional}}{{>hint-verb-table-content}}{{/conditional}}</div><div id="others-tables" class="verb-tables" style="display: none;">{{#others}}<table border="0" cellspacing="0" cellpadding="0" class="table green-head table-striped verb-table others-table {{language}}"><thead><tr>{{#tenses}}<th><span>{{#_ivar}}tense_string{{/_ivar}}</span></th>{{/tenses}}</tr></thead><tbody>{{#table}}<tr>{{#row}}<td><span>{{{word}}}</span></td>{{/row}}</tr>{{/table}}</tbody></table>{{#more_tables}}<a class="more-tenses" href="javascript:;">{{#_i}}Show more tenses{{/_i}} \u2192</a>{{/more_tables}}{{/others}}</div>{{/tables}}</div>{{/current_infinitive_data}} ',
home:'<main class="main-right"><div id="persistent-notifications" class="message"></div><section class="page-main main-right">{{>skill-tree}}</section><section class="page-sidebar sidebar-left"><div class="inner">{{>profile-side-bar}}</div></section><div id="followers-modal" class="modal hidden" style="margin-top: -200px;"><div class="modal-header"><h4>{{#_i}}Your Followers{{/_i}}</h4><div class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"></div></div><div id="following-modal" class="modal hidden" style="margin-top: -200px;"><div class="modal-header"><h4>{{#_i}}You are following{{/_i}}</h4><div class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"></div></div>{{>footer}}{{#show_sidebar_buttons}}{{#show_practice}}<div class="practice-container"><a href=\'/practice\' class="btn btn-primary btn-block btn-strengthen-skills">{{#_i}}Strengthen skills{{/_i}}</a></div>{{/show_practice}}{{/show_sidebar_buttons}}</main><div id="flashcards-container"></div>',
"hover-element":'<h1 class="player">{{#_i}}Click or hover over these words to see their translation{{/_i}}</h1><h2 class="player"><span class="icon icon-arrow-blue-right {{#rtl}}img-flipped{{/rtl}} margin-right"></span> <span class="hints translation-source">{{text}}</span></h2><span id="session-context"></span> ',"hover-reminder":'<div class="intro hover-reminder"><div class="speech-bubble arrow-left hidden" id="bubble-hover-reminder"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner "><span class="gray-dark">{{#_i}}Remember that you can always hover over words to see their translation.{{/_i}}</span></div></div><div class="owl-peeking-container hoverable" style=""><div class="owl owl-standard peek-from-bottom {{#rtl}}img-flipped{{/rtl}}"></div></div></div> ',
info:'<div id="the-company" class="about-pages"><h2 class="mission">{{#_i}}We believe everyone should have access to education of the highest quality - for free.{{/_i}}</h2><section class="team"><span class="about-img skyline"></span><ul class="team-slide">{{#employee_dict}}<li class="group" data-index={{index}}><h4>{{#_iv}}{{title}}{{/_iv}}</h4>{{#people}}<span class="about-img {{name}}"><a href="{{username}}" class="tooltip-container" data-toggle="tooltip" data-original-title="{{upper_name}}"></a></span>{{/people}}</li>{{/employee_dict}}</ul><div class="arrow prev"></div><div class="arrow next"></div></section><div class="twitter-love about-us-links"><a class="about-img twitter-love-icon about-us-icons" href="https://twitter.com/duolingo/timelines/562280555577106432" target="_blank"></a><div class="link-explanation"><div class="gray">{{#_i}}See what people are saying:{{/_i}}</div><a class="blue" href="https://twitter.com/duolingo/timelines/562280555577106432" target="_blank">{{#_i}}Twitter Wall of Love{{/_i}}</a></div></div><div class="engineering-blog about-us-links"><a class="about-img blog-icon about-us-icons" href="http://making.duolingo.com" target="_blank"></a><div class="link-explanation"><div class="gray">{{#_i}}Read our engineering blog{{/_i}}</div><a class="blue" href="http://making.duolingo.com" target="_blank">making.duolingo.com</a></div></div><hr/>{{#hide_this}}<section class="free"><div class="explanation"><h3>{{#_i}}How can Duolingo be free?{{/_i}}</h3><p>{{#_i}}Learning languages in Duolingo is completely free \u2013 now and forever \u2013 with no ads or hidden fees. Wondering how that can be? It\u2019s because you create value by translating real-world documents while you\u2019re learning.{{/_i}}</p><p>{{#_i}}Here\u2019s how it works: Somebody who needs a webpage translated uploads it to Duolingo. That document then gets presented to Duolingo students who can translate it in order to practice the language they are learning. When the document is fully translated, Duolingo returns it to the original content owner who, depending on the type of document they uploaded, pays for the translation.{{/_i}}</p></div><div class="about-img free-biz"></div></section>{{/hide_this}}<section class="jobs"><div class="about-img newspaper"></div><div class="explanation"><h3>{{#_i}}Are we hiring?{{/_i}}</h3><p>{{#_i}}We are always looking for talented computer scientists, designers, and other positions as needed. If you think you\'d like working at Duolingo, check out the current job openings and get in touch!{{/_i}}</p><p><a href="/jobs" class="btn btn-green">{{#_i}}See our job postings{{/_i}}</a></p></div></section><section class="awards"><div class="explanation"><h3>{{#_i}}Check out our awards!{{/_i}}</h3><p>{{#_i}}Our hard work has been recognized throughout the industry. Sign up for Duolingo to see what the hype is all about!{{/_i}}</p><table><tr><td><a class="blue" href="http://www.usatoday.com/story/tech/columnist/talkingtech/2013/12/17/duolingo-apples-iphone-app-of-the-year/4042469/" target="_blank">{{#_i}}iPhone App of the Year{{/_i}}, 2013</a></td></tr><tr><td><a class="blue" href="https://play.google.com/store/apps/collection/promotion_300055d_players_choice_ctp?hl={{ui_language}}" target="_blank">{{#_i}}Google\'s Best of the Best{{/_i}}, 2013</a></td></tr><tr><td><a class="blue" href="http://techcrunch.com/2014/02/11/fast-growing-duolingo-caps-off-a-big-year-with-the-crunchie-for-best-education-startup/" target="_blank">{{#_i}}TechCrunch\'s Best Education Startup{{/_i}}, 2014</a></td></tr><tr><td><a class="blue" href="https://play.google.com/store/apps/collection/promotion_3000f13_best_of_2014?hl={{ui_language}}" target="_blank">{{#_i}}Google\'s Best of the Best{{/_i}}, 2014</a></td></tr></table></div><div class="owl owl-trophy"></div></section><section class="investors"><div class="about-img plant"></div><div class="explanation"><h3>{{#_i}}Who has invested in us?{{/_i}}</h3><table><tr><td><a class="blue" href="http://www.usv.com">Union Square Ventures</a></td><td><a class="blue" href="http://www.nea.com">New Enterprise Associates</a></td></tr><tr><td><a class="blue" href="http://twitter.com/aplusk">Ashton Kutcher</a></td><td><a class="blue" href="http://www.kpcb.com">Kleiner Perkins Caufield & Byers</a></td></tr><tr><td><a class="blue" href="http://twitter.com/tferriss">Tim Ferriss</a></td></tr></table></div></section><hr/><p class="center">{{#_i}}Journalists and bloggers, please reach out to:{{/_i}} <a class="blue" href="mailto:press@duolingo.com">press@duolingo.com</a></p><p class="center">{{#_i}}We do not pay for marketing. Please do not inquire.{{/_i}}</p></div>',
"intro-1":'<div class="intro screen-1"><div class="welcome-intro-screen"><div class="owl owl-happy {{#rtl}}img-flipped{{/rtl}}"></div><div class="speech-bubble arrow-left"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner">{{^choose_language}}<h2>{{#_i}}Welcome to Duolingo!{{/_i}}</h2><p>{{#_i}}I\u2019m Duo the owl and I\u2019ll give you a quick tour on how to learn with Duolingo.{{/_i}}</p>{{/choose_language}}{{#choose_language}}<div class="bottom select-language"><h2>{{#_i}}Welcome to Duolingo!{{/_i}}</h2><p style="margin: 0 0 15px 0">{{#_i}}Which language do you want to learn first?{{/_i}}</p><label class="blue-select no-focus smaller language-select" ><select name="learning_language" id="learning-language" class="dropdown-content"><option disabled="disabled" selected>{{#_i}}Choose language{{/_i}}</option>{{#available_languages}}<option value="{{key}}" data-language="{{learning_language_name}}">{{prompt}}</option>{{/available_languages}}</select></label></div>{{/choose_language}}</div></div></div></div> ',
"intro-hover":'<div class="intro intro-hover"><div class="speech-bubble arrow-left" id="bubble-hover"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner "><span class="gray-dark">{{#_i}}You can always hover over words underlined with gray dots to see their translation{{/_i}}</span></div></div><div class="owl-peeking-container"><div class="owl owl-standard" id="hover-owl"></div></div></div>',"intro-translate":'<div class="intro intro-translate">\x3c!-- <div class="speech-bubble arrow-left" id="bubble-enter-reminder"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner "><span class="gray-dark">{{#_i}}You can use the keyboard for most things. Try hitting Enter instead of clicking check.{{/_i}}</span></div></div><div class="owl-peeking-container hoverable"><div class="owl owl-standard"></div></div> --\x3e</div>',
"invite-more":'<ul class="invite-action"><li class="facebook friend-via"><a href="javascript:;" class="btn {{#num_following}}btn-standard btn-white{{/num_following}} {{^num_following}}btn-blue{{/num_following}} margin-bottom btn-block fb-connect">{{#_i}}Find {{#num_following}}more{{/num_following}} friends on Facebook{{/_i}}</a></li><li class="friend-via"><ul class="invite-action-buttons"><li class="invite"><a href="javascript:;" class="btn email btn-standard btn-white btn-block">{{#_i}}Send invite{{/_i}}</a></li><li class="search"><a href="javascript:;" class="btn search btn-standard btn-white btn-block">{{#_i}}Search{{/_i}}</a></li></ul></li></ul><div class="go-back hidden"><a href="javascript:;">{{^rtl}}\u2190{{/rtl}}{{#rtl}}\u2192{{/rtl}} {{#_i}}Back{{/_i}}</a></div><div id="invite-box" class="board hidden email-invite-box"><div class="inner"><div class="invite-users form-row" style="margin-bottom: 0;"><div class="close"></div><h5>{{#_i}}Send a personal invite email{{/_i}}</h5><div class="block-input-row margin-bottom"><div class="col-left"><input id="invite-email" type="text" placeholder="{{#_i}}Email address{{/_i}}" class="invite input-block"/></div><div class="col-right"><button class="btn btn-small btn-green right send-invite">{{#_i}}Send{{/_i}}</button></div></div><p class="send-notification grayDark hidden"><strong>{{#_i}}Invite sent to:{{/_i}}</strong> <span id="invited-email"></span></p><p id="already-joined" class="error hidden">{{#_i}}This user has already signed up to Duolingo as <a class="user-link username"></a>.{{/_i}}</p><p id="already-invited" class="error hidden">{{#_i}}This email address has already been sent an invite.{{/_i}}</p><p id="not-email" class="error hidden">{{#_i}}Please enter one valid email address at a time.{{/_i}}</p>{{#num_accepted}}{{#invites}}<p>{{#one_invited}}{{#_i}}Out of the people you invited, {{#friend_one}}<a href="/{{username}}">{{username}}</a>{{/friend_one}} signed up.{{/_i}}{{/one_invited}}{{#two_invited}}{{#_i}}Out of the people you invited, {{#friend_one}}<a href="/{{username}}">{{username}}</a>{{/friend_one}} and {{#friend_two}}<a href="/{{username}}">{{username}}</a>{{/friend_two}} signed up.{{/_i}}{{/two_invited}}{{#three_invited}}{{#_i}}Out of the people you invited, {{#friend_one}}<a href="/{{username}}">{{username}}</a>{{/friend_one}}, {{#friend_two}}<a href="/{{username}}">{{username}}</a>{{/friend_two}} and {{#friend_three}}<a href="/{{username}}">{{username}}</a>{{/friend_three}} signed up.{{/_i}}{{/three_invited}}{{#more_invited}}{{#_i}}Out of the people you invited, {{#friend_one}}<a href="/{{username}}">{{username}}</a>{{/friend_one}}, {{#friend_two}}<a href="/{{username}}">{{username}}</a>{{/friend_two}} and {{num_left}} others signed up.{{/_i}}{{/more_invited}}</p>{{/invites}}{{/num_accepted}}{{^num_accepted}}<p>{{#_i}}Fill in your friends\u2019 email addresses and we\u2019ll send them a personal invite.{{/_i}}</p>{{/num_accepted}}</div></div></div>',
invitees:'{{#invitees}}<span><span class="{{^unknown}}invited-user{{/unknown}} {{#unknown}}unknown{{/unknown}} {{#email}}email-address{{/email}}" contenteditable="false">{{user_text}}{{^unknown}}<span class="remove-user" contenteditable="false">x</span>{{/unknown}}</span></span>{{/invitees}} <span class="editable-text" contenteditable>{{previous_text}}</span>',jobs:'<div id="jobs" class="about-pages"><h2>We are hiring</h2>{{#job_board_ff_true}}<p class="center">We\'re always looking for talented individuals to join our awesome team! If you think you\'ve got what it takes, we\'d love to hear from you. These are the positions we currently have available:</p><ul class="list-jobs">{{#jobs}}<li class="center"><span class="skill-icon unlocked {{department}} "><span class="skill-icon-image"></span></span><div class="job-description"><h5>{{title}}</h5><p>{{{short}}}</p></div><a href="{{url}}" class="btn btn-green btn-block btn-small">Apply</a></li>{{/jobs}}</ul>{{/job_board_ff_true}}{{#job_board_ff_false}}<p class="center">We\'re always looking for talented individuals to join our awesome team! If you think you\'ve got what it takes, we\'d love to hear from you. Please send an email to jobs@duolingo.com with a cover letter and your resume.</p>{{/job_board_ff_false}}<hr/><div class="benefits"><h3>Some of our benefits</h3><ul class="standard-list"><li>Competitive salaries and generous equity</li><li>Health, dental, and vision insurance</li><li>20 days of paid time off \u2013 we don\u2019t actually count</li><li>Are you a night owl? We have flexible hours</li><li>Daily catered lunch, snacks and drinks</li><li>Gym membership reimbursement</li><li>401(k) with generous match</li></ul></div><div class="about-img health"></div></div>',
js_ui_string:"{{#_i}}Start typing{{/_i}}{{#_i}}There can only be one Captain at a time. By promoting this user, you are giving up your title. Are you sure you want to do this?{{/_i}}","judge-element":'<div class="challenge-judge"><h1 class="player">{{#_i}}Mark <em class="underline">all</em> correct translations{{/_i}}</h1><div class="judge-row"><div class="col-left"><span id="big-speaker"></span><span onclick="jQuery(this).prev().click();"><bdi>{{text}}</bdi></span></div><div class="col-right"><ul class="list-judge-options hover-effect">{{#sentences}}<li class="item clearfix" style="z-index: 1;"><label for="sentence-{{i}}" class="white-label cb-container-long" data-toggle="tooltip" title="{{#_i}}Press {{number}} to Select{{/_i}}" data-margin="5" data-delay=\'{"show":"100", "hide": "0"}\' ><table border="0" cellspacing="0" cellpadding="0" ><tr><td class="number">{{#from_index}}{{i}}{{/from_index}}.</td></td><td class="checkbox"><input id="sentence-{{i}}" name="sentence-{{i}}" type="checkbox" class="border" tabindex="{{tabindex}}"/></td><td>\x3c!-- {{#from_index}}{{i}}{{/from_index}}: --\x3e<bdi>{{sentence}}</bdi></td></tr></table></label></li>{{/sentences}}</ul></div></div></div>',
justification:"{{#_i}}You started {{#pluralize}}a Duolingo skill,several Duolingo skills,{{num_skills}}{{/pluralize}}{{/_i}} ","keyboard-shortcuts":'<div class="close"></div><div class="modal-header"><h1>{{#_i}}Keyboard shortcuts{{/_i}}</h1></div><div class="modal-body"><ul class="keyboard-shortcut-panels"><li class="left"><h4 class="center">{{#_i}}Lessons{{/_i}}</h4><table border="0" cellspacing="0" cellpadding="0" class="table table-striped table-shortcuts"><tr><td class="col-keys"><div class="key">Enter</div></td><td>{{#_i}}Submit answer{{/_i}}</td></tr><tr><td class="col-keys"><bdi><div class="key">1</div><div class="key">2</div><div class="key">3</div></bdi></td><td>{{#_i}}Select multiple choice answers{{/_i}}</td></tr><tr><td class="col-keys"><div class="key">\u25bc</div><div class="key">\u25b2</div></td><td>{{#_i}}Navigate dropdown lists{{/_i}}</td></tr><tr><td class="col-keys"><div class="key">Ctrl</div><div class="key-plus">+</div><div class="key">Space</div></td><td>{{#_i}}Replay audio{{/_i}}</td></tr><tr><td class="col-keys"><div class="key">Ctrl</div><div class="key-plus">+</div><div class="key">Shift</div><div class="key-plus">+</div><div class="key">Space</div></td><td>{{#_i}}Replay audio slower{{/_i}}</td></tr></table></li><li class="right"><h4 class="center">{{#_i}}Translations{{/_i}}</h4><table border="0" cellspacing="0" cellpadding="0" class="table table-striped table-shortcuts"><tr><td class="col-keys"><span class="key">\u25bc</span><span class="key">\u25b2</span><td>{{#_i}}Change which sentence is highlighted{{/_i}}</td></tr><tr><td class="col-keys"><span class="key">&#x25b6;</span><td>{{#_i}}Edit translation of highlighted sentence{{/_i}}</td></tr><tr><td class="col-keys"><span class="key">Enter</span></td><td>{{#_i}}Save edit{{/_i}}</td></tr><tr><td class="col-keys"><span class="key">Esc</span></td><td>{{#_i}}Cancel edit{{/_i}}</td></tr><tr><td class="col-keys"><span class="key plus-key">+</span><td>{{#_i}}Rate translation "Looks good"{{/_i}}</td></tr><tr><td class="col-keys"><span class="key minus-key">-</span><td>{{#_i}}Rate translation "Looks wrong"{{/_i}}</td></tr></table></li></ul></div>',
kpis:' <!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e <html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Duolingo KPIs</title><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">\x3c/script><script src="https://code.highcharts.com/highcharts.js">\x3c/script><script> $(function () { {{#charts}} $(\'#{{chart_id}}\').highcharts({ chart: { type: \'line\' }, plotOptions: { line: { dataLabels: { enabled: true }, pointStart: new Date(\'{{start_date}}\').getTime(), pointInterval: 24 * 3600 * 1000 } }, title: { text: \'{{title}}\' }, xAxis: { type: \'datetime\', dateTimeLabelFormats: { day: \'%a, %b %e\' }, min: new Date(\'{{start_date}}\').getTime(), max: new Date(\'{{end_date}}\').getTime(), tickInterval: 24 * 3600 * 1000 }, yAxis: { title: { text: \'{{yAxis_title}}\' }, min: {{yAxis_min}} }, series: {{{series}}}, tooltip: { headerFormat: \'<b>{series.name}</b><br>\', pointFormat: \'{point.x:%a, %b %e}: {point.y}\' } }); {{/charts}} }); \x3c/script><style> body { margin-left: 20px; margin-right:20px; }</style></head><body>{{#charts}}<div id="{{chart_id}}"></div>{{/charts}}</body></html>',
language_og:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd" ><html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#"><meta property="fb:app_id" content="{{facebook_app_id}}" /><meta property="og:type" content="{{facebook_app_ns}}:language" /><meta property="og:url" content="http://www.duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}" /><meta property="og:title" content="{{#_ivar}}language_string_title{{/_ivar}}" /><meta property="og:description" content="{{language_description}} {{#_i}}With Duolingo you learn {{#_ivar}}language_string{{/_ivar}} for free while helping to translate the Web.{{/_i}}" /><meta property="og:image" content="http://static.duolingo.com/images/facebook/languages/{{language}}_owl.png" /><meta property="og:locale" content="{{locale}}" />{{#available_locales}}<meta property="og:locale:alternate" content="{{.}}" />{{/available_locales}}<script type="text/javascript"> window.location = "//www.duolingo.com" \x3c/script></head></html> ',
leaderboard:'<h2>{{^invite_fb_friends}}{{^search_friends}}{{^invite_friends}}{{^num_following}}{{#_i}}Compete with your friends{{/_i}}{{/num_following}}{{#num_following}}{{#_i}}Leaderboard{{/_i}}{{/num_following}}{{/invite_friends}}{{/search_friends}}{{/invite_fb_friends}}{{#invite_fb_friends}}{{#_i}}Invite friends from Facebook{{/_i}}{{/invite_fb_friends}}{{#invite_friends}}{{#_i}}Invite friends by email{{/_i}}{{/invite_friends}}</h2>{{#num_following}}<ul class="nav-tabs nav-leaderboard"><li class="toggle weekly active" data-sort="weekly"><a href="javascript:;" >{{#_i}}This week{{/_i}}</a></li><li class="toggle monthly" data-sort="monthly"><a href="javascript:;">{{#_i}}This month{{/_i}}</a></li><li class="toggle alltime" data-sort="alltime"><a href="javascript:;">{{#_i}}All time{{/_i}}</a></li></ul>{{/num_following}}<div id="search-friends" class="board hidden"><ul id="search-list-results"></ul></div><div id="fb-friends" class="hidden board"><div class="search-users"><div class="form-row no-margin"><input id="filter-fb-input" type="text" class="search input-block" placeholder="{{#_i}}Search friends{{/_i}}"/></div></div><ul class="list-users list-leaderboard fake">{{#fb_friends}}<li class="list-leaderboard-item"><span class="avatar avatar-small"><img src="{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}"></span><div class="action">{{#user_id}}{{#is_being_blocked}}<button class="btn btn-small" disabled="disabled">{{#_i}}Blocked{{/_i}}</button>{{/is_being_blocked}}{{^is_being_blocked}}{{^is_a_blocker}}<button class="follow-button btn btn-green {{#is_following}}success{{/is_following}} btn-small" data-toggle="follow" data-user="{{user_id}}" data-follow-text="{{#_i}}Follow{{/_i}}" data-unfollow-text="{{#_i}}Following{{/_i}}" data-silent="true">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button>{{/is_a_blocker}}{{/is_being_blocked}}{{/user_id}}{{^user_id}}<button class="btn btn-blue btn-small invite-fb-friend" data-user="{{id}}" data-toggle="facebook-invite" data-track-from="home leaderboard" data-name="{{#_i}}You\'re Invited to Join Duolingo!{{/_i}}" data-description="{{#_i}}With Duolingo you learn a language for free, while helping to translate the web.{{/_i}}" data-sent="{{#_i}}Invite sent{{/_i}}">{{#_i}}Invite{{/_i}}</button>{{/user_id}}</div><span class="name">{{name}}</span></li>{{/fb_friends}}</ul></div><div id="points-ranking" class="board"></div><div id="add-friends"></div>',
"leaderboard-list":'{{#friends}}<li>{{>avatar_medium}}\x3c!-- <span class="skill-points"><span class="small-coin"></span>{{learning_language_points}}</span> --\x3e<div class="action"><button class="follow-button btn {{#is_following}}success{{/is_following}}" data-toggle="follow" data-user="{{id}}" data-follow-text="{{#_i}}Follow{{/_i}}" data-unfollow-text="{{#_i}}Unfollow{{/_i}}">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button></div><a href="/{{username}}" class="user">{{username}}</a></li>{{/friends}}{{^friends}}<li class="none" style="padding: 0; text-align: center;"><i>{{#_i}}No users found.{{/_i}}</i></li>{{/friends}}{{#more}}<li style="text-align: center; padding: 0; background: #f5f5f5;"><a href="javascript:;" class="btn load-more">{{#_i}}load more{{/_i}}</a></li>{{/more}} ',
"leaderboard-ranking":'{{^num_following}}<ul class="list-leaderboard list-leaderboard-empty"><li class="list-leaderboard-item">{{>avatar_small}}<h5 style="margin-bottom: 5px;">{{#_i}}You\u2019re alone, {{username}}!{{/_i}}</h5><p class="gray" style="margin: 0;">{{#_i}}Add some friends to compete with!{{/_i}}</p></li></ul>{{/num_following}}{{#num_following}}<ul id="ranked-users" class="list-users list-leaderboard">{{#leaderboard_data}}{{#ranked_monthly}}{{#points_data}}{{#has_monthly}}<li class="list-leaderboard-item {{#self}}you{{/self}}">\x3c!-- <span class="position">{{monthly_rank}}</span> --\x3e{{>avatar_small}}<span class="points" data-user="{{id}}">{{monthly}} XP </span><span class="name">{{#self}}{{username}}{{/self}}{{^self}}<a href="/{{username}}" class="username">{{username}}</a>{{/self}}</span></li>{{/has_monthly}}{{/points_data}}{{/ranked_monthly}}{{^ranked_monthly}}<li class="list-leaderboard-item {{#self}}you{{/self}}">\x3c!-- <span class="position">{{#ranked_all_time}}{{alltime_rank}}{{/ranked_all_time}}{{#ranked_weekly}}{{weekly_rank}}{{/ranked_weekly}}</span> --\x3e{{>avatar_small}}<span class="points" data-user="{{id}}">{{#ranked_all_time}}{{#points_data}}{{total}}{{/points_data}}{{/ranked_all_time}}{{#ranked_weekly}}{{weekly}}{{/ranked_weekly}} XP </span><span class="name">{{#self}}{{username}}{{/self}}{{^self}}<a href="/{{username}}" class="username">{{username}}</a>{{/self}}</span></li>{{/ranked_monthly}}{{/leaderboard_data}}</ul>{{#leaderboard_data}}<div id="points-breakdown-{{id}}" class="popover lesspadding points-breakdown black top right"><div class="arrow"></div><div class="inner track-hover"><div class="content"><ul class="">{{#points_data}}{{#languages}}{{#points}}<li><span class="gold-coin"></span><strong class="points">{{points}}</strong><span class="text">{{#_i}}{{#_iv}}{{language_string}}{{/_iv}}||leaderboard points breakdown{{/_i}}</span></li>{{/points}}{{/languages}}<li class="weekly-progress"><span class="activity"></span><strong class="points">{{#weekly}}+{{weekly}}{{/weekly}}{{^weekly}}+0{{/weekly}}</strong><span class="text">{{#_i}}Points this week{{/_i}}</span></li>{{/points_data}}</ul></div></div></div>{{/leaderboard_data}}{{/num_following}}',
"lemma-row":'{{#forms_data}}<tr {{#first}}class="first-lemma-row"{{/first}}>{{#first}}<td rowspan="{{num_forms}}" style="background: white;" class="col-lemma"><a href="/word/{{language}}/{{lemma_value}}/{{pos_key}}" class="lemma">{{lemma_surface_form}}</a></td>{{/first}}<td class="lexeme"><span class="lexeme-form">{{surface_form}}</span> {{#gender}}<span class="gender">({{gender}})</span>{{/gender}}</td><td><span id="{{lexeme_id}}-skill"></span></td><td>{{last_practiced}}</td><td><ul class="word-strength small"><li class="filled"></li><li {{#strength_s}}class="filled"{{/strength_s}}></li><li {{#strength_m}}class="filled"{{/strength_m}}></li><li {{#strength_l}}class="filled"{{/strength_l}}></li></ul></td></tr>{{/forms_data}}',
"lesson-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#just_one}}{{#_i}}did {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} lesson{{/_i}}{{/just_one}}{{^just_one}}{{#_i}}did {{count}} {{#_ivar}}language_string{{/_ivar}} lessons{{/_i}}{{/just_one}} +{{total_improvement}}</p>{{>event-footer}} ',
"lesson-selector":'<b>Language direction:</b><select name="direction">{{#directions}}<option value="{{learning_lang}}_{{from_lang}}" {{#selected}}selected{{/selected}}>{{learning_lang}}<-{{from_lang}}</option>{{/directions}}</select><br><b>Lesson:</b><select name="lesson">{{#lessons}}<option name="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/lessons}}</select>',lesson_number:"{{#_i}}Lesson {{lesson_number}} of {{total_lessons}}{{/_i}} ","level-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type"><span class="level-badge-micro {{language}}"><span class="inner">{{new_level}}</span><span class="pennant"></span></span></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#_i}}leveled up in {{#_iv}}{{language_string}}{{/_iv}}{{/_i}}</p>{{>event-footer}} ',
level_og:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd" ><html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#"><meta property="fb:app_id" content="{{facebook_app_id}}" /><meta property="og:type" content="{{facebook_app_ns}}:level" /><meta property="og:url" content="http://www.duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}/{{level}}" /><meta property="og:title" content="{{#_ivar}}language_string_title{{/_ivar}} \u2014 {{#_i}}Level {{level}}{{/_i}}" /><meta property="og:description" content="{{#_i}}With Duolingo you learn a language for free while helping to translate the Web.{{/_i}}" /><meta property="og:image" content="http://static.duolingo.com/images/facebook/levels/{{level}}.png" /><meta property="{{facebook_app_ns}}:level" content="{{level}}" /><meta property="{{facebook_app_ns}}:language" content="http://www.duolingo.com/og{{#facebook_debug}}_debug{{/facebook_debug}}/{{language}}" /><meta property="og:locale" content="{{locale}}" />{{#available_locales}}<meta property="og:locale:alternate" content="{{.}}" />{{/available_locales}}<script type="text/javascript"> window.location = "//www.duolingo.com" \x3c/script></head></html> ',
"lingot-store-activity":'<table><tr><th>Item name</th><th colspan="2">Total purchases</th><th colspan="2">Lingots spent</th></tr>{{#item_stats}}<tr><td>{{item_name}}</td>{{#stats}}<td>{{#all_time}}{{purchases}}{{/all_time}}</td><td>{{#daily}}<span style="border-bottom:1px solid black;display:inline-block;vertical-align:bottom;background:black;width:4px;height:{{#normalized}}{{purchases}}{{/normalized}}%" title="{{#total}}{{purchases}}{{/total}}"></span>{{/daily}}</td><td>{{#all_time}}{{lingots_spent}}{{/all_time}}</td><td>{{#daily}}<span style="border-bottom:1px solid black;display:inline-block;vertical-align:bottom;background:black;width:4px;height:{{#normalized}}{{lingots_spent}}{{/normalized}}%" title="{{#total}}{{lingots_spent}}{{/total}}"></span>{{/daily}}</td>{{/stats}}</tr>{{#per_language_stats}}<tr><td style="padding-left:2em;">&#x21b3; {{language_id}}</td>{{#stats}}<td>{{#all_time}}{{purchases}}{{/all_time}}</td><td>{{#daily}}<span style="border-bottom:1px solid black;display:inline-block;vertical-align:bottom;background:black;width:4px;height:{{#normalized}}{{purchases}}{{/normalized}}%" title="{{#total}}{{purchases}}{{/total}}"></span>{{/daily}}</td><td>{{#all_time}}{{lingots_spent}}{{/all_time}}</td><td>{{#daily}}<span style="border-bottom:1px solid black;display:inline-block;vertical-align:bottom;background:black;width:4px;height:{{#normalized}}{{lingots_spent}}{{/normalized}}%" title="{{#total}}{{lingots_spent}}{{/total}}"></span>{{/daily}}</td>{{/stats}}</tr>{{/per_language_stats}}{{/item_stats}}</table> ',
"listen-element":'<div class="challenge-listen"><h1 class="player">{{#_i}}Type what you hear{{/_i}}</h1>{{#need_flash}}<div class="alert-message warning"><a class="close" href="javascript:;">\u00d7</a><p>{{#_i}}You need Flash version 10+ to hear the words.{{/_i}} <a href="http://www.adobe.com/go/getflashplayer" target="_blank">{{#_i}}Download the latest version here.{{/_i}}</a></p></div>{{/need_flash}}<div class="challenge-row"><div class="challenge-cell cell-left"><div id="big-speaker"></div></div><div class="challenge-cell cell-right"><div class="relative">{{>blame-popover}}</div><input class="input-listen input-block input-lg" placeholder="{{#_i}}Type in {{#_ivar}}language_name{{/_ivar}}{{/_i}}" id="word-input" name="word-input" size="30" type="text" lang="{{language}}" value="" tabindex="1" dir="auto" {{#disable_auto_correct_experiment_true}} autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" {{/disable_auto_correct_experiment_true}}/><div id="vkeyboard-placeholder"></div></div></div></div>',
"logged-out-message":"<div class=\"logged-out-message-new\"><h2>{{#username}}{{#_i}}Hey! {{username}} is using <strong>Duolingo</strong> to learn languages for free while helping to translate the web.{{/_i}}{{/username}}{{^username}}{{#language}}{{#_i}}With Duolingo you can learn languages for free! It's fun and effective.{{/_i}}{{/language}}{{^language}}{{#_i}}With Duolingo you can learn languages for free! It's fun and effective.{{/_i}}{{/language}}{{/username}}</h2></div> ",login:'<main class="main-center-narrow"><section class="page-main"><form action="/login" method="post" id="login-form"><input type="hidden" name="came_from" value="{{came_from}}"/><h1>{{#_i}}Sign in{{/_i}}</h1><p class="center" style="margin: -20px 0 20px 0;">{{#_i}}You need to log in to view this page.{{/_i}}</p><input placeholder="{{#_i}}Username or email{{/_i}}" class="input-block margin-bottom" id="login" name="login" size="30" type="text"><input placeholder="{{#_i}}Password{{/_i}}" class="input-block margin-bottom" id="password" name="password" size="30" type="password"><div id=\'message\' class="warning-message hidden margin-bottom"></div><input id="login-button" type="submit" class="btn btn-lg btn-blue btn-block more-margin-bottom" value="{{#_i}}Sign in{{/_i}}"/><p class="center no-margin"><a href="/forgot_password" class="forgot-password">{{#_i}}forgot password?{{/_i}}</a></p></form></section></main> ',
"login-modal":'<div id="signup-modal-body"><div class="modal-header"><h1>{{#_i}}Sign in{{/_i}}<div class="owl owl-pointing-small {{^rtl}}img-flipped{{/rtl}}"></div></div><div class="modal-body"><ul class=\'login-signup-list\'><form action="/login" method="post" id="login-form"><table border="0" cellspacing="0" cellpadding="0" class="form-table" style="margin-bottom: 20px;"><input type="hidden" name="came_from" value="{{came_from}}"/><tr><td><strong>{{#_i}}Username{{/_i}}</strong></td><td><input id="login" name="login" style="width: 230px;" type="text"></td></tr><tr><td><strong>{{#_i}}Password{{/_i}}</strong></td><td><input id="password" name="password" style="width: 230px;" type="password"></td></tr></table><div id=\'message\' class="warning-message hidden margin-bottom"></div><input id="login-button" type="submit" class="btn btn-lg btn-blue btn-block more-margin-bottom" value="{{#_i}}Sign in{{/_i}}"/><p class="center no-margin"><a href="/forgot_password" class="forgot-password">{{#_i}}Forgot password?{{/_i}}</a></p></form></ul></div>',
luxury_outfit_description:"{{#_i}}Learn in luxury. Duo will love the feel of 24 carat gold silk on his feathers.{{/_i}} ",luxury_outfit_title:"{{#_i}}Champagne Tracksuit{{/_i}} ","master-event":'{{#user}}{{>avatar_medium}}{{/user}}<ul class="skill-grid-small">{{#skills}}<li id="event-skills-{{id}}"></li>{{/skills}}</ul><h5><a href="/{{#user}}{{username}}{{/user}}" class="user">{{#user}}{{username}}{{/user}}</a> {{#_i}}mastered {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</h5><div class="stream-comments {{^has_comments}}hidden{{/has_comments}}"></div>{{>event-footer}}',
menu:'<header class="topbar {{^logged_in}}topbar-blue-dark dark-theme {{/logged_in}} {{#in_player}}player{{/in_player}} {{#logged_in}}topbar-blue{{/logged_in}}"><div class="container">{{#zs_branding}}<a href="{{^logged_in}}javascript:;{{/logged_in}}{{#logged_in}}/{{/logged_in}}" class="chinese-brand navigate-home track-click white"><span class="logotype"></span><span class="topbar-brand"></span></a>{{/zs_branding}}{{^zs_branding}}<a href="{{^logged_in}}javascript:;{{/logged_in}}{{#logged_in}}/{{/logged_in}}" class="topbar-brand navigate-home track-click white {{#show_vocab}}smaller-logo{{/show_vocab}}"></a>{{/zs_branding}}<div id="global-loading-indicator" class="loading-indicator {{#ui_language_zs}}smaller{{/ui_language_zs}} {{#show_vocab}}smaller-logo{{/show_vocab}}" style="display: none;"><div class="loader"></div></div>{{#logged_in}}{{^in_player}}<nav class="topbar-nav"><ul class="topbar-nav-main" {{#show_vocab}}style="font-size: 15px"{{/show_vocab}}><li id="home-nav"><a href="/">{{^show_vocab}}{{#_i}}Home{{/_i}}{{/show_vocab}}{{#show_vocab}}{{#_i}}Home||short{{/_i}}{{/show_vocab}}</a></li>{{^trial_account}}{{#show_vocab}}<li id="vocab-nav"><a href="/words">{{#_i}}Words{{/_i}}</a></li>{{/show_vocab}}{{#social_enabled}}<li id="stream-nav"><a href="/activity_stream">{{^show_vocab}}{{#_i}}Activity{{/_i}}{{/show_vocab}}{{#show_vocab}}{{#_i}}Activity||short{{/_i}}{{/show_vocab}}</a></li>{{/social_enabled}}{{/trial_account}}{{#social_enabled}}<li id="questions-nav"><a href="/discussion">{{^show_vocab}}{{#_i}}Discussion{{/_i}}{{/show_vocab}}{{#show_vocab}}{{#_i}}Discussion||short{{/_i}}{{/show_vocab}}</a></li>{{/social_enabled}}{{#show_translations_ff_true}}{{#immersion_enabled}}<li id="translations-nav"><a href="/translations">{{^show_vocab}}{{#_i}}Immersion{{/_i}}{{/show_vocab}}{{#show_vocab}}{{#_i}}Immersion||short{{/_i}}{{/show_vocab}}</a></li>{{/immersion_enabled}}{{/show_translations_ff_true}}</ul></nav>{{/in_player}}{{/logged_in}}<div class="topbar-right" {{#show_vocab}}style="font-size: 15px"{{/show_vocab}}>{{#logged_in}}<div class="hamburger"></div><div class="dropdown topbar-language"><div data-toggle="dropdown" class=""><span class="flag flag-svg-small flag-{{language}}"></span></div><ul class="dropdown-menu arrow-top languages" role="menu" aria-labelledby="dLabel">{{#any_other_learning}}<li class="head"><h6>{{#_i}}Learning{{/_i}}</h6></li>{{#languages}}{{#learning}}<li class="language-choice {{#current_learning}}active{{/current_learning}}" data-value="{{language}}"><a href="javascript:;"><span class="flag flag-svg-micro flag-{{language}}"></span><span data-value="{{language}}">{{#_i}}{{#_iv}}{{language_string}}{{/_iv}}||language switcher{{/_i}}</span> <span class="gray">{{#_i}}level{{/_i}} {{level}}</span></a></li>{{/learning}}{{/languages}}{{/any_other_learning}}<li class="divider"></li><li data-value="more"><a href="/courses">{{#_i}}Add a new course{{/_i}}</a></li></ul></div><div class="dropdown topbar-username"><div data-toggle="dropdown" class="">{{>avatar_small}}{{^trial_account}}<span class="name">{{username}}</span>{{/trial_account}}<span class="icon icon-arrow-down-white"></span></div><ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel">{{^trial_account}}<li><a href="/{{username}}">{{#_i}}Your Profile{{/_i}}</a></li>{{#enabled_groups_experiment}}{{#group}}<li><a href="/team/{{id}}">{{#_i}}Your Team{{/_i}}</a></li>{{/group}}{{/enabled_groups_experiment}}{{#has_certificates}}<li><a href="/settings/progress" class="track-click">{{#_i}}Quiz History{{/_i}}</a></li>{{/has_certificates}}<li><a href="/settings/account" class="track-click" id="header_userdrop_settings">{{#_i}}Settings{{/_i}}</a></li>{{/trial_account}}{{#trial_account}}<li><a class="register-delayed" data-track-click="trial account user dropdown create profile">{{#_i}}Create a profile{{/_i}}</a></li>{{/trial_account}}<li><a id="show-shortcuts">{{#_i}}Keyboard shortcuts{{/_i}}</a></li>{{#trial_account}}<li><a href="/settings/sound" class="sound-settings">{{#_i}}Settings{{/_i}}</a></li><li><a class="login-delayed">{{#_i}}Sign in{{/_i}}</a></li>{{/trial_account}}{{^trial_account}}{{#admin}}<li><a href=\'/admin_tools\'>{{#_i}}Admin{{/_i}}</a></li>{{/admin}}<li><a class="track-click" id="header_userdrop_logout">{{#_i}}Logout{{/_i}}</a></li>{{/trial_account}}</ul></div>{{^trial_account}}<ul class="topbar-stats"><li class="streak" data-toggle="tooltip" title="{{#_i}}{{site_streak}} {{#pluralize}}day,day,{{site_streak}}{{/pluralize}} streak{{/_i}}" data-placement="bottom"><span class="icon icon-streak-small {{#rtl}}img-flipped{{/rtl}}"></span>{{#streak_extended_today}}<span class="icon icon-checkmark-small"></span>{{/streak_extended_today}} {{site_streak}}</li><li class="lingots" data-toggle="tooltip" title="{{#_i}}Lingots{{/_i}}" data-placement="bottom"><a href="/show_store"><span class="icon icon-lingot-small"></span><span id="num_lingots"> {{rupees}}</span></a></li><li class="notifications"><button class="toggle-notifications btn btn-custom btn-notifications {{#num_notifications}}new{{/num_notifications}}" data-placement="bottom" title=""><span class="icon icon-notification-small"></span>{{#num_notifications}}<span class="count">{{num_notifications}}</span>{{/num_notifications}}</button><div id="popover-notifications" class="popover notification-popover-content hidden" {{^rtl}}style="position:fixed;"{{/rtl}}></div></li></ul>{{/trial_account}}{{/logged_in}}{{^logged_in}}<div class="hamburger"></div><div class="topbar-username dropdown click-trigger" style="padding-bottom: 15px;"><div class="current-language" id="site-language-btn">{{#_i}}Site language:{{/_i}} <strong>{{#_i}}{{#_ivar}}ui_language_name{{/_ivar}}||capitalized{{/_i}}</strong><span class="icon icon-arrow-down-white"></span></div><ul id="site-language-modal" class="double dropdown-menu arrow-top" style="">{{#ui_languages_list}}<li class=\'ui-language-option\' data-id="{{id}}" data-abbrev="{{language}}"><a href="//{{id}}.duolingo.com" data-bypass><span class="flag flag-svg-micro flag-{{language}}"></span>{{label}}</a></li>{{/ui_languages_list}}</ul></div>{{/logged_in}}{{#show_login}}<div class="topbar-buttons" style="margin-top: 1px;"><span class="sign-in relative">{{^logged_in}}<span class="btn sign-in-btn btn-white" id="sign-in-btn" data-track-click="topbar toggle">{{#_i}}Login{{/_i}}</span><a href="/register" class="btn btn-green-light right margin-left" id="join">{{#_i}}Get started{{/_i}}</a>{{/logged_in}}{{#logged_in}}<a class="btn btn-white right margin-left register-delayed" data-track-click="trial account navbar create profile">{{#_i}}Create a profile{{/_i}}</a>{{/logged_in}}<ul class="popover arrow-top login-popover hidden" id="login-modal" style="width: 240px; top: 40px; {{^rtl}}right: 0; left: auto;{{/rtl}} {{#rtl}}left: 0; right: auto;{{/rtl}}"><form id=\'login-form\' action="" method="post" accept-charset="utf-8" style="margin: 0;"><li><span class="signup-gplus btn btn-small btn-red btn-block btn-googlered-new" id="gplusSignIn" data-track-click="topbar login google"><span class="icon"></span>{{#_i}}Sign in with Google{{/_i}}</span></li><li><span class="signup-facebook btn btn-small btn-fbblue btn-block btn-fbblue-dark" data-track-click="topbar login facebook"><span class="icon"></span>{{#_i}}Sign in with Facebook{{/_i}}</span></li><li class="center"><span>{{#_i}}or||separates social login/email login{{/_i}}</span></li><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Username or email{{/_i}}" type="text" id="top_login" name="login" value="" autocomplete="on"/></div></li><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Password{{/_i}}" type="password" id="top_password" name="password" value="" autocomplete="on"/></div></li><li id="message" class="login-fail hidden"></li><li><input id="login-button" class="btn btn-green-light btn-small sign-in btn-block" type="submit" value="{{#_i}}Login{{/_i}}" data-track-click="topbar login submit"></li><li class="center"><a href="/forgot_password">{{#_i}}Forgot password{{/_i}}</a></li></form></ul></span></div>{{/show_login}}</div><div id="logged-out-message" class="logged-out-message"></div></div></header><div id="mobile-menu" class="mobile-menu {{#logged_in}}logged-in{{/logged_in}}">{{^logged_in}}<ul class="mobile-menu-listing"><li><a href="javascript:;" class="show-log-in">{{#_i}}Sign in{{/_i}}</a></li><li><a href="/register">{{#_i}}Get started{{/_i}}</a></li>{{#can_download_app}}<li><a href=" {{#android}} https://play.google.com/store/apps/details?id=com.duolingo {{/android}}{{#ios}} https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8 {{/ios}}{{#windows}} https://www.windowsphone.com/s?appid=2d89520e-d360-4b5b-ba5a-5a15064aa935 {{/windows}} ">{{#_i}}Download the Duolingo app{{/_i}}</a></li>{{/can_download_app}}<li><a href="javascript:;" class="show-languages">{{#_i}}Site language:{{/_i}} {{#_i}}{{#_ivar}}ui_language_name{{/_ivar}}||capitalized{{/_i}}</a></li></ul><ul class="ui-language-options"><li class="back-to-menu-li"><span class="icon icon-arrow-left-white"></span><a href="javascript:;" class="back-to-menu">{{#_i}}Back{{/_i}}</a></li>{{#ui_languages_list}}<li class=\'ui-language-option\' data-id="{{id}}" data-abbrev="{{language}}"><a href="//{{id}}.duolingo.com" data-bypass>{{label}}</a></li>{{/ui_languages_list}}</ul>{{/logged_in}}{{#logged_in}}<ul class="mobile-menu-listing"><div class="mobile-menu-stats"><span class="user-info">{{^first_time}}{{>avatar_micro}}{{^trial_account}}<span class="name">{{username}}</span>{{/trial_account}}{{/first_time}}{{#first_time}}<a href="/settings/direction"><span class="flag flag-svg-small flag-{{language}} skill-tree-header-language"></span></a>{{/first_time}}</span><li class="streak" data-toggle="tooltip" title="{{#_i}}{{site_streak}} {{#pluralize}}day,day,{{site_streak}}{{/pluralize}} streak{{/_i}}" data-placement="bottom"><span class="icon icon-streak-small {{#rtl}}img-flipped{{/rtl}}"></span>{{#streak_extended_today}}<span class="icon icon-checkmark-small"></span>{{/streak_extended_today}} {{site_streak}}</li><li class="lingots" data-toggle="tooltip" title="{{#_i}}Lingots{{/_i}}" data-placement="bottom"><a href="/show_store"><span class="icon icon-lingot-small"></span><span id="num_lingots"> {{rupees}}</span></a></li></div><li id="home-nav"><a href="/">{{#_i}}Home||short{{/_i}}</a></li><li id="questions-nav"><a href="/discussion">{{#_i}}Discussion||short{{/_i}}</a></li><li id="courses-nav"><a href="/courses">{{#_i}}Courses{{/_i}}</a></li><li id="settings-nav"><a href= "{{#trial_account}}/settings/sound{{/trial_account}}{{^trial_account}}/settings{{/trial_account}}" >{{#_i}}Settings{{/_i}}</a></li><li id="see-full-site"><a href="javascript:;">{{#_i}}View full site{{/_i}}</a></li>{{#trial_account}}<li class="sign-in-existing"><a href="javascript:;" class="log-in">{{#_i}}Sign in{{/_i}}</a><li class="create-a-profile"><a href="javascript:;" class="register-delayed btn btn-outline btn-white btn-small">{{#_i}}Create a profile{{/_i}}</a>{{/trial_account}}{{^trial_account}}<li><a href="/logout">{{#_i}}Log out{{/_i}}</a>{{/trial_account}}</ul>{{/logged_in}}</div><div id="keyboard-shortcuts" class="modal keyboard-shortcuts fade"></div><div id="alert-modals"></div> ',
"menu-search-popup":'<div class="caret"><div class="outer"></div><div class="inner"></div></div><ul class="small-list-users">{{>user-search-results}}</ul>{{#more}}<a href="/find_friends$q={{q}}" class="see-all-results">{{#_i}}See all results{{/_i}} \u2192</a>{{/more}}',metrics:' <!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e <html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Duolingo</title>{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}<link rel="stylesheet" href="/ab/nv.d3.css" /><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /><style type="text/css"> #retention table td { height: 1.5em; min-width: 3.5em; border: 1px solid white; text-align: center; } #retention svg.metric { height: 320px; } #retention svg.volume { height: 160px; } #retention div.error { /* For the ABBA display. */ color: black; } #retention li { display: inline-block; overflow: hidden; } #retention input[type="text"] { display: inline-block; padding: 1px; /* This makes it act as if it\'s one line. Not sure why. */ word-break: break-all; } #retention input[type="text"]:disabled { color: #cdcdcd; } #retention .radio-control li { width: 15%; vertical-align: middle; } #retention .radio-control input[type="radio"] { vertical-align: middle; } #retention .radio-control li:last-child { width: auto; } #retention .checkbox-control li { width: 25%; } #retention .checkbox-control input[type="checkbox"] { background: #e9e9e9 } #retention #nday-retention-control { text-align: right; width: 50px; } .activity_chart div.activity_tooltip { margin: 15px; } .activity_chart table { border-collapse: collapse; } .activity_chart td { padding: 2px 0 2px 10px; text-align: right; } .activity_chart .pval { text-align: center; } .activity_chart th { text-align: right; vertical-align: top; } .activity_chart .line td, .activity_chart .line th { border-bottom: 1px solid #333333; } /* The !important priority levels below are applied for fixing the bug in NVD3 library where a tooltip is not sometimes shown properly due to a bug in position calculation logic. */ .activity_volume_chart .nvtooltip { right: 10px !important; left: initial !important; } .activity_improvement_chart .nvtooltip { top: initial !important; right: 10px !important; bottom: 10px !important; left: initial !important; }</style><script type="text/javascript" src="/ab/jquery-2.1.1.min.js">\x3c/script><script type="text/javascript" src="/ab/underscore-min.js">\x3c/script>\x3c!-- The following two libraries are old versions, but the newer versions are not compatible with thumbtack/abba. --\x3e<script type="text/javascript" src="/ab/protovis-r3.2_m_853ba143cd4b66e37b7f92a33f92f2b565f0e51b.js">\x3c/script><script type="text/javascript" src="/ab/jstat-min-08fb5e8_m_218d8a8025886154ea655b9e35a43b8f52339780.js">\x3c/script><script type="text/javascript" src="/ab/abba/stats.js">\x3c/script><script type="text/javascript" src="/ab/abba/render.js">\x3c/script><script type="text/javascript" src="/ab/d3.js">\x3c/script><script type="text/javascript" src="/ab/nv.d3.js">\x3c/script><script type="text/javascript"> // Extend Underscore.js. The first three methods pulled from: https://gist.github.com/eethann/3430971 _.mixin({ // ### _.objMap // _.map for objects, keeps key/value associations objMap: function (input, mapper, context) { return _.reduce(input, function (obj, v, k) { obj[k] = mapper.call(context, v, k, input); return obj; }, {}, context); }, // ### _.objFilter // _.filter for objects, keeps key/value associations // but only includes the properties that pass test(). objFilter: function (input, test, context) { return _.reduce(input, function (obj, v, k) { if (test.call(context, v, k, input)) { obj[k] = v; } return obj; }, {}, context); }, // ### _.objReject // // _.reject for objects, keeps key/value associations // but does not include the properties that pass test(). objReject: function (input, test, context) { return _.reduce(input, function (obj, v, k) { if (!test.call(context, v, k, input)) { obj[k] = v; } return obj; }, {}, context); }, sum: function(list, context) { return _.reduce(list, function(memo, num) { return memo + num; }, 0, context); } }); // Returns a css rgb indicator with the specified rgb values. // Accepts rgb values between 0 and 1 function rgb(r, g, b) { return "rgb(" + (255 * r).toFixed(0) + "," + (255 * g).toFixed(0) + "," + (255 * b).toFixed(0) + ")"; } // Returns a css rgb indicator indicating greyscale of the specified percentage. // 0 indicates black. 1 indicates white. function greyscale(percent) { return rgb(percent, percent, percent); } function formatDate(date) { return date.getFullYear() + "-" + (date.getMonth() < 9 ? "0" : "") + (date.getMonth() + 1) + "-" + (date.getDate() < 10 ? "0" : "") + date.getDate(); } // Takes an array, converts all elements to strings, removes duplicates, and returns an array containing the resulting values. function dedup(array) { var set = {}; var new_array = []; $.each(array, function(ignored, elem) { if (!set[String(elem)]) { new_array.push(String(elem)); } set[elem] = true; }); return new_array; } function today() { var date = new Date(); date.setDate(date.getDate()); return formatDate(date); } function isDate(date) { // The call to incrDate is to make sure that we don\'t have something like 2013-07-45. return /^\\d\\d\\d\\d-\\d\\d-\\d\\d$/.test(date) && date == incrDate(date, 0); } function incrDate(date, incr_by) { var split = date.split("-"); return formatDate(new Date(parseInt(split[0]), parseInt(split[1]) - 1, parseInt(split[2]) + incr_by)); } // Returns the number of days between a and b. I.e. b - a. function dateDelta(a, b) { var a_date = new Date(a); var b_date = new Date(b); return (b_date - a_date) / 1000 / 60 / 60 / 24; } function log(target, message) { target.append($(\'<div>\').text(message)); } function graphMetric(target, metric_name, json, metric_lambda, metric_format, volume_lambda) { // target: A dom element or jquery object where graphs will be placed. // metric_name: Axis label for the metric. // json: A json object in the format returned by SegmentedMixpanelCall. This must have at least the following elements: // from_date: The date with which the first element in each array in segments corresponds. // interval: The number of days between each of the points in each segment. // segments: An object. Keys are names of the segment. Values are arrays containing arbitrary objects. // metric_lambda: Gives the value of the metric when applied to an element of an array in segments. // metric_format. A d3 format object specifying how to display the metric units. // volume_lambda: Gives the volume of users from whom the metric was computed when applied to an element of an array in segments. var chart_data = _.map(json.segments, function(segment_data, segment_name) { return { key: segment_name, values: _.map(segment_data, function(data) { return { metric: metric_lambda(data), volume: volume_lambda(data) } }) }; }); if (_.size(chart_data) > 1) { chart_data.push({ key: "aggregate", values: _.map(_.zip.apply(_, _.pluck(chart_data, \'values\')), function(zipped) { return _.reduce(zipped, function(memo, data) { var total_volume = memo.volume + data.volume; return { metric: total_volume ? ((memo.metric * memo.volume) + (data.metric * data.volume)) / total_volume : 0, volume: total_volume }; }, { metric: 0, volume: 0 }); }), disabled: true }); } // We disable Voronoi on the interactive layer for the graphs. There are bugs in it which result in the interactive layer being disabled or infinite loops. var metric_chart = nv.models.lineChart(); var volume_chart = nv.models.lineChart(); _.each([metric_chart, volume_chart], function(chart) { chart.useVoronoi(false); chart.x(function(d, i) { return i }); chart.xAxis.tickFormat(function(x) { return incrDate(json.from_date, x * json.interval); }); chart.xAxis.rotateLabels(270); }); metric_chart.y(function(d) { return d.metric; }); // TODO: Axis label doesn\'t seem to do anything. metric_chart.yAxis.axisLabel(metric_name); metric_chart.yAxis.tickFormat(metric_format); metric_chart.margin({\'bottom\': 10}); volume_chart.y(function(d) { return d.volume; }); volume_chart.forceY([0]); // TODO: Axis label doesn\'t seem to do anything. volume_chart.yAxis.axisLabel(\'Cohort Volume\'); volume_chart.showLegend(false); volume_chart.margin({\'top\': 10}); metric_chart.dispatch.on(\'stateChange\', function(newState) { volume_chart.dispatch.changeState(newState); }); volume_chart.dispatch.on(\'stateChange\', function(newState) { metric_chart.dispatch.changeState(newState); }); // Inserts a chart into the dom. // chart: A nvd3 chart. // target: A dom element where the chart should be inserted. // css_class: A css class which will be added to the chart. function insertChart(chart, target, css_class) { target = $(target); var svg = document.createElementNS(\'http://www.w3.org/2000/svg\', \'svg\'); $(svg).appendTo($(\'<div>\').appendTo(target)).attr("class", css_class); d3.select(svg) .datum(chart_data) .transition().duration(500) .call(chart); } insertChart(metric_chart, target, \'metric\'); insertChart(volume_chart, target, \'volume\'); } function mixpanelCall(path, params, callback, tag) { // path: A mixpanel api path. // params: Arguments to the mixpanel call, as a hash. // callback: Will be called with the raw mixpanel response object. // tag: A string tag which can be used to cancel a certain set of mixpanel calls. var url = "/diagnostics/mixpanel_query/" + path + "?"; for (var key in params) { if (url.substr(-1) != ("?")) { url += "&"; } var value = params[key] if (typeof value !== \'string\') { value = JSON.stringify(value); } url += key + "=" + value; } var jqXHR = $.ajax({ "url": url, "dataType": "jsonp", "crossDomain": true, "cache": true }); jqXHR.done(function(json) { callback(json); }); mixpanelCall.outstanding_calls = mixpanelCall.outstanding_calls || []; var obj = { tag: tag, jqXHR: jqXHR }; mixpanelCall.outstanding_calls.push(obj); if (typeof(tag) === "undefined") { $(\'#outstanding-calls\').text(mixpanelCall.outstanding_calls.length); } jqXHR.always(function() { mixpanelCall.outstanding_calls = _.without(mixpanelCall.outstanding_calls, obj); if (typeof(tag) === "undefined") { $(\'#outstanding-calls\').text(mixpanelCall.outstanding_calls.length); } }); } function cancelMixpanelCalls(tag) { // Cancels all outstanding mixpanel queries with the given tag. If tag is not provided, only calls which were made without a provided tag are cancelled. _.each(mixpanelCall.outstanding_calls, function(obj) { if (typeof(tag) === "undefined" && typeof(obj.tag) === "undefined" || obj.tag === tag) { // TODO: According to the jquery documentation, this is supposed to actually abort the call. // Empirically, it deletes the callback but doesn\'t cancel the request so that when the // request comes back an \'undefined is not a function\' error is raised. I see no sign of // anyone else running into this problem by searching google. The result of this is just // that we wind up with outstanding queries to mixpanel whose data we will never read. obj.jqXHR.abort(); } }); } function segmentedMixpanelCall(path, params, segments, callback) { // path: A mixpanel api path. Only retention and segmentation are supported for now. // params: Arguments to the mixpanel call, as a hash. // segments: A hash mapping segment name to mixpanel segmentation expression. // callback: Will be called with an object with the following structure: // { // from_date: "YYYY-MM-DD" //First date in the report, inclusive. // to_date: "YYYY-MM-DD" // Last date in the report, inclusive. // segments: { // // The segments hash will have the same keys as the segments hash provided as an argument. // segment_name: [ // // The length of the array will be equal to the number of days between from_date and to_date inclusive. // // segment_name[0] corresponds to from_date and segment_name[segment_name.length - 1] corresponds to to_date. // // For segmentation reports, the object will be a hash of value to count. // // For retention reports, the object will have the same structure as that returned by mixpanel, including the \'first\' and \'counts\' keys. // // For funnels, the object will have the same structure as returned by mixpanel, including the \'analysis\' and \'steps\' keys. // Object // ] // } // } if (!_.contains([\'retention\', \'segmentation\', \'arb_funnels\'], path)) { throw new "Mixpanel call not supported"; } var segments_queried = 0; var returned_reports = 0; var response = { from_date: params.from_date, to_date: params.to_date, interval: params.interval || 1, segments: {} }; _.each(segments, function(segment_restriction, segment_name) { segments_queried++; var segment_params = _.clone(params); if (path == \'retention\') { segment_params.born_where = \'(\' + segment_restriction + \') and (\' + (segment_params.born_where || \'true\') + \')\'; } else if (path == \'segmentation\') { segment_params.where = \'(\' + segment_restriction + \') and (\' + (segment_params.where || \'true\') + \')\'; } else if (path == \'arb_funnels\') { segment_params.events = _.map(segment_params.events, _.clone); segment_params.events[0].selector = \'(\' + segment_restriction + \') and (\' + (segment_params.events[0].selector || \'true\') + \')\'; } mixpanelCall(path, segment_params, function(mixpanel_json) { returned_reports++; var segment_data = response.segments[segment_name] = []; for (var date = response.from_date; date <= response.to_date; date = incrDate(date, response.interval)) { if (path == \'retention\') { segment_data.push(mixpanel_json[date] || {}); } else if (path == \'segmentation\') { segment_data.push(_.objMap(mixpanel_json.data.values, function(value) { return value[date]; })); } else if (path == \'arb_funnels\') { segment_data.push(mixpanel_json.data[date]); } } if (returned_reports == segments_queried) { callback(response); } }); }) } function segmentedMixpanelCallSet(calls, segments, callback) { // calls: An object of the form: // { // "key": { // path: "mixpanel/query/path", // params: {}, // mixpanel query params // }, // ... // } // segments: Passed directly to segmentedMixpanelCallback // callback: Will be called with an object with similar structure to that of segmentedMixpanelCall. However, the leaf objects will have keys equal to the keys of the provided calls object and values equal to the leaf object from that particular call. var results = {}; var calls_made = 0; var calls_returned = 0; _.each(calls, function(call_spec, key) { calls_made++; segmentedMixpanelCall(call_spec.path, call_spec.params, segments, function(json) { calls_returned++; results[key] = json; if (calls_made == calls_returned) { var response = { from_date: call_spec.params.from_date, to_date: call_spec.params.to_date, interval: call_spec.params.interval || 1, segments: {} }; for (var segment in segments) { response.segments[segment] = []; for (var i = 0; i < dateDelta(response.from_date, response.to_date) + 1; i++) { response.segments[segment].push(_.objMap(results, function(result) { return result.segments[segment][i]; })); } } callback(response); } }); }); } function getClientForPlatform(platform) { // platform: One of \'all\', \'web\', \'windows\', \'android\', \'ios\'. Default is \'all\'. return { web: \'web\', windows: \'Windows\', android: \'Duodroid\', ios: \'iOS\' }[platform || \'all\']; } function getAppVersions(client, callback) { // Retrieves a list of common app versions and provides it to the callback. // client: A value of the "Client" mixpanel property. // callback: Function which takes one parameter, a list of app versions. mixpanelCall(\'segmentation\', { "from_date": incrDate(today(), -7), "to_date": today(), "event": \'show home\', "where": \'properties["Client"]=="\' + client + \'"\', "type": "unique", "on": \'properties["$app_version"]\' }, function(segmentation_json) { var total_count = 0; var value_counts = {}; _.each(segmentation_json.data.values, function(value_data, value) { _.each(value_data, function(count, date) { total_count += count; value_counts[value] = (value_counts[value] || 0) + count; }); }); var values = _.map(value_counts, function(count, value) { return value; }); values.sort(function(a, b) { return value_counts[b] - value_counts[a]; }); var NEGLIGIBLE_THRESHOLD = 0.005; // Choose values which cover 99.5% of users. var accounted_values = 0; for (var i = 0; i < values.length; ++i) { accounted_values += value_counts[values[i]]; if (accounted_values / total_count > 1 - NEGLIGIBLE_THRESHOLD) { i++; break; } } callback(values.splice(0, i)); }, getAppVersions); } function populateViews(params, target) { // params is a dict with the following optional keys: // experiment: The property on which to segment. Usually an AB test. // baseline: The control condition of the experiment. Must be present to calculate significance. // start_date: The first date to look up, inclusive. // end_date: The last date to look up, inclusive. // login_state: One of \'loggedin\', \'loggedout\'. Default is \'loggedin\'. // population: One of \'all_users\', \'new_users\'. Default is \'all_users\'. // nday_retention: Integer number of days after which we care whether users came back. // platform: One of \'all\', \'web\', \'windows\', \'android\', \'ios\'. Default is \'all\'. // app_version: Array of app version strings. Consider only users on this app version. If not present or zero-length, all users will be considered. // min_age: Minimum age (in milliseconds) of users to consider. // max_age: Maximum age (in milliseconds) of users to consider. // learning_language: Array of language abbreviations. Consider only users learning these languages. If not present or zero-length, all users will be considered. // from_language: Array of language abbreviations. Consider only users learning from these languages. If not present or zero-length, all users will be considered. // freeform: Arbitrary mixpanel segmentation expression. var t = $(\'<div>\').appendTo(target); var is_logged_in = (params.login_state || \'loggedin\') == \'loggedin\'; params.nday_retention = params.nday_retention || 1; if (!(\'end_date\' in params)) { if (is_logged_in && \'experiment\' in params && \'baseline\' in params) { params.end_date = incrDate(today(), -2 * params.nday_retention - 1); } else { params.end_date = today(); } log(t, \'INFERRED END DATE: \' + params.end_date); } var inferred_start_date = false; if (!(\'start_date\' in params)) { inferred_start_date = true; params.start_date = incrDate(params.end_date, -30); } if (params.start_date > params.end_date) { log(t, "START DATE MUST NOT BE AFTER END DATE"); return; } if (typeof params.min_age !== \'undefined\' && typeof params.max_age !== \'undefined\' && params.max_age <= params.min_age) { log(t, "MAX AGE MUST BE GREATER THAN MIN AGE"); return; } function createValueRestriction(property, vals) { if (vals.length == 0) { return \'true\'; } return _.map(vals, function(val) { return \'(properties["\' + property + \'"]=="\' + val + \'")\'; }).join(" or ") } var min_age_restriction = \'min_age\' in params ? \'properties["creation_age"]>=\' + params.min_age : \'true\'; var max_age_restriction = \'max_age\' in params ? \'properties["creation_age"]<\' + params.max_age : \'true\'; var learning_language_restriction = createValueRestriction("learning_language", params.learning_language || []); var from_language_restriction = createValueRestriction("ui_language", params.from_language || []); var platform_restriction = getClientForPlatform(params.platform) ? \'properties["Client"]=="\' + getClientForPlatform(params.platform) + \'"\' : \'true\'; var app_version_restriction = createValueRestriction(\'$app_version\', params.app_version || []); var restriction = \'(\' + min_age_restriction + \') and (\' + max_age_restriction + \') and (\' + learning_language_restriction + \') and (\' + from_language_restriction + \') and (\' + platform_restriction + \') and (\' + app_version_restriction + \') and (\' + (params.freeform || \'true\') + \')\'; mixpanelCall(\'segmentation\', { "from_date": params.start_date, "to_date": params.end_date, "event": is_logged_in ? \'show home\' : \'splash load\', "where": restriction, "type": "unique", "on": \'experiment\' in params ? \'string(properties["\' + params.experiment + \'"])\' : \'"total"\' }, function(segmentation_json) { // In segmentation reports, we care about values which show up at least this fraction of the time. var NEGLIGIBLE_THRESHOLD = 0.035; var options = {}; var found_start_date = false; _.each(segmentation_json.data.series, function(date) { var total_events = 0; _.each(segmentation_json.data.values, function(counts) { if (date in counts) { total_events += counts[date]; } }); if (inferred_start_date && !found_start_date) { if (total_events > 0 && (!(\'undefined\' in segmentation_json.data.values) || segmentation_json.data.values[\'undefined\'][date] < total_events * NEGLIGIBLE_THRESHOLD)) { found_start_date = true; params.start_date = date; } else { // Do not check date\'s numbers for negligibility. This is before the experiment started. return; } } _.each(segmentation_json.data.values, function(counts, option) { if (counts[date] > total_events * NEGLIGIBLE_THRESHOLD) { if (!(option in options)) { options[option] = \'experiment\' in params ? \'string(properties["\' + params.experiment + \'"])=="\' + option + \'"\' : \'true\'; } } }); }); if (inferred_start_date) { if (found_start_date) { log(t, \'INFERRED START DATE: \' + params.start_date); } else { log(t, \'UNABLE TO INFER START DATE\'); return; } } log(t, \'INFERRED OPTIONS: \' + _.keys(options).join(\', \')); // We restrict to new users here because we don\'t know when the experiment start date is until now and we don\'t know what a "new user" is directly from the mixpanel data. var timezone_offset = 24 - Number(new Date(params.start_date).toLocaleString(\'en-US\', {timeZone: \'America/New_York\', formatMatcher: \'basic\', hour12: false, hour: \'numeric\'})) var population_restriction = params.population == \'new_users\' ? \'properties["creation_date_new"]>"\' + params.start_date + \'T\' + ("0" + timezone_offset).substr(-2) + \':00:00"\' : \'true\'; restriction = \'(\' + restriction + \') and (\' + population_restriction + \')\'; var total_event_count = 0; var negligible_event_count = 0; var negligible_events = {}; _.each(segmentation_json.data.series, function(date) { if (date < params.start_date) { return; } _.each(segmentation_json.data.values, function(counts, option) { total_event_count += counts[date]; if (!(option in options)) { negligible_event_count += counts[date]; negligible_events[option] = (negligible_events[option] || 0) + counts[date]; } }); }); if (negligible_event_count > 0) { log(t, "WARNING: Some experiment values were left out."); _.each(negligible_events, function(count, option) { log(t, option + ": " + count + " (" + (count/total_event_count*100).toFixed(1) + "%)"); }); log(t, "Out of a total of " + total_event_count); } if (is_logged_in) { var retention_params = { "from_date": params.start_date, "to_date": params.end_date, "retention_type": "birth", "born_event": "show home", "event": "show home", "born_where": restriction, "interval": params.nday_retention, }; t.append($(\'<h3>\').text("New User Retention")); segmentedMixpanelCall(\'retention\', _.extend({}, retention_params, { born_event: "welcome" }), options, _.partial(renderRetentionData, $(\'<div>\').appendTo(t), params.baseline, params.nday_retention)); t.append($(\'<h3>\').text("Recurring Retention")); segmentedMixpanelCall(\'retention\', _.extend({}, retention_params, { born_event: "show home" }), options, _.partial(renderRetentionData, $(\'<div>\').appendTo(t), params.baseline, params.nday_retention)); var funnel_params = { "from_date": params.start_date, "to_date": params.end_date, "length": 2, "interval": 1, "events": [{ "event": "welcome", "selector": restriction }, { "event": "register", "selector": \'string(properties["successful"])!="false"\' }] } t.append($(\'<h3>\').text("Trial Account Conversion Rate")); segmentedMixpanelCall(\'arb_funnels\', funnel_params, options, _.partial(renderTrialConversionFunnel, $(\'<div>\').appendTo(t), params.baseline)) var net_promoter_params = { "from_date": params.start_date, "to_date": params.end_date, "event": "net_promoter", "type": "unique", "where": restriction, "on": \'properties["npcategory"]\' }; t.append($(\'<h3>\').text("Net Promoter Score")); segmentedMixpanelCall(\'segmentation\', net_promoter_params, options, _.partial(renderNetPromoterData, $(\'<div>\').appendTo(t))); t.append(\'<h3>Activity</h3>\'); var events = [{event: \'show home\', type: \'unique\', name: \'unique show home\'}, {event: \'session_start\', type: \'unique\', name: \'unique session_start\'}, {event: \'session_start\', type: \'general\', name: \'total session_start\'}, {event: \'session_end\', type: \'general\', name: \'total session_end\'}, {event: \'session_end\', type: \'general\', where: \'string(properties["failed"])=="false"\', name: \'total successful session_end\'}]; var metrics = {events: [], segments: [], data: {}, baseline: String(params.baseline), apiCount: 0}; var calls = {}; _.each(events, function(event) { var this_restriction = _.isUndefined(event.where) ? restriction : (\'(\' + restriction + \') and (\' + event.where + \')\'); var activity_params = { "from_date": params.start_date, "to_date": params.end_date, "event": event.event, "type": event.type, "where": this_restriction, "on": \'properties["\' + params.experiment + \'"]\' }; metrics.events.push(event.name); metrics.data[event.name] = {}; calls[event.name] = {\'path\': \'segmentation\', \'params\': activity_params}; }); segmentedMixpanelCallSet(calls, {result_segment: true}, _.partial(renderActivityData, $(\'<div class="activity_chart">\').appendTo(t), metrics)); } else { // For registration flow analysis, we use an undocumented (but recommended by Mixpanel support) api call. // The api is as follows: // { // events: [{ // event: "event name", // selector: "segmentation expression" // }, ...], // from_date: "YYYY-MM-DD", // inclusive // to_date: "YYYY-MM-DD", // inclusive // length: int, // amount of time (in days) each user has to complete the funnel. // interval: int, // how many days should be grouped together in the response. // } var base_funnel_params = { "from_date": params.start_date, "to_date": params.end_date, "length": 2, "interval": 1 }; t.append($(\'<h3>\').text("Signup Funnel")); segmentedMixpanelCallSet({ register: { path: \'arb_funnels\', params: _.extend({}, base_funnel_params, { "events": [{ "event": "splash load", // Note: the check for user_id against undefined is to work around an issue where iOS used to send splash load when logged in. "selector": \'(string(properties["user_id"])=="undefined") and (\' + restriction + \')\' }, { "event": "welcome", }, { "event": "register", "selector": \'string(properties["successful"])!="false"\' }] }) }, login: { path: \'arb_funnels\', params: _.extend({}, base_funnel_params, { "events": [{ "event": "splash load", // Note: the check for user_id against undefined is to work around an issue where iOS used to send splash load when logged in. "selector": \'(string(properties["user_id"])=="undefined") and (\' + restriction + \')\' }, { "event": "login old id" }] }) }, // We don\'t combine this with the register call because session_start and sesson_end events are sampled. session: { path: \'arb_funnels\', params: _.extend({}, base_funnel_params, { "events": [{ "event": "splash load", // Note: the check for user_id against undefined is to work around an issue where iOS used to send splash load when logged in. "selector": \'(string(properties["user_id"])=="undefined") and (\' + restriction + \')\' }, { "event": "session_start" }, { "event": "session_end" }] }) } }, options, _.partial(renderSignupFunnelData, $(\'<div>\').appendTo(t), params.baseline)); } }); }; // Initializes the controls on the page and sets up some ui scripting. // Returns an object with the controls on the page. function initializeControls() { function validateDate(control) { var valid = control.val() === \'\' || isDate(control.val()); control.siblings(\'.checkmark\').toggle(valid); return valid; } function validatePositiveInteger(control) { var valid = control.val() === \'\' || parseInt(control.val()) > 0; control.siblings(\'.checkmark\').toggle(valid); return valid; } function validateAge(control) { var radio_val = getRadioValue(control); var text_control = control.find(\'input[type="text"]\'); if (radio_val == \'custom\') { text_control.prop(\'disabled\', false); var valid = /^[0-9]+$/.test(text_control.val()); text_control.siblings(\'.checkmark\').toggle(valid); return valid; } else { text_control.prop(\'disabled\', true); text_control.val(radio_val == \'all\' ? \'All\' : radio_val); text_control.siblings(\'.checkmark\').toggle(true); return true; } } function validate() { var valid = true; valid &= validateDate(start_date_control); valid &= validateDate(end_date_control); valid &= validatePositiveInteger(nday_retention_control); valid &= validateAge(min_age_control); valid &= validateAge(max_age_control); valid &= typeof getAge(min_age_control) === \'undefined\' || typeof getAge(max_age_control) === \'undefined\' || getAge(min_age_control) < getAge(max_age_control); submit_control.prop(\'disabled\', !valid || window.location.search == getUrlParamString()); return valid; } function getText(control) { var undefined; var val = control.val(); return val === \'\' ? undefined : val; } function getPositiveInteger(control) { var undefined; var val = parseInt(control.val()); return val > 0 ? val : undefined; } function getAge(control) { var undefined; var val = getRadioValue(control); if (val == \'all\' ) { return undefined; } else if (val == \'custom\') { return Number(control.find(\'input[type="text"]\').val()); } else { return Number(val); } } function setAge(control, value) { var radio = value; if (value == \'\') { radio = \'all\'; } if (!control.find(\'input[type="radio"][value="\' + radio.replace(/"/, \'\\\\"\') + \'"]\').length) { radio = \'custom\'; control.find(\'input[type="text"]\').val(value); } setRadioValue(control, radio); } function getCheckValues(control) { // control: a jQuery selection of a container containing language checkboxes. // Returns a list of language abbreviations. return _.map(control.find(\'input[type="checkbox"]:checked\'), function(el) { return $(el).val(); }); } function setCheckValues(control, values) { // Selects the checkboxes specified in values and deselects others. // control: a jQuery selection of a container containing language checkboxes. // values: a list of language abbreviatsions. control.find(\'input[type="checkbox"]\').prop(\'checked\', false); _.each(values, function(value) { control.find(\'input[type="checkbox"][value="\' + value.replace(/"/, \'\\\\"\') + \'"]\').prop(\'checked\', true); }); } function removeCheckOptions(control) { // Removes all options from a given check control. control.find(\'input[type="checkbox"]\').closest(\'li\').remove(); } function addCheckboxOption(control, value, checked) { // Adds a checkbox for the given value to the given control. If checked is true, the // option will be selected, but if checked is false and the item already exists, its state // will not be changed. // Adds the checkbox in the position determined by getPositionFunction(control). var input = control.find(\'input[type="checkbox"][value="\' + value.replace(/"/, \'\\\\"\') + \'"]\'); if (input.length == 0) { input = $(\'<input type="checkbox">\').attr(\'value\', value); var li = $(\'<li>\'); li.append(input); li.append($(\'<span>\').text(value)); var position = getPositionFunction(control)(control, value); var last_li = control.find(\'input[type="checkbox"]\').last().closest(\'li\'); if (position == 0) { control.prepend(li); } else { $(control.find(\'input[type="checkbox"]\')[position - 1]).closest(\'li\').after(li); } } if (checked) { input.prop(\'checked\', true); } validate(); } function defaultPositionFunction(control, value) { // A PositionFunction returns the position at which the given value should be inserted in the control. // The returned value should be in the range [0, # of items in control] and the element should be // inserted after that number of options. // defaultPositionFunction always places elements at the end of the list. return control.find(\'input[type="checkbox"]\').length; } function dottedVersionPositionFunction(control, value) { // Returns a position based on dotted version sorted order. function splitValue(value) { return (typeof(value) !== "string" || value === "") ? [] : value.split(\'.\'); } var split_value = splitValue(value); var values = _.map(control.find(\'input[type="checkbox"]\'), function(input) {return $(input).val();}); // TODO: This takes linear time, but could take logarithmic time. for (var i = 0; i < values.length; ++i) { var split_candidate = splitValue(values[i]); for (var j = 0; j < Math.max(split_value.length, split_candidate.length); ++j) { var value_part = split_value[j] || \'\'; var candidate_part = split_candidate[j] || \'\'; var value_part_int = parseInt(value_part) || 0; var candidate_part_int = parseInt(candidate_part) || 0; if (value_part_int > candidate_part_int) { return i; } else if (value_part_int == candidate_part_int) { var value_part_string = value_part.replace(/^\\d*/, \'\'); var candidate_part_string = candidate_part.replace(/^\\d*/, \'\'); if (value_part_string > candidate_part_string) { return i; } else if (value_part_string == candidate_part_string) { continue; } } break; } } return values.length; } function setPositionFunction(control, func) { setPositionFunction.functions = setPositionFunction.functions || {}; setPositionFunction.functions[control] = func; } function getPositionFunction(control) { return (setPositionFunction.functions || {})[control] || defaultPositionFunction; } function setupCheckboxActions(control) { control.find(\'a[data-action="all"]\').on(\'click\', function() { control.find(\'input[type="checkbox"]\').prop(\'checked\', true); validate(); }); control.find(\'a[data-action="in-house"]\').on(\'click\', function() { control.find(\'input[type="checkbox"]\').prop(\'checked\', false); control.find(\'input[type="checkbox"][data-in-house]\').prop(\'checked\', true); validate(); }); control.find(\'a[data-action="clear"]\').on(\'click\', function() { setCheckValues(control, []); validate(); }); control.find(\'a[data-action="add"]\').on(\'click\', function() { var value = prompt(); if (value == null) { // User hit cancel. return; } addCheckboxOption(control, value, true); }); } function getRadioValue(control) { return control.find(\'input[type="radio"]:checked\').val(); } function setRadioValue(control, value) { control.find(\'input[type="radio"][value="\' + value.replace(/"/, \'\\\\"\') + \'"]\').prop(\'checked\', true); } function getParams() { var params = { experiment: getText(experiment_control), baseline: getText(baseline_control), start_date: getText(start_date_control), end_date: getText(end_date_control), login_state: getRadioValue(login_state_control), population: getRadioValue(population_control), nday_retention: getPositiveInteger(nday_retention_control), platform: getRadioValue(platform_control), app_version: getCheckValues(app_version_control), min_age: getAge(min_age_control), max_age: getAge(max_age_control), learning_language: getCheckValues(learning_language_control), from_language: getCheckValues(from_language_control), freeform: getText(freeform_control) }; for (key in params) { if (typeof params[key] === "undefined") { delete params[key]; } } return params; } function getUrlParams() { var url_params = getParams(); if (url_params.login_state == \'loggedin\') { delete url_params.login_state; } if (url_params.population == \'all_users\') { delete url_params.population; } if (url_params.nday_retention == 1) { delete url_params.nday_retention; } if (url_params.platform == \'all\') { delete url_params.platform; } if (url_params.app_version.length == 0) { delete url_params.app_version; } else { url_params.app_version = url_params.app_version.join(\',\'); } if (url_params.learning_language.length == 0) { delete url_params.learning_language; } else { url_params.learning_language = url_params.learning_language.join(\',\'); } if (url_params.from_language.length == 0) { delete url_params.from_language; } else { url_params.from_language = url_params.from_language.join(\',\'); } return url_params; } function getUrlParamString() { var param_string = $.param(getUrlParams()); if (param_string) { param_string = \'?\' + param_string; } return param_string; } function parseUrl() { function getParam(param) { var match = new RegExp("[?&]" + param + "=([^&]*)").exec(window.location.search); return match ? decodeURIComponent(match[1]) : \'\'; } experiment_control.val(getParam(\'experiment\')); baseline_control.val(getParam(\'baseline\')); start_date_control.val(getParam(\'start_date\')); end_date_control.val(getParam(\'end_date\')); setRadioValue(login_state_control, getParam(\'login_state\')); setRadioValue(population_control, getParam(\'population\')); nday_retention_control.val(getParam(\'nday_retention\') || 1); setRadioValue(platform_control, getParam(\'platform\')); _.each(_.compact(getParam(\'app_version\').split(\',\')), function(version) { addCheckboxOption(app_version_control, version, true); }); setAge(min_age_control, getParam(\'min_age\')); setAge(max_age_control, getParam(\'max_age\')); setCheckValues(learning_language_control, _.compact(getParam(\'learning_language\').split(\',\'))); setCheckValues(from_language_control, _.compact(getParam(\'from_language\').split(\',\'))); freeform_control.val(getParam(\'freeform\')); var param_string = getUrlParamString(); if (window.location.search != param_string) { window.history.replaceState(null, null, window.location.pathname + param_string); return parseUrl(); } if (validate()) { cancelMixpanelCalls(); populateViews(getParams(), $(\'#data-view\').empty()); } } function populateAppVersions() { cancelMixpanelCalls(getAppVersions); var client = getClientForPlatform(getRadioValue(platform_control)); var client_has_app_version = typeof(client) !== "undefined" && client !== \'web\'; app_version_control.closest(\'div\').toggle(client_has_app_version); if (client_has_app_version) { getAppVersions(client, function(versions) { _.each(versions, function(version) { addCheckboxOption(app_version_control, version, false); }); }); } } var experiment_control = $(\'#experiment-control\'); var baseline_control = $(\'#baseline-control\'); var start_date_control = $(\'#start-date-control\'); var end_date_control = $(\'#end-date-control\'); var login_state_control = $(\'#login-state-control\'); var population_control = $(\'#population-control\'); var nday_retention_control = $(\'#nday-retention-control\'); var platform_control = $(\'#platform-control\'); var app_version_control = $(\'#app-version-control\'); var min_age_control = $(\'#min-age-control\'); var max_age_control = $(\'#max-age-control\'); var learning_language_control = $(\'#learning-language-control\'); var from_language_control = $(\'#from-language-control\'); var freeform_control = $(\'#freeform-control\'); var submit_control = $(\'#submit-control\'); setPositionFunction(app_version_control, dottedVersionPositionFunction); setupCheckboxActions(app_version_control); setupCheckboxActions(learning_language_control); setupCheckboxActions(from_language_control); experiment_control.keyup(validate); baseline_control.keyup(validate); start_date_control.keyup(validate).change(validate); end_date_control.keyup(validate).change(validate); login_state_control.change(validate); population_control.change(validate); nday_retention_control.keyup(validate).change(validate); platform_control.change(function () { removeCheckOptions(app_version_control); populateAppVersions(); }).change(validate); app_version_control.change(validate); min_age_control.keyup(validate).change(validate); max_age_control.keyup(validate).change(validate); learning_language_control.change(validate); from_language_control.change(validate); freeform_control.keyup(validate); submit_control.click(function(event) { event.preventDefault(); window.history.pushState(null, null, window.location.pathname + getUrlParamString()); parseUrl() }); parseUrl(); populateAppVersions(); $(window).bind(\'popstate\', parseUrl); } function renderABResults(target, baseline, last_complete_day, json, getTrials, getSuccesses) { // This calculates confidence intervals. // target: A UI element where results will be rendered. // baseline: The baseline value of the experiment. // last_complete_day: last day with valid data for the purposes of calculating ab results. // json: JSON in the segmentedRetentionReport format. // getTrials: A function which computes the number of trials for a given day of data. // getSuccesses: A function which computes the number of successful trials for a given day of data. if (typeof baseline !== \'undefined\') { if (!(baseline in json.segments)) { log(target, \'BASELINE SEGMENT NOT PRESENT. NOT CALCULATING AB RESULTS.\'); } else { if (json.from_date > last_complete_day) { log(target, \'DATA TOO RECENT. NOT COMPUTING AB RESULTS.\'); } else { var segment_num_days = dateDelta(json.from_date, json.to_date) + 1; // + 1 because to_date is inclusive. if (json.to_date > last_complete_day) { log(target, \'IGNORING DATA AFTER \' + last_complete_day + \' WHEN CALCULATING AB RESULTS.\'); segment_num_days = dateDelta(json.from_date, last_complete_day) + 1; // + 1 because last_complete_day is inclusive. } var options = _.objMap(json.segments, function(segment_data) { segment_data = segment_data.slice(0, Math.ceil(segment_num_days / json.interval)); return { trials: _.sum(_.map(segment_data, getTrials)), successes: _.sum(_.map(segment_data, getSuccesses)) }; }); var abba = new Abba.Abba(baseline, options[baseline].successes, options[baseline].trials); delete options[baseline]; _.each(options, function(data, option) { abba.addVariation(option, data.successes, data.trials); }); abba.renderTo($(\'<div>\').appendTo(target)); } } } } function renderRetentionData(target, baseline, nday_retention, json) { // target: A UI element where results will be rendered. // baseline: The baseline value of the experiment. // nday_retention: Graph retention for users who come back within this many days after this many days. // json: JSON in the segmentedRetentionReport format. function getTrials(data) { return data.first; } function getSuccesses(data) { return (data.counts[1] || 0); } function getRetention(data) { return getTrials(data) ? getSuccesses(data) / getTrials(data) : 0; } renderABResults($(\'<div>\').appendTo(target), baseline, incrDate(today(), -2 * nday_retention - 1), json, getTrials, getSuccesses); graphMetric($(\'<div>\').appendTo(target), \'Retention\', json, getRetention, d3.format(\',.1%\'), getTrials); } function renderFunnelData(target, baseline, json, getTrials, getSuccesses) { // target: A UI element where results will be rendered. // baseline: The baseline value of the experiment. // json: JSON in the segmentedRetentionReport format. // getTrials: A function which computes the number of trials for a given day of data. // getSuccesses: A function which computes the number of successful trials for a given day of data. function getFunnelRate(data) { return getTrials(data) ? getSuccesses(data) / getTrials(data) : 0; } renderABResults($(\'<div>\').appendTo(target), baseline, today(), json, getTrials, getSuccesses); graphMetric($(\'<div>\').appendTo(target), \'Funnel Completion Rate\', json, getFunnelRate, d3.format(\',.1%\'), getTrials); } function renderNetPromoterData(target, json) { function getPromoters(data) { return (data.promoter || 0); } function getDetractors(data) { return (data.detractor || 0); } function getPassives(data) { // d.undefined represents users who dismissed the dialog without making a rating. return (data.passive || 0) + (data.undefined || 0); } function getTotal(data) { return getPromoters(data) + getDetractors(data) + getPassives(data); } function getNPScore(data) { return getTotal(data) ? 100.0 * (getPromoters(data) - getDetractors(data)) / getTotal(data) : 0; } _.each(json.segments, function(segment_data, segment_name) { var sums = { promoter: _.sum(_.map(segment_data, getPromoters)), detractor: _.sum(_.map(segment_data, getDetractors)), passive: _.sum(_.map(segment_data, getPassives)) }; target.append($(\'<div>\').text("Net Promoter Score for " + segment_name + ": " + getNPScore(sums).toFixed(1))); }); graphMetric($(\'<div>\').appendTo(target), \'Net Promoter Score\', json, getNPScore, d3.format(".1d"), getTotal); } function renderActivityData(target, metrics, json) { // TODO: Break this down in terms of lessons vs. other session types, since // there are many experiments that affect only lessons (feedback from Matt) // Currently, size of json.segments is 1. var dailyCounts = json.segments[_.keys(json.segments).pop()]; metrics[\'n\'] = dailyCounts.length; _.each(dailyCounts, function(dailyCount) { for (var event in dailyCount) { for (var segment in dailyCount[event]) { //For example, event is \'total session_end\' and segment is \'true\' var base = _.isUndefined(metrics.data[event][segment]) ? 0 : metrics.data[event][segment]; metrics.data[event][segment] = base + dailyCount[event][segment]; } } }); // unique list of segments e.g. [\'false\', \'true\', \'undefined\'] metrics.segments = _.union.apply(_, _.map(metrics.data, _.keys)); if (_.contains(metrics.segments, metrics.baseline)) { metrics.segments = [metrics.baseline].concat(_.without(metrics.segments, metrics.baseline)); } drawActivityChart(target, metrics, true, \'Avg. daily volume\', getVolumeToolTip); drawActivityChart(target, metrics, false, \'Relative improvement (%)\', getImprovementToolTip); function formatInt(number, signed) { return (signed && number > 0 ? \'+\' : \'\')+Number(number).toLocaleString(); } function drawActivityChart(target, metrics, isVolume, yAxisLabel, getToolTip) { $(isVolume ? \'<div>Avg. daily activity volume</div>\' : \'<div>Activity growth over baseline</div>\').appendTo(target); if (!isVolume) { var isBaselineInvalid = _.isUndefined(metrics.baseline) || !_.contains(metrics.segments, metrics.baseline); if (isBaselineInvalid) { $(\'<div>\').text(\'BASELINE SEGMENT NOT PRESENT OR INVALID.\').appendTo(target); return; } } // Draw activity chart with NVD3 var chart = nv.models.multiBarHorizontalChart() .margin({left: 180}) .x(function(d) { return d.label }) .y(function(d) { return d.value }) .tooltips(true) .valueFormat(d3.format(isVolume ? \',\' : \'+.2%\')) .showValues(true) .showControls(false); chart.tooltipContent(function(key, y, e, graph) { return getToolTip(key, y, metrics); }); chart.yAxis.axisLabel(yAxisLabel); var chartData = toChartData(metrics, isVolume); var svg = document.createElementNS(\'http://www.w3.org/2000/svg\', \'svg\'); var height = 150 + chartData.length * 50; $(\'<div>\').addClass(isVolume ? "activity_volume_chart" : \'activity_improvement_chart\').html($(svg).attr(\'height\', height)).appendTo(target); d3.select(svg) .datum(chartData) .transition() .duration(500) .call(chart); nv.utils.windowResize(chart.update); } function toChartData(metrics, isVolume) { // Convert activity metrics data for NVD3 var chartData = []; _.each(metrics.segments, function(segment) { if (!isVolume && (segment == metrics.baseline || segment == \'undefined\')) { return; } var segmentData = {key: segment, values: []}; _.each(metrics.events, function(event) { var value = metrics.data[event][segment]; if (isVolume) { value = Math.round(value / metrics.n); } else { var controlValue = metrics.data[event][metrics.baseline]; value = (value / controlValue - 1); } segmentData.values.push({label: event, value: value}); }); chartData.push(segmentData); }); return chartData; } function getVolumeToolTip(segment, event, metrics) { // Create a tool tip for activity volume chart var experimentTotal = metrics.data[event][segment]; var experimentAvg = Math.round(experimentTotal / metrics.n); var controlTotal = metrics.data[event][metrics.baseline]; var controlAvg = Math.round(controlTotal / metrics.n); var improv = formatInt(((experimentAvg / controlAvg-1) * 100).toFixed(2), true); return \'<div class="activity_tooltip"><h4>\'+event+\'</h4><table>\' +\'<tr><th></th><th>Per Day</th><th>&nbsp;Total (\'+metrics.n+\' days)</th></tr>\' +\'<tr><th>\'+segment+\'</th><td>\'+formatInt(experimentAvg, false)+\'</td>\' +\'<td>\'+formatInt(experimentTotal, false)+\'</td></tr></table></div>\'; } function getImprovementToolTip(segment, event, metrics) { // Create a tool tip for activity improvement chart var experimentTotal = metrics.data[event][segment]; var experimentAvg = Math.round(experimentTotal / metrics.n); var controlTotal = metrics.data[event][metrics.baseline]; var controlAvg = Math.round(controlTotal / metrics.n); var improv = formatInt(((experimentAvg / controlAvg - 1) * 100).toFixed(2), true); return \'<div class="activity_tooltip"><h4>\'+event+\'</h4><table>\' +\'<tr><th></th><th>Per Day</th><th>&nbsp;Total (\'+metrics.n+\' days)</th></tr>\' +\'<tr><th>\'+metrics.baseline+\'</th><td>\'+formatInt(controlAvg, false)+\'</td>\' +\'<td>\'+formatInt(controlTotal, false)+\'</td></tr>\' +\'<tr><th>\'+segment+\'</th><td>\'+formatInt(experimentAvg, false)+\'</td>\' +\'<td>\'+formatInt(experimentTotal, false)+\'</td></tr>\' +\'<tr class="line"><th>Delta</th><td>\'+formatInt(experimentAvg - controlAvg, true)+\'</td>\' +\'<td>\'+formatInt(experimentTotal - controlTotal, true)+\'</td></tr>\' +\'<tr><th>Improv.</th><td colspan=2 class="pval">\' //Feedback from Matt: If we\'re going to show confidence intervals, we should make sure they\'re //legit (e.g., we shouldn\'t assume that session_starts follow a binomial distribution). +improv+\'%\' +\'</td></tr></table>Note: statistical significance should be taken<br />into account but it is not availbale yet.</div>\'; } } function renderSignupFunnelData(target, baseline, json) { function getSplashLoads(data) { var register_starting_amount = data.register.analysis.starting_amount; var login_starting_amount = data.login.analysis.starting_amount; var session_starting_amount = data.session.analysis.starting_amount; if (register_starting_amount != login_starting_amount) { log(target, \'WARNING: splash load numbers for registration and login do not agree: (\' + register_starting_amount + \', \' + login_starting_amount + \')\'); } if (session_starting_amount % 2 != 0) { log(target, \'WARNING: sampled analysis does not have an even number of splash loads: \' + session_starting_amount); } if (Math.abs(register_starting_amount - session_starting_amount) > register_starting_amount * 0.01) { // We expect that the session_start numbers will be slightly different. Since session_start is sampled, Mixpanel samples the show home event when evaluating this funnel. log(target, \'WARNING: splash load numbers for registration and session_start do not agree: (\' + register_starting_amount + \', \' + session_starting_amount + \')\'); } return register_starting_amount; } function getLogins(data) { return data.login.steps[1].count; } function getEligibleForRegistration(data) { return getSplashLoads(data) - getLogins(data); } function getWelcomes(data) { return data.register.steps[1].count; } function getRegistrations(data) { return data.register.steps[2].count; } function getSessionStarts(data) { return data.session.steps[1].count; } function getSessionEnds(data) { return data.session.steps[2].count; } function divBy2(fn) { // Returns a function which takes the same arguments as fn, but returns half the value. // This is for use when computing ab test results so that we don\'t report them as being more significant than they are. // If an event is sampled, we\'ve really only seen half as many instances. function inner() { return fn.apply(this, arguments) / 2; } return inner } target.append($(\'<h4>\').text(\'Get Started Rate\')); renderFunnelData(target, baseline, json, getSplashLoads, getWelcomes); target.append($(\'<h4>\').text(\'Trial Account Conversion Rate\')); renderFunnelData(target, baseline, json, getWelcomes, getRegistrations); target.append($(\'<h4>\').text(\'Session Start Rate\')); renderFunnelData(target, baseline, json, divBy2(getEligibleForRegistration), divBy2(getSessionStarts)); target.append($(\'<h4>\').text(\'Session End Rate\')); renderFunnelData(target, baseline, json, divBy2(getEligibleForRegistration), divBy2(getSessionEnds)); } function renderTrialConversionFunnel(target, baseline, json) { function getWelcomes(data) { return data.steps[0].count; } function getRegistrations(data) { return data.steps[1].count; } renderFunnelData(target, baseline, json, getWelcomes, getRegistrations); } $(initializeControls); \x3c/script></head><body><div id="site"><div id="wrapper"><div id="app"><main class="main-center"><section class="page-main"><form id="retention" action="/"><h2>Metrics</h2><div class="controls"><div>Experiment: <input type="text" id="experiment-control" value=""></div><div>Baseline: <input type="text" id="baseline-control" value=""></div><div>Start date: <input type="text" id="start-date-control" value=""><a href="javascript:$(\'#start-date-control\').val(today()).change();">today</a><span class="checkmark">&#10004;</span></div><div>End date: <input type="text" id="end-date-control" value=""><a href="javascript:$(\'#end-date-control\').val(today()).change();">today</a><span class="checkmark">&#10004;</span></div><div>Signed-in state: <ul id="login-state-control" class="radio-control"><li><input type="radio" name="login-state" value="loggedin" checked="checked">Logged In{{!</li>}}<li><input type="radio" name="login-state" value="loggedout">Logged Out{{!</li>}}</ul></div><div>User population: <ul id="population-control" class="radio-control"><li><input type="radio" name="population" value="all_users" checked="checked">All users{{!</li>}}<li><input type="radio" name="population" value="new_users">New Users{{!</li>}}</ul></div><div>N-day retention: <input type="text" id="nday-retention-control" value=""><span class="checkmark">&#10004;</span></div><div>Platform: <ul id="platform-control" class="radio-control"><li><input type="radio" name="platform" value="all" checked="checked">All{{!</li>}}<li><input type="radio" name="platform" value="web">Web{{!</li>}}<li><input type="radio" name="platform" value="android">Android{{!</li>}}<li><input type="radio" name="platform" value="ios">iOS{{!</li>}}<li><input type="radio" name="platform" value="windows">Windows{{!</li>}}</ul></div><div>App Version: <ul id="app-version-control" class="checkbox-control"><li><a href="javascript:;" class="blue" data-action="all">all</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="clear">clear</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="add">add</a>{{!</li>}}</ul></div><div>Min age: <ul id="min-age-control" class="radio-control"><li><input type="radio" name="min-age" value="all" checked="checked">All{{!</li>}}<li><input type="radio" name="min-age" value="604800000">1 Week{{!</li>}}<li><input type="radio" name="min-age" value="2592000000">1 Month{{!</li>}}<li><input type="radio" name="min-age" value="15552000000">6 Months{{!</li>}}<li><input type="radio" name="min-age" value="custom"><input type="text" value=""> <span class="checkmark">&#10004;</span>{{!</li>}}</ul></div><div>Max age: <ul id="max-age-control" class="radio-control"><li><input type="radio" name="max-age" value="all" checked="checked">All{{!</li>}}<li><input type="radio" name="max-age" value="604800000">1 Week{{!</li>}}<li><input type="radio" name="max-age" value="2592000000">1 Month{{!</li>}}<li><input type="radio" name="max-age" value="15552000000">6 Months{{!</li>}}<li><input type="radio" name="max-age" value="custom"><input type="text" value=""> <span class="checkmark">&#10004;</span>{{!</li>}}</ul></div><div>Learning language: <ul id="learning-language-control" class="checkbox-control">{{#learning_language}}<li><input type="checkbox" value="{{abbrev}}" {{#in_house}}data-in-house{{/in_house}}>{{name}}{{!</li>}}{{/learning_language}}<li><a href="javascript:;" class="blue" data-action="all">all</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="in-house">in house</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="clear">clear</a>{{!</li>}}</ul></div><div>From language: <ul id="from-language-control" class="checkbox-control">{{#from_language}}<li><input type="checkbox" value="{{abbrev}}" {{#in_house}}data-in-house{{/in_house}}>{{name}}{{!</li>}}{{/from_language}}<li><a href="javascript:;" class="blue" data-action="all">all</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="in-house">in house</a>{{!</li>}}<li><a href="javascript:;" class="blue" data-action="clear">clear</a>{{!</li>}}</ul></div><div>Freeform restriction: <input type="text" id="freeform-control" value=""></div><div><button id="submit-control" class="btn btn-green">Submit</button> Outstanding calls: <span id="outstanding-calls"></span></div></div></form><div id="data-view"></div></section></main></div></div></div></body></html> ',
"mini-lemma-row":'{{#forms_data}}<tr {{#first}}class="first-lemma-row"{{/first}}>{{#first}}<td rowspan="{{num_forms}}" style="background: white;"><a href="/word/{{language}}/{{lemma_value}}/{{pos_key}}" class="lemma">{{lemma_surface_form}}</a></td>{{/first}}<td class="lexeme">{{#new_form}}<span class="icon-present-small left" title="{{#_i}}New word{{/_i}}"></span>{{/new_form}}<span class="lexeme-form">{{surface_form}}</span></td><td><ul class="word-strength small"><li class="filled"></li><li {{#strength_s}}class="filled"{{/strength_s}}></li><li {{#strength_m}}class="filled"{{/strength_m}}></li><li {{#strength_l}}class="filled"{{/strength_l}}></li></ul></td></tr>{{/forms_data}}',
"mini-vocab-overview":'{{#has_vocab}}<div class="skill-practice-box"><a href="javascript:;" class="btn primary large practice right">{{#_i}}Practice skill{{/_i}}<span class="coin-medium">+10</span><ul class="word-strength medium blue"><li class="filled"></li><li {{#avg_strength_s}}class="filled"{{/avg_strength_s}}></li><li {{#avg_strength_m}}class="filled"{{/avg_strength_m}}></li><li {{#avg_strength_l}}class="filled"{{/avg_strength_l}}></li></ul><div class="popover black below skill"><div class="arrow"></div><div class="inner track-hover"><div class="content"><strong>{{#_i}}Increase your word strength{{/_i}}</strong><br/><p style="margin: 10px 0 0 0; color: #BBB">{{#_i}}Get all vocabulary from {{#_ivar}}skill_title{{/_ivar}} into your long-term memory.{{/_i}}</p></div></div></div></a><h4>{{#_i}}You have learned<br/><strong>{{vocab_count}} {{#pluralize}}word,words,{{vocab_count}}{{/pluralize}}</strong>{{/_i}}</h4></div>{{/has_vocab}}{{^has_vocab}}<h3>{{#_i}}You have learned <strong>{{vocab_count}} {{#pluralize}}word,words,{{vocab_count}}{{/pluralize}}</strong>{{/_i}}</h3>{{/has_vocab}}<table class="vocabulary table table-striped" border="0" cellspacing="0" cellpadding="0"><thead><tr><th class="sortable" data-sort="word" style="">{{#_i}}Word{{/_i}} <span class="sorting-icon"></span></th><th style="">{{#_i}}Forms{{/_i}}</th><th style="width: 25%">{{#_i}}Strength{{/_i}}</th></tr></thead><tbody>{{^has_vocab}}<tr><td colspan="3">{{#_i}}You haven\'t learned any words in this skill yet. Try doing some lessons.{{/_i}}</td></tr>{{/has_vocab}}{{#vocab}}{{>mini-lemma-row}}{{/vocab}}</tbody></table>{{#more_vocab}}<a href="/vocab/{{skill_id}}">\u2192 {{#_i}}View full vocabulary from{{/_i}} {{#_ivar}}skill_title{{/_ivar}}</a>{{/more_vocab}} ',
mobile:'<div id="mobile" class="about-pages"><section><h2 class="app-link">{{#_i}}See why Apple named us iPhone App of the Year and Google selected us as the Best of the Best in Google Play.{{/_i}}</h2><div class="content" style="text-align:center;"><div class="store-buttons"><a class="btn btn-mobile" href="https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8" target="_blank"><span class="about-img apple-store"></span><span class="button-text">{{#_i}}<span class="subtext">Download on the</span>App Store{{/_i}}</span></a><a class="btn btn-mobile" href="https://play.google.com/store/apps/details?id=com.duolingo" target="_blank"><span class="about-img play-store"></span><span class="button-text">{{#_i}}<span class="subtext">Get it on</span>Google Play{{/_i}}</span></a><a class="btn btn-mobile" href="https://www.windowsphone.com/s?appid=2d89520e-d360-4b5b-ba5a-5a15064aa935" target="_blank"><span class="about-img windows-store"></span><span class="button-text">{{#_i}}<span class="subtext">Download from</span>Windows Store{{/_i}}</span></a></div><div class="link-container">\x3c!-- <a id="email-app-link" href="javascript:;" class="blue">{{#_i}}Email me a link{{/_i}}</a><div id="app-link-popover" class="popover arrow-top-right dropdown-menu"><form><ul><li><input id="apple-radio" class="device-choice" type="radio" name="device-choice" value="apple"><label for="apple-radio">{{#_i}}iPhone{{/_i}}</label></li><li style="margin: 10px 0;"><input id="android-radio" class="device-choice" type="radio" name="device-choice" value="android"><label for="android-radio">{{#_i}}Android device{{/_i}}</label></li></ul></form><div class="block-input-row margin-bottom"><div class="col-left"><input type="text" class="input-block" placeholder="Email address" id="email" name="email" value="{{email}}" autocomplete="on"/></div><div class="col-right"><input id="get-app-link" class="btn btn-green right" type="submit" disabled="disabled" style="width: auto" value="{{#_i}}Send{{/_i}}"></div></div><div id="message" class="login-failed hidden">{{#_i}}You entered an invalid email address.{{/_i}}</div></div> --\x3e</div><div class="device-container"><div class="about-img devices"></div></div></div></section></div>',
"mod-manager":'<div class="manage-mods">{{#has_topic}}<div class="add-moderator"><h2>Add a moderator</h2><input type="text" id="add-moderator" name="add-mod" placeholder="enter a user id"/><button class="btn btn-green add-user">Add</button></div><div class="list-moderators"><h2>Current moderators</h2><ul>{{#has_moderators}}<table class="table-striped">{{#moderators}}<tr style="line-height: 28px;"><td><a href="/{{username}}" class="username">{{username}}</a></td><td>{{user_id}}</td><td><div class="remove-moderator" data-id="{{user_id}}">x</div></td></tr>{{/moderators}}</table>{{/has_moderators}}{{^has_moderators}} Nobody is moderating this topic. Ahh! {{/has_moderators}}</ul></div>{{/has_topic}}{{^has_topic}}<table class="table-striped">{{#moderators}}<tr><td>{{username}}</td><td>{{email}}</td><td>{{#is_inc_mod}}<span class="tag incubator">INC</span>{{/is_inc_mod}}{{^is_inc_mod}}<span class="tag forum">FOR</span>{{/is_inc_mod}}</td><td><ul>{{^topics}}<li>Global</li>{{/topics}}{{#topics}}<li>{{from_language}} -> {{name}}</li>{{/topics}}</ul></td></tr>{{/moderators}}</table>{{/has_topic}}</div><div class="manage-mods-sidebar"><h2>Topics</h2><a href="javascript:;" class="see-all blue" id="see-all">(See all moderators)</a><ul class="topic-list">{{#topics}}<li class="topic-option {{#active}}active{{/active}}" data-id="{{id}}"><div class="topic-icon"><span class="icon icon-sidebar {{^learning_language}}icon-section-{{type}}{{/learning_language}} {{#learning_language}}flag flag-svg-small flag-{{learning_language}}{{/learning_language}}"><span class="flag flag-svg-micro flag-{{flag_abbrev}}"></span></span></div><a>{{from_language}} -> {{#learning_language}}{{learning_language}}{{/learning_language}}{{^learning_language}}{{type}}{{/learning_language}}</a></li>{{/topics}}</ul></div>',
"moderation-log":'<ul class="activity-stream moderation-log">{{#events}}{{#delete_log}}<li class="stream-item"><span class="stream-item-type default"></span>{{#user}}{{>avatar_medium}}{{/user}}<header class="stream-item-header"><a href="#/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a><span class="stream-item-time">{{datetime}}</span></header><p class="stream-item-content"> deleted a comment by <a href="#/{{#author}}{{username}}{{/author}}" class="username">{{#author}}{{username}}{{/author}}</a> from {{#parent_thread_id}}<strong><a href="/comment/{{parent_thread_id}}">{{parent_title}}</a></strong>{{/parent_thread_id}}<br/>{{text}}</p><ul class="stream-item-social-links"><li><a href="javascript:;" class="undelete" data-id="{{comment_id}}" data-index="{{index}}">{{#_i}}Undelete{{/_i}}</a></li></ul></li>{{/delete_log}}{{#comment_log}}<li class="stream-item"><span class="stream-item-type default"></span>{{#user}}{{>avatar_medium}}{{/user}}<header class="stream-item-header"><a href="#/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a><span class="stream-item-time">{{datetime}}</span></header><p class="stream-item-content">{{^new_discussion}} commented on {{/new_discussion}}{{#new_discussion}} created the thread {{/new_discussion}}{{#parent_thread_id}}<strong><a href="/comment/{{parent_thread_id}}">{{parent_title}}</a></strong>{{/parent_thread_id}}<br/>{{text}}</p></li>{{/comment_log}}{{/events}}</ul>{{#more}}<button class="btn btn-standard btn-block load-more">Load More</button>{{/more}} ',
"name-element":'<div class="challenge-name"><h1 class="player">{{#hint}}{{#_i}}Translate \u201c{{hint}}\u201d{{/_i}}{{/hint}}</h1><div class="challenge-row"><div class="challenge-cell cell-left">{{>name-images}}</div><div class="challenge-cell cell-right"><div class="choose-article-container"><ul class="choose-article hover-effect">{{#articles_map}}<li><label class="blue-label"><input id="option-{{index}}" type="radio" class="player-radio" name="articles" value="{{article}}"/> {{article}}</label></li>{{/articles_map}}</ul></div>{{>blame-popover}}<input class="one-line-input input-lg input-block" id="word-input" placeholder="{{#_i}}Type in {{#_ivar}}language_name{{/_ivar}}{{/_i}}" name="word-input" size="30" type="text" value="" dir="auto"><div id="vkeyboard-placeholder"></div></div></div></div> ',
"name-images":'<ul class="list-tilted-images">{{#images}}<li style="background-image: url(\'{{.}}\')"></li>{{/images}}</ul> ',"nested-comment":'<div id="nested-comment-{{id}}" class="{{#removed}}{{^deleted}}faded-comment{{/deleted}}{{/removed}}"><span id="self-comment">{{#user}}<span class="left">{{>avatar_medium}}</span>{{/user}}<header>{{#user}}{{^deactivated}}<a href="/{{username}}" class="username">{{username}}</a> {{/deactivated}}{{#deactivated}}{{#_i}}[deactivated user]{{/_i}} {{/deactivated}}{{>user_flair}}{{/user}}{{#show_date}}<span class="showing-date-compact">{{#pretty_date}}{{datetime_string}}{{/pretty_date}}</span>{{/show_date}}</header><div class="body" id="body-{{id}}"><bdi>{{^deleted}}{{{processed_message}}}{{/deleted}}{{#deleted}}<p><i>{{#_i}}[deleted]{{/_i}}</i></p>{{/deleted}}</bdi></div><div class="footer" style="height:26px">{{#logged_in}}{{^trial_account}}{{^removed}}<div class="vote-module-small"><div class="vote-count {{#user_upvoted}}active-upvoted{{/user_upvoted}} {{#user_downvoted}}active-downvoted{{/user_downvoted}}">{{votes}}</div><button class="btn btn-custom vote-up " id="comment-{{id}}-upvote"><span class="icon icon-vote-up-small {{#user_upvoted}}active{{/user_upvoted}}"></span></button><button class="btn btn-custom vote-down" id="comment-{{id}}-downvote"><span class="icon icon-vote-down-small {{#user_downvoted}}active{{/user_downvoted}}"></span></button></div>{{^deleted}}{{^frozen}}{{#depth}}<a href="javascript:;" class="add-reply">{{#_i}}Reply{{/_i}}</a>{{/depth}}{{#editable}}<a href="javascript:;" class="edit-comment">{{#_i}}Edit{{/_i}}</a>{{/editable}}{{/frozen}}{{#deletable}}<a href="javascript:;" class="delete-comment">{{#_i}}Delete{{/_i}}</a>{{/deletable}}{{/deleted}}{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<a href="javascript:;" class="undelete-comment">{{#_i}}Undelete{{/_i}}</a>{{/undeletable}}{{/deleted}}{{/removed}}{{#deleted}}{{#undeletable}}<a href="javascript:;" class="undelete-comment">{{#_i}}Undelete{{/_i}}</a>{{/undeletable}}{{/deleted}}{{#rupees}}<a href="javascript:;" class="give-love">{{#_i}}Give Lingot{{/_i}}</a>{{/rupees}}{{#love}}<span class="icon icon-lingot-micro"></span><span class="love-number">{{love}}</span>{{/love}}{{#show_date}}<span class="divider">\u2022</span>{{/show_date}}{{/trial_account}}{{/logged_in}}{{#show_date}}<span class="showing-date">{{#pretty_date}}{{datetime_string}}{{/pretty_date}}</span>{{/show_date}}</div><div class="edit-post-box hidden" id="edit-box-{{id}}"><div class="form-row small margin-bottom"><textarea class="post-edit-box comment-box" style="width: 96%; height: 80px;" name="post-edit-box" dir="auto">{{message}}</textarea></div><input type="submit" class="btn btn-green update-comment btn-small" value="{{#_i}}Save{{/_i}}"> <input type="reset" class="btn-small btn btn-standard cancel-update-comment" value="{{#_i}}Cancel{{/_i}}"></div><div id="reply-box-{{id}}" class="hidden new-comment"><textarea class="textarea-block margin-bottom" id="postreply-{{id}}" name="postreply" placeholder="{{#_i}}Leave a reply{{/_i}}" dir="auto"></textarea><button id="post-reply" class="btn margin-right btn-green post-reply">{{#_i}}Post{{/_i}}</button><button class="btn btn-standard cancel-reply">{{#_i}}Cancel{{/_i}}</button></div></span><ul id="comments" class="discussion-comments-list shifted" style="{{^comments}}margin: 0;{{/comments}}">{{#comments}}{{^removed}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/removed}}{{#removed}}{{^deleted}}{{#undeletable}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/undeletable}}{{/deleted}}{{/removed}}{{#removed}}{{#deleted}}<li id="comment-{{id}}" class="discussion-comments-list-item"></li>{{/deleted}}{{/removed}}{{/comments}}{{#num_hidden}}<li class="show-toggle comment" id="show-toggle-{{id}}"><a href="javascript:;" class="show-bad-comment">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/num_hidden}}{{^num_hidden}}{{#undeletable}}<li class="show-toggle comment" id="show-toggle-{{id}}"><a href="javascript:;" class="show-bad-comment">[+] <i>{{#_i}}{{num_hidden}} hidden {{#pluralize}}comment,comments,{{num_hidden}}{{/pluralize}}{{/_i}}</i></a></li>{{/undeletable}}{{/num_hidden}}</ul></div> ',
"new-user-modal":'<div class="modal hidden fade in" id="signup-modal"><div class="close" data-dismiss="modal"></div><div id="register-view"></div><div id="login-view" class="hidden"></div><div id="modal-footer"><div id="user-login">{{#_i}}Have an Account?{{/_i}} <a href="javascript:;" class="existing-login">{{#_i}}Sign in{{/_i}}</a></div><div id="create-account" style="display:none;"><a href="javascript:;" class="create-profile">{{#_i}}Create an account{{/_i}}</a></div></div></div> ',new_friend:"{{#_i}}{{username}} is following you on Duolingo.{{/_i}}",
new_years_resolution:'<html><head><meta property="fb:app_id" content="248280928555325" /><meta property="og:site_name" content="Duolingo" /><meta property="og:title" content="{{#_i}}Learn a New Language in 2015{{/_i}}" /><meta property="og:description" content="{{#_i}}Research shows that sharing your New Year\'s Resolution with friends actually helps you succeed! Make a commitment and start learning a new language now.{{/_i}}" /><meta property="og:image" content="http://www.duolingo.com/images/2015.png" /><meta property="og:locale" content="{{locale}}" /><meta property="og:locale:alternate" content="en_US" /><meta property="og:locale:alternate" content="es_ES" /><meta property="og:locale:alternate" content="pt_PT" /><meta property="og:locale:alternate" content="es_LA" /><meta property="og:locale:alternate" content="de_DE" /><meta property="og:locale:alternate" content="fr_FR" /><meta property="og:locale:alternate" content="it_IT" /><meta property="og:locale:alternate" content="pt_BR" /></head><script type="text/javascript"> window.location = "//www.duolingo.com" \x3c/script></html> ',
"no-sound-modal":'{{#version_too_low}}<p>{{#_i}}Your Flash version is too old. You need Flash version 8 or higher. Go <a href="http://www.adobe.com/support/flashplayer/downloads.html">here</a> to download a more recent version.{{/_i}}</p>{{/version_too_low}}{{^version_too_low}}<p>{{#_i}}It\'s possible that you have browser extensions that block Flash or that Flash crashed.{{/_i}}</p><p>{{#_i}}Let\'s fix this! If you have a Flash blocker add \'duolingo.com\' to its whitelist. If Flash crashed try <a href="javascript:;" onclick="window.location.reload();">reloading</a> the page.{{/_i}}</p>{{/version_too_low}}<p>{{#_i}}Sound still not working? Go to the <a href="/settings">settings page</a> in the top right corner to disable the speaker.{{/_i}}</p>',
nojs_flashcards:'<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>{{title}}</title><link href="/images/favicon.ico?v=3" rel="shortcut icon" type="image/x-icon" />{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}</head><body id="no-javascript"><div id="no-js"><div id="topbar"><header class="topbar dark-theme topbar-blue"><div id="topbar-box"><div id="topbar-brand-container" class="left-aligned"><a href="http://www.duolingo.com" id="to-home" class="topbar-brand navigate-home track-click white "></a></div><div id="topbar-btn-container"><a href="/nojs/flashcardsmenu" id="to-no-js-menu" class="btn btn-green-light">{{moreflashcards}}</a></div></div></header></div>{{#cards}}<input type="radio" name="card-locs" id="card-{{index}}-loc" class="hidden" {{checked}} />{{/cards}}<div id="gallery-clipping-mask"><div id="gallery">{{#cards}}<div class="gallery-item"><input type="checkbox" id="card-{{index}}-state" class="hidden"><label for="card-{{index}}-state" class="outlet"><div class="flip-container"><div class="card"><div class="face front">{{#prev}}<label for="card-{{prev}}-loc" class="prev">&#x2039;</label>{{/prev}}<span class="flip">{{flip}}</span><span class="icon icon-flip"></span><span class="flashcard-word"><table class="flag-word-table"><tr><td><span class="flag flag-svg-small flag-{{lang_1_code}}"></span></td><td><div class="flashcard-word-text">{{lang_1_word}}</div></td></tr></table></span>{{#next}}<label for="card-{{next}}-loc" class="next">&#x203a;</label>{{/next}}</div><div class="face back">{{#prev}}<label for="card-{{prev}}-loc" class="prev">&#x2039;</label>{{/prev}}<span class="flip">{{flip}}</span><span class="icon icon-flip"></span><span class="flashcard-word"><table class="flag-word-table"><tr><td><span class="flag flag-svg-small flag-{{lang_2_code}}"></span></td><td><div class="flashcard-word-text">{{lang_2_word}}</div></td></tr></table></span>{{#next}}<label for="card-{{next}}-loc" class="next">&#x203a;</label>{{/next}}</div></div></div></label></div>{{/cards}}</div></div><div id="nav-dots">{{#cards}}<label for="card-{{index}}-loc" class="nav-dot" id="img-dot-{{index}}"></label>{{/cards}}</div></div></body></html>',
nojs_index:'<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Lite</title><link href="/images/favicon.ico?v=3" rel="shortcut icon" type="image/x-icon" />{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}</head><body><div id="no-js" ><div id="topbar"><header class="topbar dark-theme topbar-blue"><div id="topbar-box"><div id="topbar-brand-container" class="center"><a href="http://www.duolingo.com" id="to-home" class="topbar-brand navigate-home track-click white "></a></div></div></header></div><div id="index-background" class="box-colored white center-block"><h1 id="warning" class="center-text">Para la mejor experiencia, habilita Javascript y visita <a href="http://www.duolingo.com"> Duolingo.com</a></h1><div id="no-js-apps"><a href="/nojs/flashcardsmenu" class="btn btn-primary no-js-app-link"> Tarjetas Espa\u00f1ol - Ingl\u00e9s </a></div></div></div></body></html>',
nojs_menu:'<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Men\u00fa</title><link href="/images/favicon.ico?v=3" rel="shortcut icon" type="image/x-icon" />{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}</head><body><div id="no-js" ><div id="topbar"><header class="topbar dark-theme topbar-blue"><div id="topbar-box"><div id="topbar-brand-container" class="center"><a href="http://www.duolingo.com" id="to-home" class="topbar-brand navigate-home track-click white "></a></div></div></header></div><div id="skill-options" class="box-colored white center-block">{{#skills}}<div class="skill-option"><a href="/nojs/flashcards/{{URLsuffix}}" class="fade-this-in skill-badge-small" style="opacity: 1;"><span class="skill-icon {{iconColor}} small unlocked "><span class="skill-icon-image skill-icon-{{iconNum}}"></span></span><span class="skill-badge-name">{{name}}</span></a></div>{{/skills}}</div></div></body></html>',
notifications:'<div id="notifications-content" class="settings-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1>{{#_i}}Notifications{{/_i}}</h1><h3 style="text-align: center;">{{#_i}}General{{/_i}}</h3><ul class="list-settings" style="margin-top: 30px; margin-bottom: 50px;"><li><label class="label" for="notify_follow">{{#_i}}Email me when{{/_i}}</label><div class="input"><ul class="inputs-inline left"><li><label><input class="border" id="notify_announcement" name="notify_announcement" type="checkbox" {{#notify_announcement}}checked="checked"{{/notify_announcement}}/></label></li></ul><p class="gray gray-text">{{#_i}}There is an announcement{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="notify_follow" name="notify_follow" type="checkbox" {{#notify_follow}}checked="checked"{{/notify_follow}}/></label></li></ul><p class="gray gray-text">{{#_i}}Somebody friends me{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="notify_pass" name="notify_pass" type="checkbox" {{#notify_pass}}checked="checked"{{/notify_pass}}/></label></li></ul><p class="gray gray-text">{{#_i}}Somebody passes me{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="notify_comment" name="notify_comment" type="checkbox" {{#notify_comment}}checked="checked"{{/notify_comment}}/></label></li></ul><p class="gray gray-text">{{#_i}}Somebody responds to a discussion I\'m following{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="notify_stream_post" name="notify_stream_post" type="checkbox" {{#notify_stream_post}}checked="checked"{{/notify_stream_post}}/></label></li></ul><p class="gray gray-text">{{#_i}}Someone posts on my stream{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="notify_edit_suggested" name="notify_edit_suggested" type="checkbox" {{#notify_edit_suggested}}checked="checked"{{/notify_edit_suggested}}/></label></li></ul><p class="gray gray-text">{{#_i}}Someone edits a sentence I have translated{{/_i}}</p></div></li><li><label class="label" for="notify_follow">{{#_i}}Notify me when{{/_i}}</label><div class="input"><ul class="inputs-inline left"><li><label><input class="border" id="insite_sentence_edited" name="insite_sentence_edited" type="checkbox" {{#insite_sentence_edited}}checked="checked"{{/insite_sentence_edited}}/></label></li></ul><p class="gray gray-text">{{#_i}}Someone edits a sentence I have translated{{/_i}}</p><ul class="inputs-inline left"><li><label><input class="border" id="insite_immersion_lingots" name="insite_immersion_lingots" type="checkbox" {{#insite_immersion_lingots}}checked="checked"{{/insite_immersion_lingots}}></label></li></ul><p class="gray" style="padding-top: 7px; margin-bottom: 10px; padding-left: 32px">{{#_i}}I receive lingots for uploading documents{{/_i}}</p></div></li></ul><h3 style="text-align: center;">{{#_i}}Daily reminders{{/_i}}</h3><ul class="list-settings" style="margin-top: 30px;"><li><label class="label" for="notify_follow">{{#_i}}Email me when{{/_i}}</label><div class="input">{{#languages_data}}<ul class="inputs-inline left"><li><label><input class="border" name="language_settings.{{language}}.notify_practice" type="checkbox" {{#notify_practice}}checked="checked"{{/notify_practice}}/></label></li></ul><p class="gray gray-text">{{#_i}}I forget to practice {{#_iv}}{{language_string}}{{/_iv}} by {{> practice-time-settings}}{{/_i}}</p>{{/languages_data}}</div></li></ul></div> ',
"notifications-view":'<ul class="list-notifications">{{#notification_events}}<li {{#unseen}}class="new-notification"{{/unseen}}>{{#lingot_icon}}<div class="icon icon-lingot-small notif-rupee"></div>{{/lingot_icon}}{{#user}}{{#follow}}{{^is_following}}<span class="follow right btn btn-small btn-green" data-user={{id}}>{{#_i}}Add friend{{/_i}}</span>{{/is_following}}{{/follow}}{{^translation_lingots}}{{^document_lingots}}{{^translator_promotion}}{{^accepted}}{{^streak}}{{^invited}}{{>avatar_micro}}{{/invited}}{{/streak}}{{/accepted}}{{/translator_promotion}}{{/document_lingots}}{{/translation_lingots}}{{#follow}} {{#_i}}<a href="/{{username}}" class="user">{{username}}</a> added you as a friend.{{/_i}} {{/follow}}{{#pass}} {{#_i}}<a href="/{{username}}" class="user">{{username}}</a> passed you in skill points.{{/_i}} {{/pass}}{{#comment}} {{#_i}}<a href="/{{username}}" class="user">{{username}}</a> replied to your comment in <a href="/comment/{{comment_id}}{{#nested_id}}$comment_id={{nested_id}}{{/nested_id}}"><strong>{{comment_title}}</strong></a>.{{/_i}} {{/comment}} {{#is_following}}<br/>{{/is_following}}{{#stream_post}} {{#_i}}<a href="/{{username}}" class="user">{{username}}</a> posted on your stream{{/_i}}<div>{{stream_blurb}} </div>{{/stream_post}}{{#invite}}{{#invited}}{{#_i}}<a href="/{{username}}" class="user">{{username}}</a> accepted your invite to join Duolingo! You have earned 1 lingot.{{/_i}} {{/invited}}{{#accepted}}{{#_i}}You earned 1 lingot for accepting an invite from your friend {{#inviter}}<a href="/{{username}}" class="user">{{username}}</a>{{/inviter}}. Use it in the store to purchase helpful items!{{/_i}} {{/accepted}}{{/invite}}{{#translation}}{{#_i}}<a href="/{{username}}">{{username}}</a> edited your translation in <a href="/translation/{{translation_id}}$index={{sentence_index}}"><strong>{{document_title}}</strong></a>.{{/_i}}{{/translation}}{{/user}}{{#streak}}{{^won_wager}}{{^lost_wager}}<span>{{#_i}}You earned {{num_rupees}} {{#pluralize}}lingot,lingots,{{num_rupees}}{{/pluralize}} for reaching a {{streak_days}} day streak!{{/_i}} </span>{{/lost_wager}}{{/won_wager}}{{#won_wager}}<span>{{#_i}}You won your wager by keeping your streak for 7 days and have been awarded 10 lingots!{{/_i}} </span>{{/won_wager}}{{#lost_wager}}<span>{{#_i}}You have lost your wager. Better luck next time!{{/_i}} </span>{{/lost_wager}}{{/streak}}{{#translator_promotion}}<span class="translator-tier-flag-micro"><span class="double-flag-source flag flag-svg-micro flag-{{source_language}}"></span><span class="double-flag-target flag flag-svg-micro flag-{{target_language}}"></span></span><span>{{#_i}}You reached translation tier {{new_tier}}!{{/_i}} </span>{{/translator_promotion}}{{#document_lingots}}<span>{{#_i}}You received {{num_lingots}} {{#pluralize}}Lingot,Lingots,{{num_lingots}}{{/pluralize}} for upvotes to <a href="/translation/{{translation_id}}">{{document_title}}</a>{{/_i}}</span>{{/document_lingots}}{{#translation_lingots}}<span>{{#_i}}You received {{num_lingots}} {{#pluralize}}Lingot,Lingots,{{num_lingots}}{{/pluralize}} for helping to translate <a href="/translation/{{translation_id}}">{{document_title}}</a>{{/_i}} </span>{{/translation_lingots}}<span style="padding:0 2px"></span><span class="datetime">{{pretty_datetime}}</span></li>{{/notification_events}}{{^notification_events}}<li style="padding-left: 10px;text-align: center;color: #999;">{{#_i}}You have no new notifications.{{/_i}}</li>{{/notification_events}}</ul><div class="close"></div> ',
notify_me:'<div class="center-pane"><form action="" method="post" id="subscribe-form"><input type="hidden" name="came_from" value="{{came_from}}"/><fieldset class="clearfix">{{#_i}}Notify me{{/_i}}<h3>{{#_i}}We are starting with Spanish,<br/>German and English.<br/>Let us know if you want to learn another<br/>language and we will keep you posted.{{/_i}}</h3><ul class="login-signup-list"><li><select class="medium" name="learning_language" id="learning_language"><option disabled="disabled">{{#_i}}Notify me about...{{/_i}}</option><option value="fr">{{#_i}}French{{/_i}}</option><option value="it">{{#_i}}Italian{{/_i}}</option><option value="zh">{{#_i}}Chinese{{/_i}}</option><option value="ja">{{#_i}}Japanese{{/_i}}</option><option value="ru">{{#_i}}Russian{{/_i}}</option><option value="ar">{{#_i}}Arabic{{/_i}}</option><option value="**">{{#_i}}Klingon{{/_i}}</option></select></li><li><label for="email">{{#_i}}Email{{/_i}}</label><input class="large" id="email" name="email" size="30" type="text" value="{{email}}"><div class="error-flag" id=\'email-error\'>{{#_i}}Enter a correct email address{{/_i}}</div></li><li><input type="submit" id="subscribe-button" class="btn large primary" style="width: 220px;" value="{{#_i}}Notify me{{/_i}}"/></li></ul></fieldset></form><div id="form_txt_good" class="hidden"><h1>{{#_i}}Thanks!{{/_i}}</h1><h3>{{#_i}}We\'ll keep you posted.{{/_i}}</h3></div><div id="form_txt_bad" class="hidden"><h1>{{#_i}}Oops!{{/_i}}<h1><h3>{{#_i}}You were already subscribed.{{/_i}}</h3></div></div> ',
observer_settings:'<div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><div class="tracking-settings"><div class="blue-header"><div class="text"><h1 class="with-subheading">{{#_i}}Progress Sharing{{/_i}}</h1><p>{{#_i}}Want to use Duolingo in a classroom? Want to show off to your parents? Tracking allows you to share your language learning progress with a teacher, a parent, a friend, or even a pet! They\'ll be able to see which lessons you complete and how many XP you get.{{/_i}}</p><div>{{#_i}}Learn more at <a href="http://schools.duolingo.com/">schools.duolingo.com</a>{{/_i}}</div></div><span class="school-icon school-students-img"></span></div><ul class="list-settings"><li><label class="label">{{#_i}}Share progress with{{/_i}}</label><div class="input"><input style="width: 300px;" class="large" id="observer-email" name="observer-email" type="text" placeholder="{{#_i}}Email address{{/_i}}"{{#experimental}} disabled{{/experimental}}></div></li><li><label class="label">{{#_i}}Section or class{{/_i}}</label><div class="input"><input style="width: 300px;" class="large" id="hashtag" name="hashtag" size="30" type="text" placeholder="{{#_i}}If provided by teacher{{/_i}}"{{#experimental}} disabled{{/experimental}}></div></li></ul><button id="submit_button" type="submit" class="btn btn-green left">{{#_i}}Save changes{{/_i}}</button><span id="stop-sharing" class="gray left margin-left">{{#_i}}Stop sharing{{/_i}}</button></div>',
"one-click-landing":'<div class="center-pane"><form action="" method="post" id="gplus-form"><input type="hidden" id="email" name="email" value="{{email}}"/><input type="hidden" id="token" name="token" value="{{token}}"/><fieldset class="clearfix"><h1 style="font-size: 34px;">{{#_i}}Select Your Login{{/_i}}</h1><ul class="login-signup-list"><li><label for="username">{{#_i}}Pick a Username{{/_i}}</label><input class="large" id="username" name="username" size="30" type="text" value="{{username}}"><div class="error-flag" id=\'username-error\'>{{#_i}}Username already taken{{/_i}}</div></li><li><label for="new_password">{{#_i}}Pick a Password{{/_i}}</label><input class="large" id="new_password" name="new_password" size="30" type="password" value=""><div class="error-flag" id=\'password-error\'>{{#_i}}Invalid password{{/_i}}</div></li><li><label for="confirm_new_password">{{#_i}}Confirm Password{{/_i}}</label><input class="large" id="confirm_new_password" name="confirm_new_password" size="30" type="password"></li><li><input type="submit" class="btn large primary" style="width: 288px;" value="{{#_i}}Submit{{/_i}}"/></li></ul></fieldset></form><div id="reset-message"></div><div id=\'error-message\' class=\'hidden save-message\'>{{#_i}}Error{{/_i}}</div></div></style> ',
"other-fb-friends":'{{#other_friends}}<li><span class="avatar-small"><img src="{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}" class="avatar"></span><strong class="name">{{name}}</strong><a class="invite-friend btn btn-small right btn-primary" data-user="{{id}}">{{#_i}}Invite{{/_i}}</a></li>{{/other_friends}}',"pass-event":'{{#user}}{{>avatar_medium}}{{/user}}<h5><a href="/{{#user}}{{username}}{{/user}}" class="user">{{#user}}{{username}}{{/user}}</a> {{#_i}}passed <a href="/{{#passed}}{{username}}{{/passed}}">{{#passed}}{{username}}{{/passed}}</a> in skill points{{/_i}}</h5>{{#show_time}}<span class="time">{{datetime_string}}</span>{{/show_time}}{{>event-footer}}',
password:'<div id="password-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1>{{#_i}}Password{{/_i}}</h1><ul class="list-settings">{{^no_password}}<li><label class="label">{{#_i}}Current Password{{/_i}}</label><div class="input"><input class="large" id="current-password" name="current-password" size="30" type="password" {{#experimental}} disabled{{/experimental}}></div></li>{{/no_password}}<li><label class="label">{{#_i}}New Password{{/_i}}</label><div class="input"><input class="large" id="new-password" name="new-password" size="30" type="password" {{#experimental}} disabled{{/experimental}}></div></li><li><label class="label">{{#_i}}Confirm New Password{{/_i}}</label><div class="input"><input class="large" id="confirm-new-password" name="confirm-new-password" size="30" type="password" {{#experimental}} disabled{{/experimental}}></div></li></ul></div> ',
"persistent-notifications":'<div class="persistent-notification {{message}}"><div class="container">{{#toefl_study}}<strong class="message">{{#_i}}Want to help Duolingo teach English even better?{{/_i}}</strong><br><span class="title">{{#_i}}If you took the TOEFL exam in the last 18 months, you can earn USD$20 (through Amazon or Western Union).{{/_i}}</span> &nbsp;{{#ui_language_es}}<a id="learn-more" target="_blank" href="https://pitt.co1.qualtrics.com/SE/?SID=SV_6wW70uGKcq8IAMB&Q_lang=ES">{{/ui_language_es}}{{#ui_language_pt}}<a id="learn-more" target="_blank" href="https://pitt.co1.qualtrics.com/SE/?SID=SV_6wW70uGKcq8IAMB&Q_lang=PT">{{/ui_language_pt}}{{#_i}}Learn more!{{/_i}}</a>{{/toefl_study}}{{#net_promoter}}<div class="feedback-widget"><b>0 </b><ul><li title="{{#_i}}10 (extremely likely){{/_i}}" data-score="10"></li><li title="9" data-score="9"></li><li title="8" data-score="8"></li><li title="7" data-score="7"></li><li title="6" data-score="6"></li><li title="5" data-score="5"></li><li title="4" data-score="4"></li><li title="3" data-score="3"></li><li title="2" data-score="2"></li><li title="1" data-score="1"></li><li title="{{#_i}}0 (extremely unlikely){{/_i}}" data-score="0"></li></ul><b> 10</b></div><div class="hidden thanks"><b>{{#_i}}Thanks!{{/_i}}</b></div><strong class="message">{{#_i}}We want your feedback!{{/_i}}</strong><span> {{#_i}}On a scale of <b>0</b> to <b>10</b>, how likely are you to recommend Duolingo to a friend?{{/_i}}</span>{{/net_promoter}}{{#banned_from_translations}}<strong class="message">{{#_i}}Uh-oh.{{/_i}}</strong> &nbsp; {{#_i}}Duolingo users reported you for entering bogus translations, so we took away your translation points. Next time please play nice!{{/_i}}{{/banned_from_translations}}{{#chrome_app_ad}}<img class="webstore-icon" src="/images/chrome_web_store.svg"/><strong class="message">{{#_i}}Using Chrome?{{/_i}}</strong> &nbsp; <span class="title">{{#_i}}<a id="get-chrome-app" target="_blank" href="https://chrome.google.com/webstore/detail/duolingo/aiahmijlpehemcpleichkcokhegllfjl">Add Duolingo to your home screen</a> for easy access.{{/_i}}</span>{{/chrome_app_ad}}{{#immersion_tier_points_depend_on_sentence_length}}<strong class="message">{{#_i}}Update: tier progress now depends on sentence length.{{/_i}} </strong><br><span class="title">{{#_i}}Before, you could get up to 3 upvotes for a given sentence. Now you can get more upvotes for longer sentences.{{/_i}}</span> &nbsp;<a id="learn-more" href="javascript:;">{{#_i}}Learn more.{{/_i}}</a>{{/immersion_tier_points_depend_on_sentence_length}}{{#immersion_tier_percent_positive}}<strong class="message">{{#_i}}Update: the effect of downvotes on tier progress has changed.{{/_i}} </strong><br><span class="title">{{#_i}}Now, you advance to the next tier once you have at least 100 upvotes and at least 90% of your votes are positive.{{/_i}}</span>{{/immersion_tier_percent_positive}}{{#new_tree_change_v2}}<strong class="message">{{#_i}}Notice something different?{{/_i}} </strong><br><span class="title">{{#_i}}We\u2019ve updated your skill tree to teach you {{#_ivar}}language_string{{/_ivar}} more effectively.{{/_i}}</span>{{/new_tree_change_v2}}{{#new_years_resolution}}<strong class="message">{{#_i}}Commit to learning a language in 2015{{/_i}}</strong><br><span class="title">{{#_i}}Research shows that sharing your New Year\'s Resolution with friends helps you succeed!{{/_i}} <a href="javascript:window.open(\'https://www.facebook.com/dialog/share?app_id=234536436609303&display=popup&href=https://www.duolingo.com/og/new_year&redirect_uri=http://www.duolingo.com/redirect\', \'popUpWindow\',\'height=400,width=550\')" data-track-click="fb share new year" class="blue">{{#_i}}Tell your friends on Facebook.{{/_i}}</a></span>{{/new_years_resolution}}<div class="close"></div></div></div> ',
"placement-intro":'<div class="practice-intro-screen"><div class="owl owl-graduation {{#rtl}}img-flipped{{/rtl}}"></div><div class="speech-bubble arrow-left"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner"><h2>{{#_i}}Take a test to jump ahead!{{/_i}}</h2><p>{{#_i}}It takes about 5 minutes, and adapts to your level by getting harder (or easier) based on your answers.{{/_i}}</p></div></div></div>',"player-header":'<div id="context-view"></div>{{^use_strength}}<header class="player-header"><div id="progress-bar"></div><ul class="player-header-right" style="">{{^session_failed}}<li><a class="player-quit" style="cursor:pointer;" id="quit-button">{{#welcome}}{{^no_direction}}{{#_i}}Skip tour{{/_i}}{{/no_direction}}{{/welcome}}{{^welcome}}{{#_i}}Quit{{/_i}}{{/welcome}}</a></li>{{/session_failed}}{{^points_per_correct}}{{#explanation}}<li id="explanation"></li>{{/explanation}}{{/points_per_correct}}{{#points_per_correct}}<li class="points"><span class="icon icon-xp-small"></span><span id="point-count"></span></li>{{/points_per_correct}}{{#timed}}{{#owned_timed_practice}}<li class="timer" id="timer"></li>{{/owned_timed_practice}}{{/timed}}{{^points_per_correct}}{{#heart_refill}}<li id="heart-refill-container" style="display:none;"><div id="heart-refill" class="btn btn-standard btn-outline">{{#_i}}Refill heart{{/_i}}</div></li>{{/heart_refill}}{{/points_per_correct}}<li class="hearts-container"><div id="hearts"></div></li></ul></header>{{/use_strength}}{{#use_strength}}<header class="player-header dynamic {{#web_strength_v2_experiment_true}}v2{{/web_strength_v2_experiment_true}}">{{^web_strength_v2_experiment_true}}<ul class="player-header-left" style="">{{#explanation}}<li id="explanation" class="tip-and-notes"><li>{{/explanation}}</ul>{{/web_strength_v2_experiment_true}}<ul class="player-header-right">{{#web_strength_v2_experiment_true}}{{#explanation}}<li id="explanation"><li>{{/explanation}}{{/web_strength_v2_experiment_true}}<li><a class="player-quit" style="cursor:pointer;" id="quit-button">{{#web_strength_v2_experiment_true}}<span class="icon icon-x-gray"></span>{{/web_strength_v2_experiment_true}}{{#_i}}Quit{{/_i}}</a></li></ul><div class="progress-bar-container"><div id="progress-bar"></div></div></header>{{/use_strength}} ',
"point-count":"{{points}}","post-modal":'<header class="discussion-header"><button class="btn btn-primary right submit-post">{{#edit}}{{#_i}}Save{{/_i}}{{/edit}}{{^edit}}{{#_i}}Post Discussion{{/_i}}{{/edit}}</button><button class="btn btn-standard right cancel-post margin-right">{{#_i}}Cancel{{/_i}}</button><div class="dropdown left"><button id="select-category" data-toggle="dropdown" class="btn btn-green"><span id="category">{{#_i}}Pick a discussion topic{{/_i}}</span> <span class="icon icon-arrow-down-white"></span></button><ul class="dropdown-menu skill-list" role="menu" aria-labelledby="dLabel">{{#edit}}{{#all_topics}}<li id="topic-{{id}}" class="category-option" data-topic="{{id}}" data-name="{{#_ivar}}name{{/_ivar}}"><a href="javascript:;">{{#_ivar}}name{{/_ivar}}</a></li>{{/all_topics}}{{/edit}}{{^edit}}{{#show_subscriptions}}{{#subscriptions}}<li id="topic-{{topic_id}}" class="category-option" data-topic="{{topic_id}}" data-name="{{#_ivar}}name{{/_ivar}}"><a href="javascript:;">{{#language_string}}{{#_i}}{{#_iv}}{{language_string}}{{/_iv}} from {{#_iv}}{{from_language_string}}{{/_iv}}{{/_i}}{{/language_string}}{{^language_string}}{{#_i}}{{#_iv}}{{name}}{{/_iv}} in {{#_iv}}{{from_language_string}}{{/_iv}}{{/_i}}{{/language_string}}</a></li>{{/subscriptions}}{{/show_subscriptions}}{{^show_subscriptions}}<li id="topic-{{id}}" class="category-option" data-topic="{{id}}" data-name="{{#_ivar}}name{{/_ivar}}"><a href="javascript:;">{{#_ivar}}name{{/_ivar}}</a></li>{{/show_subscriptions}}{{/edit}}</ul></div></header><ul class="list-discussion-errors hidden"><li class="no-topic hidden"><span class="icon icon-wrong-small"></span> {{#_i}}Pick a discussion topic{{/_i}}</li><li class="no-title hidden"><span class="icon icon-wrong-small"></span> {{#_i}}Enter a post title{{/_i}}</li></ul><div class="post-discussion-main"><textarea class="textarea-block textarea-discussion-headline title-field" id="{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-title" maxlength="100" {{#edit}}value="{{title}}"{{/edit}} placeholder="{{#_i}}Type your post title{{/_i}}" dir="auto"></textarea><span class="max-error warning-message hidden">{{#_i}}Please limit your title to 100 characters.{{/_i}}</span><textarea name="" rows="" class="textarea-block textarea-discussion-post post-field" id="{{#edit}}edit{{/edit}}{{^edit}}{{type}}{{/edit}}-post" placeholder="{{#_i}}Type your post{{/_i}}" dir="auto">{{#edit}}{{message}}{{/edit}}</textarea></div>',
"practice-event":'{{#user}}{{>avatar_medium}}{{/user}}{{#total_improvement}}<ul class="point-gain-box"><li><span class="icon-star-small"></span><span class="skill-points-small">+{{total_improvement}}</span></li></ul>{{/total_improvement}}{{^refresh}}<h5><a href="/{{#user}}{{username}}{{/user}}" class="user">{{#user}}{{username}}{{/user}}</a> {{#_i}}did {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} practice lesson{{/_i}}</h5>{{/refresh}}{{#refresh}}<h5><a href="/{{#user}}{{username}}{{/user}}" class="user">{{#user}}{{username}}{{/user}}</a> {{#_i}}refreshed {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</h5>{{/refresh}}',
"practice-time-settings":'<select class="small" name="language_settings.{{language}}.notify_time">{{#practice_times}}<option {{#selected}}selected="selected"{{/selected}} value="{{offset}}">{{time}}</option>{{/practice_times}}</select>',practice_reminder:"{{#streak}}{{#day_streak}}{{#_i}}Learning a language requires a little practice every day. Practice your {{#_ivar}}language{{/_ivar}} on Duolingo.{{/_i}}{{/day_streak}}{{#short_streak}}{{#_i}}You\u2019re heating up. Continue your {{days}} day {{#_ivar}}language{{/_ivar}} streak on Duolingo.{{/_i}}{{/short_streak}}{{#long_streak}}{{#_i}}You\u2019re on fire. Continue your {{days}} day {{#_ivar}}language{{/_ivar}} streak on Duolingo.{{/_i}}{{/long_streak}}{{/streak}}{{^streak}}{{#_i}}Oh no, you lost your streak on Duolingo. Get back on track!{{/_i}}{{/streak}}",
press:'<div id="press" class="about-pages"><h3>{{#_i}}About Duolingo{{/_i}}</h3><p>{{#_i}}Duolingo is the free science-based language education platform selected by Apple as iPhone App of the Year 2013, by Google as Best of the Best for Android in 2013 and 2014, and by TechCrunch as Best Education Startup.{{/_i}}</p><p>{{#_i}}It was created by crowdsourcing pioneer Luis von Ahn, PhD, and Severin Hacker, PhD.{{/_i}}</p><p>{{#_i}}With over {{num_users_total}} {{#pluralize}}million users, million users, {{num_users_total}}{{/pluralize}}, Duolingo has organically become the most popular way to learn languages online in only 2 years.{{/_i}}</p><p>{{#_i}}In a recent <a href="http://static.duolingo.com/s3/DuolingoReport_Final.pdf">independent study</a>, professors from the City University of New York (CUNY) and the University of South Carolina found that when using Duolingo for 34 hours, students learn the equivalent of one university semester of language instruction.{{/_i}}</p><hr/><ul><li>{{#_i}}Location: Duolingo is headquartered in Pittsburgh, PA{{/_i}}</li><li>{{#_i}}Team size:{{/_i}} 42</li><li>{{#_i}}Platforms:{{/_i}} Duolingo.com, <a href="https://play.google.com/store/apps/details?id=com.duolingo">Android</a>, <a href="https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8">iOS</a> &amp; <a href="https://www.windowsphone.com/s?appid=2d89520e-d360-4b5b-ba5a-5a15064aa935">Windows Phone</a></li><li>{{#_i}}Investors:{{/_i}} Union Square Ventures, New Enterprise Associates (NEA), Kleiner Perkins Caufield & Byers, Ashton Kutcher &amp; Tim Ferriss</li></ul><hr/><h3>{{#_i}}Social Media{{/_i}}</h3><p>{{#_i}}For our videos, check out our <a href="http://www.youtube.com/duolingo">YouTube channel</a>.{{/_i}}</p><p>{{#_i}}To keep up with the news, follow us on <a href="http://www.twitter.com/duolingo">Twitter</a> and <a href="http://www.facebook.com/duolingo">Facebook</a>.{{/_i}}</p><hr/><h3>{{#_i}}Images for Download{{/_i}}</h3><ul class="resource-images"><li><a href="http://static.duolingo.com/images/about/resources/duolingo-logo.pdf" target="_blank"><div class="thumbnail duolingo-logotype"></div><div>{{#_i}}Duolingo Logotype{{/_i}} (PDF)</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/duolingo-banner.ai" target="_blank"><div class="thumbnail duolingo-banner"></div><div>Duolingo (Ai)</div></a></li></ul><ul class="resource-images"><li><a href="http://static.duolingo.com/images/about/resources/Luis_Severin.jpg" target="_blank"><div class="thumbnail luis-severin"></div><div>Luis von Ahn &amp; Severin Hacker</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/Luis_Severin_2.jpg" target="_blank"><div class="thumbnail luis-severin-2"></div><div>Luis von Ahn &amp; Severin Hacker</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/Luis_von_Ahn_1.jpg" target="_blank"><div class="thumbnail luis-1"></div><div>Luis von Ahn</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/Luis_von_Ahn_3.jpg" target="_blank"><div class="thumbnail luis-3"></div><div>Luis von Ahn</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/Luis_von_Ahn_4.png" target="_blank"><div class="thumbnail luis-4"></div><div>Luis von Ahn</div></a></li><li><a href="http://static.duolingo.com/images/about/resources/Severin_Hacker.jpg" target="_blank"><div class="thumbnail severin"></div><div>Severin Hacker</div></a></li></ul><hr/><h3>{{#_i}}Press Releases{{/_i}}</h3><ul>{{#pt_ui_language}}<li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_TestCenter_pt.pdf" target="_blank"> Duolingo Lan\u00e7a o Test Center: Certifica\u00e7\u00e3o de Idiomas Acess\u00edvel a Todos </a></li>{{/pt_ui_language}}{{#es_ui_language}}<li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_Lanzara_el_TestCenter_es.pdf" target="_blank"> Duolingo Lanzar\u00e1 el Test Center: Certificaci\u00f3n de idiomas al alcance de todos </a></li>{{/es_ui_language}}{{^pt_ui_language}}{{^es_ui_language}}<li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_TestCenter.pdf" target="_blank">{{#_i}}Duolingo Test Center: Fair Language Certification for All{{/_i}}</a></li>{{/es_ui_language}}{{/pt_ui_language}}<li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_BuzzFeed_CNN.pdf" target="_blank">{{#_i}}Duolingo Selling Translations to BuzzFeed and CNN to Fund Free Education{{/_i}}</a></li><li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_GlassWear.pdf" target="_blank">{{#_i}}Duolingo Launches Hands-Off Apps for Google Glass and Android Wear{{/_i}}</a></li><li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_Incubator_Launch.pdf" target="_blank">{{#_i}}Duolingo to Launch Crowdsourced Language Courses{{/_i}}</a></li>{{#pt_ui_language}}<li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Novo_Curso_de_Espanhol_Para_Brasileiros_pt.pdf" target="_blank"> Duolingo Lan\u00e7a Curso de Espanhol Para Brasileiros </a></li><li><a href="http://duolingo-data.s3.amazonaws.com/s3/press-assets/Duolingo_Fecha_nova_Rodada_pt.pdf" target="_blank"> Duolingo Fecha nova Rodada de US $20 Milh\u00f5es </a></li>{{/pt_ui_language}}<hr/><p class="center">{{#_i}}Journalists and bloggers, please reach out to:{{/_i}} <a class="blue" href="mailto:press@duolingo.com">press@duolingo.com</a></p><p class="center">{{#_i}}We do not pay for marketing. Please do not inquire.{{/_i}}</p></div> ',
pretty_date:"{{#just}}{{#_i}}just now{{/_i}}{{/just}}{{#minute}}{{#_i}}a minute ago{{/_i}}{{/minute}}{{#minutes}}{{#_i}}{{#pluralize}}{{n}} minute ago,{{n}} minutes ago,{{n}}{{/pluralize}}{{/_i}}{{/minutes}}{{#hour}}{{#_i}}an hour ago{{/_i}}{{/hour}}{{#hours}}{{#_i}}{{#pluralize}}{{n}} hour ago,{{n}} hours ago,{{n}}{{/pluralize}}{{/_i}}{{/hours}}{{#yesterday}}{{#_i}}yesterday{{/_i}}{{/yesterday}}{{#days}}{{#_i}}{{#pluralize}}{{n}} day ago,{{n}} days ago,{{n}}{{/pluralize}}{{/_i}}{{/days}}{{#weeks}}{{#_i}}{{n}} {{#pluralize}}week,weeks,{{n}}{{/pluralize}} ago{{/_i}}{{/weeks}}{{#months}}{{#_i}}{{n}} {{#pluralize}}month,months,{{n}}{{/pluralize}} ago{{/_i}}{{/months}}{{#years}}{{#_i}}{{n}} {{#pluralize}}year,years,{{n}}{{/pluralize}} ago{{/_i}}{{/years}}{{#date}}{{#_ivar}}month{{/_ivar}} {{day}}, {{year}}{{/date}}",
privacy:'<h1>Privacy Policy</h1><ol class="terms"><li><h3>General</h3> <p>At Duolingo, we know you care about your personal information, so we have prepared this privacy policy (our \u201cPrivacy Policy\u201d) to explain how we collect, use and share it. By using or accessing the Service, you agree to the terms of this Privacy Policy. Capitalized terms not defined here have the meanings set forth in the terms and conditions (the \u201cTerms and Conditions\u201d), located at <a href="https://www.duolingo.com/terms">https://www.duolingo.com/terms</a>. We may update our Privacy Policy to reflect changes to our information practices. If we do this and the changes are material, we will post a notice that we have made changes to this Privacy Policy on the Website for at least 7 days after the changes are made, and we will indicate the date these terms were last revised at the bottom of the Privacy Policy. Any revisions to this Privacy Policy will become effective the earlier of (i) the end of that 7-day period or (ii) the first time you access or use the Service after any such changes.</p></li><li><h3>Information We Collect</h3><p>When you use Duolingo you provide us with two types of information: (i) information you submit via the Service and (ii) information regarding your use of the Service collected by us as you interact with the Service.</p><p>When you enter the Website, we collect your browser type and your IP address (a unique address that identifies your computer on the Internet). When you use our mobile Application, we collect your device type, your device ID, and your IP address. In addition, we store certain information from your browser using "cookies." A cookie is a piece of data stored on the user\'s computer tied to information about the user. We use session ID cookies to confirm that users are logged in. If you do not want information collected through the use of cookies, there is a simple procedure in most browsers that allows you to deny or accept the cookie feature; however, you should note that cookies may be necessary to provide you certain features available on the Website (e.g., customized delivery of information).</p><p>Through the registration process you may provide us with your name and email address.</p><p>When you use the Service you may submit information and content to your profile, generate Activity Data through engaging in educational activities on the Service, or send messages and otherwise transmit information to other users. We store this information so that we can provide you the Service and offer personalized features.</p><p>We do not share your personal information with third-parties unless it is necessary to offer the Service or required by law (see below for specifics).</p></li><li><h3>Use of Information Obtained by Duolingo</h3><p>We may use your contact information to send you notifications regarding new services offered by Duolingo that we think you may find valuable. Duolingo may also send you service-related announcements from time to time through the general operation of the Service. Generally, you may opt out of such emails.</p><p>Profile information is used by Duolingo to be presented back to and edited by you when you access the Service and to be presented to other users. In some cases, other users may be able to supplement your profile, including by submitting comments (which can be deleted by you).</p><p>Duolingo may use or share aggregate or anonymous data collected through the Service, including Activity Data, for purposes such as understanding or improving the service.</p> </li><li><h3>Sharing Your Personally-Identifiable Information with Third Parties</h3> <p>Duolingo shares your personally-identifiable information only when it is reasonably necessary to offer the Service, legally required, or permitted by you. For example:</p><p>We may provide personally-identifiable information to service providers who help us bring you the Service, such as hosting the Service at a co-location facility or sending email updates. In connection with these operations, our service providers may have access to personally-identifiable information for a limited time. When we utilize service providers for processing any personally-identifiable information, we implement reasonable contractual protections limiting the use of that personally-identifiable information to the provision of services to Duolingo.</p><p>We may be required to disclose personally-identifiable information pursuant to lawful requests, such as subpoenas or court orders, or in compliance with applicable laws. Additionally, we may share account or other personally-identifiable information when we believe it is necessary to comply with law, to protect our interests or property, to prevent fraud or other illegal activity perpetrated through the Service or using the Duolingo name, or to prevent imminent harm. This may include sharing personally-identifiable information with other companies, lawyers, agents or government agencies.</p><p>If we sell some or all of the assets of Duolingo, your personally-identifiable information may be transferred to the new owner. We would require any such purchaser to abide by the terms of this Privacy Policy if your information were to be transferred, but pursuant to this policy the new owner would be able to change these terms after notice to you as described above. We may also share your information with a proposed new owner while they are evaluating our business and in connection with borrowing money or issuing stock. In all of these cases we would require the persons gaining access to your information to agree to keep it confidential and to use it only for evaluating whether they will proceed.</p></li><li><h3>Links</h3> <p>The Service may contain links to other websites. We are not responsible for the privacy practices of other websites. We encourage users to be aware when they leave the Service to read the privacy statements of other websites that collect personally identifiable information. This Privacy Policy applies only to information collected by Duolingo via the Service.</p></li><li style="list-style: none">Last revised on January 26, 2015.</li></ol>',
profile:'<main class="main-left"><section class="page-sidebar sidebar-right"><div class="inner"><div class="box-gray box-achievements"><h2>{{#_i}}Achievements{{/_i}}</h2><ul class="sidebar-stats"><li><h3 class="gray">{{#_i}}Streak{{/_i}}</h3><span class="icon icon-streak-small-normal {{#rtl}}img-flipped{{/rtl}}"></span> {{#_i}}<strong>{{site_streak}}</strong> {{#pluralize}}Day,Days,{{site_streak}}{{/pluralize}}{{/_i}}</li>\x3c!-- <li><h3 class="gray">{{#_i}}Highest Streak{{/_i}}</h3><span class="icon icon-streak-small"></span> {{#_i}}<strong>{{site_streak}}</strong> Days{{/_i}}</li> --\x3e</ul><h3 class="gray">{{#_i}}Languages{{/_i}}</h3>{{^new_profile_sidebar}}<ul class="level-badge-grid">{{#points_languages}}{{#learning}}<li><span class="level-badge-small {{language}}" data-toggle="tooltip" data-original-title="{{#_iv}}{{language_string}}{{/_iv}}"><span class="inner">{{level}}</span><span class="pennant"></span></span></li>{{/learning}}{{/points_languages}}</ul>{{/new_profile_sidebar}}{{#new_profile_sidebar}}<ul class="profile-language-list">{{#points_languages}}{{#learning}}<li><div class="profile-language"><div class="course-card {{language}} course-profile-badge"><div class="course-card-header course-page-illustration-{{language}} gradient"><div class="small-course-illustration layer-1"></div><div class="small-course-illustration layer-2"></div><div class="small-course-illustration layer-3"></div></div></div><div class="language-info"><div class="language-name">{{#_iv}}{{language_string}}||capitalized{{/_iv}} - {{#_i}}Level {{level}}{{/_i}}</div><div class="substat">{{#_i}}Next level:{{/_i}} {{#_i}}{{to_next_level}} XP{{/_i}}</div><div class="substat">{{#_i}}Total XP:{{/_i}} {{#_i}}{{points}} XP{{/_i}}</div></div></div></li>{{/learning}}{{/points_languages}}</ul>{{/new_profile_sidebar}}{{#have_tiers}}<h3 class="gray">{{#_i}}Translation Tiers{{/_i}}</h3><ul class="tier-badge-grid {{#new_profile_sidebar}}updated{{/new_profile_sidebar}}">{{#tiers}}<li><span class="tier-wrapper"><span class="translator-tier-flag"><span class="double-flag-source flag flag-svg-small flag-{{source}}"></span><span class="double-flag-target flag flag-svg-small flag-{{target}}"></span></span><br/><span class="tier-number">{{tier}}</span></span></li>{{/tiers}}</ul>{{/have_tiers}}</div>{{#logged_in}}{{^current_user}}<div class="box-gray">{{#enabled_groups_experiment}}{{#group}}<h2>{{#_i}}Team{{/_i}}</h2><div class="profile-team-widget"><div class="group-widget-strip group-color-{{color}}"><a href="/team/{{id}}"><span class="group-avatar-icon tiny group-avatar-icon-{{icon_index}}"></span></a><a href="/team/{{id}}"><span class="icon icon-arrow-white-medium right"></span><strong class="group-name">{{name}}</strong></a></div></div>{{/group}}{{/enabled_groups_experiment}}<div id="friends"></div></div>{{/current_user}}{{/logged_in}}</div></section><section class="page-main main-left"><header class="profile-header" {{^social_enabled}}style="margin: 0";{{/social_enabled}}>{{^viewer_trial_account}}{{>profile-context-menu}}{{/viewer_trial_account}}{{>avatar_xlarge}}<h1 class="profile-header-username">{{username}}</h1><h2 class="profile-header-subline {{^fullname}}{{^location}}{{^twitter_id}}{{^facebook_id}}hidden{{/facebook_id}}{{/twitter_id}}{{/location}}{{/fullname}}">{{#fullname}}<span class="real-name">{{fullname}}</span>{{/fullname}}{{#location}}<span class="location"><span class="icon-location-small icon"></span> {{location}}</span>{{/location}}<ul class="user-social-links">{{#twitter_id}}<li><a href="https://twitter.com/account/redirect_by_id?id={{twitter_id}}" target="_blank" ><span class="icon icon-twitter-white-small"></span></a></li>{{/twitter_id}}{{#facebook_id}}<li><a href="http://www.facebook.com/{{facebook_id}}" target="_blank"><span class="icon icon-fb-white-small"></span></a></li>{{/facebook_id}}</ul></h2>{{#bio}}<p class="profile-header-bio">{{bio}}</p>{{/bio}}{{#logged_in}}{{^current_user_profile}}{{^is_blocking}}{{^is_blocked_by}}{{^viewer_trial_account}}<a href="javascript:;" class="btn btn-green {{#is_following}}success checkmark{{/is_following}}" data-toggle="follow" data-user="{{id}}" data-follow-text="{{#_i}}Follow{{/_i}}" data-unfollow-text="{{#_i}}Following{{/_i}}" data-follow-class="" data-unfollow-class="checkmark">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</a>{{/viewer_trial_account}}{{/is_blocked_by}}{{/is_blocking}}{{#is_blocking}}<a href="javascript:;" class="btn" disabled="disabled">{{#_i}}Blocked{{/_i}}</a>{{/is_blocking}}{{/current_user_profile}}{{/logged_in}}</header>{{#social_enabled}}<div id="stream-container" class="stream-container"></div>{{/social_enabled}}</section></main> ',
"profile-context-menu":'{{#logged_in}}{{^current_user_profile}}<span id=\'profile-context-menu\' class="icon icon-gear-small profile-context-menu"><ul class="dropdown-menu hidden"><li id="block-toggle"><a href="javascript:;">{{^is_blocking}}{{#_i}}Block {{username}}{{/_i}}{{/is_blocking}}{{#is_blocking}}{{#_i}}Unblock {{username}}{{/_i}}{{/is_blocking}}</a></li>{{#can_shadowban}}{{^admin}}{{^global_moderator}}<li id="shadowban-user"><a href="javascript:;">{{#_i}}Shadowban {{username}}{{/_i}}</a></li>{{/global_moderator}}{{/admin}}{{/can_shadowban}}</ul></span>{{/current_user_profile}}{{/logged_in}} ',
"profile-friends":'<h2 class="friends-title" data-search="{{#_i}}Search for other learners{{/_i}}" data-fb="{{#_i}}Facebook friends{{/_i}}">{{#_i}}Friends{{/_i}}</h2><ul class="nav-tabs following-switch"><li id="switch-following" class="switch-friends active" data-tab="following"><a href="javascript:;">{{#_i}}Following: {{num_following}}{{/_i}}</a></li><li id="switch-followers" class="switch-friends" data-tab="followers"><a href="javascript:;">{{#_i}}Followers: {{num_followers}}{{/_i}}</a></li></ul><ul id="followers" class="avatar-grid hidden">{{#followers}}<li>{{>avatar_medium}}</li>{{/followers}}{{#show_more_followers}}<li><a href="javascript:;" class="more" data-type="followers">+{{num_show_more_followers}}</a></li><div id="followers-modal" class="modal fade hide hidden" style="margin-top: -200px;"><div class="modal-header"><h1>{{#_i}}{{username}}\'s Followers{{/_i}}</h1><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"></div></div>{{/show_more_followers}}</ul><ul id="following" class="avatar-grid {{^num_following}}hidden{{/num_following}}">{{#following}}<li>{{>avatar_medium}}</li>{{/following}}{{#show_more_following}}<li><a href="javascript:;" class="more" data-type="following">+{{num_show_more_following}}</a></li><div id="following-modal" class="modal fade hide hidden" style="margin-top: -200px;"><div class="modal-header"><h1>{{#_i}}{{username}}\'s Friends{{/_i}}</h1><div class="close icon icon-close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"></div></div>{{/show_more_following}}</ul><div id="add-more-friends"><div id="search-friends" class="board hidden"><ul id="search-list-results"></ul></div><div id="fb-friends" class="hidden board"><ul class="list-leaderboard">{{#fb_friends}}<li class="list-leaderboard-item"><span class="avatar avatar-small"><img src="{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}"></span><div class="action">{{#user_id}}{{#is_being_blocked}}<button class="btn btn-small" disabled="disabled">{{#_i}}Blocked{{/_i}}</button>{{/is_being_blocked}}{{^is_being_blocked}}{{^is_a_blocker}}<button class="follow-button btn {{#is_following}}btn-green{{/is_following}} btn-small {{^is_following}}btn-green{{/is_following}}" data-toggle="follow" data-user="{{user_id}}" data-follow-text="{{#_i}}Follow{{/_i}}" data-unfollow-text="{{#_i}}Unfollow{{/_i}}" data-silent="true">{{#is_following}}{{#_i}}Following{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Follow{{/_i}}{{/is_following}}</button>{{/is_a_blocker}}{{/is_being_blocked}}{{/user_id}}{{^user_id}}<button class="btn btn-blue btn-small invite-fb-friend" data-user="{{id}}" data-toggle="facebook-invite" data-track-from="home leaderboard" data-name="{{#_i}}You\'re Invited to Join Duolingo!{{/_i}}" data-description="{{#_i}}With Duolingo you learn a language for free, while helping to translate the web.{{/_i}}" data-sent="{{#_i}}Invite sent{{/_i}}">{{#_i}}Invite{{/_i}}</button>{{/user_id}}</div><span class="name">{{name}}</span></li>{{/fb_friends}}</ul></div></div>{{#show_add_friends}}<div id="add-friends"></div>{{/show_add_friends}}',
"profile-side-bar":'{{#show_fluency_score}}<div class="box-colored white"><h2>{{#_i}}{{#_ivar}}language_string{{/_ivar}} Fluency{{/_i}}</h2><div class="fluency-container"><span class="icon icon-fluency-score">{{fluency_score}}%</span></div></div>{{/show_fluency_score}}<div class="box-colored white vocab-test"><h2>{{#daily_goal}}<a href="/settings/coach"><span data-toggle="tooltip" title="{{#_i}}Change daily goal{{/_i}}" class="icon icon-gear-small right"></span></a>{{/daily_goal}}{{#_i}}Daily Goal{{/_i}}</h2><div class="daily-goal-container {{^show_home_graph}}{{#trial_account}}empty{{/trial_account}}{{/show_home_graph}}">{{#daily_goal}}<div class="daily-donut-container"><span class="icon icon-daily-donut-streak {{#met_goal}}completed{{/met_goal}}"></span><div id="daily-donut-text">{{#met_goal}}<span class="stat-text">{{xp_today}}/{{daily_goal}}</span> {{#_i}}xp goal met{{/_i}}{{/met_goal}}{{^met_goal}}<span class="stat-text">{{xp_today}}/{{daily_goal}}</span> {{#_i}}xp gained{{/_i}}{{/met_goal}}</div><div id="daily-donut"></div></div><div class="daily-goal-stats"><div class="stat-container">{{#_i}}<span class="stat-text">{{site_streak}}</span>day streak{{/_i}}</div><div class="stat-container">{{#time_remaining}}{{#_i}}<span class="stat-text">{{time_remaining}}</span>{{#pluralize}}hour,hours,{{time_remaining}}{{/pluralize}} left{{/_i}}{{/time_remaining}}{{^time_remaining}}{{#_i}}<span class="stat-text"><span class="less-than">&lt;</span> 1</span>hour left{{/_i}}{{/time_remaining}}</div></div>{{/daily_goal}}{{^daily_goal}}<div class="coach-ad"><div class="coach-ad-text"><div>{{#_i}}Set a Daily XP Goal to help keep yourself motivated.{{/_i}}</div><a href="/settings/coach" class="blue">{{#_i}}Set your Daily Goal{{/_i}}</a></div><span class="owl owl-coach-x-small"></span></div>{{/daily_goal}}</div>{{#show_home_graph}}<div class="tooltips-container"><ul id="progress-tooltips">{{#calendar}}<li id="hover-helper-{{index}}" data-original-title="{{#_i}}{{points}} {{#pluralize}}XP,XP,{{points}}{{/pluralize}}{{/_i}}" data-toggle="tooltip" class="hover-areas-container"><span class="hover-areas"></span></li>{{/calendar}}</ul></div><div id="weekly-progress"></div>{{/show_home_graph}}{{#show_sidebar_buttons}}{{^trial_account}}<div class="strengthen-skills-container {{^show_flashcards}}with-strength-icon{{/show_flashcards}}">{{#show_practice}}<a href=\'/practice\' class="btn btn-primary {{#show_flashcards}}btn-flashcards-on-home{{/show_flashcards}}{{^show_flashcards}}btn-block btn-strengthen-skills{{/show_flashcards}}">{{^show_flashcards}}<span class="strength"><span class="icon icon-practice-small-white"></span></span><span class="skill-icon-strength skill-icon-strength-micro {{#rtl}}img-flipped{{/rtl}} strength-{{total_strength}}"></span>{{/show_flashcards}}{{#_i}}Strengthen skills{{/_i}}</a>{{/show_practice}}{{#show_flashcards}}<a id="start-flashcards" href="javascript:;" class="btn btn-green btn-flashcards-on-home">{{#_i}}Review flashcards{{/_i}}</a>{{/show_flashcards}}</div>{{/trial_account}}{{/show_sidebar_buttons}}</div>{{#trial_account}}<div class="box-gray"><div class="trial-account-overlay"></div></div>{{/trial_account}}{{^trial_account}}{{#enabled_groups_experiment}}{{#true_groups_experiment}}<div class="box-colored less-padding white">{{#group}}<div class="group-leaderboard"></div>{{/group}}{{^group}}<div class="team-up-box {{^has_pending_invites}}no-pending-invites{{/has_pending_invites}}" id="team-up-box"><div class="team-illustration"><span class="group-avatar-icon small group-avatar-icon-11 group-color-green"></span><span class="group-avatar-icon small group-avatar-icon-9 group-color-orange"></span><span class="group-avatar-icon tiny group-avatar-icon-4 group-color-red"></span></div><h2>{{#_i}}Duolingo Teams{{/_i}}</h2><p>{{#_i}}Teams are a new way to learn with others and stay motivated. Players get daily goals, shared skill trees and team achievements. What are you waiting for?{{/_i}}</p><a href="/team" class="btn btn-white btn-outline btn-block team-up">{{#_i}}Create or join a team{{/_i}}</a>{{#show_manage}}<a href="/manageTeams" class="btn btn-outline btn-white btn-block">{{#_i}}Show all teams you manage{{/_i}}</a>{{/show_manage}}</div>{{/group}}{{#has_pending_invites}}<div class="pending-invites-box {{^group}}no-border{{/group}}"><h5>{{#_i}}You were invited to join {{#pluralize}}this team, these teams,{{has_pending_invites}}{{/pluralize}}:{{/_i}}</h5><ul class="list-pending-invites">{{#pending_invites}}<li data-id="{{invitation_id}}" data-group-id="{{group_id}}"><div class="group-widget-strip group-color-{{color}}"><div class="group-invite-response"><span class="invite-info-wrapper" data-toggle="tooltip" title=" {{#short_list}}{{#one}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}} has invited you.{{/_i}}{{/one}}{{#two}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}} and {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} have invited you.{{/_i}}{{/two}}{{#three}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} and {{#item_three}}{{#_ivar}}username{{/_ivar}}{{/item_three}} have invited you.{{/_i}}{{/three}}{{#more}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} and {{remainder}} others have invited you to this team.{{/_i}}{{/more}}{{/short_list}} "><span>?</span></span><button class="btn btn-small btn-white btn-outline accept-invite" data-toggle="tooltip" title="{{#_i}}Accept Invite{{/_i}}"><span class="icon icon-check-white-small"></span></button><button class="btn btn-small btn-white btn-outline reject-invite" data-toggle="tooltip" title="{{#_i}}Reject Invite{{/_i}}"><span class="icon-x-white-small icon"></span></button></div><a href="/team/{{group_id}}"><span class="group-avatar-icon tiny group-avatar-icon-{{icon_index}}"></span><strong class="group-name">{{name}}</strong></a></div></li>{{/pending_invites}}</ul></div>{{/has_pending_invites}}</div>{{/true_groups_experiment}}{{^true_groups_experiment}}{{#has_pending_invites}}<div class="box-colored less-padding white"><div class="team-up-box" id="team-up-box"><div class="team-illustration"><span class="group-avatar-icon small group-avatar-icon-11 group-color-green"></span><span class="group-avatar-icon small group-avatar-icon-9 group-color-orange"></span><span class="group-avatar-icon tiny group-avatar-icon-4 group-color-red"></span></div><h2>{{#_i}}Duolingo Teams{{/_i}}</h2><p style="margin: 0;">{{#_i}}Teams are a new way to learn with your friends and stay motivated. Players get daily goals, shared skill trees and team achievements. What are you waiting for?{{/_i}}</p></div><div class="pending-invites-box {{^group}}no-border{{/group}}"><h5>{{#_i}}You were invited to join {{#pluralize}}this team, these teams,{{has_pending_invites}}{{/pluralize}}:{{/_i}}</h5><ul class="list-pending-invites">{{#pending_invites}}<li data-id="{{invitation_id}}" data-group-id="{{group_id}}"><div class="group-widget-strip group-color-{{color}}"><div class="group-invite-response"><span class="invite-info-wrapper" data-toggle="tooltip" title=" {{#short_list}}{{#one}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}} has invited you.{{/_i}}{{/one}}{{#two}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}} and {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} have invited you.{{/_i}}{{/two}}{{#three}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} and {{#item_three}}{{#_ivar}}username{{/_ivar}}{{/item_three}} have invited you.{{/_i}}{{/three}}{{#more}} {{#_i}}{{#item_one}}{{#_ivar}}username{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}username{{/_ivar}}{{/item_two}} and {{remainder}} others have invited you to this team.{{/_i}}{{/more}}{{/short_list}} "><span>?</span></span><button class="btn btn-small btn-white btn-outline accept-invite" data-toggle="tooltip" title="{{#_i}}Accept Invite{{/_i}}"><span class="icon icon-check-white-small"></span></button><button class="btn btn-small btn-white btn-outline reject-invite" data-toggle="tooltip" title="{{#_i}}Reject Invite{{/_i}}"><span class="icon-x-white-small icon"></span></button></div><a href="/team/{{group_id}}"><span class="group-avatar-icon tiny group-avatar-icon-{{icon_index}}"></span><strong class="group-name">{{name}}</strong></a></div></li>{{/pending_invites}}</ul></div></div>{{/has_pending_invites}}<div class="box-gray">{{#group}}<h2>{{#_i}}Team{{/_i}}</h2><div class="profile-team-widget"><div class="group-widget-strip group-color-{{color}}"><a href="/team/{{id}}"><span class="group-avatar-icon tiny group-avatar-icon-{{icon_index}}"></span></a><a href="/team/{{id}}"><span class="icon icon-arrow-white-medium right"></span><strong class="group-name">{{name}}</strong></a></div></div>{{/group}}<div id="ranking" class="stream-leaderboard"></div></div>{{/true_groups_experiment}}{{/enabled_groups_experiment}}{{^enabled_groups_experiment}}<div class="box-gray"><div id="ranking" class="stream-leaderboard"></div></div>{{/enabled_groups_experiment}}{{/trial_account}}<div class="box-gray box-social-buttons"><strong class="gray-dark">{{#_i}}Follow Duolingo{{/_i}}</strong><ul class="list-social-buttons"><li><div class="container"><a target="_blank" href="http://twitter.com/duolingo" class="btn btn-block btn-white btn-twitter"><span class="icon icon-twitter-small"></span> 130k</a></div></li><li><div class="container"><a target="_blank" href="http://facebook.com/duolingo" class="btn btn-block btn-white btn-fb"><span class="icon icon-fb-small"></span> 600k</a></div></li><li><div class="container"><a target="_blank" href="http://plus.google.com/+duolingo" class="btn btn-block btn-white btn-google"><span class="icon icon-google-small"></span> 100k</a></div></li></ul></div>{{#dashboard_ad_experiment_true}}{{^has_observees}}{{^trial_account}}{{#in_house_localized}}<div class="box-gray box-dashboard"><div class="top"><h2>Duolingo {{#_i}}for schools{{/_i}}</h2><div class="school-icon school-students-img"></div></div><p>{{#_i}}Now teachers can track all their students in one place through our brand new dashboard.{{/_i}}</p><a href="https://schools.duolingo.com/" data-track-click="nav nonteacher schools" class="btn btn-white btn-block">{{#_i}}Check it out!{{/_i}}</a></div>{{/in_house_localized}}{{/trial_account}}{{/has_observees}}{{#has_observees}}{{#in_house_localized}}<div class="box-colored blue box-dashboard"><div class="top"><h2>{{#_i}}Duolingo Dashboard{{/_i}}</h2><div class="school-icon school-students-img"></div></div><p>{{#_i}}It looks like you are tracking students, see how they are doing!{{/_i}}</p><a href="https://dashboard.duolingo.com/" data-track-click="nav teacher dashboard" class="btn btn-white btn-outline btn-block">{{#_i}}Take me to the dashboard{{/_i}}</a></div>{{/in_house_localized}}{{/has_observees}}{{/dashboard_ad_experiment_true}} ',
"profile-stats":'<li data-toggle="popover" data-popover="#skillpoints-breakdown" data-placement="below"><span class="skill-points"></span>{{total_points}}<div id="skillpoints-breakdown" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content"><h4>{{#_i}}Skill points{{/_i}}</h4><ul class="">{{#points_languages}}{{#learning}}<li><span class="gold-coin"></span><strong class="points">{{points}}</strong><span class="text">{{#_i}}{{#_iv}}{{language_string}}{{/_iv}}||point breakdown by language{{/_i}}</span></li>{{/learning}}{{/points_languages}}<li><span class="activity"></span><strong class="points">+{{points_gained_in_week}}</strong><span class="text">{{#_i}}{{#pluralize}}Point,Points,{{points_gained_in_week}}{{/pluralize}} this week{{/_i}}</span></li></ul></div></div></div></li><li data-toggle="popover" data-popover="#words-breakdown" data-placement="below"><span class="words-icon {{#ui_language_es}}es{{/ui_language_es}} {{#ui_language_pt}}es{{/ui_language_pt}} {{#ui_language_it}}es{{/ui_language_it}} {{#ui_language_fr}}fr{{/ui_language_fr}} {{#ui_language_pl}}pl{{/ui_language_pl}}"></span><span id="word-count">{{#loading_word_count}}<img src="/images/profile-word-spinner.gif" style="" class="spinner" />{{/loading_word_count}}{{^loading_word_count}}{{#vocab_size}}{{total}}{{/vocab_size}}{{/loading_word_count}}</span><div id="words-breakdown" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content"><h4>{{#_i}}Words{{/_i}}</h4><ul class="">{{#vocab_size}}{{#languages}}<li><span class="words-icon small {{#ui_language_es}}es{{/ui_language_es}} {{#ui_language_pt}}es{{/ui_language_pt}} {{#ui_language_it}}es{{/ui_language_it}} {{#ui_language_fr}}fr{{/ui_language_fr}} {{#ui_language_pl}}pl{{/ui_language_pl}}"></span><strong class="points">{{count}}</strong><span class="text">{{#_i}}{{#_iv}}{{language_string}}{{/_iv}}||word breakdown by language{{/_i}}</span></li>{{/languages}}{{/vocab_size}}</ul></div></div></div></li><li data-toggle="popover" data-popover="#streak-breakdown" data-placement="below"><span class="streak"></span>{{site_streak}}<div id="streak-breakdown" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content"><h4>{{#_i}}Streaks{{/_i}}</h4><ul class="">{{#streak_languages}}{{#learning}}<li><span class="streak-small"></span><strong class="points">{{streak}}</strong><span class="text">{{#_i}}{{#_iv}}{{language_string}}{{/_iv}}||streak breakdown by language{{/_i}}</span></li>{{/learning}}{{/streak_languages}}</ul></div></div></div></li>',
"progress-bar":'{{^use_strength}}<ul class="progress-bar-distinct left">{{#elements}}<li id="element-{{.}}" class="nothing"><div class="inner"></div></li>{{/elements}}</ul>{{/use_strength}}{{#use_strength}}{{^web_strength_v2_experiment_true}}<span class="progress-bar-container-inner"><span class="progress-bar-dynamic left strength-bar"><div class="bar {{#global_practice}}blue{{/global_practice}}{{^global_practice}}{{skill_color}}{{/global_practice}}" style="opacity: 0; width: 0%"><div class="bubbles"></div><div class="triangle-end"></div></div><div class="skill-icon-container"><div class="challenge-number-container"><span class="challenge-num">1</span><span class="challenge-num-circle white"></span><span class="challenge-num-backing"></span></div>{{#global_practice}}<span class="skill-icon smaller locked white" style="position: absolute;"><span class="skill-icon-image skill-icon-global skill-locked-barbell"></span></span><span class="skill-icon smaller blue unlocked finished-skill bounce-in hidden"><span class="skill-icon-image skill-icon-global skill-unlocked-barbell"></span></span>{{/global_practice}}{{^global_practice}}<span class="skill-icon smaller locked white" style="position: absolute;"><span class="skill-icon-image skill-icon-{{skill_index}}"></span></span><span class="skill-icon smaller {{skill_color}} unlocked finished-skill bounce-in hidden"><span class="skill-icon-image skill-icon-{{skill_index}}"></span></span>{{/global_practice}}</div><span class="backing"></span></span></span>{{/web_strength_v2_experiment_true}}{{#web_strength_v2_experiment_true}}<span class="progress-bar-dynamic v2"><div class="lightning-container"><div class="icon icon-lightning-gray status-icon"></div><div class="icon icon-lightning-green status-icon opacity-0"></div><div class="v2-backing"></div></div><div class="bar" style="width: 0%"><div class="ruler-overlay"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></div></div><div class="ruler"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></div><div class="challenge-number-container">{{#_i}}Challenge <span class="challenge-num">1</span>{{/_i}}</div></span>{{/web_strength_v2_experiment_true}}{{/use_strength}} ',
"progress-dashboard":'<main class="main-full-width"><section class="page-main dashboard-main"><div class="content dashboard-banner"><div class="first"><h1>{{#_i}}Manage your students\' progress{{/_i}}</h1></div><div class="second"><span class="school-icon school-students-img"></span></div></div>{{#has_students}}<div class="bar"><label class="blue-select no-focus left"><select id="tag-selector"><option value="all" data-id="all" selected>{{#_i}}All sections{{/_i}}</option>{{#all_tags}}<option value="{{.}}" data-id="{{.}}">{{.}}</option>{{/all_tags}}</select></label><div id="create-new-section" class="btn btn-blue {{#observee_limit}}disabled{{/observee_limit}}">{{#_i}}Invite more students{{/_i}}</div><label class="grey-select smaller no-focus right"><select id="week-selector">{{#all_weeks}}<option value="{{week_id}}" data-id="{{week_id}}" selected>{{localized_week_string}}</option>{{/all_weeks}}</select></label></div>{{/has_students}}<table class="dashboard "><tr><th>{{#_i}}Student{{/_i}}</th><th>{{#_i}}Course{{/_i}}</th><th>{{#_i}}Skill{{/_i}}</th><th>{{#_i}}Lesson{{/_i}}</th><th>{{#_i}}XP{{/_i}}</th><th>{{#_i}}Total{{/_i}}</th><th class="remove"></th></tr>{{#has_students}}{{#observees}}<tr>{{#new_student}}<td><span class="avatar-container"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><span class="avatar avatar-small"><img src="https://www.duolingo.com/avatars/{{user_id}}/medium"><span class="ring"></span></span></a></span><span class="student-info" data-id="{{user_id}}">{{#display_name}}<a href="https://www.duolingo.com/users/{{user_id}}/redirect"><div class="name bold gray-dark">{{display_name}}</div></a>{{/display_name}}{{^display_name}}<a href="https://www.duolingo.com/users/{{user_id}}/redirect"><div class="name bold gray-dark">{{user_name}}</div></a>{{/display_name}}<div class="email gray">{{email}}</div><div class="name gray" id="static-section"><span id="section-display-name">{{tag_}}</span><span id="update-existing-section" class="update-section blue small-margin-left {{^tag_}}hidden{{/tag_}}">{{#_i}}Edit Section{{/_i}}</span><span id="add-section" class="update-section blue {{#tag_}}hidden{{/tag_}}">{{#_i}}Add Section{{/_i}}</span></div><div class="name gray hidden" id="editable-section"><div class="input left"><input class="large" id="section-editor" name="observed-section" maxlength="45" onfocus="this.value = this.value;" type="text" value="{{tag_}}"></div><div class="save-cancel-button"><div data-toggle="tooltip" title="{{#_i}}Cancel{{/_i}}" class="btn btn-blue btn-small cancel cancel-edit"><span class="icon icon-x-white-small"></span></div><div class="btn btn-blue btn-small save save-edit" data-toggle="tooltip" title="{{#_i}}Save{{/_i}}"><span class="icon icon-check-white-small"></span></div></div></div></span></td>{{/new_student}}{{^new_student}}<td class="same-user"></td>{{/new_student}}<td>{{#from_language_name}}<div class="learning-language bold">{{#_ivar}}learning_language_name{{/_ivar}}</div><div class="from-language gray">{{#_i}}from{{/_i}} {{#_ivar}}from_language_name{{/_ivar}}</div>{{/from_language_name}}</td><td class="skills-col"><table>{{#skills}}<tr><td class="nested skills bold">{{.}}&nbsp;</td></tr>{{/skills}}</table></td><td class="lesson-col"><table>{{#lessons}}<tr>{{#is_lesson}}<td class="nested lesson gray">{{lesson_number}}/{{skill_lessons}}</td>{{/is_lesson}}{{#is_practice}}<td class="nested lesson gray">{{#_i}}Practice{{/_i}}</td>{{/is_practice}}{{#is_test}}<td class="nested lesson gray">{{#_i}}Test{{/_i}}</td>{{/is_test}}</tr>{{/lessons}}</table></td><td class="xp-col"><table>{{#xps}}<tr><td class="nested xp gray">{{.}} XP</td></tr>{{/xps}}</table></td><td class="total-col"><table><tr><td class="total bold green">{{total}} XP</td></tr></table></td>{{#new_student}}<td class="remove"><a href="javascript:;" data-id="{{user_id}}" data-email="{{email}}" class="btn-gray remove-button" data-toggle="tooltip" title="{{#_i}}Remove{{/_i}}">-</a></td>{{/new_student}}{{^new_student}}<td class="same-user"></td>{{/new_student}}</tr>{{/observees}}{{/has_students}}</table>{{^has_students}}<div class="no-students"><h2 class="gray">{{#_i}}No students have added you yet!{{/_i}}</h2><span class="btn btn-blue btn-more-padding" id="send-invitation">{{#_i}}Invite students{{/_i}}</span></div>{{/has_students}}</section>{{>footer}}</main><div class="modal fade hidden" id="invite-students"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><div class="modal-header"><h1 class="section-header">{{#_i}}Generate a link to send to your students{{/_i}}</h1><h1 class="share-header hidden">{{#_i}}Send this link to all your students!{{/_i}}</h1><h1 class="share-header-section hidden">{{#_i}}Send this link to your students in <span id="section-name"></span>!{{/_i}}</h1></div><div class="modal-body"><div class="section-area"><div style="display:none"><label>{{#_i}}Email address{{/_i}}</label><div class="input"><input class="large" id="observer-email" name="observer-email" type="text" value="{{email}}" disabled></div></div><label>{{#_i}}Name of your section (optional){{/_i}}</label><table class="form-table"><tr><td><div class="input"><input class="large" id="section" name="section" type="text"></div></td></tr></table><div class="gray center">{{#_i}}Teach multiple sections/classes? Use this to group your students. You can create additional sections later.{{/_i}}</div><div class="link-area"><span id="show-link" class="btn btn-blue btn-block">{{#_i}}Show link{{/_i}}</span></div></div><div class="share-area hidden"><div class="gray center">{{#_i}}Students must click on the link to start Duolingo and appear on your dashboard.{{/_i}}</div><div class="link-area"><div class="magic-link-container"><div style="display:table"><input type="text" id="magic-link" value=""><div class="btn-container"><div id="copy-link" class="btn btn-blue" data-clipboard-target="magic-link">{{#_i}}Copy link{{/_i}}</div></div></div></div><span class="tooltip hidden"><span class="tooltip-inner">{{#_i}}Copied to clipboard!{{/_i}}</span></span></div></div></div></div><div id="alert-modals"></div> ',
"progress-dashboard-v2":'<main class="main-full-width v2"><section class="dashboard-main">{{^has_students}}<div class="content dashboard-banner"><div class="first"><h1>{{#_i}}Manage your students\' progress{{/_i}}</h1></div><div class="second"><span class="school-icon school-students-img"></span></div></div>{{/has_students}}{{#has_students}}<div class="blue-header"><div class="content"><div class="background"><span class="student-count">{{#_i}}<b>{{num_students}}</b> {{#pluralize}}student,students,{{num_students}}{{/pluralize}}{{/_i}}</span><span class="filter"><label class="white-select no-focus"><select id="tag-selector"><option value="all" data-id="all" selected>{{#_i}}All sections{{/_i}}</option>{{#all_sections}}{{#.}}<option value="{{.}}" data-id="{{.}}">{{.}}</option>{{/.}}{{/all_sections}}</select></label></span><span class="filter"><label class="white-select no-focus"><select id="language-selector">{{^tree_view}}<option value="all" data-id="all" selected>{{#_i}}All languages{{/_i}}</option>{{/tree_view}}{{#all_languages}}<option value="{{language_abbrev}}" data-id="{{language_abbrev}}">{{#_iv}}{{language_name}}{{/_iv}}</option>{{/all_languages}}</select></label></span>{{^tree_view}}<span class="filter"><label class="white-select no-focus"><select id="week-selector">{{#all_weeks}}<option value="{{week_id}}" data-id="{{week_id}}" data-end="{{week_end}}" data-string="{{localized_week_string}}" selected>{{#localized_week_string}}{{localized_week_string}}{{/localized_week_string}}{{^localized_week_string}}{{#_i}}All time{{/_i}}{{/localized_week_string}}</option>{{/all_weeks}}</select></label></span>{{/tree_view}}<div class="bulk-actions right hidden"><a class="edit" href="#"><span class="school-icon white-gear"></span>{{#_i}}Edit Section{{/_i}}</a><a class="remove bulk-remove" href="#"><span class="school-icon white-trash-can"></span>{{#_i}}Remove{{/_i}}</a></div>{{#v3_enabled}}{{>progress-switch-lenses}}{{/v3_enabled}}</div></div></div>{{#num_students}}{{^tree_view}}<section id="dashboard-v2-wrapper" class="dashboard-v2-wrapper"></section>{{/tree_view}}{{#tree_view}}<section id="dashboard-v3-wrapper" class="dashboard-v3-wrapper"></section>{{/tree_view}}{{/num_students}}{{^num_students}}{{>progress-no-students}}{{>footer}}{{/num_students}}{{/has_students}}{{^has_students}}<div class="no-students"><h2 class="gray">{{#_i}}No students have added you yet!{{/_i}}</h2><span class="btn btn-blue btn-more-padding" id="send-invitation">{{#_i}}Invite students{{/_i}}</span></div>{{>footer}}{{/has_students}}</section></main><div id="alert-modals"></div>',
"progress-logged-out-menu":'<header class="topbar topbar-schools-splash"><div class="container"><div class="logo-container"><a href="//www.duolingo.com" class="topbar-brand track-click blue">Duolingo</a><a href="/" class="lockup">{{#_i}}dashboard{{/_i}}</a></div><div id="global-loading-indicator" class="loading-indicator" style="display: none;"><div class="white-spinner"></div></div><div class="topbar-right">{{#username}}<span class="btn btn-green" onclick="location.href=\'/logout\';">{{#_i}}Logout{{/_i}}</span>{{/username}}{{^username}}<div class="topbar-username dropdown click-trigger" style="padding-bottom: 15px;"><div class="current-language" id="site-language-btn">{{#_i}}Site language:{{/_i}} <strong>{{#_i}}{{#_ivar}}ui_language_name{{/_ivar}}||capitalized{{/_i}}</strong><span class="icon icon-arrow-down-gray"></span></div><ul id="site-language-modal" class="double dropdown-menu arrow-top-right">{{#ui_languages_list}}<li class=\'ui-language-option\' data-id="{{id}}" data-abbrev="{{language}}"><a href="//{{id}}.duolingo.com" data-bypass><span class="flag flag-svg-micro flag-{{language}}"></span>{{label}}</a></li>{{/ui_languages_list}}</ul></div><div class="topbar-buttons" style="margin-top: 1px;"><span class="sign-in relative"><span class="btn btn-blue sign-in-btn" id="sign-in-btn">{{#_i}}Login{{/_i}}</span><ul class="popover arrow-top login-popover hidden" id="login-modal" style="width: 240px; right:0; top: 40px; left: auto;"><li id="auth-callback" class="hidden"></li><form id=\'login-form\' action="" method="post" accept-charset="utf-8" style="margin: 0;"><li><span class="signup-gplus btn btn-small btn-red btn-block btn-googlered-new" id="gplusSignIn" data-track-click="topbar login google"><span class="icon"></span>{{#_i}}Sign in with Google{{/_i}}</span></li><li class="center"><span>{{#_i}}or||separates social login/email login{{/_i}}</span></li><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Username or email{{/_i}}" type="text" id="top_login" name="login" value="" autocomplete="on"/></div></li><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Password{{/_i}}" type="password" id="top_password" name="password" value="" autocomplete="on"/></div></li><li id="message" class="login-fail hidden"></li><li><input id="login-button" class="btn btn-green btn-small sign-in btn-block" type="submit" value="{{#_i}}Login{{/_i}}"></li><li class="center"><a href="/forgot_password">{{#_i}}Forgot password{{/_i}}</a></li></form></ul></span></div>{{/username}}</div><div id="logged-out-message" class="logged-out-message"></div></div></header><div id="keyboard-shortcuts" class="modal keyboard-shortcuts fade"></div> ',
"progress-magic-link":'{{#show_mobile_view}}<meta name = "viewport" content = "width = device-width">\x3c!-- <meta name = "viewport" content = "width = 320"> --\x3e<div class="container"><div class="header"><a href="//www.duolingo.com" class="topbar-brand track-click blue">Duolingo</a><a class="left" href="/">{{#_i}}for schools{{/_i}}</a></div><div class="main-area">\x3c!-- This LOGIN section should be visible first for users, if they dont have an acct, they will click the \'Need an account?\' link in the footer --\x3e{{#login}}<div id="login-form" class="login-form"><ul class=\'login-signup-list\'><form id="login-form"><table border="0" cellspacing="0" cellpadding="0" class="form-table" style="margin-bottom: 20px;"><input type="hidden" name="came_from" value="{{came_from}}"/><tr><td><input id="login" name="login" size="30" type="text" placeholder="{{#_i}}Username{{/_i}}"></td></tr><tr><td><input id="password" name="password" size="30" type="password" placeholder="{{#_i}}Password{{/_i}}"></td></tr></table><div id=\'message\' class="warning-message hidden margin-bottom"></div><input id="login-button" class="btn btn-lg btn-blue btn-block more-margin-bottom" value="{{#_i}}Login{{/_i}}"/><p class="center no-margin"><a href="/forgot_password" class="forgot-password">{{#_i}}Forgot password?{{/_i}}</a></p></form></ul></div>{{/login}}\x3c!-- This SIGNUP section appears if a user clicks \'Need and account?\' in the footer --\x3e{{#signup}}<div class="signup-form"><span class="signup"></span></div>{{/signup}}\x3c!-- After a user logs in or signs up they will see this confirmation --\x3e{{#confirmation}}<div class="new-user-success"><h1>{{#_i}}Welcome <b>{{user_email}}</b>{{/_i}}</h1><div><a class="log-out blue">{{#_i}}Is this not you?{{/_i}}</a></div><p>{{#_i}}You are authorizing <b>{{observer_email}}</b> to track your Duolingo progress.{{/_i}}</p><a class="btn btn-blue btn-block add-observer">{{#_i}}Continue{{/_i}}</a></div>{{/confirmation}}\x3c!-- After the user clicks continue, they will see this screen with a success message in the footer --\x3e{{#success}}<div class="success-msg">{{#_i}}<b>{{observer_email}}</b> is now tracking your Duolingo progress.{{/_i}}</div><div class="apps-buttons"><h1>{{#_i}}Start learning a language now!{{/_i}}</h1><div class="store-buttons">{{#ios}}<a class="btn btn-mobile" href="https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8" target="_blank"><span class="about-img apple-store"></span><span class="button-text">{{#_i}}<span class="subtext">Download on the</span>App Store{{/_i}}</span></a>{{/ios}}{{#android}}<a class="btn btn-mobile" href="https://play.google.com/store/apps/details?id=com.duolingo" target="_blank"><span class="about-img play-store"></span><span class="button-text">{{#_i}}<span class="subtext">Get it on</span>Google Play{{/_i}}</span></a>{{/android}}</div></div>{{/success}}</div>\x3c!-- Each of these footer message(s) correspond with one of the sections above --\x3e<div class="mobile-footer"><div class="footer-content">{{#login}}<a class="sign-up-btn blue">{{#_i}}Need an account? Sign up!{{/_i}}</a>{{/login}}{{#signup}}<a class="log-in blue">{{#_i}}Have an Account? Log in{{/_i}}</a>{{/signup}}{{#confirmation}}<a href="/" class="no-share blue">{{#_i}}Continue, but don\'t share my progress{{/_i}}</a>{{/confirmation}}{{#success}}{{#ios}}{{#_i}}Also available on <a class="blue" href="https://play.google.com/store/apps/details?id=com.duolingo">Android</a> and on <a class="blue" href="/">www.duolingo.com</a>{{/_i}}{{/ios}}{{#android}}{{#_i}}Also available on <a class="blue" href="https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8">iOS</a> and on <a class="blue" href="/">www.duolingo.com</a>{{/_i}}{{/android}}{{/success}}</div></div></div>{{/show_mobile_view}}{{^show_mobile_view}}<section dir="{{dir}}" class="monument-carousel dark-theme"><div dir="{{dir}}" class="signup">{{>small-register}}<div id="teacher-confirmation" class="hidden"><div id="confirm-teacher-form" class="splash-signup-form"><section class="section-white space"><div class="section-inner-wide section-inner"><ul class="login-signup-list"><table border="0" cellspacing="0" cellpadding="0" class="form-table"><tr><td><strong>{{#_i}}Email{{/_i}}</strong></td><td><div class="relative"><input class="input-block" id="email" name="email" size="30" type="text" value="{{email}}"><div class="error-flag" id="invalid-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Invalid email address{{/_i}}</div><div class="error-flag" id="taken-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Email already taken{{/_i}}</div></div></td></tr><tr><td><strong>{{#_i}}Username{{/_i}}</strong></td><td><div class="relative"><input class="input-block" id="login" name="register_login" size="30" type="text" value="{{username}}"><div class="error-flag" id="invalid-login-error" style="top: -20px;"><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Username must be between 3 and 16 valid characters (letters, numbers and "-", ".", "_"){{/_i}}</div><div class="error-flag" id="taken-login-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Username already taken{{/_i}}</div><div class="error-flag" id="unknown-login-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Unknown error{{/_i}}</div></div></td></tr></table></ul></div></section></div></div></div></section>{{/show_mobile_view}}',
"progress-magic-link-modal":'<div class="modal fade hidden" id="invite-students"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><div class="modal-header"><h1 class="section-header">{{#_i}}Generate a link to send to your students{{/_i}}</h1><h1 class="share-header hidden">{{#_i}}Send this link to all your students!{{/_i}}</h1><h1 class="share-header-section hidden">{{#_i}}Send this link to your students in <span id="section-name"></span>!{{/_i}}</h1></div><div class="modal-body"><div class="section-area"><div class="email-field"><label>{{#_i}}Email address{{/_i}}</label><div class="input"><input class="large" id="observer-email" name="observer-email" type="text" value="{{email}}" disabled></div></div><label>{{#_i}}Name of your section (optional){{/_i}}</label><table class="form-table"><tr><td><div class="input"><input class="large" id="section" name="section" type="text"></div></td></tr></table><div class="gray center">{{#_i}}Teach multiple sections/classes? Use this to group your students. You can create additional sections later.{{/_i}}</div><div class="link-area"><span id="show-link" class="btn btn-blue btn-block">{{#_i}}Show link{{/_i}}</span></div></div><div class="share-area hidden"><div class="gray center">{{#_i}}Students must click on the link to start Duolingo and appear on your dashboard.{{/_i}}</div><div class="link-area"><div class="magic-link-container"><div style="display:table"><input type="text" id="magic-link" value=""><div class="btn-container"><div id="copy-link" class="btn btn-blue" data-clipboard-target="magic-link">{{#_i}}Copy link{{/_i}}</div></div></div></div><span class="tooltip hidden"><span class="tooltip-inner">{{#_i}}Copied to clipboard!{{/_i}}</span></span></div></div></div></div>',
"progress-menu":'<header class="topbar topbar-schools-splash"><div class="container"><div class="logo-container"><a href="//www.duolingo.com" class="topbar-brand track-click blue">Duolingo</a><a href="/" class="lockup">{{#_i}}dashboard{{/_i}}</a></div><div id="global-loading-indicator" class="loading-indicator smaller-logo-schools" style="display: none;"><div class="white-spinner"></div></div><div id="spinner-container"></div><div class="topbar-right">{{#ui_language_en}}<a class="btn btn-standard btn-outline teacher-forum" href="https://www.duolingo.com/topic/909">Discuss with teachers</a>{{/ui_language_en}}{{#dashboard_redesign}}{{#num_observees}}<div id="create-new-section" class="btn btn-blue {{#observee_limit}}disabled{{/observee_limit}}">{{#_i}}Invite more students{{/_i}}</div>{{/num_observees}}{{/dashboard_redesign}}<div class="dropdown topbar-username"><div data-toggle="dropdown" class="">{{>avatar_small}}<span class="name">{{username}}</span><span class="icon icon-arrow-down-gray"></span></div><ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel">{{#ui_language_en}}{{#dashboard_help_ff_true}}<li><a href="/dashboard_help">{{#_i}}Help{{/_i}}</a></li>{{/dashboard_help_ff_true}}{{/ui_language_en}}<li><a href="/logout" class="track-click" id="header_userdrop_logout" data-bypass>{{#_i}}Logout{{/_i}}</a></li></ul></div></div></div></header> ',
"progress-no-students":'{{#ui_language_en}}<div class="no-students gray">{{#section_selected}}{{#_i}}No students in {{section}} are learning {{#_iv}}{{learning_language_name}}{{/_iv}}.{{/_i}}{{/section_selected}}{{^section_selected}}{{#_i}}No students are learning {{#_iv}}{{learning_language_name}}{{/_iv}}.{{/_i}}{{/section_selected}}</div>{{/ui_language_en}}',"progress-notification-modal":'<div class="modal fade in" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><h4 class="modal-title">{{#_i}}Notice something different?{{/_i}}</h4></div><div class="modal-body">{{>progress-switch-lenses}}<span class="v3-copy">{{#_i}}You can now see your classroom\'s course progress at a glance. To return to the detailed list view, click this button.{{/_i}}</span></div><div class="modal-footer"><button data-bb-handler="okay" type="button" data-dismiss="modal" class="btn margin-left btn-primary modal-success">{{#_i}}OK{{/_i}}</button></div></div></div></div>',
"progress-report":"<html><head><title>Progress Report</title></head><body><table border='1'><tr><th>Username</th><th>XP (total)</th><th>XP (this week)</th><th>Level</th><th># Skills learned</th><th>% Skill tree completed</th><th># Words (weak-medium-strong)</th><th>Estimated score</th></tr>{{#report_data}}<tr><td>{{username}}</td><td>{{points}}</td><td>{{points_week}}</td><td>{{level}}</td><td>{{learned_skills}}</td><td>{{perc_tree}}</td><td>{{w_total}} ({{w_weak}}-{{w_medium}}-{{w_strong}})</td><td>{{tc_estimate}}</td></tr>{{/report_data}}</table></body></html> ",
"progress-splash":'<main class="main-full-width"><div class="content dashboard-banner"><div class="first"><h1>{{#_i}}Manage your students\' progress{{/_i}}</h1><a class="btn btn-lg btn-white" href="javascript:;" id="signup-link" data-track-click="splash page register facebook">{{#_i}}Get Started{{/_i}}</a></div><div class="second"><span class="school-icon school-students-img"></span></div></div><section class="page-main dashboard-main"><table class="dashboard "><tr><th>{{#_i}}Student{{/_i}}</th><th>{{#_i}}Course{{/_i}}</th><th>{{#_i}}Skill{{/_i}}</th><th>{{#_i}}Lesson{{/_i}}</th><th>{{#_i}}XP{{/_i}}</th><th>{{#_i}}Total{{/_i}}</th></tr><tr><td><span class="avatar-container"><span class="avatar avatar-small"><img src="https://duolingo-images.s3.amazonaws.com/avatars/14/eMyvXJ6I6p/medium"><span class="ring"></span></span></span><span class="student-info"><div class="email bold">student1@duolingo.com</div><div class="name gray">Luis</div></span></td><td><div class="learning-language bold">{{#_i}}English{{/_i}}</div><div class="from-language gray">{{#_i}}from{{/_i}} {{#_i}}Spanish{{/_i}}</div></td><td><div class="skills bold">{{#_i}}Basics 2{{/_i}}</div><div class="skills bold">{{#_i}}Basics 2{{/_i}}</div><div class="skills bold">{{#_i}}Directions{{/_i}}</div></td><td><div class="lesson gray">2/3</div><div class="lesson gray">3/3</div><div class="lesson gray">1/3</div></td><td><div class="xp gray">7 {{#_i}}XP{{/_i}}</div><div class="xp gray">10 {{#_i}}XP{{/_i}}</div><div class="xp gray">9 {{#_i}}XP{{/_i}}</div></td><td><div class="total bold red">16 {{#_i}}XP{{/_i}}</div></td></tr><tr><td><span class="avatar-container"><span class="avatar avatar-small"><img src="https://duolingo-images.s3.amazonaws.com/avatars/5/EiWVRG6TJH/medium"><span class="ring"></span></span></span><span class="student-info"><div class="email bold">student2@duolingo.com</div><div class="name gray">Severin</div></span></td><td><div class="learning-language bold">{{#_i}}English{{/_i}}</div><div class="from-language gray">{{#_i}}from{{/_i}} {{#_i}}Spanish{{/_i}}</div></td><td><div class="skills bold">{{#_i}}Food{{/_i}}</div><div class="skills bold">{{#_i}}Animals{{/_i}}</div><div class="skills bold">{{#_i}}Animals{{/_i}}</div></td><td><div class="lesson gray">3/3</div><div class="lesson gray">1/3</div><div class="lesson gray">2/3</div></td><td><div class="xp gray">10 {{#_i}}XP{{/_i}}</div><div class="xp gray">10 {{#_i}}XP{{/_i}}</div><div class="xp gray">10 {{#_i}}XP{{/_i}}</div></td><td><div class="total bold green">30 {{#_i}}XP{{/_i}}</div></td></tr><tr><td class="same-user"></td><td><div class="learning-language bold">{{#_i}}French{{/_i}}</div><div class="from-language gray">{{#_i}}from{{/_i}} {{#_i}}Spanish{{/_i}}</div></td><td><div class="skills bold">{{#_i}}Food{{/_i}}</div><div class="skills bold">{{#_i}}Animals{{/_i}}</div><div class="skills bold">{{#_i}}Animals{{/_i}}</div></td><td><div class="lesson gray">3/3</div><div class="lesson gray">1/3</div><div class="lesson gray">2/3</div></td><td><div class="xp gray">10 {{#_i}}XP{{/_i}}</div><div class="xp gray">10 {{#_i}}XP{{/_i}}</div><div class="xp gray">10 {{#_i}}XP{{/_i}}</div></td><td><div class="total bold green">30 {{#_i}}XP{{/_i}}</div></td><td></td></tr></table><div class="blur"></div></section>{{>footer}}</main><span id="signup-modal" class="progress-splash-signup modal fade hidden"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><span class="signup"></span></span>',
"progress-student-modal":'<div class="modal fade student-info-modal"><div type="button" class="close" data-dismiss="modal" aria-hidden="true"></div><div class="modal-content"><div class="modal-header"><a class="remove right single-remove" href="#"><span class="school-icon white-trash-can"></span>{{#_i}}Remove{{/_i}}</a><h1 class="student-name">{{display_name}}</h1><span class="student-email">{{email}}</span><span class="student-section">{{section}}</span><div class="school-icon school-supplies first"></div></div><div class="modal-subheader"><span class="avatar-container"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><span class="avatar avatar-xlarge"><img src="{{avatar_url}}/large"><span class="ring"></span><span class="flag flag-svg-small flag-{{learning_language}}"></span></span></a></span>{{^localized_week_string}}<div class="center"><b>{{#_i}}All time{{/_i}}</div>{{/localized_week_string}}{{#localized_week_string}}<div class="center"><b>{{localized_week_string}}</div>{{/localized_week_string}}</div><div class="modal-body">{{^has_events}}<div class="empty">{{#_i}}{{display_name}} has not completed any lessons during this time.{{/_i}}</div>{{/has_events}}{{#has_events}}<table class="activity table table-striped"><thead><th class="time-col">{{#_i}}Timestamp{{/_i}}</th><th class="skills-col">{{#_i}}Skill{{/_i}}</th><th class="lesson-col">{{#_i}}Lesson{{/_i}}</th><th class="xp-col">{{#_i}}XP{{/_i}}</th></thead>{{#events}}<tr><td class="time-col">{{localized_dt_string}}</td><td class="skills-col">{{skill_title}}{{^skill_title}} - {{/skill_title}}</td><td class="lesson-col">{{#lesson_number}}{{lesson_number}}/{{skill_lessons}}{{/lesson_number}}{{^lesson_number}}{{#is_practice}}{{#_i}}Practice{{/_i}}{{/is_practice}}{{#is_test}}{{#_i}}Test{{/_i}}{{/is_test}}{{/lesson_number}}</td><td class="xp-col">{{xp}} {{#_i}}XP{{/_i}}</td></tr>{{/events}}</table>{{/has_events}}</div></div></div>',
"progress-student-row":'<td class="narrow"><input type="checkbox" name="student" value="{{user_id}}" class="border student-checkbox"></td><td class="student-info-cell" sorttable_customkey="{{display_name}}"><span class="avatar-container"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><span class="avatar avatar-small"><img class="lazy" src="{{avatar_url}}/medium"><span class="ring"></span><span class="flag flag-svg-micro flag-{{learning_language}}"></span></span></a></span><span class="student-info" data-id="{{user_id}}"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><div class="name bold gray-dark">{{display_name}}</div></a><div class="student-section gray"><span id="section-display-name">{{section}}</span></div></span></td>{{#summary}}<td class="trigger-modal {{^attendance}}gray{{/attendance}}" sorttable_customkey="{{attendance}}">{{#_i}}<span>{{attendance}}</span> {{#pluralize}}day,days,{{attendance}}{{/pluralize}}{{/_i}}</td>{{#time_tracking_true}}<td class="trigger-modal {{^total_time}}gray{{/total_time}}" sorttable_customkey="{{total_time}}">{{#_i}}<span>{{total_time}}</span> {{#pluralize}}min,mins,{{total_time}}{{/pluralize}}{{/_i}}</td>{{/time_tracking_true}}<td class="trigger-modal {{^total_lessons}}gray{{/total_lessons}}" sorttable_customkey="{{total_lessons}}">{{#_i}}<span>{{total_lessons}}</span> {{#pluralize}}lesson,lessons,{{total_lessons}}{{/pluralize}}{{/_i}}</td><td class="trigger-modal {{^num_skills_learned}}gray{{/num_skills_learned}}" sorttable_customkey="{{num_skills_learned}}"><span>{{num_skills_learned}}</span> {{#_i}}Skills completed{{/_i}}</td><td sorttable_customkey="{{total_xps}}" class="narrow total trigger-modal"><span>{{total_xps}}</span> {{#_i}}XP{{/_i}}</td><td class="narrow more-info trigger-modal"><span class="school-icon black-eye"></span></td>{{/summary}} ',
"progress-switch-lenses":'<ul class="tab-switch dashboard-views"><li><span class="btn btn-blue switch-lenses v2 {{^tree_view}}active{{/tree_view}}" id="switch-v2"><span class="school-icon list-view-white"></span></span></li><li><span class="btn btn-blue switch-lenses v3 {{#tree_view}}active{{/tree_view}}" id="switch-v3"><span class="school-icon dot-view-white"></span></span></li></ul> ',"progress-table-view":'<div class="container">{{#num_students}}<table class="dashboard-v2 sortable" id="dashboard-table"><thead><th class="narrow sorttable_nosort table-header"><div class="sorttable_nosort fixed-header"><input type="checkbox" name="student" value="all" class="border"></div></th><th class="table-header">{{#_i}}Student{{/_i}}<div class="student-row student-info sorttable_sorted fixed-header">{{#_i}}Student{{/_i}} <span class="sorting-icon"></span><span id="sorttable_sortfwdind"></span></div></th><th class="table-header">{{#_i}}Days active{{/_i}}<span {{#has_old_students}}data-toggle="tooltip" data-placement="bottom" title="{{#_i}}since December 2014{{/_i}}"{{/has_old_students}}><div class="fixed-header">{{#_i}}Days active{{/_i}} <span class="sorting-icon"></span></div></span></th>{{#time_tracking_true}}<th>{{#_i}}Time spent{{/_i}}<div class="fixed-header">{{#_i}}Time spent{{/_i}} <span class="sorting-icon"></span></div></th>{{/time_tracking_true}}<th class="table-header">{{#_i}}Lessons{{/_i}}<span {{#has_old_students}}data-toggle="tooltip" data-placement="bottom" title="{{#_i}}since December 2014{{/_i}}"{{/has_old_students}}><div class="fixed-header">{{#_i}}Lessons{{/_i}} <span class="sorting-icon"></span></div></span></th><th class="table-header">{{#_i}}Course progress{{/_i}}<div class="fixed-header">{{#_i}}Course progress{{/_i}} <span class="sorting-icon"></span></div></th><th class="narrow table-header">{{#_i}}XP{{/_i}}<div class="fixed-header">{{#_i}}XP{{/_i}} <span class="sorting-icon"></span></div></th><th class="narrow fixed-header table-header"></th></thead><tbody>{{#course_students}}<tr class="student-row" data-id="{{.}}"></tr>{{/course_students}}</tbody></table>{{/num_students}}{{>footer}}</div> ',
"progress-tree":'<div class="scroller"><div class="fixed-template"><div class="fixed-td"><div class=""><div class="narrow"><div><input type="checkbox" name="student" value="all" class="border check-all"></div></div><div class="lang-info"><div class="first-col-content"><span class="tree-direction"><span class="flag-svg-mid-small flag-{{learning_language}}"></span><span class="flag-svg-micro flag-{{from_language}}"></span></span><span class="tree-direction">{{#_i}}<strong>{{#_iv}}{{learning_language_name}}{{/_iv}}</strong>for {{#_iv}}{{from_language_name}}{{/_iv}} speakers{{/_i}}</span></div></div><div class="nav-button"><button id="nav-prev" class="btn nav-tree nav-tree-{{learning_language}}-{{from_language}} previous"> \u2190 </button></div></div></div><div class="tree-skill-container">{{#skills}}<span class="skill-icon {{skill_color}} nano unlocked" data-toggle="tooltip" data-placement="bottom" title="{{skill_name}}"><span class="skill-icon-image skill-icon-{{skill_index}}"></span></span>{{/skills}}</div><div class="nav-button fixed-td-end"><div class=""><button id="nav-next" class="btn nav-tree next nav-tree-{{learning_language}}-{{from_language}}"> \u2192 </button></div></div></div><table class="dashboard-tree-table dashboard-v2 dashboard-tree-table-{{learning_language}}-{{from_language}}" id="tree-table-{{learning_language}}-{{from_language}}"><tbody>{{#students}}<tr class="student-row" data-id="{{id}}"></tr>{{/students}}</tbody></table></div>',
"progress-tree-row":'<td class="fixed-td"><div class="narrow"><input type="checkbox" name="student" value="{{user_id}}" class="border student-checkbox"></div><div class="student-info-cell"><div class="first-col-content"><span class="avatar-container"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><span class="avatar avatar-small"><img class="lazy" src="{{avatar_url}}/medium"><span class="ring"></span><span class="flag flag-svg-micro flag-{{learning_language}}"></span></span></a></span><span class="student-info" data-id="{{user_id}}"><a href="https://www.duolingo.com/users/{{user_id}}/redirect"><div class="name bold gray-dark" title="{{display_name}}">{{display_name}}</div></a><div class="student-section gray"><span id="section-display-name" title="{{section}}">{{section}}</span></div></span></div></div></td>{{#skills}}<td class="skill-cell"><span class="tree-circles" data-toggle="tooltip" data-placement="top" {{#completed}}{{#completion_date}} title="{{completion_date}}" {{/completion_date}}{{^completion_date}} title="{{#_i}}Complete{{/_i}}" {{/completion_date}}{{/completed}}{{^completed}}{{#locked}} title="{{#_i}}Locked{{/_i}}" {{/locked}}{{^locked}} title="{{completed_lessons}}/{{total_lessons}}" {{/locked}}{{/completed}} >{{#completed}}<span class="icon icon-green-check-small"></span>{{/completed}}{{^completed}}<span class="incomplete-skill">{{#completed_lessons}}<div class="pie"><span class="overlay-progress" data-pie="{{completed_lessons}}+{{lessons_left}}"></span></div>{{/completed_lessons}}</span>{{/completed}}</span></td>{{/skills}} ',
"progress-tree-view":'<div class="container">{{#num_trees}}{{#tree_representations}}<div class="tree-container" id="tree-{{learning_language}}-{{from_language}}"></div>{{/tree_representations}}{{/num_trees}}</div>{{>footer}}<div id="alert-modals"></div> ',"quality-eval":'An email has been sent to {{username}}. <br><br>Return to <a href="/diagnostics/published_translations">published translations diagnostics page</a>.',"recommended-translations":'<h1>Recommended translations</h1> Enter vocabulary size and translation direction, or enter username to use values for that user. <br><br><form> Username: <input name="username" type="text">{{#username}}{{^user_id}}<br><b>User {{username}} not found in the DB.</b>{{/user_id}}{{/username}}<br><br>Vocabulary size: <input name="vocab_size" type="text" {{#vocab_size}}value="{{vocab_size}}"{{/vocab_size}}><br>Source (learning) language: <input name="source_lang" type="text" {{#source_lang}}value="{{source_lang}}"{{/source_lang}}><br>Target (UI) language: <input name="target_lang" type="text" {{#target_lang}}value="{{target_lang}}"{{/target_lang}}><br>Skill name: <input name="skill" type="text" {{#skill_name}}value="{{skill_name}}"{{/skill_name}}><br><br><input type="submit" value="Submit"></form>{{#enough_input}}{{#percent_can_read}}<br>We report that this user can read {{percent_can_read}}% of all articles. <br>{{/percent_can_read}}<br>{{num_translations}} recommended translations, in order of preference: <table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Translation</th><th>Flesch-Kincaid grade level</th><th>Sponsored?</th><tr></thead><tbody>{{#translations}}<tr><td><a href="/translation/{{translation_id}}">{{document_title}}</a></td><td>{{flesch_kincaid_grade}}</td><td>{{sponsored}}</td></tr>{{/translations}}</tbody></table>{{/enough_input}} ',
"recommended-translations-stats":'<h1>Stats for {{source_language}}->{{target_language}} recommended translations</h1><b>{{num_translations_indexed}}</b> translation(s) in index. <br><br><form> Min. fraction of document lexemes the user must have seen to be able to "understand" a document: <input name="min_frac_lexemes_seen" type="text" value="{{min_frac_lexemes_seen}}"><input type="submit" value="Submit"></form><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Vocab size</th><th>Percent of translation(s) understood</th><tr></thead><tbody>{{#frac_translations_understood}}<tr><td>{{vocab_size}}</td><td>{{percent_understood}}</td></tr>{{/frac_translations_understood}}</tbody></table> ',
"register-form":'<form action="/welcome" method="post" id="register-form"><table border="0" cellspacing="0" cellpadding="0" class="form-table">{{#facebook_id}}<tr class="connected-to"><td colspan="2"><span class="icon-fb-small icon right"></span><img src="{{profile_image}}" class="left"/><strong>{{facebook_name}}</strong></td></tr><input name="profile_image" type="hidden" value="http://graph.facebook.com/{{facebook_id}}/picture?type=large"><input name="facebook_fullname" type="hidden" value="{{facebook_name}}"><input name="facebook_username" type="hidden" value="{{facebook_username}}">{{/facebook_id}}{{^hide_language_select}}<tr class="select-language-row"><td colspan="2"><div class="relative"><div class="dropdown"><span id="direction" class="select-ll" data-toggle="dropdown"><span class="prompt">I want to learn Spanish</span> <span class="icon icon-arrow-down"></span></span><ul class="dropdown-menu language-list" role="menu" aria-labelledby="dLabel">{{#available_languages}}<li id="opt-{{key}}" class="direction-option" data-value="{{key}}"><a href="javascript:;">{{prompt}}</a></li>{{/available_languages}}</ul></div><div class="error-flag" id="invalid-learning-language-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Invalid learning direction{{/_i}}</div></div></td></tr>{{/hide_language_select}}<input name="learning_language" type="hidden" value="{{learning_language}}"><tr><td><strong>{{#_i}}Full name{{/_i}}</strong></td><td><input placeholder="{{#_i}}(optional){{/_i}}" class="input-block" id="fullname" name="fullname" size="30" type="text" value="{{fullname}}"></td></tr><tr><td><strong>{{#_i}}Email{{/_i}}</strong></td><td><div class="relative"><input class="input-block" id="email" name="email" size="30" type="text" value="{{email}}"><div class="error-flag" id="invalid-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Invalid email address{{/_i}}</div><div class="error-flag" id="taken-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Email already taken{{/_i}}</div></div></td></tr><tr><td><strong>{{#_i}}Username{{/_i}}</strong></td><td><div class="relative"><input class="input-block" id="login" name="register_login" size="30" type="text" value="{{username}}"><div class="error-flag" id="invalid-login-error" style="top: -20px;"><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Username must be between 3 and 16 valid characters (letters, numbers and "-", ".", "_"){{/_i}}</div><div class="error-flag" id="taken-login-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Username already taken{{/_i}}</div><div class="error-flag" id="unknown-login-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Unknown error{{/_i}}</div></div></td></tr><tr class="suggest-box"><td colspan="2"><ul class="suggested-names"><li class="title"><strong>{{#_i}}Suggestions{{/_i}}</strong></li><li class="suggestion"><a class="suggested-name suggest1"></a></li><li class="suggestion"><a class="suggested-name suggest2"></a></li></ul></td></tr><tr><td><strong>{{#_i}}Password{{/_i}}</strong></td><td><div class="relative"><input class="input-block" id="password" name="register_password" size="30" type="password"><div class="error-flag" id="invalid-password-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Password too short{{/_i}}</div></div></td></tr></table><input name="ui_language" type="hidden" value="{{ui_language}}"><input name="invite" type="hidden" value="{{invite}}"><input name="invited_by" type="hidden" value="{{invited_by}}"><input name="invited_via" type="hidden" value="{{invited_via}}">{{#facebook_id}}<input name="facebook_id" type="hidden" value="{{facebook_id}}">{{/facebook_id}}</form> ',
"registration-form-inner":'<ul class="login-signup-list {{#splash_skip_delayed}}skip-delayed{{/splash_skip_delayed}}">{{#splash_skip_delayed}}<h1>{{#_i}}Sign up with Duolingo{{/_i}}</h1>{{/splash_skip_delayed}}<li style="margin-bottom: 20px;" id="register-form-container"></li><li style="text-align: center;"><a id="register-button" href="javascript:;" class="btn btn-blue {{#splash_skip_delayed}}btn-green-light{{/splash_skip_delayed}} btn-lg btn-block" data-track-click="course register submit">{{^has_facebook}}{{#_i}}Create account{{/_i}}{{/has_facebook}}{{#has_facebook}}{{#_i}}Complete profile{{/_i}}{{/has_facebook}}</a></li>{{^hide_social_signup}}{{#signup_modal_buttons_experiment_true}}{{#google_only}}<li class="signup-social-buttons"><a class="btn btn-googlered-new signup-google" href="javascript:;" data-track-click="splash page register google"><span class="icon icon-google-small"></span>{{#_i}}Sign up with Google{{/_i}}</a></li>{{/google_only}}{{^google_only}}{{#has_facebook}}<li class="signup-email-link">{{#_i}}or Sign up with <a href="javascript:;" class="signup-email">Email</a> or <a href="javascript:;" class="signup-google">Google</a>{{/_i}}</li>{{/has_facebook}}{{^has_facebook}}<li class="signup-social-buttons"><a class="btn btn-fbblue-dark signup-facebook" href="javascript:;" data-track-click="splash page register facebook"><span class="icon icon-fb-small"></span>{{#_i}}Sign up with Facebook{{/_i}}</a><a class="btn btn-googlered-new signup-google" href="javascript:;" data-track-click="splash page register google"><span class="icon icon-google-small"></span>{{#_i}}Sign up with Google{{/_i}}</a></li>{{/has_facebook}}{{/google_only}}{{/signup_modal_buttons_experiment_true}}{{^signup_modal_buttons_experiment_true}}{{#google_only}}<li class="signup-social-link"><a href="javascript:;" class="signup-google" data-track-click="course register google">{{#_i}}Sign up with Google{{/_i}}</a></li>{{/google_only}}{{^google_only}}{{#has_facebook}}<li class="signup-email-link">{{#_i}}Sign up with <a href="javascript:;" class="signup-email">email</a> or <a href="javascript:;" class="signup-google" data-track-click="course register google">Google</a>{{/_i}}</li>{{/has_facebook}}{{^has_facebook}}<li class="signup-social-link">{{#_i}}Sign up with <a href="javascript:;" class="signup-facebook">Facebook</a> or <a href="javascript:;" class="signup-google" data-track-click="course register google">Google</a>{{/_i}}</li>{{/has_facebook}}{{/google_only}}{{/signup_modal_buttons_experiment_true}}{{/hide_social_signup}}{{#splash_skip_delayed}}<div id="modal-footer" class="user-login hidden {{#magic_link_view}}magic-link{{/magic_link_view}}">{{#_i}}Have an Account?{{/_i}} <a href="javascript:;" class="existing-login {{#magic_link_view}}signup-email{{/magic_link_view}}">{{#_i}}Sign in{{/_i}}</a></div>{{/splash_skip_delayed}}</ul>',
"registration-modal":'<div id="signup-modal-body"><div class="modal-header"><h1>{{#_i}}Sign up{{/_i}}<div class="owl owl-pointing-small {{^rtl}}img-flipped{{/rtl}}"></div></div><div class="modal-body">{{>registration-form-inner}}</div> ',"report-options":'{{#translate}}{{#incorrect}}{{#user_solution}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="accepted" value="My answer should be accepted."><label class="report-label" for="accepted">{{#_i}}<b>My answer</b> should be accepted.{{/_i}}</label></li>{{/user_solution}}{{/incorrect}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The given answer has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Correct solution"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="hints" value="The dictionary hints are misleading/incomplete."><label class="report-label" for="hints">{{#_i}}<b>The dictionary hints</b> on hover are wrong or missing.{{/_i}}</label></li>{{#has_audio}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="audio" value="The audio is not clear."><label class="report-label" for="audio">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/translate}}{{#judge}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li>{{#incorrect}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The given answer has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Correct translation"</b> is unnatural or has an error.{{/_i}}</label></li>{{/incorrect}}{{#has_audio}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="audio" value="The audio is not clear."><label class="report-label" for="audio">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/judge}}{{#form}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The given answer has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Translation"</b> is unnatural or has an error.{{/_i}}</label></li>{{#has_audio}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="audio" value="The audio is not clear."><label class="report-label" for="audio">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}{{/form}}{{#listen}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="audio" value="The audio is not clear."><label class="report-label" for="audio">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li><li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The Translation has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Translation"</b> is unnatural or has an error.{{/_i}}</label></li>{{/listen}}{{#speak}}{{#has_audio}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="audio" value="The audio is not clear."><label class="report-label" for="audio">{{#_i}}<b>The audio</b> does not sound correct.{{/_i}}</label></li>{{/has_audio}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The Translation has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Translation"</b> is unnatural or has an error.{{/_i}}</label></li>{{/speak}}{{#reverse_speak}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="original" value="The sentence is not grammatically correct."><label class="report-label" for="original">{{#_i}}<b>The {{#_ivar}}source_language_name{{/_ivar}} sentence</b> is unnatural or has an error.{{/_i}}</label></li><li class="hoverable"><input type="checkbox" class="report-checkbox border" id="translate" value="The Translation has a mistake."><label class="report-label" for="translate">{{#_i}}<b>The "Translation"</b> is unnatural or has an error.{{/_i}}</label></li>{{/reverse_speak}}{{#name}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="pictures" value="The pictures do not match the given word."><label class="report-label" for="pictures">{{#_i}}<b>The pictures</b> do not match the given word.{{/_i}}</label></li>{{/name}}{{#select}}<li class="hoverable"><input type="checkbox" class="report-checkbox border" id="pictures" value="The pictures do not match the given word."><label class="report-label" for="pictures">{{#_i}}<b>The picture</b> does not match the given word.{{/_i}}</label></li>{{/select}}<li><input type="checkbox" class="report-checkbox border" id="free-write"><textarea class="free-write-box animated-resizing textarea-block" type="text" style="text-transform: none" placeholder="{{#_i}}Have a different problem? Explain it here.{{/_i}}"></textarea></li>',
"report-tc-charge":' <!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e <html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Report TC Sale</title><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">\x3c/script><script type="text/javascript"> // Mixpanel (function(c,a){var b,d,h,e;b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src=("https:"===c.location.protocol?"https:":"http:")+\'//api.mixpanel.com/site_media/js/api/mixpanel.2.js\';d=c.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);a._i=[];a.init=function(b,c,f){function d(a,b){var c=b.split(".");2==c.length&&(a=a[c[0]],b=c[1]);a[b]=function(){a.push([b].concat(Array.prototype.slice.call(arguments,0)))}}var g=a;"undefined"!==typeof f?g= a[f]=[]:f="mixpanel";g.people=g.people||[];h="disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config people.set people.increment".split(" ");for(e=0;e<h.length;e++)d(g,h[e]);a._i.push([b,c,f])};a.__SV=1.1;window.mixpanel=a})(document,window.mixpanel||[]); mixpanel.init("2178e0df6f413afb8c43afe3bbd13f04", { disable_cookie: true }); \x3c/script><script> $(document).ready(function (){ $(\'#button\').click(function(){ mixpanel.track(\'tc_charge\', { type: \'bulk\', amount: $(\'#amount\').val(), }); $(\'#button\').attr(\'disabled\', \'disabled\'); }); }); \x3c/script><style> body { margin-left: 20px; margin-right:20px; }</style></head><body><h1>Report TC Sale</h1><div class="form-group"><label for="amount">Amount (US$)</label><input type="number" id="amount"></div><button type="submit" id="button" class="btn btn-default">Report Charge</button></body></html>',
reset:'<main class="main-center-narrow"><section class="page-main"><form action="" method="post" id="reset-form" style="margin: 0;"><input type="hidden" name="came_from" value="{{came_from}}"/><input type="hidden" id="email" name="email" value="{{email}}"/><input type="hidden" id="token" name="token" value="{{token}}"/><input type="hidden" name="came_from" value="{{came_from}}"/><h1 style="margin: 0 0 30px 0;">{{#_i}}Reset Password{{/_i}}</h1><input placeholder="{{#_i}}New Password{{/_i}}" class="input-block margin-bottom" id="new-password" name="new-password" size="30" type="password"><input placeholder="{{#_i}}Confirm New Password{{/_i}}" class="input-block margin-bottom" id="confirm-new-password" name="confirm-new-password" size="30" type="password"><div id=\'message\' class="warning-message hidden margin-bottom"></div><div id="reset-message" class="warning-message hidden margin-bottom"></div><input id="" type="submit" class="btn btn-lg btn-blue btn-block more-margin-bottom" value="{{#_i}}Submit{{/_i}}"/></form><div id="form_txt_good" class="form_msg hidden"><h1 style="">{{#_i}}Password Changed!{{/_i}}</h1><h2 style="text-align: center;"><a class="username" href="/" data-bypass>{{#_i}}Click here to continue to Duolingo{{/_i}}</a></h2></div></section></main> ',
reset_lang:'<button id="reset_cancel_button" type="reset" class="btn btn-standard right btn-enabled">{{#_i}}Cancel{{/_i}}</button><h1>{{#_i}}Reset or remove languages{{/_i}}</h1><ul class="reset-languages">{{#languages}}{{#learning}}<li><span class="flag flag-svg-small flag-{{language}}"></span><span>{{#_i}}<strong>{{#_ivar}}language_string{{/_ivar}}</strong> level {{level}}||list of curr languages in reset languages{{/_i}}</span><button id="remove-{{language}}" class="btn right btn-small reset-lang btn-red {{#allow_delete}}btn-enabled{{/allow_delete}} margin-left" {{^allow_delete}}disabled="disabled"{{/allow_delete}} data-value="{{language}}" data-delete="true">{{#_i}}Remove{{/_i}}</button><button id="reset-{{language}}" class="btn btn-blue btn-small right reset-lang btn-enabled" data-value="{{language}}" data-delete="false">{{#_i}}Reset progress{{/_i}}</button></li>{{/learning}}{{/languages}}</ul><p class="gray">{{#_i}}Be careful, removing a language gets rid of all your progress and can\u2019t be undone.{{/_i}}</p>',
"reverse-speak-element":'<div class="challenge-speak"><h1 class="player">{{#_i}}Click the microphone and translate to {{#_ivar}}target_language_name{{/_ivar}}:{{/_i}}</h1>{{^web_speech}}<h2 class="player">{{text}}</h2><div class="challenge-row"><div class="challenge-cell"><div id=\'audio-recorder\'><p><a href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="{{#_i}}Get Adobe Flash player{{/_i}}" /></a></p></div></div></div>{{/web_speech}}{{#web_speech}}<div class="challenge-row"><div class="challenge-cell chrome-speech"><div id="audio-recorder" class="speech-button"><button id="record-button" style="" class="btn btn-blue btn-outline btn-record"><span class="icon icon-microphone"></span></button><button id="stop-button" style="" class="hidden btn btn-blue btn-record"><span class="icon icon-stop"></span>{{#_i}}Stop{{/_i}}</button></div><div class="speech-input"><h2 class="player"><span class="flag flag-svg-small flag-{{source_language}}"></span><span id="original-text" class="hints translation-source"><bdi>{{text}}</bdi></span></h2><h2 class="player speech-underlined"><span class="flag flag-svg-small flag-{{target_language}}"></span><span id="web-speech-solution"></span></h2></div></div></div>{{/web_speech}}</div> ',
"revert-all-translations-from-user":'Have scheduled a task that will remove all translations from {{username}}. Do not reload this page! <br><br><a href="/diagnostics/user_translations?user={{username}}">Back to view translations from this user</a>',review_page:'<div class="close icon icon-close" data-dismiss="modal">close</div><div id="review-page"><h1 class="session-end">{{#_i}}Check out your scorecard!{{/_i}}</h1><h2 class="session-end review-instructions">{{#_i}}Click the tiles below to reveal the solutions{{/_i}}</h2><div class="table-wrap"><div class="review-container slide-in"><ul>{{#review_data}}<li class="challenge {{#correct}}correct{{/correct}}{{^correct}}wrong{{/correct}}" data-index="{{index}}" data-row={{row}} {{#alt_last}}data-alt-last=true{{/alt_last}}{{#last_row}}data-last=true{{/last_row}} data-track-click="review lesson tile"><span class="badge-{{#correct}}correct{{/correct}}{{^correct}}wrong{{/correct}}-micro"><span class="icon icon-{{#correct}}correct{{/correct}}{{^correct}}wrong{{/correct}}-micro"></span></span><span class="challenge-prompt">{{#select_challenge}}{{#_i}}Select translation of:{{/_i}}{{/select_challenge}}{{#translate_challenge}}{{#_i}}Translate this text:{{/_i}}{{/translate_challenge}}{{#form_challenge}}{{#_i}}Select the missing word:{{/_i}}{{/form_challenge}}{{#listen_challenge}}{{#_i}}Type what you hear:{{/_i}}{{/listen_challenge}}{{#name_challenge}}{{#_i}}Translate:{{/_i}}{{/name_challenge}}{{#speak_challenge}}{{#_i}}Speak:{{/_i}}{{/speak_challenge}}{{#reverse_speak_challenge}}{{#_i}}Translate and speak:{{/_i}}{{/reverse_speak_challenge}}{{#judge_challenge}}{{#_i}}Mark all correct translations:{{/_i}}{{/judge_challenge}}</span><br/><span class="prompt">{{^speak_challenge}}{{prompt}}{{/speak_challenge}}{{#speak_challenge}}{{correct_solution}}{{/speak_challenge}}{{#listen_challenge}}<div class="speaker-container"><span class="speaker-medium listen-{{index}}"></span></div>{{/listen_challenge}}</span><div class="popover below {{#right_align}}right-popover{{/right_align}} {{#left_align}}left-popover{{/left_align}}" {{#alt_last}}style="margin-bottom: 30px"{{/alt_last}}"><div class="arrow-top-small-container"><div class="arrow"></div></div><div class="close"></div><div class="inner"><div class="content"><div class="response"><h5>{{#_i}}Your response:{{/_i}}</h5>{{#skipped}}{{#_i}}Skipped{{/_i}}{{/skipped}}{{^skipped}}{{#judge_challenge}}{{#user_response}}<div class="{{#incorrect}}highlight{{/incorrect}}">{{#_i}}"{{sentence}}"{{/_i}}</div>{{/user_response}}{{/judge_challenge}}{{#speak}}{{#correct}}{{^mic_off}}{{#_i}}"{{correct_solution}}"{{/_i}}{{/mic_off}}{{#mic_off}}{{#_i}}Microphone turned off{{/_i}}{{/mic_off}}{{/correct}}{{^correct}}{{#_i}}Skipped{{/_i}}{{/correct}}{{/speak}}{{#form_challenge}}{{#correct}}{{#_i}}"<span id="user_response_{{index}}">{{correct_solution}}</span>"{{/_i}}{{/correct}}{{^correct}}{{#_i}}"<span id="user_response_{{index}}">{{user_response}}</span>"{{/_i}}{{/correct}}{{/form_challenge}}{{^judge_challenge}}{{^speak}}{{^form_challenge}}{{#_i}}"<span id="user_response_{{index}}">{{user_response}}</span>"{{/_i}}{{/form_challenge}}{{/speak}}{{/judge_challenge}}{{/skipped}}</div><div class="response"><h5>{{#_i}}Correct response:{{/_i}}</h5>{{#judge_challenge}}{{#correct_solution}}<div class="{{#missed}}correct_highlight{{/missed}}">{{#_i}}"{{sentence}}"{{/_i}}</div>{{/correct_solution}}{{/judge_challenge}}{{^judge_challenge}}{{#_i}}"<span id="correct_solution_{{index}}">{{correct_solution}}</span>"{{/_i}}{{/judge_challenge}}</div></div></div></div></li>{{/review_data}}</ul><div class="footer-owl hidden"><span class="owl owl-happy"></span></div></div></div><span id="discussion-modal-container"></span></div>',
"rupee-store":'<div class="store-awning-container"><h1 class="store-headline">{{#_i}}Lingot store{{/_i}}</h1><div class="store-awning"><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div><div class="band"><div class="flap"></div></div></div></div><button class="btn btn-white btn-outline right back-home leave-store" data-tab="skill-tree">{{#_i}}Leave store{{/_i}}</button><div style="overflow:hidden; position: relative">{{#trial_account}}<div class="trial-account-overlay"></div>{{/trial_account}}<div class="store-section"><h5 class="gray">{{#_i}}POWER-UPS{{/_i}}</h5><ul class="store-shelf"><li><span class="store-icon store-icon-streak-freeze"></span>{{#own_streak_freeze}}<a id=\'streak-purchase\' class="item-purchase btn btn-green purchased right" disabled="disabled"><span class="icon icon-check-white-small better-margin"></span> {{#_i}}Equipped{{/_i}}</a>{{/own_streak_freeze}}{{^own_streak_freeze}}<a id=\'streak-purchase\' class="item-purchase btn btn-green {{#afford_streak_freeze}}buy-item{{/afford_streak_freeze}}{{^afford_streak_freeze}}btn-outline{{/afford_streak_freeze}} right" data-type="streak_freeze" {{^afford_streak_freeze}}disabled="disabled" data-toggle="popover" data-popover="#afford-streak" data-placement="below"{{/afford_streak_freeze}}><span class="margin-right">{{#_i}}Get for:{{/_i}}</span><span class="icon icon-lingot-small"></span><span class="price">{{#prices}} {{streak_freeze}}{{/prices}}</span>{{^afford_streak_freeze}}<div id="afford-streak" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content">{{#_i}}You don\'t have enough lingots to get this item.{{/_i}}</div></div></div>{{/afford_streak_freeze}}</a>{{/own_streak_freeze}}<h4>{{#_i}}Streak Freeze{{/_i}}</h4><p>{{#_i}}Streak Freeze allows your streak to remain in place for one full day of inactivity.{{/_i}}</p></li><li><span class="store-icon store-icon-double"></span>{{#own_rupee_wager}}<a id=\'wager-purchase\' class="item-purchase btn btn-green right purchased" disabled="disabled">{{#_i}}Day {{wager_day}} of 7{{/_i}}</a>{{/own_rupee_wager}}{{^own_rupee_wager}}<a id=\'wager-purchase\' class="item-purchase btn btn-green {{#afford_rupee_wager}}buy-item{{/afford_rupee_wager}}{{^afford_rupee_wager}}btn-outline{{/afford_rupee_wager}} right" data-type="rupee_wager" {{^afford_rupee_wager}}disabled="disabled" data-toggle="popover" data-popover="#afford-wager" data-placement="below"{{/afford_rupee_wager}}><span class="margin-right">{{#_i}}Get for:{{/_i}}</span><span class="icon icon-lingot-small"></span><span class="price">{{#prices}} {{rupee_wager}}{{/prices}}</span>{{^afford_rupee_wager}}<div id="afford-wager" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content">{{#_i}}You don\'t have enough lingots to get this item.{{/_i}}</div></div></div>{{/afford_rupee_wager}}</a>{{/own_rupee_wager}}<h4>{{#_i}}Double or Nothing{{/_i}}</h4><p>{{#_i}}Attempt to double your five lingot wager by maintaining a seven day streak.{{/_i}}</p></li></ul></div><div class="store-section" id="practice"><h5 class="gray">{{#_i}}PRACTICE{{/_i}}</h5><ul class="store-shelf"><li><span class="store-icon store-icon-timed-practice"></span>{{#own_timed_practice}}<a id=\'practice-purchase\' class="item-purchase btn btn-green purchased right" disabled="disabled"><span class="icon icon-check-white-small better-margin"></span> {{#_i}}Equipped{{/_i}}</a>{{/own_timed_practice}}{{^own_timed_practice}}<a id=\'practice-purchase\' class="item-purchase btn btn-green {{#afford_timed_practice}}buy-item{{/afford_timed_practice}}{{^afford_timed_practice}}btn-outline{{/afford_timed_practice}} right" data-type="timed_practice" {{^afford_timed_practice}}disabled="disabled" data-toggle="popover" data-popover="#afford-practice" data-placement="below"{{/afford_timed_practice}}><span class="margin-right">{{#_i}}Get for:{{/_i}}</span><span class="icon icon-lingot-small"></span><span class="price">{{#prices}} {{timed_practice}}{{/prices}}</span>{{^afford_timed_practice}}<div id="afford-practice" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content">{{#_i}}You don\'t have enough lingots to get this item.{{/_i}}</div></div></div>{{/afford_timed_practice}}</a>{{/own_timed_practice}}<h4>{{#_i}}Timed Practice{{/_i}}</h4><p>{{#_i}}See how well you do practicing your skills against the clock in Timed Practice.{{/_i}}</p></li><li><span class="store-icon store-icon-progress"></span>{{#own_certification}}<a id=\'certification-purchase\' class="item-purchase btn btn-green purchased take-test right">{{#_i}}Take a quiz{{/_i}}</a>{{/own_certification}}{{^own_certification}}<a id=\'certification-purchase\' class="item-purchase btn btn-green {{#afford_certification}}buy-item{{/afford_certification}}{{^afford_certification}}btn-outline{{/afford_certification}} right" data-type="certification" {{^afford_certification}}disabled="disabled"{{/afford_certification}}><span class="margin-right">{{#_i}}Get for:{{/_i}}</span><span class="icon icon-lingot-small"></span><span class="price">{{#prices}} {{certification}}{{/prices}}</span>{{^afford_certification}}<div id="afford-certification" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content">{{#_i}}You don\'t have enough lingots to get this item.{{/_i}}</div></div></div>{{/afford_certification}}</a>{{/own_certification}}<h4>{{#_i}}{{#_ivar}}language_string{{/_ivar}} Progress Quiz{{/_i}}</h4><p>{{#_i}}Take an extended {{#_ivar}}language_string{{/_ivar}} quiz to measure your language learning progress.{{/_i}}{{#has_certificates}} {{#_i}}You can see your previous scores <a href="/settings/progress">here</a>.{{/_i}}{{/has_certificates}} </p></li></ul></div>{{#store_bonus_skills}}<div class="store-section" id="bonus"><h5 class="gray"><span class="left">{{#_i}}BONUS SKILLS{{/_i}}</span><span class="open-slots">{{#_i}}{{#pluralize}}{{slots}} slot open,{{slots}} slots open,{{slots}}{{/pluralize}}{{/_i}}</span></h5><ul class="store-shelf bonus-skill-items">{{#bonus_skills}}<li><span class="skill-icon small purple unlocked"><span class="skill-icon-image skill-icon-{{icon_index}}"></span></span>{{#own}}<a id=\'{{name}}-purchase\' class="item-purchase btn btn-green purchased right" disabled="disabled"><span class="icon icon-check-white-small better-margin"></span> {{#_i}}Equipped{{/_i}}</a>{{/own}}{{^own}}<a id=\'{{name}}-purchase\' class="item-purchase btn btn-green {{#afford}}buy-item show-tree{{/afford}}{{^afford}}btn-outline{{/afford}} right" data-type="{{name}}" data-tab="bonus-row"{{^afford}}disabled="disabled"{{/afford}}><span class="margin-right">{{#_i}}Get for:{{/_i}}</span><span class="icon icon-lingot-small"></span><span class="price">{{price}}</span>{{^afford}}<div id="afford-christmas" class="popover points-breakdown black top below"><div class="arrow"></div><div class="inner track-hover"><div class="content">{{^bonus_slot_available}}{{#_i}}You don\'t have room for any more bonus skills.{{/_i}}{{/bonus_slot_available}}{{#bonus_slot_available}}{{#_i}}You don\'t have enough lingots to get this item.{{/_i}}{{/bonus_slot_available}}</div></div></div>{{/afford}}</a>{{/own}}<h4>{{title}}</h4><p>{{^own}}{{description}}{{/own}}{{#own}}{{#_i}}You can find this skill in your skill tree now.{{/_i}}{{/own}}</p></li>{{/bonus_skills}}</ul></div>{{/store_bonus_skills}}<div id="store-help"><span class="question-rupee"></span><div class="store-text"><h4>{{#_i}}What is a lingot?{{/_i}} <span class="icon icon-lingot-small"></span></h4><span class="intro">{{#_i}}A <strong>lingot</strong> <i>[ling-guht]</i> is the Duolingo virtual currency. The more you learn on Duolingo, the more lingots you\'ll receive and be able to use in the store! They can be earned through:{{/_i}}</span><ul><li><strong class="title"><span class="store-earn">{{#_i}}Leveling up{{/_i}}</span></strong> <span class="store-desc">{{#_i}}Earn <strong>1 lingot</strong> <i>(multiplied by level reached)</i>{{/_i}}</span></li><li><strong class="title"><span class="store-earn">{{#_i}}Finishing a skill{{/_i}}</span></strong> <span class="store-desc">{{#_i}}Earn <strong>2 lingots</strong> for finishing a new skill{{/_i}}</span></li><li><strong class="title"><span class="store-earn">{{#_i}}10 day streaks{{/_i}}</span></strong> <span class="store-desc">{{#_i}}Earn <strong>1 lingot</strong> for every 10 days on a streak (1 for 10, 2 for 20, etc){{/_i}}</span></li><li><strong class="title"><span class="store-earn">{{#_i}}Inviting friends{{/_i}}</span></strong> <span class="store-desc">{{#_i}}Invite a friend to Duolingo and, if your friend accepts, you both will receive <strong>1 lingot</strong>{{/_i}}</span></li><li><strong class="title"><span class="store-earn">{{#_i}}Uploading documents{{/_i}}</span></strong> <span class="store-desc">{{#_i}}Upload a document to Immersion, and receive <strong>1 lingot</strong> every time someone upvotes your document{{/_i}}</span></li><li style="margin: 20px 0 0 0;">{{#_i}}Note: Lingots are not awarded when you use a tree shortcut to level up or finish a skill.{{/_i}}</li></ul></div></div></div>',
rupee_wager_description:"{{#_i}}Attempt to double your five lingot wager by maintaining a seven day streak.{{/_i}}",rupee_wager_title:"{{#_i}}Double or Nothing{{/_i}}","schools-help":'<section><div id="help" class="schools-help about-pages"></div></section><section class="bottom"><div class="content footer schools-help-footer">{{>footer}}</div></section>',"schools-logged-out-menu":'<header class="topbar topbar-schools-splash"><div class="container"><div class="logo-container"><a href="//www.duolingo.com" class="topbar-brand track-click blue">Duolingo</a><a class="lockup" href="/">{{#_i}}for schools{{/_i}}</a></div><div id="global-loading-indicator" class="loading-indicator" style="display: none;"><div class="white-spinner"></div></div>{{^logged_in}}<div class="topbar-right"><div class="topbar-username dropdown click-trigger" style="padding-bottom: 15px;"><div class="current-language" id="site-language-btn">{{#_i}}Site language:{{/_i}} <strong>{{#_i}}{{#_ivar}}ui_language_name{{/_ivar}}||capitalized{{/_i}}</strong><span class="icon icon-arrow-down-gray"></span></div><ul id="site-language-modal" class="double dropdown-menu arrow-top-right">{{#ui_languages_list}}<li class=\'ui-language-option\' data-id="{{id}}" data-abbrev="{{language}}"><a href="//{{id}}.duolingo.com" data-bypass><span class="flag flag-svg-micro flag-{{language}}"></span>{{label}}</a></li>{{/ui_languages_list}}</ul></div></div>{{/logged_in}}<div id="logged-out-message" class="logged-out-message"></div></div></header><div id="keyboard-shortcuts" class="modal keyboard-shortcuts fade"></div>',
"schools-splash":'<section class="welcome"><div class="content"><div class="headline"><p>{{#_i}}Bring the world\'s most popular language-learning platform to your classroom. No ads, 100% free.{{/_i}}</p><a class="btn btn-lg btn-blue" href="https://dashboard.duolingo.com/">{{#_i}}Get started{{/_i}}</a><span id="share-schools"><span class="btn btn-lg btn-standard btn-outline" data-toggle="dropdown">{{#_i}}Share with teacher{{/_i}}</span><ul class="dropdown-menu arrow-top"><li><a href="mailto:?body={{#_i}}Learn more about how to use Duolingo in your class or school at schools.duolingo.com.{{/_i}}&subject={{#_i}}Check out Duolingo for Schools!{{/_i}}" target="_blank"><img src="/images/progress/email.svg">{{#_i}}Email{{/_i}}</a></li><li><a data-partner="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fschools.duolingo.com&app_id=234536436609303" target="_blank"><img src="/images/testcenter/certificate/share_facebook.svg">{{#_i}}Facebook{{/_i}}</a></li><li><a data-partner="twitter" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fschools.duolingo.com&text={{#_i}}Check out Duolingo for Schools!{{/_i}}&via=duolingo" target="_blank"><img src="/images/testcenter/certificate/share_twitter.svg">{{#_i}}Twitter{{/_i}}</a></li><li><a data-partner="google" href="https://plus.google.com/share?url=https%3A%2F%2Fschools.duolingo.com" target="_blank"><img src="/images/testcenter/certificate/share_google.svg">{{#_i}}Google+{{/_i}}</a></li></ul></span></div><span class="school-icon class-img"></span></div></section><section class="duolingo-info"><div class="content"><p>{{#_i}}Over 50 million people around the world use Duolingo to help them learn languages. The fun, game-like lessons keep students motivated and excited about language. Best of all, as studies by the City University of New York and others have shown - it really works!{{/_i}}</p><div class="center"><a href="javascript:;" id="video-toggle" class="play-video"><span class="video"></span>{{#_i}}Watch video (1 min){{/_i}}</a><a href="http://static.duolingo.com/s3/DuolingoReport_Final.pdf" target="_blank"><span class="study"></span>{{#_i}}View effectiveness study{{/_i}}</a></div></div></section><section class="schools-info"><div class="content what-is"><div class="half"><h2>{{#_i}}What is Duolingo for Schools?{{/_i}}</h2><p>{{#_i}}Many teachers and even entire governments around the world already view Duolingo as the perfect blended learning companion for their classrooms. Duolingo lessons give each student personalized feedback and practice, preparing them to get the most out of classroom instruction.{{/_i}}</p><p>{{#_i}}Now teachers can track all their students in one place through our brand new dashboard.{{/_i}}</p></div><div class="half"><div class="owl-container"><span class="owl"></span></div><span class="school-icon dashboard-img"></span></div></div><div class="content teacher-method"><div class="half"><span class="school-icon school-students-img"></span></div><div class="half"><h2>{{#_i}}What do teachers recommend?{{/_i}}</h2><ul><li><h3>{{#_i}}Use Our Lesson Plan{{/_i}}</h3><p>{{#_i}}It\u2019s scientifically proven and heavily tested. Many teachers design their lessons around it.{{/_i}}</p></li><li><h3>{{#_i}}Assign it as Homework{{/_i}}</h3><p>{{#_i}}We recommend one Duolingo \u201cskill\u201d per week (a skill is a Duolingo unit like \u201cPlurals\u201d).{{/_i}}</p></li><li><h3>{{#_i}}Extra Credit{{/_i}}</h3><p>{{#_i}}Encourage students to learn and practice at their own pace. Award Extra Credit points for gaining Duolingo \u201cXP\u201d points and hitting other milestones.{{/_i}}</p></li></ul></div></div></section><section class="testimonials"><div class="content carousel slide" id="teacher-carousel" data-ride="carousel"><h2 class="center">{{#_i}}What are other teachers saying?{{/_i}}</h2><a href="javascript:;" data-target="#teacher-carousel" class="left-arrow" data-slide="prev"></a><a href="javascript:;" data-target="#teacher-carousel" class="right-arrow" data-slide="next"></a><ul class="carousel-inner" style="height: 200px"><li class="active item"><div class="slide-content"><div class="school-icon teacher-img"></div><div class="testimonial-content"><p>{{#_i}}"I am using Duolingo pretty much every day with my students. The game nature and the competition is something that they love. Most of my students are addicted to the app and I have to ask some to stop playing. Overall, Duolingo is a great success in my classroom so far."{{/_i}}</p><div class="credit"><p class="bold">Greg Smolinski</p><p class="gray">{{#_i}}7th-8th grade German Teacher{{/_i}}</p><p class="gray">Seneca Valley Middle School, PA</p></div></div></div></li><li class="item"><div class="slide-content"><div class="school-icon teacher-img"></div><div class="testimonial-content"><p>{{#_i}}\u201cDuolingo is perceived as being something fun to do. So, when we do it at the end of a class, the students almost see it as a reward for their previous work."{{/_i}}</p><div class="credit"><p class="bold">Veronique Balou-Kovalenko</p><p class="gray">{{#_i}}7th-8th grade French and Spanish Teacher{{/_i}}</p><p class="gray">Convent of the Sacred Heart, CT</p></div></div></div></li><li class="item"><div class="slide-content"><div class="school-icon teacher-img"></div><div class="testimonial-content"><p>{{#_i}}\u201cI have a wide range of ability levels in my class, which influences the speed of completion. Duolingo is one of the options for when students finish early. This frees me up to help the students who need the personalized attention most."{{/_i}}</p><div class="credit"><p class="bold">Lisa Butler</p><p class="gray">{{#_i}}6th-8th grade Spanish{{/_i}}</p><p class="gray">Hershey Middle School, PA</p></div></div></div></li><li class="item"><div class="slide-content"><div class="school-icon teacher-img"></div><div class="testimonial-content"><p>{{#_i}}\u201cI think it\u2019s great that they can work at their own rate. I love the way it gives immediate feedback and that it doesn\u2019t let go until the student has answered the question correctly."{{/_i}}</p><div class="credit"><p class="bold">Sandra Binion</p><p class="gray">SAU #6 Middle School, NH</p></div></div></div></li><li class="item"><div class="slide-content"><div class="school-icon teacher-img"></div><div class="testimonial-content"><p>{{#_i}}\u201cThe kids are getting a very nice review of words and it forces them to be conscious of spelling. Once, I was asking a question about a grammar point \u2013 many students yelled out the answer when I was thinking that only one or two would know it. I asked `How did you know this?\u2019 In unison, they yelled `Duolingo.\u2019 It was hilarious."{{/_i}}</p><div class="credit"><p class="bold">Michelle Kindt</p><p class="gray">{{#_i}}6th-8th grade French{{/_i}}</p><p class="gray">Hershey Middle School, PA</p></div></div></div></li></ul></div></section><section class="bottom"><div class="content center"><h2>{{#_i}}Start using the world\'s #1 language learning tool now, for free.{{/_i}}</h2><a class="btn btn-lg btn-blue" href="https://dashboard.duolingo.com/">{{#_i}}Get started{{/_i}}</a></div><div class="content footer">{{>footer}}</div></section>',
"section-edit-modal":'<div class="modal fade in" tabindex="-1" role="dialog"><div type="button" class="close" data-dismiss="modal" aria-hidden="true">\u00d7</div><div class="modal-content"><div class="modal-header"><h1 class="section-header">{{#_i}}Edit Section{{/_i}}</h1></div><div class="modal-body"><div class="input"><input class="large bulk-section-editor" id="section-editor" name="section" type="text" maxlength="45" placeholder="{{#_i}}Section or Class{{/_i}}"></div></div><div class="modal-footer"><button data-bb-handler="cancel" type="button" data-dismiss="modal" class="btn btn-standard btn-outline btn-default modal-close">{{#_i}}Cancel{{/_i}}</button><button id="save-bulk-edit" data-bb-handler="okay" type="button" class="btn margin-left btn-primary modal-success">{{#_i}}Save{{/_i}}</button></div></div></div> ',
"select-element":'<div class="challenge-select"><h1 class="player">{{#_i}}Select translation of \u201c{{hint}}\u201d{{/_i}}</h1><bdi><ul class="select-images select-images-list hover-effect">{{#options}}<li id="option-{{number}}" data-toggle="tooltip" title="{{#_i}}Press {{number}} to Select{{/_i}}" data-margin="5" data-delay=\'{"show":"100", "hide": "0"}\' ><label><div class="select-images-frame" style="background-image: url(\'{{image}}\')"></div><span class="number">{{number}}</span><input type="radio" class="player-radio" name="selection" value="{{phrase}}" data-number="{{number}}"><span class="title">{{phrase}}</span></label></li>{{/options}}</ul></bdi></div>{{#options}}<div id="speaker-{{number}}"></div>{{/options}}',
"self-service":'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner"><div class="translations-overview box-colored white"><h2>{{#_i}}Translations Overview{{/_i}}</h2><ul class="translations-progress"><li><span class="looks-good"></span>{{#_i}}{{#pluralize}}Completed translation,Completed translations,{{num_completed_translations}}{{/pluralize}}{{/_i}}<span class="right">{{num_completed_translations}}</span></li><li><span class="pending"></span>{{#_i}}{{#pluralize}}Pending translation,Pending translations,{{num_pending_translations}}{{/pluralize}}{{/_i}}<span class="right">{{num_pending_translations}}</span></li></ul><hr>{{#_i}}Total cost this month: ${{total_cost_this_month}}{{/_i}}</div><div class="box-gray"><h2>{{#_i}}Progress{{/_i}}</h2><ul class="list-checkable"><li><input class="border" type="checkbox" class="border" id="progress_pending" checked><label>{{#_i}}Pending{{/_i}}</label></li><li><input class="border" type="checkbox" class="border" id="progress_finished" checked><label>{{#_i}}Finished{{/_i}}</label></li></ul></div><p>{{#_i}}If you need assistance, feel free to email us at <a href="mailto:help-translation@duolingo.com">help-translation@duolingo.com</a>{{/_i}}</p></div></section><section class="page-main main-right translations-main"><div style="height:80px;"><button type="button" class="btn btn-green right" id="upload-document">{{#_i}}Upload a document{{/_i}}</button><h1>{{#_i}}Translations{{/_i}}</h1>\x3c!-- <div class="search-uploads"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="{{#_i}}Search{{/_i}}" class="search-box" id="search-comments" maxlength="50"/><div class="clear-button btn" style="display : none">x</div></div> --\x3e</div><div class="translate-main" id="translation-tabs"><ul class="tabs big nav-tabs" style="position: relative; z-index: 1;"><li class="active" data-tab="uploaded"><a href="javascript:;">{{#_i}}All Translations{{/_i}}</a></li><li class="active" data-tab="monthly"><label class="green-select no-focus smaller"><select><option value="none" class="hidden" selected>{{#_i}}View by Month{{/_i}}</option></select></label></li></ul><div id="uploaded-tab" class="panel"></div><div id="monthly-tab" class="panel"></div></div></section>{{>footer}}</main> ',
"self-service-api":'<title>Duolingo translation API</title><h1>Welcome to the Duolingo translation API!</h1> To upload a document, POST a request to <a href="http://translations.duolingo.com/upload_api">http://translations.duolingo.com/upload_api</a>. The request has the following parameters. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th style="width: 20%">Parameter</th><th style="width: 30%">Type</th><th>Description</th></tr></thead><tbody><tr><td><tt>source_language</tt></td><td>Required</td><td>ISO code for language the document is in (for example, \'en\' for English)</td></tr><tr><td><tt><tt>target_language</tt></td><td>Required</td><td>ISO code for language into which the document should be translated</td></tr><tr><td><tt>url</tt></td><td>Required if <tt>url</tt> is not specified</td><td>the URL of the document to translate. If <tt>text</tt> is not specified, the document content is loaded from this URL.</td></tr><tr><td><tt>text</tt></td><td>Required if <tt>url</tt> is not specified</td><td>the document in plain text format</td></tr><tr><td><tt>title</tt></td><td>Required if <tt>url</tt> is not specified</td><td>the document title</td></tr><tr><td><tt>image_url</tt></td><td>Optional</td><td>URL of lead image for document</td></tr><tr><td><tt>category</tt></td><td>Optional</td><td>The category into which the document should be placed. Valid categories are: {{#categories}}{{#last}}and {{/last}}<tt>{{category}}</tt>{{^last}}, {{/last}}{{/categories}}</td></tr></tbody></table><br> The server will return a JSON response with the following fields. <br><br><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th style="width:50%">Field</th><th style="width:50%">Description</th></tr></thead><tbody><tr><td><tt>success</tt></td><td>True if the upload succeeded, False otherwise</td></tr><tr><td><tt>error_message</tt></td><td>An error message explaining why the upload failed (only returned if success=False)</td></tr><tr><td><tt>translation_id</tt></td><td>ID of translation (only returned if success=True)</td></tr><tr><td><tt>charge_us_dollars</tt></td><td>The amount charged to your credit card, in US dollars (only returned if success=True)</td></tr></tbody></table><br> Note that for your upload to succeed, you must have a credit card on file with us. You can establish your credit card information by uploading a document manually via <a href="http://translations.duolingo.com/upload">http://translations.duolingo.com/upload</a>. {{#show_form}}<hr><h2>Test form (only shown because you are Duolingo staff)</h2><form method="POST"> source_language: <input name="source_language"><br>target_language: <input name="target_language"><br>URL: <input name="url"><br>text: <input name="text" type="textarea"><br>title: <input name="title"><br>image_url: <input name="image_url"><br><input type="submit" value="Submit"></form>{{/show_form}}',
"self-service-input":'<div class="form-row"><div class="step-number"><span class="icon icon-words-small">1</span></div><div><p>{{#_i}}How would you like to upload your content?{{/_i}}</p><label class="blue-select no-focus smaller"><select id="input-type"><option value=\'url\'>{{#_i}}URL{{/_i}}</option><option value=\'paste\'>{{#_i}}Paste Text{{/_i}}</option>\x3c!-- <option value=\'file\'>{{#_i}}File Upload{{/_i}}</option> --\x3e</select></label></div></div><div id="self-service-file" class="self-service-type-input"><div class="step-number"><span class="icon icon-words-small">2</span></div><div><div class="form-row"><p>{{#_i}}Select your file for upload. Valid file types are .doc, .docx, .odt, .rtf, and .txt.{{/_i}}</p><button type="button" id="file-button" class="btn btn-large btn-standard">{{#_i}}Choose file{{/_i}}</button></div></div></div><div id="self-service-paste" class="self-service-type-input"><div class="step-number"><span class="icon icon-words-small">2</span></div><div><div class="form-row"><p>{{#_i}}Please provide a headline for your content.{{/_i}}</p><input type="text" id="article-headline" placeholder="Headline"></input></div></div><div class="step-number"><span class="icon icon-words-small">3</span></div><div><div class="form-row"><p>{{#_i}}Paste the body text of your content.{{/_i}}<span style="float: right;">{{#_i}}Word count:{{/_i}} <span id="word-count">{{count}}</span>, {{#_i}}Estimated cost:{{/_i}} $<span id="cost">{{cost}}</span></p><textarea id="article-body" placeholder="{{#_i}}Body text{{/_i}}"></textarea></div></div><div class="step-number"><span class="icon icon-words-small">4</span></div><div><div class="form-row"><p>{{#_i}}Enter an image url (optional).{{/_i}}</p><input type="text" id="image-url"></input></div></div><div class="step-number"><span class="icon icon-words-small">5</span></div><div><div class="form-row"><p>{{#_i}}Enter a document url (optional).{{/_i}}</p><input type="text" id="document-url"></input></div></div></div><div id="self-service-url" class="self-service-type-input"><div class="step-number"><span class="icon icon-words-small">2</span></div><div><div class="form-row"><p>{{#_i}}Where is your content located on the web?{{/_i}}</p><input type="text" id="url" placeholder="{{#_i}}Content web address{{/_i}}"></input></div></div></div>{{#cnn}}<div class="form-row"><div class="step-number"><span class="icon icon-words-small">3</span></div><div><p>{{#_i}}What priority level does this document have?{{/_i}}</p><label class="blue-select no-focus smaller"><select id="priority"><option value=\'0\'>{{#_i}}Low{{/_i}}</option><option value=\'1\'>{{#_i}}Medium{{/_i}}</option><option value=\'2\'>{{#_i}}High{{/_i}}</option></select></label></div></div>{{/cnn}}<div><p id="input-errors" class="left hidden"></p><button type="button" id="continue-input" class="btn right btn-large btn-primary" data-wait="{{#_i}}Loading...{{/_i}}">{{#_i}}Continue{{/_i}}</button></div> ',
"self-service-item":'<div class="list-document-item-right"><span class="payment-info"><div class="payment-info-arrow"></div><div>{{#_i}}{{num_words}} words{{/_i}}</div><div>{{#_i}}${{total_cost}}{{/_i}}</div></span><div class="translation-progress">{{#finished}}<a href="javascript:;" data-job="{{translate_job_id}}">{{#_i}}Download{{/_i}}</a>{{/finished}}{{^finished}}{{#_i}}{{percent_high_quality}}% translated{{/_i}}{{/finished}}</div></div>{{#document}}{{#preview_image}}<div class="immersion-teaser-image" style="background-image: url( \'{{preview_image}}\')"></div>{{/preview_image}}{{^preview_image}}<div class="immersion-teaser-image owl-default"></div>{{/preview_image}}{{/document}}<header class="list-document-item-header">{{#document}}{{title}}{{/document}}</header><div><span class="list-document-item-desc">{{published_date}} | {{#_i}}{{#_ivar}}language_name{{/_ivar}}||capitalized{{/_i}} > {{#_i}}{{#_ivar}}target_language_name{{/_ivar}}||capitalized{{/_i}}</span><span class="translator-tier-flag-micro"><span class="double-flag-source flag flag-svg-micro flag-{{#document}}{{language}}{{/document}}"></span><span class="double-flag-target flag flag-svg-micro flag-{{target_language}}"></span></span></div> ',
"self-service-logged-out-menu":'<header class="topbar topbar-self-service-splash"><div class="container"><a href="//www.duolingo.com" class="topbar-brand track-click white">Duolingo</a><a class="left" href="/">{{#_i}}Translations{{/_i}}</a><div id="global-loading-indicator" class="loading-indicator" style="display: none;"><div class="dark-spinner"></div></div><div class="topbar-right">{{#username}}<span class="btn btn-green" onclick="location.href=\'/logout\';">{{#_i}}Logout{{/_i}}</span>{{/username}}{{^username}}<div class="topbar-username dropdown click-trigger" style="padding-bottom: 15px;"><div class="current-language" id="site-language-btn">{{#_i}}Site language:{{/_i}} <strong>{{#_i}}{{#_ivar}}ui_language_name{{/_ivar}}||capitalized{{/_i}}</strong><span class="icon icon-arrow-down-gray"></span></div><ul id="site-language-modal" class="dropdown-menu arrow-top" style="min-width: 200px; left: 0; right: auto; margin-top: 0px; z-index: 101;"><li class=\'ui-language-option\' data-id="en" data-abbrev="en"><a href="/en" data-bypass="true">English</a></li><li class=\'ui-language-option\' data-id="es" data-abbrev="es"><a href="/es" data-bypass="true">Espa\u00f1ol</a></li><li class=\'ui-language-option\' data-id="fr" data-abbrev="fr"><a href="/fr" data-bypass="true">Fran\u00e7ais</a></li><li class=\'ui-language-option\' data-id="pt" data-abbrev="pt"><a href="/pt" data-bypass="true">Portugu\u00eas</a></li></ul></div><div class="topbar-buttons" style="margin-top: 1px;"><span class="sign-in relative"><span class="btn btn-green sign-in-btn" id="sign-in-btn">{{#_i}}Login{{/_i}}</span><ul class="popover arrow-top login-popover hidden" id="login-modal" style="width: 240px; right:0; top: 40px; left: auto;"><li id="auth-callback" class="hidden"></li><form id=\'login-form\' action="" method="post" accept-charset="utf-8" style="margin: 0;"><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Username or email{{/_i}}" type="text" id="top_login" name="login" value="" autocomplete="on"/></div></li><li><div class="form-row"><input class="input-small input-block" placeholder="{{#_i}}Password{{/_i}}" type="password" id="top_password" name="password" value="" autocomplete="on"/></div></li><li id="message" class="login-fail hidden"></li><li><input id="login-button" class="btn btn-green btn-small sign-in btn-block" type="submit" value="{{#_i}}Login{{/_i}}"></li><li class="center"><a href="/forgot_password">{{#_i}}Forgot password{{/_i}}</a></li></form></ul></span></div>{{/username}}</div><div id="logged-out-message" class="logged-out-message"></div></div></header><div id="keyboard-shortcuts" class="modal keyboard-shortcuts fade"></div> ',
"self-service-menu":'<header class="topbar topbar-self-service"><div class="container"><a href="//www.duolingo.com" class="topbar-brand track-click white">Duolingo</a><div id="global-loading-indicator" class="loading-indicator" style="display: none;"><div class="dark-spinner"></div></div><a href="/" class="left">{{#_i}}Translations{{/_i}}</a><div class="topbar-right"><div class="dropdown topbar-username"><div data-toggle="dropdown" class="">{{>avatar_small}}<span class="name">{{username}}</span><span class="icon icon-arrow-down-white"></span></div><ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel"><li><a href="/logout" class="track-click" id="header_userdrop_logout" data-bypass>{{#_i}}Logout{{/_i}}</a></li></ul></div></div></div></header> ',
"self-service-pay":'<form action="" method="POST" id="payment-form"><h2 class="center">{{#_i}}Please confirm your transaction details!{{/_i}}</h2><div class="pay-panel"><div class="pay-amount"><div class="pay-arrow"></div><h4>$<span id="confirm-cost"></span></h4><p><span id="confirm-words"></span> {{#_i}}words{{/_i}}</p></div><div class="pay-summary"><h6>{{#_i}}Headline:{{/_i}}</h6><p id="confirm-headline"></p><h6>{{#_i}}Category:{{/_i}}</h6><p id="confirm-category"></p><h6>{{#_i}}Translate into:{{/_i}}</h6><p id="confirm-language"></p></div></div><div id="payment-choice" class="form-row"><div id="submit-container" class="right"><h5>&nbsp;</h5><button type="button" id="stripe-button" class="btn btn-large btn-primary" data-wait="{{#_i}}Please wait...{{/_i}}">{{#_i}}Submit{{/_i}}</button></div><div><h5>{{#_i}}Payment method{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="cards"><option value="New">{{#_i}}New credit card...{{/_i}}</option></select></label></div></div><div id="card-fields" class="form-row"><input id="card-month" type="hidden" data-stripe="exp_month"></input><input id="card-year" type="hidden" data-stripe="exp_year"></input><div class="col"><h5>{{#_i}}Credit card number{{/_i}}</h5><input id="card-number" type="text" size="24" data-stripe="number"></input></div><div class="col"><h5>{{#_i}}Expires{{/_i}}</h5><input id="card-expiry" type="text" size="10" placeholder="{{#_i}}MM / YY{{/_i}}"></input></div><div class="col"><h5>{{#_i}}CVC{{/_i}}</h5><input id="card-cvc" type="text" size="7" data-stripe="cvc"></input></div></div><p id="payment-errors"{{^charged_monthly}} class="hidden"{{/charged_monthly}}>{{#_i}}(You will not be charged until the first day of the following month.){{/_i}}</p></form> ',
"self-service-preview":'<div class="upload-panel preview-panel"><div id="preview-text" class="wiki-document-body">{{#custom_html}}{{{custom_html}}}{{/custom_html}}{{^custom_html}}<h3>{{title}}</h3><span class="flat-image-wrapper"><a class="fbox fancybox.image" rel="group" href="{{image_url}}" target="_blank" style="display: inline; height: 100%;"><img src="{{image_url}}" class="image-thumb"></a></span>{{#paragraphs}}<p>{{paragraph_text}}</p>{{/paragraphs}}{{/custom_html}}</div><div class="footer"><div class="form-row"><div class="col-left"><h5>{{#_i}}Pick a category that best fits:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="category"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#categories}}<option value="{{id}}" {{#selected}}selected{{/selected}}>{{#_ivar}}label{{/_ivar}}</option>{{/categories}}</select></label></div><div class="col-right"><h5>{{#_i}}Translate into this language:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="language"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#target_languages}}<option value="{{id}}}" {{#selected}}selected{{/selected}}>{{#_ivar}}name{{/_ivar}}</option>{{/target_languages}}</select></label></div></div><button type="button" id="edit" class="btn left btn-standard btn-large make-edits edit-preview">{{#_i}}Edit{{/_i}}</button><button type="button" id="continue-preview" class="btn right btn-large btn-primary" style="margin-left: 10px;" data-wait="{{#_i}}Loading...{{/_i}}">{{#_i}}Continue{{/_i}}</button><button type="button" id="cancel-upload" class="btn right btn-large btn-standard cancel-preview">{{#_i}}Cancel{{/_i}}</button><div id="upload-failure" class="hidden">{{#_i}}Your document failed to upload, please try a different webpage:{{/_i}}<ul><li id="error-message">{{#_ivar}}upload_failure_reason{{/_ivar}}</li></ul></div></div></div> ',
"self-service-splash":'<div class="welcome"><span class="globe"></span><div class="right"><h1>{{#_i}}Welcome to the future of translation.{{/_i}}</h1><p>{{#_i}}Translate anything you want. Support free education.{{/_i}}</p><button class="btn btn-white">{{#_i}}Request Invitation to Beta{{/_i}}</button></div></div><h1 id="thankyou" class="hidden center">{{#_i}}Thanks for signing up!{{/_i}}</h1><div class="request-form hidden"><table><tbody><tr><td><strong>{{#_i}}Name of company{{/_i}}</strong></td><td><input id="request-company" type="text"></td></tr><tr><td><strong>{{#_i}}E-mail address{{/_i}}</strong></td><td><input id="request-email" type="text"></td></tr><tr><td><strong>{{#_i}}Sample content{{/_i}}</strong><p>{{#_i}}Please provide a web address{{/_i}}</p></td><td><textarea id="request-sample"></textarea></td></tr><tr><td><strong>{{#_i}}What can we translate for you?{{/_i}}</strong><p>{{#_i}}Please describe the content you want translated, your desired languages, preferred turnaround time, and expected number of words.{{/_i}}</p></td><td><textarea id="request-description"></textarea></td></tr></tbody></table><div class="center"><button class="btn btn-white" data-wait="{{#_i}}Sending...{{/_i}}" data-fail="{{#_i}}Request Failed{{/_i}}">{{#_i}}Send Request{{/_i}}</button></div></div><div class="content"><h2 class="center">{{#_i}}Translate with Duolingo{{/_i}}</h2><section class="features"><div class="feature"><span class="feature-icon coin"></span><p>{{#_i}}Only 4 cents per word{{/_i}}</p></div><div class="feature"><span class="feature-icon time"></span><p>{{#_i}}24-hour turnaround{{/_i}}</p></div><div class="feature"><span class="feature-icon globe"></span><p>{{#_i}}Translate and help millions learn languages for free{{/_i}}</p></div><div class="feature"><span class="feature-icon gear"></span><p>{{#_i}}Seamless API integration{{/_i}}</p></div></section><section class="client-info"><h2 class="center">{{#_i}}Verified Quality{{/_i}}</h2><p>{{#_i}}Duolingo translations are used by a number of international media corporations. While one translator can make human mistakes, our translations are done collaboratively by a large group of people and verified by professionals for perfection. <a href="/">Read some samples ></a>{{/_i}}</p></section><section id="callout-directions" class="callout"><div id="available-languages" class="callout-left"><div><label class="green-select no-focus"><select><option value="en">{{#_i}}English||capitalized{{/_i}}</option><option value="es">{{#_i}}Spanish||capitalized{{/_i}}</option><option value="fr">{{#_i}}French||capitalized{{/_i}}</option><option value="pt">{{#_i}}Portuguese||capitalized{{/_i}}</option></select></label><span class="language-arrow"></span></div><table class="available-en"><tbody><tr><td><span class="flag flag-es-micro"></span>{{#_i}}Spanish||capitalized{{/_i}}</td><td><span class="flag flag-fr-micro"></span>{{#_i}}French||capitalized{{/_i}}</td></tr><tr><td><span class="flag flag-pt-micro"></span>{{#_i}}Portuguese||capitalized{{/_i}}</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table><table class="available-es hidden"><tbody><tr><td><span class="flag flag-en-micro"></span>{{#_i}}English||capitalized{{/_i}}</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td colspan="2" class="center more-incubator">{{#_i}}More languages coming soon in our <a href="http://incubator.duolingo.com/">Incubator</a>!{{/_i}}</td></tr></tbody></table><table class="available-fr hidden"><tbody><tr><td><span class="flag flag-en-micro"></span>{{#_i}}English||capitalized{{/_i}}</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td colspan="2" class="center more-incubator">{{#_i}}More languages coming soon in our <a href="http://incubator.duolingo.com/">Incubator</a>!{{/_i}}</td></tr></tbody></table><table class="available-pt hidden"><tbody><tr><td><span class="flag flag-en-micro"></span>{{#_i}}English||capitalized{{/_i}}</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td colspan="2" class="center more-incubator">{{#_i}}More languages coming soon in our <a href="http://incubator.duolingo.com/">Incubator</a>!{{/_i}}</td></tr></tbody></table></div><div class="callout-right"><h2>{{#_i}}Growing language offerings{{/_i}}</h2><p>{{#_i}}Duolingo already translates to and from popular languages, with more options becoming available soon.{{/_i}}</p></div></section><section id="callout-method" class="callout topborder"><div class="callout-left"><h2>{{#_i}}A revolutionary method{{/_i}}</h2><p>{{#_i}}Duolingo students are motivated to collaborate on translations by the opportunity to sharpen their language skills through real-world content. Students submit translations, review those created by others and vote on the most accurate submissions. Finally, Duolingo selects trusted editors to approve each translated document before submission. This iterative review process ensures the creation of very accurate translations.{{/_i}}</p></div><div class="callout-right"><img class="computer" src="/images/self-service/computer.svg"/></div></section><section id="callout-api" class="callout topborder"><div class="callout-left"><img class="console" src="/images/self-service/console.svg"/></div><div class="callout-right"><h2>{{#_i}}Translate at scale{{/_i}}</h2><p>{{#_i}}We offer a robust API you can easily integrate into your company\'s workflow for high-volume integration. It\'s plug and play at its best!{{/_i}}</p></div></section></div><div class="bottom"><h2 class="center">{{#_i}}Start translating today.{{/_i}}</h2><button class="btn btn-white">{{#_i}}Request Invitation to Beta{{/_i}}</button></div>{{>footer}} ',
"self-service-upload":'<main class="main-left"><section class="page-sidebar sidebar-right"><div class="inner"><div class="box-gray"><h2>{{#_i}}How does it work?{{/_i}}</h2><p>{{#_i}}You upload a document and language learners interact with it on Duolingo to translate it to the required language. It\u2019s fast and accurate.{{/_i}}</p><div class="owl owl-happy owl-small"></div></div></div></section><section class="page-main main-left"><h6 class="back-link"><span class="icon icon-back-gray"></span> <a href="/">{{#_i}}Translations{{/_i}}</a></h6><ul class="nav-tabs upload-tabs"><li class="active step-tab input-step" data-tab="input" data-index=1 id="input"><a href="javascript:;">{{#_i}}Upload{{/_i}}</a></li><li class="inactive step-tab prev-step" data-tab="prev" data-index=2 id="prev"><a href="javascript:;">{{#_i}}Preview{{/_i}}</a></li><li class="inactive step-tab pay-step" data-tab="type" data-index=3 id="pay"><a href="javascript:;">{{#_i}}Pay &amp; Submit{{/_i}}</a></li></ul><div id="self-service-input-step" class="panel"></div><div id="self-service-prev-step" class="panel"></div><div id="self-service-pay-step" class="panel"></div></section></main><span id="confirm-message-window" class="hidden">{{#_i}}You haven\'t submitted yet!{{/_i}}</span><span id="confirm-message-link" class="hidden">{{#_i}}You haven\'t submitted yet! Are you sure you want to leave this page?{{/_i}}</span>{{>footer}}<script src="https://js.stripe.com/v2/">\x3c/script> ',
session:'<div class="player-inner"><section class="player-container slide-in">{{>player-header}}<div class="player-main"><div id="prev-session-element-container" class=""></div><div id="session-element-container"></div><div class="intro"></div></div><footer id="controls" class="player-footer {{#web_strength_v2_experiment_true}}v2{{/web_strength_v2_experiment_true}}">{{#requires_ready}}<div class="right ready-panel">{{#placement_test}}<button id="start-button" type="submit" class="btn success btn-lg right" tabindex="10">{{#_i}}Start the test{{/_i}}</button>{{/placement_test}}{{#certification_test}}<button id="start-button" type="submit" class="btn success btn-lg right" tabindex="10">{{#_i}}Start the quiz{{/_i}}</button>{{/certification_test}}{{^placement_test}}{{^certification_test}}{{#owned_timed_practice}}<button id="start-button" type="submit" class="btn btn-green btn-lg right" tabindex="10">{{#_i}}Start timed practice{{/_i}}</button>{{#allow_opt_out}}<button id="untimed-button" type="submit" class="btn btn-blue btn-lg right margin-right" tabindex="10">{{#_i}}Practice without a timer{{/_i}}</button>{{/allow_opt_out}}{{/owned_timed_practice}}{{^owned_timed_practice}}<button id="untimed-button" type="submit" class="btn btn-lg btn-blue right margin-right" tabindex="10">{{#_i}}Practice{{/_i}}</button>{{/owned_timed_practice}}{{/certification_test}}{{/placement_test}}</div>{{/requires_ready}}<div class="col-right {{#requires_ready}}action-panel hidden{{/requires_ready}}"><span class="more-padding-left"><button id="next_button" type="submit" data-toggle="tooltip" title="{{#_i}}Press Enter to Check{{/_i}}" class="btn btn-green btn-lg redesign-check has-tooltip" disabled="disabled" data-margin="5" tabindex="20" data-delay=\'{"show":"100", "hide": "0"}\'>{{#_i}}Check{{/_i}}</button></span></div><div class="col-left"><button id="skip_button" style="border-color: #CCCCCC;" class="{{#requires_ready}}hidden{{/requires_ready}} btn btn-outline btn-standard btn-lg left skip-margin skip-button" tabindex="30">{{#_i}}Skip{{/_i}}</button><button id="no-mic-link" style="display: none;" type="submit" class="btn btn-lg {{^web_strength_v2_experiment_true}}btn-white{{/web_strength_v2_experiment_true}} left hidden skip-margin {{#web_strength_v2_experiment_true}}btn-outline btn-standard{{/web_strength_v2_experiment_true}}" tabindex="10">{{#_i}}I don\'t want to use a microphone{{/_i}}</button><div id="grade" ></div></div></footer><div id="no-sound-modal" class="modal hidden fade" style="margin-top: -200px;"><div class="modal-header"><h4>{{#_i}}We can\'t play sound in your browser.{{/_i}}</h4><div class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"></div></div><div id="modal-notification" class="modal hidden fade"></div></section></div>{{>footer}} ',
"session-explanation":'<div class="tips-and-notes">{{#web_strength_v2_experiment_true}}<span class="icon icon-lightbulb"></span>{{/web_strength_v2_experiment_true}}{{#_i}}Tips & notes{{/_i}}</div><div class="popover below popover-tips-and-notes"><div class="arrow-top-small-container"><div class="arrow"></div></div><div class="close"></div><div class="inner"><div class="content">{{{explanation}}}</div></div></div>',"session-failed":'<div class="player-inner"><div class="player-container" style="opacity: 1;">{{>player-header}}<div class="player-main"><div id="session-element-container"><h1 class="player" style="margin-bottom: 20px;">{{#learning_es}}<strong>\u00a1Ay!</strong>{{/learning_es}}{{#learning_de}}<strong>Verflixt!</strong>{{/learning_de}}{{#learning_fr}}<strong>Oups !</strong>{{/learning_fr}}{{#learning_en}}<strong>Ouch!</strong>{{/learning_en}}{{#learning_pt}}<strong>Ui!</strong>{{/learning_pt}}{{#learning_it}}<strong>Cavolo!</strong>{{/learning_it}} &nbsp; {{#none_correct}}{{#_i}}You didn\'t get any answers correct.{{/_i}}{{/none_correct}}{{^none_correct}}{{#no_placement}}{{#_i}}You didn\'t test out of any skills.{{/_i}}{{/no_placement}}{{^no_placement}}{{#times_up}}{{#_i}}You ran out of time!{{/_i}}{{/times_up}}{{^times_up}}{{#_i}}You are out of hearts!{{/_i}}{{/times_up}}{{/no_placement}}{{/none_correct}}<div class="close-fail">{{#_i}}Show my answer{{/_i}}</div></h1><div class="illustration-session-failed"></div></div></div><footer id="controls" class="player-footer"><div class="col-right">{{#no_placement}}<button id="home-button-reload" class="btn btn-lg right btn-primary">{{#_i}}End{{/_i}}</button>{{/no_placement}}{{^no_placement}}<button id="home-button" class="btn btn-lg right btn-primary btn-green">{{#_i}}Go back to home{{/_i}}</button>{{/no_placement}}</div><div class="col-left"><div id="grade"></div></div></footer></div></div>{{>footer}} ',
"session-hearts":'<ul class="player-header-hearts" data-toggle="tooltip" title="{{#_i}}Don\'t make more than {{num_hearts}} {{#pluralize}}mistake,mistakes,{{num_hearts}}{{/pluralize}} or you\'ll have to start over!{{/_i}}">{{#hearts}}<li><span id="heart-{{index}}" class="icon icon-heart-medium"></span><span class="icon icon-heart-medium-gray"></span></li>{{/hearts}}</ul>',"session-scoreboard":'<span class="avatar" style="top:8px; left:7px; display:inline-block; position:relative; float:left"><a href="/vicki" title="vicki" class="medium-circular-avatar avatar"><img src="https://www.duolingo.com/avatars/{{opponent_id}}/medium"></a></span><span class="score"><span class="wrong-answers">0</span><span> - </span><span class="right-answers">0</span></span>',
"set-trusted-translator-days-off":"Your changes have been saved.",settings:'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner"><div class="box-colored white">{{^trial_account}}<h2 class="view-profile-headline">{{>avatar_small}} {{username}} <a href="/{{username}}" class="username">{{#_i}}View your profile{{/_i}}</a></h2>{{/trial_account}}<ul id="settings_tab" class="nav-sidebar">{{^trial_account}}<li><a href="/settings/account" id="account_tab">{{#_i}}Account{{/_i}}</a></li>{{/trial_account}}<li><a href="/settings/direction" id="direction_tab">{{#_i}}Learning language{{/_i}}</a></li>{{^trial_account}}<li><a href="/settings/profile" id="profile_tab">{{#_i}}Profile{{/_i}}</a></li><li><a href="/settings/password" id="password_tab">{{#_i}}Password{{/_i}}</a></li><li><a href="/settings/notifications" id="notifications_tab">{{#_i}}Notifications{{/_i}}</a></li>{{#has_certificates}}<li><a href="/settings/progress" id="progress_tab">{{#_i}}Quiz History{{/_i}}</a></li>{{/has_certificates}}{{/trial_account}}{{#trial_account}}<li><a href="/settings/sound" id="sound_tab">{{#_i}}Sound{{/_i}}</a></li>{{/trial_account}}<li><a href="/settings/coach" id="coach_tab">{{#_i}}Coach{{/_i}}<span class="icon-arrow-right icon"></span></a></li>{{^trial_account}}<li><a href="/settings/observer" id="observer_tab">{{#_i}}Progress Sharing{{/_i}}<span class="icon-arrow-right icon"></span></a></li>{{/trial_account}}</ul></div></div></section><section class="page-main main-right"><div id=\'tab-container\'></div></section>{{>footer}}</main> ',
settings_profile:'<div id="profile-content" class="settings-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1>{{#_i}}Profile{{/_i}}</h1><ul class="list-settings"><li><label class="label">{{#_i}}Fullname{{/_i}}</label><div class="input"><input class="large" id="fullname" name="fullname" size="30" type="text" style="width: 334px;" value="{{fullname}}"></div></li><li><label class="label">{{#_i}}Location{{/_i}}</label><div class="input"><input class="large" id="location" name="location" size="30" type="text" style="width: 334px;" value="{{location}}"></div></li><li><label class="label">{{#_i}}Bio{{/_i}}</label><div class="input"><textarea id="bio" name="bio" rows="3" cols="40" style="margin-bottom: 10px; width: 334px;">{{bio}}</textarea><p class="gray"><span id="bio-count">140</span> {{#_i}}characters left{{/_i}}</p></div></li><li><label class="label">{{#_i}}Learning since{{/_i}}</label><div class="input" style="padding-top:5px; width: 334px;">{{formatted_creation}}</div></li><li><label class="label">{{#_i}}Facebook Connect{{/_i}}</label><div class="input"><input id="facebook_id" name="facebook_id" size="30" type="hidden" style="margin-bottom: 10px; width: 334px;" value="{{facebook_id}}">{{^facebook_id}}<a id="facebook-connect" href="javascript:;" class="btn btn-blue btn-lg fb-connect" style="margin: -5px 0 0 0">{{#_i}}Connect to Facebook{{/_i}}</a>{{/facebook_id}}{{#facebook_id}}<p style="margin-bottom: 10px;">{{#_i}}You are connected as{{/_i}} {{^facebook_name}}<fb:name uid="{{facebook_id}}" capitalize="true" useyou="false" />{{/facebook_name}}{{#facebook_name}}<a id="facebook-profile-link" href="http://www.facebook.com/{{facebook_id}}" target="_blank" class="username">{{facebook_name}}</a>{{/facebook_name}}</p><a id="facebook-disconnect" href="javascript:;" class="btn btn-standard btn-small">{{#_i}}Disconnect{{/_i}}</a>{{/facebook_id}}</div></li>{{#facebook_id}}<li><label class="label">{{#_i}}Automatically share on Facebook{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="" id="auto_facebook_post_on" name="auto_facebook_post" type="radio" value="true" {{#auto_facebook_post}}checked{{/auto_facebook_post}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="" id="auto_facebook_post_off" name="auto_facebook_post" type="radio" value="false" {{^auto_facebook_post}}checked{{/auto_facebook_post}}> {{#_i}}off{{/_i}}</label></li></ul></div></li>{{/facebook_id}}{{#gplus_id}}<li><label class="label">{{#_i}}Google+ Connect{{/_i}}</label><div class="input"><a id="gplus-disconnect" href="javascript:;" class="btn btn-standard btn-small">{{#_i}}Disconnect{{/_i}}</a><div id="gplus-error" style="display:none;">{{#_i}}There was an issue disconnecting your account. Please visit your <a href="https://plus.google.com/apps">Google Plus Apps page</a> to revoke access.{{/_i}}</div></div></li>{{/gplus_id}}</ul></div> ',
"shadow-banned":'<div class="shadow-banned-modal modal"><div class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div><div style="padding: 30px 30px 20px 30px" class="modal-body"><h3>Shadow Ban List</h3><span class="username-group"><input id="add-username" type="text" class="add-username-input" maxlength="100" placeholder="add a username"/></span><span class="add-banned pointer"></span><ul class="ban-list">{{#users}}<li class="banned-user"><span style="float:left">{{#user}}{{>avatar_medium}}{{/user}}</span><div class="banned-user-info"><a class="username" href="#/{{#user}}{{username}}{{/user}}">{{#user}}{{username}}{{/user}}</a><p>{{datetime}}<button class="btn primary unban-user" data-userid="{{#user}}{{id}}{{/user}}" style="float:right">unban</button></p></div></li>{{/users}}</ul></div></div>',
"shadowban-form":'<div id="shadowban-form" class="modal hidden fade"><div class="close"></div><div class="modal-header"><h1>{{#_i}}Shadowban User:{{/_i}} {{username}}</h1></div><div class="modal-body"><form id="shadowban-submit" action="/api/1/shadowban_user" method="post"><input class="hidden" name="user_id" value="{{id}}"><input class="hidden" name="username" value="{{username}}"><div class="description-section"><h2>{{#_i}}Please enter an explanation for banning this user. (minimum: 100 characters){{/_i}}</h2><textarea name="ban_description" class="description"></textarea></div><div class="upload-section"><h2>{{#_i}}Upload a screenshot of the user\'s offensive behavior.{{/_i}}</h2><div id="screenshot-upload"><span id="filename">{{#_i}}Select your file...{{/_i}}</span><label for="file-upload"> Browse <input type="file" id="file-upload" name="image"></label></div></div></form><div class="error-placeholder"></div></div><div class="modal-footer"><div class="btn btn-standard left cancel-ban">{{#_i}}Cancel{{/_i}}</div><div class="btn btn-red ban-user">{{#_i}}Shadowban{{/_i}}</div></div></div>',
short_list:"{{{one}}}{{#two}}{{^more_two}} {{#_i}}and{{/_i}}{{/more_two}}{{#more_two}},{{/more_two}} {{{two}}}{{#three}} {{#_i}}and{{/_i}} {{{three}}}{{/three}}{{#more}} {{#_i}}and {{more}} {{#pluralize}}other,others,{{more}}{{/pluralize}}{{/_i}}{{/more}}{{/two}} ",skill:'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner">{{#lessons_left}}<div class="box-colored white"><div class="skill-progress"><span class="skill-badge-big "><span class="skill-icon unlocked {{icon_color}} big"><span class="skill-icon-image skill-icon-{{new_index}}"></span><div class="pie"><span id="overlay-progress" data-pie="{{lessons_completed}}+{{lessons_left}}"></span></div></span></span><header class="skill-progress-headline">{{#_i}}<span>{{lessons_completed}}/{{num_lessons}}</span> Lessons completed{{/_i}} <span class="icon icon-green-check-small"></span></header><button class="btn btn-yellow btn-test-out" onclick="location.href=\'/skill/{{language}}/{{url_title}}/test\';">{{#_i}}Test out{{/_i}}</button><div class="popover"><div class="arrow-top-small-container"><div class="arrow"></div></div><div class="inner" style="padding: 20px;"><h4>{{#_i}}Feeling confident?{{/_i}}</h4><p>{{#_i}}If you know about {{#_ivar}}title{{/_ivar}} you can quickly finish this skill by taking a short test.{{/_i}}</p></div></div></div></div>{{/lessons_left}}{{^lessons_left}}<div class="box-colored {{#perfect_strength}}gold{{/perfect_strength}} {{^perfect_strength}}{{icon_color}}{{/perfect_strength}}"><div class="skill-done"><span class="skill-badge-big" style="{{#perfect_strength}}margin-bottom: 55px;{{/perfect_strength}}"><span style="{{#perfect_strength}}background: none; margin-bottom: 25px;{{/perfect_strength}}" class="skill-icon {{#perfect_strength}}gold huge{{/perfect_strength}} {{^perfect_strength}}unlocked skill-icon-darker big{{/perfect_strength}}"><span class="skill-icon-image skill-icon-{{new_index}}"></span>{{^perfect_strength}}<span class="skill-icon-strength skill-icon-strength-big {{#total_strength}}strength-{{total_strength}}{{/total_strength}} {{#rtl}}img-flipped{{/rtl}}"></span>{{/perfect_strength}}</span></span><header class="skill-done-headline {{#perfect_strength}}bigger{{/perfect_strength}}">{{#_i}}Strength: {{total_strength}}/5{{/_i}}</header><button class="btn btn-white btn-outline practice">{{#_i}}Strengthen {{#_ivar}}title{{/_ivar}}{{/_i}}</button></div></div>{{/lessons_left}}</div></section><section class="page-main main-right" style="{{^lessons_left}}min-height: 390px;{{/lessons_left}}">{{#bonus}}<h1>{{#_i}}Bonus Skill: {{#_ivar}}title{{/_ivar}}{{/_i}}</h1>{{/bonus}}{{^bonus}}<h1>{{#_ivar}}title{{/_ivar}}</h1>{{/bonus}}<div class="list-lessons" style="">{{#rows}}<div class="list-lessons-row">{{#lessons}}{{^empty}}{{^learn_marker}}{{#open}}<div class="list-lesson-item past"><div class="inner"><h3>{{#_i}}Lesson {{index}}{{/_i}} {{^active}}<span class="icon icon-green-check-small"></span>{{/active}}</h3><p>{{words_list}}</p><footer>{{#active}}<a href=\'/skill/{{language}}/{{url_title}}/{{lesson}}\' class="btn btn-{{icon_color}} btn-block ">{{#_i}}Begin{{/_i}}</a>{{/active}}{{^active}}<a href=\'/skill/{{language}}/{{url_title}}/{{lesson}}\' class="btn btn-standard btn-block btn-outline">{{#_i}}Redo{{/_i}}</a>{{/active}}</footer></div></div>{{/open}}{{^open}}<div class="list-lesson-item locked"><div class="inner"><h3>{{#_i}}Lesson {{index}}{{/_i}}</h3><p>{{words_list}}</p><footer><button class="btn btn-locked btn-block btn-outline btn-standard">{{#_i}}Locked{{/_i}}</button></footer></div></div>{{/open}}{{/learn_marker}}{{/empty}}{{#empty}}<div class="list-lesson-item"></div>{{/empty}}{{/lessons}}</div>{{/rows}}</div>{{#has_explanation}}<hr style="margin-top: 40px"/><div class="tips-notes-panel"><h2>{{#_i}}Tips and notes{{/_i}}</h2>{{{explanation}}}</div>{{/has_explanation}}</section>{{>footer}}</main> ',
"skill-item":'{{#locked}}<span href="" class="skill-badge-small fade-this-in locked"><span class="skill-icon small locked"><span class="skill-icon-image skill-icon-{{new_index}}"></span></span><span class="skill-badge-name">{{#_ivaru}}short{{/_ivaru}} <span class="lessons-left" style="opacity: 0.5">{{#missing_lessons}}{{lessons_completed}}/{{total_lessons}}{{/missing_lessons}}</span></span></span>{{/locked}}{{^locked}}{{#hide_first_skill}}<span style="display:none;">{{/hide_first_skill}}<a href="/skill/{{language}}/{{url_title}}" class="fade-this-in skill-badge-small" data-skill="{{name}}" style="opacity: 0"><span class="skill-icon {{^perfect_strength}}{{icon_color}}{{/perfect_strength}} small {{^perfect_strength}}unlocked{{/perfect_strength}} {{#perfect_strength}}gold{{/perfect_strength}}"><span class="skill-icon-image skill-icon-{{new_index}}"></span>{{#percent_left}}<div class="pie"><span id="overlay-progress" data-pie="{{progress_percent}}+{{percent_left}}"></span></div>{{/percent_left}}{{^percent_left}}<span class="skill-icon-strength skill-icon-strength-small {{#rtl}}img-flipped{{/rtl}} {{#skill_strength}}strength-{{skill_strength}}{{/skill_strength}}"></span>{{/percent_left}}</span><span class="skill-badge-name">{{#_ivaru}}short{{/_ivaru}} <span class="lessons-left">{{#missing_lessons}}{{lessons_completed}}/{{total_lessons}}{{/missing_lessons}}</span></span></a>{{#hide_first_skill}}</span>{{/hide_first_skill}}{{/locked}}',
"skill-list":'<div class="row"><div class="span10 columns home-left">{{>skill-tree}}</div><div class="span5-5 columns home-right">{{>profile-side-bar}}</div></div> ',"skill-progress-bar":'<div class="progress-bar-skill">{{#progress_percent}}<div class="bar" style="width: {{progress_percent}}%"></div>{{/progress_percent}}<div class="label learned" style="left: {{learning_threshold_percentage}}%;"><span class="status"></span>{{#learned}}{{#learned_more}}<div class="checkmark-middle"></div>{{/learned_more}}{{^learned_more}}<div class="checkmark-end"></div>{{/learned_more}}{{/learned}}</div><div class="label mastered"><span class="status"></span>{{#mastered}}<span class="checkmark"></span>{{/mastered}}</div></div>',
"skill-tree":'<div class="tree">{{^first_time}}<button data-tab="store" class="btn btn-standard right store-button btn-store"><span class="icon icon-store-small"></span> {{#_i}}Lingot store{{/_i}}</button><a href="/settings/direction"><span data-toggle="tooltip" title="{{#_i}}Change language{{/_i}}" class="flag flag-svg-small flag-{{language}} skill-tree-header-language"></span></a><span class="skill-tree-header"><h1>{{#_i}}{{#_ivar}}language_string{{/_ivar}} skills{{/_i}}</h1><span class="level-text">{{#_i}}LEVEL {{level}}{{/_i}}</span></span>{{#in_beta}}<div class="beta-ribbon-container"><span class="content">{{#_i}}IN BETA{{/_i}}</span><span class="ribbon-end"></span></div>{{/in_beta}}{{/first_time}}{{#first_time}}<div class="skill-tree-intro{{#rtl}}-rtl{{/rtl}}"><div class="speech-bubble arrow-right" id="bubble-hover"><div class="arrow-right-container"><div class="arrow"></div></div><div class="inner "><h2>{{#_i}}Choose your path!{{/_i}}</h2><p>{{#_i}}Beginners start at {{#_ivar}}basics_title{{/_ivar}}.<br/>Advanced learners take a short test.{{/_i}}</p><ul class="choose-your-path"><li><a href="/skill/{{language}}/{{basics_url}}" class="skill-badge-small" style="margin: 0;"><span class="skill-icon blue small unlocked " style="margin-bottom: 8px;"><span class="skill-icon-image skill-icon-1"></span></span><strong class="skill-badge-name blue">{{#_ivar}}basics_title{{/_ivar}}</strong></a></li><li class="or">{{#_i}}or{{/_i}}</li><li><a href="/placement/{{learning_language}}" class="skill-badge-small" style="margin: 0;"><span class="skill-icon green small unlocked " style="margin-bottom: 8px;"><span class="skill-icon-image skill-icon-11"></span></span><strong class="green skill-badge-name">{{#_i}}Placement test{{/_i}}</strong></a></li></ul></div></div><div class="{{^rtl}}owl-peeking-right-container{{/rtl}}{{#rtl}}owl-peeking-left-container{{/rtl}}"><div class="owl owl-standard"></div></div></div>{{/first_time}}<ul class="skill-tree">{{#rows}}{{#bonus_row}}<li class="skill-tree-row bonus-row">{{#filled_slots}}<span id="skill-{{short_name}}"></span>{{/filled_slots}}{{#empty_slots}}<a href="/show_store$scroll=bonus" class="fade-this-in skill-badge-small skill-badge-placeholder" style="opacity: 0;"><span class="skill-icon small skill-icon-placeholder"><span class="icon icon-plus-black-big"></span></span><span class="skill-badge-name">{{#_i}}Bonus Skill{{/_i}}</span></a>{{/empty_slots}}</li>{{/bonus_row}}{{^bonus_row}}{{#test_row}}<li class="skill-tree-row row-shortcut"><div class="skill-span columns track-hover">{{#done}}<div class="btn btn-standard btn-lg disabled {{#fade_in}}opacity-0{{/fade_in}} fade-this-in"><span class="icon icon-check-white-small better-margin"></span> {{#_i}}Checkpoint passed{{/_i}}</div>{{/done}}{{^done}}<a id="big-test-{{level_test}}" href="/bigtest/{{language}}/{{level_test}}" class="{{#fade_in}}opacity-0{{/fade_in}} fade-this-in btn btn-lg btn-yellow btn-test-out">{{#_i}}Test out of {{num_unlocks}} {{#pluralize}}skill,skills,{{num_unlocks}}{{/pluralize}}{{/_i}}</a>{{/done}}</div></li>{{/test_row}}{{^test_row}}{{#register_row}}<li class="skill-tree-row"><a href="javascript:;" class="{{#fade_in}}opacity-0{{/fade_in}} fade-this-in btn btn-lg btn-green register-delayed" data-track-click="trial account skill tree create profile">{{#_i}}Create a profile to continue{{/_i}}</a </li>{{/register_row}}{{^register_row}}<li class="skill-tree-row row-{{row}}">{{#columns}}<span id="skill-{{column}}-{{row}}"></span>{{/columns}}</li>{{/register_row}}{{/test_row}}{{/bonus_row}}{{/rows}}</ul>{{#finished_tree}}<div class=""><div class="trophy golden-duo owl owl-trophy-small {{learning_language}}" style="cursor:pointer; display:block"></div></div>{{/finished_tree}}</div><div id="rupee-store-view" style="position: relative;"></div> ',
skill_og:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd" ><html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{facebook_app_ns}}: http://ogp.me/ns/fb/{{facebook_app_ns}}#"><meta property="fb:app_id" content="{{facebook_app_id}}" /><meta property="og:type" content="{{facebook_app_ns}}:skill" /><meta property="og:url" content="http://www.duolingo.com/skill{{#facebook_debug}}_debug{{/facebook_debug}}/{{id}}" /><meta property="og:title" content="{{#_ivar}}language_string_title{{/_ivar}} \u2014 {{#_ivar}}title{{/_ivar}}" /><meta property="og:description" content="{{#_i}}With Duolingo you learn a language for free while helping to translate the Web.{{/_i}}" /><meta property="og:image" content="http://static.duolingo.com/images/facebook/skills/{{index}}.png" /><meta property="{{facebook_app_ns}}:skill_description" content="{{translated_description}}" /><meta property="{{facebook_app_ns}}:language" content="{{language_string}}" /><meta property="og:locale" content="{{locale}}" />{{#available_locales}}<meta property="og:locale:alternate" content="{{.}}" />{{/available_locales}}<script type="text/javascript"> window.location = "//www.duolingo.com/skill/{{language}}/{{url_title}}" \x3c/script></head></html> ',
"slide-session-end":'<div class="slide-session-end"><div class="player-inner"><section class="player-container slide-in"><div id="end-carousel" class="carousel slide"><ul class="carousel-inner session-end-slider"><li id="award-slide" class="carousel-slide active item" data-slide="{{award_index}}"><div class="session-end-main {{#show_coach_session_end}}coach-end{{/show_coach_session_end}} {{#show_par_experiment}}par-end{{/show_par_experiment}} {{#met_goal}}show-goal-subheading{{/met_goal}}"><h1 class="session-end opacity-0">{{#has_hearts}}{{^use_strength}}{{#gained_skill_points}}{{#hearts-0}}{{#_i}}Lesson complete!{{/_i}} <span class="lighter">{{#_i}}+{{lesson_points}} XP{{/_i}}</span>{{/hearts-0}}{{/gained_skill_points}}{{^gained_skill_points}}{{#hearts-0}}{{#_i}}Great! You completed this lesson again{{/_i}}{{/hearts-0}}{{/gained_skill_points}}{{#hearts-4}}{{#_i}}Lesson complete!{{/_i}} <span class="lighter">{{#_i}}+{{lesson_points}} XP{{/_i}}</span><br/>{{^big_test}}{{#_i}}Heart bonus!{{/_i}} <span class="lighter">{{#_i}}+4 XP{{/_i}}</span>{{/big_test}}{{/hearts-4}}{{#hearts-3}}{{#_i}}Lesson complete!{{/_i}} <span class="lighter">{{#_i}}+{{lesson_points}} XP{{/_i}}</span><br/>{{^big_test}}{{#_i}}Heart bonus!{{/_i}} <span class="lighter">{{#_i}}+3 XP{{/_i}}</span>{{/big_test}}{{/hearts-3}}{{#hearts-2}}{{#_i}}Lesson complete!{{/_i}} <span class="lighter">{{#_i}}+{{lesson_points}} XP{{/_i}}</span><br/>{{^big_test}}{{#_i}}Heart bonus!{{/_i}} <span class="lighter">{{#_i}}+2 XP{{/_i}}</span>{{/big_test}}{{/hearts-2}}{{#hearts-1}}{{#_i}}Lesson complete!{{/_i}} <span class="lighter">{{#_i}}+{{lesson_points}} XP{{/_i}}</span><br/>{{^big_test}}{{#_i}}Heart bonus!{{/_i}} <span class="lighter">{{#_i}}+1 XP{{/_i}}</span>{{/big_test}}{{/hearts-1}}{{/use_strength}}{{#use_strength}}{{#gained_skill_points}}{{^is_refreshing_lesson}}{{#_i}}Lesson complete!{{/_i}}{{/is_refreshing_lesson}}{{#is_refreshing_lesson}}{{#_i}}Lesson refreshed!{{/_i}}{{/is_refreshing_lesson}}<span class="lighter"> {{#_i}}+{{lesson_points}} XP{{/_i}}</span>{{/gained_skill_points}}{{^gained_skill_points}}{{#_i}}Great! You completed this lesson again{{/_i}}{{/gained_skill_points}}{{/use_strength}}{{/has_hearts}}{{^has_hearts}}{{^times_up}}{{^placement_test}}{{^certification_test}}{{#_i}}You beat the clock and got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct!{{/_i}}{{/certification_test}}{{#certification_test}}{{#_i}}Congratulations! You scored {{#toFixed}}{{total_score}},2{{/toFixed}}/5.00{{/_i}}{{/certification_test}}{{/placement_test}}{{#placement_test}}{{#_i}}Congratulations! You tested out of {{num_learned}} {{#pluralize}}skill,skills,{{num_learned}}{{/pluralize}}!{{/_i}}{{/placement_test}}{{/times_up}}{{#times_up}}{{#point_accumulation}}{{#_i}}Time\u2019s up! You got {{point_accumulation}} {{#pluralize}}answer,answers,{{point_accumulation}}{{/pluralize}} correct{{/_i}}{{/point_accumulation}}{{/times_up}}{{/has_hearts}}</h1>{{#show_coach_session_end}}{{^met_goal}}<h2 class="session-subheading">{{^just_met_goal}}{{#streak_extended_today}}{{#_i}}Keep going to meet your daily goal!{{/_i}}{{/streak_extended_today}}{{^streak_extended_today}}{{#_i}}Keep going to meet your daily goal and extend your streak!{{/_i}}{{/streak_extended_today}}{{/just_met_goal}}{{#just_met_goal}}{{#streak_extended_today}}{{#_i}}You met your daily goal!{{/_i}}{{/streak_extended_today}}{{^streak_extended_today}}{{#_i}}You met your daily goal and extended your streak!{{/_i}}{{/streak_extended_today}}{{/just_met_goal}}</h2>{{/met_goal}}{{/show_coach_session_end}}{{^certification_test}}<div class="progress-xp-container"><div class="progress-xp"><div class="col-left"><div class="inner">{{#show_coach_session_end}}<span class="daily-goal-container session opacity-0"><div class="daily-donut-container"><span class="icon icon-daily-donut-streak {{#met_goal}}completed{{/met_goal}}"></span><span class="animate-me icon icon-daily-donut-streak completed bounce-in hidden"></span>{{#daily_goal}}<div id="daily-donut-text">{{#met_goal}}<span class="stat-text"><span class="numerator">{{old_xp_today}}</span>/{{daily_goal}}</span> {{#_i}}xp goal met{{/_i}}{{/met_goal}}{{^met_goal}}<span class="stat-text"><span class="numerator">{{old_xp_today}}</span>/{{daily_goal}}</span> {{#_i}}xp gained{{/_i}}{{/met_goal}}</div>{{/daily_goal}}<div id="daily-donut"></div></div></span>{{/show_coach_session_end}}{{^show_coach_session_end}}{{#gained_skill_points}}{{#points_data}}<div id="level-bar" class="language-progress-bar-big session-end-progress opacity-0"><div class="level-next level">{{next_level}}</div><div class="bar" style="width: {{level_before_bar_width}}px; max-width: 250px;"><div id="next-hook" class="popover-hook"><div id="next-level" class="popover popover-blue progress-xp-popover" style="display: block;"><div class="arrow-bottom-container"><div class="arrow"></div></div><div class="popover-content"><strong>{{#_i}}Next level{{/_i}}</strong>{{#_i}}<span id="level_points">{{old_points}}</span>/{{level_points}} XP{{/_i}}</div></div></div></div><div class="level-current level">{{level}}</div></div>{{/points_data}}{{/gained_skill_points}}{{/show_coach_session_end}}</div></div><div class="col-right"><div id="progress-line-graph" class="graph" style="width: 350px; position: relative;"><div id="today-hook" class=""><div id="today-popover" class="popover popover-blue progress-xp-popover opacity-0" style="display: block;"><div class="arrow-bottom-container"><div class="arrow"></div></div><div class="popover-content"><strong>{{#_i}}TODAY{{/_i}}</strong>{{#_i}}<span class="today-points">{{old_points}}</span> XP{{/_i}}</div></div></div></div></div></div></div>{{/certification_test}}{{#show_par_experiment}}<div class="session-par">{{#_i}}Completed in {{num_challenges}} challenges.{{/_i}}{{^perfect_lesson}} {{#_i}}Best possible: {{min_challenges}}{{/_i}}{{/perfect_lesson}}</div>{{#perfect_lesson}}<h2 class="session-par-percent">{{#_i}}You did this lesson perfectly!{{/_i}}</h2>{{/perfect_lesson}}{{^perfect_lesson}}<h2 class="session-par-percent">{{#_i}}You did better than <span class="gold">{{percentile}}%</span> of people at this lesson.{{/_i}}</h2>{{/perfect_lesson}}{{/show_par_experiment}}{{#certification_test}}<div class="certificate-container opacity-0"><span class="store-icon store-icon-progress big"></span></div><div class="strengthened-message">{{#_i}}You can take this quiz again by visiting the <a class="blue" href="/show_store">lingot store</a>.{{/_i}}</div><div class="strengthened-message">{{#_i}}Try to improve your score!{{/_i}}</div>{{/certification_test}}</div></li>{{^certification_test}}{{#strengthen}}<li id="skill-slide" class="carousel-slide slider-pane-words item" data-slide="{{skill_index}}"><h1 class="session-end">{{#learned}}{{#learned_short_list}}{{#one}} {{#_i}}You learned {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}}{{/_i}}{{/one}}{{#two}} {{#_i}}You learned {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}} and {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}}{{/_i}}{{/two}}{{#three}} {{#_i}}You learned {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}} and {{#item_three}}{{#_ivar}}title{{/_ivar}}{{/item_three}}{{/_i}}{{/three}}{{#more}} {{#_i}}You learned {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}} and {{remainder}} others{{/_i}}{{/more}}{{/learned_short_list}}{{/learned}}{{^learned}}{{#delta_short_list}}{{#one}} {{#_i}}You strengthened {{#item_one}}{{#_ivar}}skill_title{{/_ivar}}{{/item_one}}{{/_i}}{{/one}}{{#two}} {{#_i}}You strengthened {{#item_one}}{{#_ivar}}skill_title{{/_ivar}}{{/item_one}} and {{#item_two}}{{#_ivar}}skill_title{{/_ivar}}{{/item_two}}{{/_i}}{{/two}}{{#three}} {{#_i}}You strengthened {{#item_one}}{{#_ivar}}skill_title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}skill_title{{/_ivar}}{{/item_two}} and {{#item_three}}{{#_ivar}}skill_title{{/_ivar}}{{/item_three}}{{/_i}}{{/three}}{{#more}} {{#_i}}You strengthened {{#item_one}}{{#_ivar}}skill_title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}skill_title{{/_ivar}}{{/item_two}} and {{remainder}} others{{/_i}}{{/more}}{{/delta_short_list}}{{/learned}}</h1><ul class="strengthened-skills-big">{{#learned}}{{#max_3_learned_skills}}<li><span class="skill-badge-big" id="skill-1" data-strength="1"><span style="" class="skill-icon {{icon_color}} unlocked big"><span class="skill-icon-image skill-icon-{{new_index}}"></span></span><span class="skill-icon-strength skill-icon-strength-big {{#rtl}}img-flipped{{/rtl}} strength-0"></span></span></li>{{/max_3_learned_skills}}{{/learned}}{{^learned}}{{#max_3_strengthened_skills}}<li><span class="skill-badge-big" data-strength="{{strength}}"><span style="" class="skill-icon {{icon_color}} unlocked big"><span class="skill-icon-image skill-icon-{{new_index}}"></span></span><span class="skill-icon-strength skill-icon-strength-big {{#rtl}}img-flipped{{/rtl}} strength-0"></span></span></li>{{/max_3_strengthened_skills}}{{/learned}}</ul>{{#learned}}<div class="strengthened-message opacity-0">{{#_i}}Keep those <strong>strength bars</strong> full as words fade from your memory.{{/_i}}</div>{{/learned}}{{^learned}}<div class="strengthened-message opacity-0">{{#_i}}Keep those <strong>strength bars</strong> full as words fade from your memory.{{/_i}}</div>{{/learned}}</li>{{/strengthen}}{{/certification_test}}{{#showing_rupees_screen}}<li id="lingot-slide" class="item" data-slide="{{lingots_index}}"><h1 class="session-end">{{#_i}}You\'ve earned {{new_rupees}} {{#pluralize}}lingot,lingots,{{new_rupees}}{{/pluralize}}!{{/_i}}</h1><div class="lingot-bill-container"><div class="lingot-bill-cell opacity-0"><div class="lingot-bill"><ul class="lingot-bill-items">{{#rupee_earnings}}{{#level_event}}{{#level}}<li>{{#_i}}Reached level {{new_level}}{{/_i}}<span class="amount">{{new_level}}</span></li>{{/level}}{{/level_event}}{{#learn}}<li>{{#_i}}Completed {{#_ivar}}skill_title{{/_ivar}}{{/_i}}<span class="amount">2</span></li>{{/learn}}{{#full_hearts}}<li>{{#_i}}Full heart bonus{{/_i}}<span class="amount">1</span></li>{{/full_hearts}}{{/rupee_earnings}}</ul><span class="icon icon-lingot-medium right">{{new_rupees}}</span><p class="store-link">{{#_i}}Use lingots to get cool items from the <a href="/show_store" class="blue">Virtual store!</a>{{/_i}}</p></div></div></div></li>{{/showing_rupees_screen}}{{#have_document_recommendations}}{{^mobile_web_view}}<li id="translation-slide" class="carousel-slide item" data-slide="{{immersion_index}}"><h1 class="session-end">{{#_i}}You can now read {{percent_can_read}}% of all real {{#_ivar}}learning_language_name{{/_ivar}} text{{/_i}}</h1>{{#recommendations}}<h2 class="session-end want-to-see">{{#_i}}Want to see? Try translating this article:{{/_i}}</h2><div class="wiki-document-body immersion-card opacity-0"><div class="wiki-document-body immersion-card-inner">{{{custom_html}}}</div><div class="footer"><strong>{{#_i}}Strengthen your skills!{{/_i}}</strong><btn class="btn btn-blue start-translating">{{#_i}}Start translating{{/_i}}</btn></div></div>{{/recommendations}}</li>{{/mobile_web_view}}{{/have_document_recommendations}}{{^trial_account}}{{#testcenter_event}}{{#show_test_center_ad}}<li id="test-center-slide" class="carousel-slide item" data-slide="{{tc_index}}"><h1 class="session-end">{{#_i}}Your {{#_ivar}}language_string{{/_ivar}} language ability has increased to{{/_i}}</h1><span class="tc-badge"><span class="score">{{tc_estimate}}</span><span class="total-score">{{#_i}}out of 10{{/_i}}</span></span><h2 class="session-end ">{{#_i}}Duolingo can certify this score for use on a job or school r\u00e9sum\u00e9{{/_i}}</h2>{{!Why is it necessary to handle the click event in JS in order to make this link work??}}<a href="https://testcenter.duolingo.com" data-bypass><button id="certify-my-score" class="btn btn-standard btn-lg" data-track-click="certify my score button">{{#_i}}Certify my score{{/_i}}</button></a></li>{{/show_test_center_ad}}{{#show_fluency_score}}<li id="test-center-slide" class="carousel-slide item" data-slide="{{tc_index}}"><h1 class="session-end">{{#_i}}You are now {{new_fluency_score}}% fluent in {{#_ivar}}language_string{{/_ivar}}!{{/_i}}</h1><div class="test-center-container"><div class="icon icon-fluency-score larger bounce-in"><span class="fluency-score">{{new_fluency_score}}%</span></div><div class="test-center-actions"><div id="certify-my-score" data-track-click="certify my score button" href="https://testcenter.duolingo.com" data-bypass><h3><span class="icon icon-testcenter-box"></span>{{#_i}}Certify Your Fluency{{/_i}}</h3></div><p>{{#_i}}Applying to a school or job that takes language skills seriously? We can verify your identity and fluency level with a human proctor.{{/_i}}</p><div href="javascript:;" class="facebook-share-fluency"><h3><span class="icon icon-facebook-box"></span>{{#_i}}Share on Facebook{{/_i}}</h3></div></div></div></li>{{/show_fluency_score}}{{/testcenter_event}}{{/trial_account}}</ul></div><footer class="session-end-footer"><div class="buttons">{{^certification_test}}<button id="show-review-modal" class="btn btn-lg btn-standard left relative review" data-track-click="review lesson button">{{#_i}}Review lesson{{/_i}}</button>{{/certification_test}}{{#learned}}{{^trial_account}}<button id="share-footer-button" class="btn btn-lg btn-blue share left relative">{{#_i}}Share{{/_i}}<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel"><li><a href="http://twitter.com/intent/tweet?url=https://www.duolingo.com&text= {{#learned_short_list}}{{#one}}{{#_i}}I learned the {{#_ivar}}language_string{{/_ivar}} skill {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}} on{{/_i}}"{{/one}}{{#two}}{{#_i}}I learned the {{#_ivar}}language_string{{/_ivar}} skills {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}} and {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}} on{{/_i}}"{{/two}}{{#three}}{{#_i}}I learned the {{#_ivar}}language_string{{/_ivar}} skills {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}} and {{#item_three}}{{#_ivar}}title{{/_ivar}}{{/item_three}} on{{/_i}}"{{/three}}{{#more}}{{#_i}}I learned the {{#_ivar}}language_string{{/_ivar}} {{#pluralize}}skill,skills,{{num_items}}{{/pluralize}} {{#item_one}}{{#_ivar}}title{{/_ivar}}{{/item_one}}, {{#item_two}}{{#_ivar}}title{{/_ivar}}{{/item_two}} and {{remainder}} others on{{/_i}}"{{/more}}{{/learned_short_list}} &hashtags=duolingo" target="_blank">{{#_i}}Share on Twitter{{/_i}}</a></li><li><a id="facebook-post-action" class="facebook share-skills" data-shared="{{#_i}}Shared on Facebook{{/_i}}" href="javascript:;">{{#_i}}Share on Facebook{{/_i}}</a></li><li class="divider"></li><li><span><label><input id="fb-auto-post" class="border" type="checkbox" {{#auto_facebook_post}}checked="checked"{{/auto_facebook_post}}/> {{#_i}}Automatically share on Facebook{{/_i}}</label></span></li></ul></button>{{/trial_account}}{{/learned}}{{#certification_test}}<a href="javascript:;" class="external-link btn btn-lg btn-blue" style="float: left; margin: 0 0 0 10px; padding-right: 20px; padding-left: 20px;" data-href="/certs/{{certificate_id}}" data-bypass="true" >{{#_i}}View certificate{{/_i}}</a>{{/certification_test}}{{^practice}}<button data-r="home" data-href="{{^home}}/skill/{{language}}/{{skill_name}}{{/home}}" class="continue btn btn-lg btn-green right">{{#_i}}Continue{{/_i}}</button>{{/practice}}{{#practice}}{{#skill_id}}<button data-r="skill" data-href="/skill/{{language}}/{{skill_name}}" type="submit" class="continue btn btn-lg btn-green right">{{#_i}}Continue{{/_i}}</button><button data-r="skill" data-href="/skill/{{language}}/{{skill_name}}/practice" type="submit" class="margin-right end-continue btn btn-lg btn-blue right">{{#_i}}Practice again{{/_i}}</button>{{/skill_id}}{{^skill_id}}<button data-r="{{#home}}home{{/home}}{{^home}}skill{{/home}}" data-href="" type="submit" class="continue btn btn-lg btn-green right">{{#_i}}Continue{{/_i}}</button><button data-r="home" data-href="practice" type="submit" class="margin-right end-continue btn btn-lg btn-blue right">{{#_i}}Practice again{{/_i}}</button>{{/skill_id}}{{/practice}}</div></footer><div class="carousel-container"><ul class="carousel-dots"><li data-slide="{{award_index}}" class="carousel-dot active"></li>{{#strengthen}}<li data-slide="{{skill_index}}" class="carousel-dot"></li>{{/strengthen}}{{#showing_rupees_screen}}<li data-slide="{{lingots_index}}" class="carousel-dot"></li>{{/showing_rupees_screen}}{{#have_document_recommendations}}{{^mobile_web_view}}<li class="translation-slide-dot carousel-dot" data-slide="{{immersion_index}}" ></li>{{/mobile_web_view}}{{/have_document_recommendations}}{{^trial_account}}{{#tc_index}}<li data-slide="{{tc_index}}" class="carousel-dot"></li>{{/tc_index}}{{/trial_account}}</ul></div><div id="review-modal" class="modal fade hidden"></div></section></div></div> ',
"small-register":'{{^splash_skip_delayed}}<div id="signup-main" class="{{#show_form}}hidden{{/show_form}}"><section class="section-white dark-theme"><div class="section-inner center fold"><div class="earth-container"><span class="splash-globe"></span></div><div class="cta-container"><h1 class="splash" >{{#single_learning_language}}{{#_i}}Learn English for free. Forever.{{/_i}}{{/single_learning_language}}{{^single_learning_language}}{{#_i}}Learn a language for free. Forever.{{/_i}}{{/single_learning_language}}</h1><div class="email-div"><a class="btn btn-green sign-up signup-trial" href="javascript:;" id="signup-link" style="margin-bottom: 15px;" data-track-click="splash page register facebook">{{#_i}}Get started{{/_i}}</a><div class="have-account">{{#_i}}Have an Account?{{/_i}}</div></div></div></div></section></div><div class="{{^show_form}}hidden{{/show_form}} splash-signup-form" id="signup-language"><section class="section-white space"><div class="section-inner-wide section-inner"><h1 class="splash">{{#_i}}I want to learn...{{/_i}}</h1><div class="login-signup-list-container language-select"><table class="form-table">{{#languages_from_ui}}<tr><td class="from-ui-language"><li class="choose-language" data-language="{{learning_language}}"><span class="flag flag-svg-micro flag-{{learning_language}}"></span><span class="language-name">{{#_iv}}{{learning_language_name}}||capitalized{{/_iv}}</span><span class="icon icon-arrow-forward-gray"></span></li></td></tr>{{/languages_from_ui}}</table>{{#single_learning_language}}<div class="splash english expand-english">I speak English, show me courses I can take.</div><div class="english-courses hidden"><table class="form-table">{{#languages_from_en}}<tr><td class="from-en"><li class="choose-language" data-language="{{learning_language}}"><span class="flag flag-svg-micro flag-{{learning_language}}"></span><span class="language-name">{{learning_language_name}}</span><span class="icon icon-arrow-forward-gray"></span></li></td></tr>{{/languages_from_en}}</table></div>{{/single_learning_language}}</div></div></section></div>{{/splash_skip_delayed}}{{#splash_skip_delayed}}<div id="signup-email" class="splash-signup-form"><section class="section-white space"><div class="section-inner-wide section-inner">{{>registration-form-inner}}</div></section></div>{{/splash_skip_delayed}}<div dir="{{dir}}" class="login" style="display: none;"><div id="login-form" class="login-form"><ul class=\'login-signup-list\'><form id="login-form"><table border="0" cellspacing="0" cellpadding="0" class="form-table" style="margin-bottom: 20px;"><input type="hidden" name="came_from" value="{{came_from}}"/><tr><td><input id="login" name="login" size="30" type="text" placeholder="{{#_i}}Username{{/_i}}"></td></tr><tr><td><input id="password" name="password" size="30" type="password" placeholder="{{#_i}}Password{{/_i}}"></td></tr></table><div id=\'message\' class="warning-message hidden margin-bottom"></div><input id="login-button" readonly class="btn btn-lg btn-blue btn-block more-margin-bottom" value="{{#_i}}Log in{{/_i}}"/><p class="center no-margin"><a href="/forgot_password" class="forgot-password">{{#_i}}Forgot password?{{/_i}}</a></p></form></ul></div></div>',
"small-register-container":'{{#show_magic_register_modal}}<div class="modal hidden show in" id="signup-modal"><div class="modal-body magic-link-modal">{{>small-register}}</div></div>{{/show_magic_register_modal}}{{^show_magic_register_modal}}{{>small-register}}{{/show_magic_register_modal}}',"snippet-list":'{{#snippet}}<a href="/translation/{{id}}$index={{start_index}}&skill={{skill_id}}{{#recommended}}&recommended{{/recommended}}" class="translation unlocked">{{#document}}{{#active}}{{^done}}<span class="coin-medium">+{{sentence_points}}</span>{{/done}}{{#done}}{{^rated}}<span class="error has-twipsy" title="{{#_i}}Missing rating{{/_i}}">!</span>{{/rated}}{{/done}}{{/active}}{{^active}}<span class="checkmark"><span class="icon"></span></span>{{/active}}<strong class="number">{{index}}</strong><h3>{{#_i}}Real world translation{{/_i}}</h3>{{/document}}</a>{{/snippet}}{{#refresh}}<a class="lesson unlocked" href="/skill/{{language}}/{{url_title}}/practice/{{index}}"><h3>{{#_i}}Refresh{{/_i}}</h3>{{#active}}<span class="coin-medium">+10</span>{{/active}}{{^active}}<span class="checkmark"><span class="icon"></span></span>{{/active}}<strong class="number">{{index}}</strong>{{#no_data}}{{^active}}<ul class="hearts"><li class="none"></li><li class="none"></li><li class="none"></li>{{#beginner}}<li class="none"></li>{{/beginner}}</ul>{{/active}}{{/no_data}}{{^no_data}}<ul class="hearts">{{#hearts}}<li class="{{#filled}}filled{{/filled}}{{^filled}}empty{{/filled}}"></li>{{/hearts}}</ul>{{/no_data}}</a>{{/refresh}} ',
sound:'<div class="settings-content"><button id="submit_button" type="submit" class="btn btn-green right">{{#_i}}Save changes{{/_i}}</button><div id=\'confirmation-message\' class=\'hidden save-message\'>{{#_i}}Saved!{{/_i}}</div><div id=\'error-message\' class=\'hidden error-message\'>{{#_i}}Error{{/_i}}</div><h1>{{#_i}}Sound settings{{/_i}}</h1>\x3c!--TODO: refactor into account--\x3e<ul class="list-settings"><li><label class="label">{{#_i}}Microphone{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="microphone_on" name="microphone" type="radio" value="true" {{#microphone}}checked{{/microphone}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="microphone_off" name="microphone" type="radio" value="false" {{^microphone}}checked{{/microphone}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Speaker{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="speaker_on" name="speaker" type="radio" value="true" {{#speaker}}checked{{/speaker}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="speaker_off" name="speaker" type="radio" value="false" {{^speaker}}checked{{/speaker}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Voice autoplay{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="autoplay_on" name="autoplay" type="radio" value="true" {{#autoplay}}checked{{/autoplay}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="autoplay_off" name="autoplay" type="radio" value="false" {{^autoplay}}checked{{/autoplay}}> {{#_i}}off{{/_i}}</label></li></ul></div></li><li><label class="label">{{#_i}}Sound effects{{/_i}}</label><div class="input"><ul class="radio-buttons"><li><label><input class="border" id="sound_effects_on" name="sound_effects" type="radio" value="true" {{#sound_effects}}checked{{/sound_effects}}> {{#_i}}on{{/_i}}</label></li><li><label><input class="border" id="sound_effects_off" name="sound_effects" type="radio" value="false" {{^sound_effects}}checked{{/sound_effects}}> {{#_i}}off{{/_i}}</label></li></ul></div></li></ul></div> ',
"speak-element":'<div class="challenge-speak"><h1 class="player" style="">{{#_i}}Click the microphone and say:{{/_i}}</h1>{{^web_speech}}<h2 class="player"><span id="big-speaker"></span> <bdi>{{text}}</bdi></h2><div class="challenge-row"><div class="challenge-cell"><div id=\'audio-recorder\'><p><a href="http://www.adobe.com/go/getflashplayer" target="_blank"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="{{#_i}}Get Adobe Flash player{{/_i}}" /></a></p></div></div></div>{{/web_speech}}{{#web_speech}}<div class="challenge-row"><div class="challenge-cell chrome-speech"><div id="audio-recorder" class="speech-button"><button id="record-button" style="" class="btn btn-blue btn-outline btn-record"><span class="icon icon-microphone"></span></button><button id="stop-button" style="" class="hidden btn btn-blue btn-record"><span class="icon icon-stop"></span>{{#_i}}Stop{{/_i}}</button></div><div class="speech-input"><h2 class="player"><span id="big-speaker"></span><span id="original-text"><bdi>{{text}}</bdi></span></h2><h2 class="player speech-underlined"><span class="flag flag-svg-small flag-{{source_language}}"></span><span id="web-speech-solution"></span></h2></div></div></div>{{/web_speech}}</div> ',
speaker:"{{#visible}}<span id=\"speaker-{{aid}}-button\" class=\"speaker-{{size}}\" {{^slowEnabled}}style=\"margin-right: 20px\"{{/slowEnabled}}><span class=\"icon icon-speaker-{{size}} {{#rtl}}img-flipped{{/rtl}}\"></span></span>{{/visible}}<div id='speaker-{{aid}}' src='{{sound_path}}' class='hidden'></div>{{#slowEnabled}}{{#visible}}<span class=\"speaker-slow\" id='speaker-{{aid}}-slow-button'><span class=\"icon icon-turtle {{#rtl}}img-flipped{{/rtl}}\"></span></span>{{/visible}}<div id='speaker-{{aid}}-slow' src='{{sound_path}}&speed=70p' class='hidden'></div>{{/slowEnabled}} ",
splash:'<section dir="{{dir}}" class="monument-carousel dark-theme"><div dir="{{dir}}" class="signup">{{>small-register}}</div>{{#en_ui_language}}<div dir="{{dir}}" class="flag-carousel"><div class="section-inner center"><div class="featured-languages slider"><span class="language-list-container"><ul class="language-list bxslider">{{#languages_from_ui}}<li><a data-track-click="splash page flag" href="/course/{{learning_language_id}}/{{from_language_id}}/{{#_i}}Learn-{{#_iv}}{{learning_language_name}}{{/_iv}}-Online{{/_i}}"><span class="flag flag-svg-small flag-{{learning_language}}"></span><span class="language-name">{{#_iv}}{{base_learning_language_name}}||capitalized{{/_iv}}</a></span></li>{{/languages_from_ui}}</ul></span></div></div></div>{{/en_ui_language}}{{^en_ui_language}}{{^single_learning_language}}<div dir="{{dir}}" class="flag-carousel"><div class="section-inner center"><ul class="featured-languages">{{#languages_from_ui}}<li><a data-track-click="splash page flag" href="/course/{{learning_language_id}}/{{from_language_id}}/{{#_i}}Learn-{{#_iv}}{{learning_language_name}}{{/_iv}}-Online{{/_i}}"><span class="flag flag-svg-small flag-{{learning_language}}"></span><span class="language-name">{{#_iv}}{{base_learning_language_name}}||capitalized{{/_iv}}</a></span></li>{{/languages_from_ui}}</ul></div></div>{{/single_learning_language}}{{/en_ui_language}}</section><section dir="{{dir}}" class="duo-info"><div class="section-inner"><span class="owl owl-happy {{#rtl}}img-flipped{{/rtl}}"></span><div class="text"><h2>{{#_i}}The best new way to learn a language.{{/_i}}</h2><p>{{#_i}}Learning with Duolingo is fun and addictive. Earn points for correct answers, race against the clock, and level up. Our bite-sized lessons are effective, and we have a <a href="/effectiveness-study">study to prove it</a>.{{/_i}}</p><a href="javascript:;" id="video-toggle" class="play-video"><div class="play-border"><div class="play-button"></div></div><strong>{{#_i}}See how we do it{{/_i}}</strong></a></div></div></section><section dir="{{dir}}" class="website"><div class="section-inner"><h2 class="splash">{{#_i}}Gamification poured into every lesson.{{/_i}}</h2><div class="callout-wrapper"><div class="callout-container-left scroll-animate"><span class="callout challenges"><span class="splash-icon challenges"></span><div class="text"><h4>{{#_i}}Read, Listen, Speak{{/_i}}</h4><p>{{#_i}}Each lesson includes a variety of speaking, listening, translation, and multiple choice challenges.{{/_i}}</p></div></span><span class="callout grading"><span class="splash-icon check"></span><div class="text"><h4>{{#_i}}In-Lesson Grading{{/_i}}</h4><p>{{#_i}}Instantly see which answers you get correct. When you miss a challenge, we\'ll quickly show you how to improve.{{/_i}}</p></div></span></div><span class="left-line-container scroll-animate"><div class="challenges line"></div><div class="grading line"></div></span><span class="splash-icon computer {{#rtl}}img-flipped{{/rtl}}"></span><span class="right-line-container scroll-animate" ><div class="streak line"></div><div class="heart line"></div></span><div class="callout-container-right scroll-animate"><span class="callout streak"><span class="splash-icon streak"></span><div class="text"><h4>{{#_i}}Streak Count{{/_i}}</h4><p>{{#_i}}Duolingo motivates you to stay on track by recording how many days in a row you spend learning a language.{{/_i}}</p></div></span><span class="callout heart"><span class="splash-icon heart"></span><div class="text"><h4>{{#_i}}Hearts{{/_i}}</h4><p>{{#_i}}Hearts keep your lessons alive! You lose them when you answer incorrectly. When you\'re out of hearts, start over and try again.{{/_i}}</p></div></span></div></div></div></section><section dir="{{dir}}" class="mobile"><div class="section-inner"><div class="text"><h2>{{#_i}}Learn anytime, anywhere.{{/_i}}</h2>\x3c!-- (pending ui strings) <p>{{#_i}}Make your breaks and commutes more productive with our mobile app. Download it and see why Apple and Google gave us their highest accolades.{{/_i}}</p>--\x3e<p>{{#_i}}Make your breaks and commutes more productive with our iPhone and Android apps. Download them and see why Apple and Google gave us their highest accolades.{{/_i}}</p><p class="mobile-link"><a class="btn btn-primary btn-outline btn-small" href="https://itunes.apple.com/app/duolingo-learn-spanish-french/id570060128?mt=8" target="_blank" data-track-click="mobile download ios"><span class="splash-icon apple"></span><span class="link-text">{{#_i}}iOS{{/_i}}</span></a><a class="btn btn-primary btn-outline btn-small" href="https://play.google.com/store/apps/details?id=com.duolingo" data-track-click="mobile download android" target="_blank"><span class="splash-icon android"></span><span class="link-text">{{#_i}}Android{{/_i}}</span></a><a class="btn btn-primary btn-outline btn-small" href="https://www.windowsphone.com/s?appid=2d89520e-d360-4b5b-ba5a-5a15064aa935" target="_blank" data-track-click="mobile download windows"><span class="splash-icon windows"></span><span class="link-text">{{#_i}}Windows Phone{{/_i}}</span></a></p></div><span class="splash-icon apps"></span></div></section><section dir="{{dir}}" class="footer dark-theme"><div class="section-inner"><h2>{{#single_learning_language}}{{#_i}}Learn English with Duolingo.{{/_i}}{{/single_learning_language}}{{^single_learning_language}}{{#_i}}Learn a language with Duolingo.{{/_i}}{{/single_learning_language}}</h2><a class="btn btn-xl btn-green sign-up bottom-signup-btn" href="javascript:;" id="signup-link" data-id="signup-link" style="margin-bottom: 15px;" data-track-click="splash page register">{{#_i}}Get started{{/_i}}</a>{{>footer}}</div></section> ',
"stack-translate-element":'<div class="challenge-translate"><h1 class="player">{{#_i}}Translate this sentence to {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}{{#difficulty}}<span style="font-weight: normal; font-size: 13px; color: gray; position: absolute; right: 0px;">DIFFICULTY: {{difficulty}}/10</span>{{/difficulty}}</h1><div class="challenge-row"><div class="challenge-cell"><div class="text-to-translate"><div class="col-left">{{^need_flash}}<span id="big-speaker"></span>{{/need_flash}}</div><div class="col-right hints translation-source"><bdi>{{sentence}}</bdi></div></div></div><div class="challenge-cell"><div class="relative"><span class="icon icon-arrow-blue-right {{#rtl}}img-flipped{{/rtl}}"></span></div>{{>blame-popover}}<textarea placeholder="{{#_i}}Type in {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}" class="textarea-block textarea-lg textarea-translate" id="text-input" name="text-input" lang="{{target_language}}" tabindex="1"></textarea><div id="submitted-text"></div><div id="vkeyboard-placeholder"></div></div></div></div> ',
"standalone-event":'<main class="main-center"><div class="page-main"><ul class="activity-stream"></ul></div></main>',"static":'<main class="main-center about-us"><section class="page-main"><div class="about-banner hidden"><h1>{{#_i}}About us{{/_i}}</h1><span class="about-img skyline"></span><span class="about-img bridge"></span></div><div class="mobile-banner hidden"><h1>{{#_i}}Duolingo on the go{{/_i}}</h1></div><ul class="tabs big nav-tabs"><li data-tab="info_tab"><a href="/info">{{#_i}}The company{{/_i}}</a></li><li data-tab="study_tab"><a href="/effectiveness-study">{{#_i}}Effectiveness{{/_i}}</a></li><li data-tab="jobs_tab"><a href="/jobs">{{#_i}}Jobs{{/_i}}</a></li><li data-tab="press_tab"><a href="/press">{{#_i}}Press{{/_i}}</a></li></ul><div id=\'tab-container\'></div></section>{{>footer}}</main> ',
streak_freeze_description:"{{#_i}}Streak Freeze allows your streak to remain in place for one full day of inactivity.{{/_i}}",streak_freeze_title:"{{#_i}}Streak Freeze{{/_i}}",stream:'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner"><div class="box-gray">{{#enabled_groups_experiment}}{{#true_groups_experiment}}<div id="ranking"</div>{{/true_groups_experiment}}{{^true_groups_experiment}}<div id="friends"</div>{{/true_groups_experiment}}{{/enabled_groups_experiment}}{{^enabled_groups_experiment}}<div id="friends"</div>{{/enabled_groups_experiment}}</div></div></section><section class="page-main main-right"><h1>{{#_i}}Activity{{/_i}}</h1><ul class="activity-stream" style="margin-left: 140px;"><li id="no-friends" class="list-leaderboard-item">{{>avatar_small}}<h5 style="margin-bottom: 5px;">{{#_i}}You\u2019re alone, {{username}}!{{/_i}}</h5><p class="gray" style="margin: 0;">{{#_i}}Add some friends to see their activity.{{/_i}}</p></li></ul><div id="stream-container" class="stream-container"></div></section>{{>footer}}</main> ',
"stream-post":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header">{{#own}}<span class="left">{{#_i}}<a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a> wrote{{/_i}}</span>{{/own}}{{^own}}<span class="left">{{#_i}}<a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a> wrote to <a href="/{{#for_user}}{{username}}{{/for_user}}" class="username">{{#for_user}}{{username}}{{/for_user}}</a>{{/_i}}</span>{{/own}}<span class="stream-item-time">{{datetime_string}}</span></header><ul class="stream-item-comment-list stream-post"><li><a href="/{{#user}}{{username}}{{/user}}" class="username left small-margin-right">{{#user}}{{username}}{{/user}}:</a> <bdi>{{{processed_text}}}</bdi></li><div class="stream-comments"></div></ul>{{>event-footer}} ',
stream_post:"{{#_i}}{{username}} posted on your stream.{{/_i}}","strength-bar-notification":'<span class="icon icon-arrow-swoosh"></span><h1>{{#_i}}Duolingo lessons have changed!{{/_i}}</h1><p>{{#_i}}Now, instead of losing hearts, you have a strength bar that goes up and down. You complete the lesson once the bar reaches full strength.{{/_i}}</p><div class="btn btn-primary right dismiss-warning">{{#_i}}Got it!{{/_i}}</div>',study:'<div id="effectiveness" class="about-pages"><h2>{{#_i}}Does Duolingo work?{{/_i}}</h2><div class="main-results"><div class="duolingo"><div class="about-img watch"></div>{{#_i}}<h2>34</h2>Hours of Duolingo{{/_i}}</div><span class="equals">=</span><div class="college"><div class="about-img calendar"></div>{{#_i}}<h2>1</h2>University semester{{/_i}}<br/>{{#_i}}(11 weeks){{/_i}}</div></div><div class="study-container"><div class="about-container"><div class="about-study"><h4>{{#_i}}Study conducted by:{{/_i}}</h4><br/><h4>Roumen Vesselinov, PhD</h4><div>Queens College</div><div>City University of New York</div><br/><h4>John Grego, PhD</h4><div>{{#_i}}Statistics Department{{/_i}}</div><div>University of South Carolina</div></div></div><div class="summary"><p>{{#_i}}According to an <strong>independent study</strong> conducted by the City University of New York and the University of South Carolina, an average of 34 hours of Duolingo are equivalent to a full university semester of language education.{{/_i}}</p><p>{{#_i}}Participants took one university placement Spanish language test at the beginning of the study and one at the end. The improvement of language abilities was measured as the difference between the initial and the final language test results.{{/_i}}</p><p>{{#_i}}The study concluded that a person with no knowledge of Spanish would need between 26 and 49 hours (or 34 hours on average) to cover the material for the first college semester of Spanish.{{/_i}}</p><p>{{#_i}}Since a one semester university course usually takes more than 34 hours of work, this study suggests that Duolingo is more effective than an average university course.{{/_i}}</p></div></div><div class="center signup-box">{{^logged_in}}<a href="/#" class="signup btn btn-more-padding btn-green">{{#_i}}Sign up, it\u2019s free{{/_i}}</a>{{/logged_in}}<a href="http://static.duolingo.com/s3/DuolingoReport_Final.pdf" target="_blank" class="btn btn-green btn-more-padding {{#logged_in}}primary{{/logged_in}}">{{#_i}}Download Study (PDF){{/_i}}</a></div></div>',
table:'<table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr>{{#headers}}<th>{{name}}</th>{{/headers}}</tr></thead><tbody>{{#rows}}<tr>{{#cells}}<td>{{{cell}}}</td>{{/cells}}</tr>{{/rows}}</tbody></table> ',terms:'<h1>Terms and Conditions of Service</h1><ol class="terms"><li><h2>Website and Service Terms and Conditions - General.</h2> <p>The Duolingo website (\u201cWebsite\u201d) and related services (together with the Website, the \u201cService\u201d) are operated by Duolingo, Inc. (\u201cDuolingo,\u201d \u201cus,\u201d or \u201cwe\u201d). Access and use of the Service is subject to the following Terms and Conditions of Service (\u201cTerms and Conditions\u201d). By accessing or using any part of the Service, you represent that you have read, understood, and agree to be bound by these Terms and Conditions including any future modifications. Duolingo may amend, update or change these Terms and Conditions. If we do this, we will post a notice that we have made changes to these Terms and Conditions on the Website for at least 7 days after the changes are posted and will indicate at the bottom of the Terms and Conditions the date these terms were last revised. Any revisions to these Terms and Conditions will become effective the earlier of (i) the end of such 7-day period or (ii) the first time you access or use the Service after such changes. If you do not agree to abide by these Terms and Conditions, you are not authorized to use, access or participate in the Service.</p></li><li><h2>Description of Website and Service</h2> <p>The Service allows users to (i) learn or practice a language while they translate content from the Web and elsewhere, (ii) submit material for translation by other users, and in some cases (iii) submit translated language courses or new language courses. Users interested in learning or practicing a language are presented with different types of educational activities; while they perform these activities, they also generate valuable data such as translations of Web content. Users interested in submitting material for translation, or submitting translated material or courses, may do so only if they comply with requirements set forth in these Terms and Conditions concerning the material submitted and use of the translation. Duolingo may, in its sole discretion and at any time, update, change, suspend, make improvements to or discontinue any aspect of the Service, temporarily or permanently.</p></li><li><h2>Registration; Submission of Material for Translation; Course Contributor Submissions</h2><p>In connection with registering for and using the Service, you agree (i) to provide accurate, current and complete information about you and/or your organization as requested by Duolingo; (ii) to maintain the confidentiality of your password and other information related to the security of your account; (iii) to maintain and promptly update any registration information you provide to Duolingo, to keep such information accurate, current and complete; and (iv) to be fully responsible for all use of your account and for any actions that take place through your account.</p><p>Any material you submit for translation (\u201cTranslation Material\u201d) must be your original work or material owned by you. You will not submit any other type of material as Translation Material. The Service is not intended to be used to translate confidential or sensitive documents and you agree not to submit Translation Material that includes any such information. By submitting Translation Material to the Service, you grant us a fully paid up, worldwide license to use the Translation Material in connection with the operation of the Service and agree that, among other things, this license will allow us to (i) create and use translations that are derivative works of the material, (ii) disclose part or all of the Translation Material and any translations to one or more users of the Service in connection with their use of the Services and (iii) make the Translation Material and any translations available on the Service as a teaching tool, to promote the service or for other purposes in connection with our operation of the Service. This means that all or part of your Translation Material and any translations may be indexed and available on search engines such as Google and Bing. You understand that other Users will have access to Translation Material and that neither they or Duolingo have any obligation to you or anyone else to maintain the confidentiality of Translation Material. If we are able to complete a translation of any Translation Material you submit, we will provide you with a copy of the translation. As between us and you, you will own the copyright in any derivative work we create that is a translation of Translation Material you submit provided that you do not make or permit any commercial use of the translation. If you wish to make or permit commercial use of a translation, please contact us. You must have a separate agreement with us that expressly authorizes any commercial use of any translation produced by the Service before any such use occurs. </p><p>If you delete any Translation Material you submit from the Service we will in turn delete any translation tasks in progress and completed translations in the normal course of our operations. This may take up to thirty (30) days.</p><p>If you are or become a Course Contributor, you may offer to translate or have translated certain existing courses into other languages and you may offer to contribute new courses to the Service, as agreed between you and Duolingo on a case-by-case basis. Subject to any guidelines posted on the Service, you may perform any such translations or create any such courses in accordance with your own schedule and using your own facilities and resources. You are not required to become a Course Contributor and you may cease your activities as a Course Contributor at any time. You acknowledge that you do not desire and will not receive compensation for your activities as a Course Contributor or for our use of any Course Contributor Materials (as defined below) you submit. Any translation of an existing Duolingo course you submit or have submitted and any new language course you submit or have submitted as a Course Contributor (collectively, \u201cCourse Contributor Materials\u201d) are owned by you (subject of course to us retaining ownership of the existing Duolingo course you translated). By submitting any Course Contributor Material, you grant us a fully paid up, royalty-free, perpetual, sublicensable license to reproduce, display, perform, modify, create derivative works of, distribute and otherwise use such Course Contributor Material in any manner.</p></li><li><h2>Your Representations and Warranties</h2> <p>You represent and warrant to Duolingo that your access and use of the Service will be in accordance with these Terms and Conditions and with all applicable laws, rules and regulations of the United States and any other relevant jurisdiction, including those regarding online conduct or acceptable content, and those regarding the transmission of data or information exported from the United States and/or the jurisdiction in which you reside. You further represent and warrant that you have created or own any material you submit via the Service (including Translation Materials, Course Contributor Materials, and Activity Materials) and that you have the right, as applicable, to grant us a license to use that material as set forth in Section 3 or the right to assign that material to us as set forth in Section 10.</p></li><li><h2>Inappropriate Use</h2> <p>You will not upload, display or otherwise provide on or through the Service any content that: (i) is libelous, defamatory, abusive, threatening, harassing, hateful, offensive or otherwise violates any law or infringes upon the right of any third party (including copyright, trademark, privacy, publicity or other personal or proprietary rights); or (ii) in Duolingo\u2019s sole judgment, is objectionable or which restricts or inhibits any other person from using the Service or which may expose Duolingo or its users to any harm or liability of any kind. </p></li><li><h2>Indemnification of Duolingo</h2><p>You agree to defend, indemnify and hold harmless Duolingo and its directors, officers, employees, contractors, agents, suppliers, licensors, successors and assigns, from and against any and all losses, claims, causes of action, obligations, liabilities and damages whatsoever, including attorneys\' fees, arising out of or relating to your access or use of the Service, any false representation made to us (as part of these Terms and Conditions or otherwise), your breach of any of these Terms and Conditions,or any claim that any translation we provide to you is inaccurate, inappropriate or defective in any way whatsoever. </p></li><li><h2>NO REPRESENTATIONS OR WARRANTIES</h2><p> THE SERVICE, INCLUDING ALL IMAGES, AUDIO FILES AND OTHER CONTENT THEREIN, AND ANY OTHER INFORMATION, PROPERTY AND RIGHTS GRANTED OR PROVIDED TO YOU BY DUOLINGO ARE PROVIDED TO YOU ON AN \u201cAS IS\u201d BASIS. DUOLINGO AND ITS SUPPLIERS MAKE NO REPRESENTATIONS OR WARRANTIES OF ANY KIND WITH RESPECT TO THE SERVICE, EITHER EXPRESS OR IMPLIED, AND ALL SUCH REPRESENTATIONS AND WARRANTIES, INCLUDING WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT, ARE EXPRESSLY DISCLAIMED. WITHOUT LIMITING THE GENERALITY OF THE FOREGOING, DUOLINGO DOES NOT MAKE ANY REPRESENTATION OR WARRANTY OF ANY KIND RELATING TO ACCURACY, SERVICE AVAILABILITY, COMPLETENESS, INFORMATIONAL CONTENT, ERROR-FREE OPERATION, RESULTS TO BE OBTAINED FROM USE, OR NON-INFRINGEMENT. ACCESS AND USE OF THE SERVICE MAY BE UNAVAILABLE DURING PERIODS OF PEAK DEMAND, SYSTEM UPGRADES, MALFUNCTIONS OR SCHEDULED OR UNSCHEDULED MAINTENANCE OR FOR OTHER REASONS. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF IMPLIED WARRANTIES, SO THE ABOVE EXCLUSION MAY NOT APPLY TO YOU.</p> </li><li><h2>LIMITATION ON TYPES OF DAMAGES/LIMITATION OF LIABILITY</h2> <p>IN NO EVENT WILL DUOLINGO BE LIABLE TO YOU OR ANY THIRD PARTY CLAIMING THROUGH YOU (WHETHER BASED IN CONTRACT, TORT, STRICT LIABILITY OR OTHER THEORY) FOR INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL OR EXEMPLARY DAMAGES ARISING OUT OF OR RELATING TO THE ACCESS OR USE OF, OR THE INABILITY TO ACCESS OR USE, THE SERVICE OR ANY PORTION THEREOF, INCLUDING BUT NOT LIMITED TO THE LOSS OF USE OF THE SERVICE, INACCURATE RESULTS, LOSS OF PROFITS, BUSINESS INTERRUPTION, OR DAMAGES STEMMING FROM LOSS OR CORRUPTION OF DATA OR DATA BEING RENDERED INACCURATE, THE COST OF RECOVERING ANY DATA, THE COST OF SUBSTITUTE SERVICES OR CLAIMS BY THIRD PARTIES FOR ANY DAMAGE TO COMPUTERS, SOFTWARE, MODEMS, TELEPHONES OR OTHER PROPERTY, EVEN IF DUOLINGO HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. DUOLINGO\u2019S LIABILITY TO YOU OR ANY THIRD PARTY CLAIMING THROUGH YOU FOR ANY CAUSE WHATSOEVER, AND REGARDLESS OF THE FORM OF THE ACTION, IS LIMITED TO THE AMOUNT PAID, IF ANY, BY YOU TO DUOLINGO FOR THE SERVICE IN THE 12 MONTHS PRIOR TO THE INITIAL ACTION GIVING RISE TO LIABILITY. THIS IS AN AGGREGATE LIMIT. THE EXISTENCE OF MORE THAN ONE CLAIM HEREUNDER WILL NOT INCREASE THIS LIMIT.</p> </li><li><h2>Termination</h2><p>Duolingo may terminate your access and use of the Service immediately at any time, for any reason, and at such time you will have no further right to use the Service. You may terminate your Duolingo account at any time by following the instructions available through the Service. The provisions of these Terms and Conditions relating to the protection and enforcement of Duolingo\u2019s proprietary rights, your representations and warranties, disclaimer of representations and warranties, release and indemnities, limitations of liability and types of damages, ownership of data and information, governing law and venue, and miscellaneous provisions shall survive any such termination.</p> </li><li><h2>Proprietary Rights in Service Content and Activity Materials</h2><p>All content available through the Service, including designs, text, graphics, images, information, software, audio and other files, and their selection and arrangement (the "Service Content"), are the proprietary property of Duolingo or its licensors. No Service Content may be modified, copied, distributed, framed, reproduced, republished, downloaded, scraped, displayed, posted, transmitted, or sold in any form or by any means, in whole or in part, other than as expressly permitted in these Terms and Conditions. You may not use any data mining, robots, scraping or similar data gathering or extraction methods to obtain Service Content. As between you and Duolingo, all data, information and materials generated from your access and use of the educational activities made available on or through the Service, including translated content generated by you (collectively, the \u201cActivity Materials\u201d), shall be exclusively owned by Duolingo, and you shall not have any right to use such Activity Materials except as expressly authorized by these Terms and Conditions. Activity Materials will not include Translation Materials. By using the Service, you hereby assign to Duolingo any and all rights, title and interest, including any intellectual property rights or proprietary rights, in the Activity Materials. All rights of Duolingo or its licensors that are not expressly granted in these Terms and Conditions are reserved to Duolingo and its licensors. </p> </li><li><h2>Trademarks</h2> <p>\u201cDuolingo\u201d and all other trademarks, service marks, graphics and logos used in connection with the Service are trademarks or service marks of Duolingo or their respective owners, and certain of them are registered with the United States Patent and Trademark Office. Access and use of the Service does not grant or provide you with the right or license to reproduce or otherwise use the Duolingo name or any Duolingo or third-party trademarks, service marks, graphics or logos.</p></li><li><h2>Privacy</h2> <p>Use of the Service is also governed by our Privacy Policy, a copy of which is located at <a href="https://www.duolingo.com/privacy">https://www.duolingo.com/privacy</a>. By using the Service, you consent to the terms of the Privacy Policy. </p></li><li><h2>Notice for Claims of Copyright Violations and Agent for Notice</h2><p>If you are a copyright owner and have a good faith belief that any material available through the service infringes upon your copyrights, you may submit a copyright infringement notification to Duolingo pursuant to the Digital Millennium Copyright Act by providing us with the following information in writing:</p><ul class="standard-list" style="margin-bottom: 20px;"><li>an electronic or physical signature of the copyright owner or the person authorized to act on behalf of the owner of the copyright interest;</li><li>a description of the copyrighted work that you claim has been infringed;</li><li>a description of where the material that you claim is infringing is located on the Service, with enough detail that we may find it on the Service;</li><li>your address, telephone number, and email address;</li><li>a statement by you that you have a good faith belief that the disputed use is not authorized by the copyright owner, its agent, or the law; and</li><li>a statement by you, made under penalty of perjury, that the above information in your notice is accurate and that you are the copyright owner or are authorized to act on the copyright owner\'s behalf.</li></ul><p>Please consult your legal counsel for further details or see 17 U.S.C. \u00a7512(c)(3). Duolingo\u2019s Agent for Notice of claims of copyright infringement can be reached as follows:</p><ul><li>By mail: 5533 Walnut Street, third floor, Pittsburgh PA 15232</li><li>By email: <a href="mailto:abuse@duolingo.com">abuse@duolingo.com</a></li></ul></li><li><h2>Governing Law and Arbitration</h2> <p>These Terms and Conditions, its subject matter and Duolingo\u2019s and your respective rights under these Terms and Conditions shall be governed by and construed under the laws of the Commonwealth of Pennsylvania, United States of America, excluding the conflict of law provisions of that or any other jurisdiction. Any dispute arising between you and Duolingo will be resolved by binding arbitration. The arbitration shall be conducted by a single arbitrator in the County of Allegheny in the Commonwealth of Pennsylvania. Unless otherwise expressly required by applicable law, each party shall bear its own attorneys\u2019 fees without regard to which party is deemed the prevailing party in the arbitration proceeding. </p></li><li><h2>Language</h2> <p>This agreement was originally written in English (US). To the extent any translated version of this agreement conflicts with the English version, the English version controls. </p></li><li><h2>Miscellaneous</h2> <p>These Terms and Conditions constitute the entire agreement between Duolingo and you concerning the subject matter hereof. In the event that any of the Terms and Conditions are held by a court or other tribunal of competent jurisdiction to be unenforceable, such provisions shall be limited or eliminated to the minimum extent necessary so that these Terms and Conditions shall otherwise remain in full force and effect. A waiver by Duolingo or you of any provision of these Terms and Conditions or any breach thereof, in any one instance, will not waive such term or condition or any subsequent breach thereof. Duolingo may assign its rights or obligations under these Terms and Conditions without condition. These Terms and Conditions will be binding upon and will inure to the benefit of Duolingo and you, and Duolingo\u2019s and your respective successors and permitted assigns. </p></li><li><h2>Temporary Restrictions on Users from the European Union</h2> <p>Users within the European Union are not presently allowed to submit materials for translation or translated materials to Duolingo. While these users can continue to use the educational services offered through the Website, they will not be involved in the translation of any documents. If you submit a request for translation or translated materials to Duolingo, you thereby warrant and represent that you are not currently within the European Union, did not translate the document within the European Union, and will not be within the European Union when your translation request has been finalized. </p></li><li style="list-style: none;">Last revised on September 26th, 2014</li></ol> ',
"test-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type"><span class="skill-icon micro blue unlocked"><span class="skill-icon-image skill-icon-1"></span></span></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#shortcut}} {{#_i}}took a shortcut and learned {{num_skills}} {{#_ivar}}language_string{{/_ivar}} {{#pluralize}}skill,skills,{{num_skills}}{{/pluralize}}{{/_i}}{{/shortcut}}{{^shortcut}} {{#_i}}tested out of {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}{{/shortcut}}</p>{{>event-footer}}',
"timed-session-intro":'<div class="practice-intro-screen"><div class="owl owl-sporty"></div><div class="speech-bubble arrow-left"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner">{{#owned_timed_practice}}<h2>{{#_i}}Practice and beat the clock!{{/_i}}</h2>{{^mobile_web_view}}<p>{{#_i}}Answer correctly to get extra time and points. Use your keyboard to save time. (Check out our <a href="javascript:;" class="show-shortcuts blue">Shortcuts</a>).{{/_i}}</p>{{/mobile_web_view}}{{/owned_timed_practice}}{{^owned_timed_practice}}<h2>{{#_i}}Lesson Practice{{/_i}}</h2><p>{{#_i}}Complete a lesson that includes words you\'ve learned{{/_i}}</p>{{/owned_timed_practice}}</div></div></div> ',
timer:'<div class="inner {{#running_out}}running-out{{/running_out}}">{{#format_seconds}}{{seconds}}{{/format_seconds}}</div> ',timezones:'<select><option timeZoneId="1" gmtAdjustment="GMT-12:00" useDaylightTime="0" value="-12">(GMT-12:00) International Date Line West</option><option timeZoneId="2" gmtAdjustment="GMT-11:00" useDaylightTime="0" value="-11">(GMT-11:00) Midway Island, Samoa</option><option timeZoneId="3" gmtAdjustment="GMT-10:00" useDaylightTime="0" value="-10">(GMT-10:00) Hawaii</option><option timeZoneId="4" gmtAdjustment="GMT-09:00" useDaylightTime="1" value="-9">(GMT-09:00) Alaska</option><option timeZoneId="5" gmtAdjustment="GMT-08:00" useDaylightTime="1" value="-8">(GMT-08:00) Pacific Time (US & Canada)</option><option timeZoneId="6" gmtAdjustment="GMT-08:00" useDaylightTime="1" value="-8">(GMT-08:00) Tijuana, Baja California</option><option timeZoneId="7" gmtAdjustment="GMT-07:00" useDaylightTime="0" value="-7">(GMT-07:00) Arizona</option><option timeZoneId="8" gmtAdjustment="GMT-07:00" useDaylightTime="1" value="-7">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option><option timeZoneId="9" gmtAdjustment="GMT-07:00" useDaylightTime="1" value="-7">(GMT-07:00) Mountain Time (US & Canada)</option><option timeZoneId="10" gmtAdjustment="GMT-06:00" useDaylightTime="0" value="-6">(GMT-06:00) Central America</option><option timeZoneId="11" gmtAdjustment="GMT-06:00" useDaylightTime="1" value="-6">(GMT-06:00) Central Time (US & Canada)</option><option timeZoneId="12" gmtAdjustment="GMT-06:00" useDaylightTime="1" value="-6">(GMT-06:00) Guadalajara, Mexico City, Monterrey</option><option timeZoneId="13" gmtAdjustment="GMT-06:00" useDaylightTime="0" value="-6">(GMT-06:00) Saskatchewan</option><option timeZoneId="14" gmtAdjustment="GMT-05:00" useDaylightTime="0" value="-5">(GMT-05:00) Bogota, Lima, Quito, Rio Branco</option><option timeZoneId="15" gmtAdjustment="GMT-05:00" useDaylightTime="1" value="-5">(GMT-05:00) Eastern Time (US & Canada)</option><option timeZoneId="16" gmtAdjustment="GMT-05:00" useDaylightTime="1" value="-5">(GMT-05:00) Indiana (East)</option><option timeZoneId="17" gmtAdjustment="GMT-04:00" useDaylightTime="1" value="-4">(GMT-04:00) Atlantic Time (Canada)</option><option timeZoneId="18" gmtAdjustment="GMT-04:00" useDaylightTime="0" value="-4">(GMT-04:00) Caracas, La Paz</option><option timeZoneId="19" gmtAdjustment="GMT-04:00" useDaylightTime="0" value="-4">(GMT-04:00) Manaus</option><option timeZoneId="20" gmtAdjustment="GMT-04:00" useDaylightTime="1" value="-4">(GMT-04:00) Santiago</option><option timeZoneId="21" gmtAdjustment="GMT-03:30" useDaylightTime="1" value="-3.5">(GMT-03:30) Newfoundland</option><option timeZoneId="22" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-3">(GMT-03:00) Brasilia</option><option timeZoneId="23" gmtAdjustment="GMT-03:00" useDaylightTime="0" value="-3">(GMT-03:00) Buenos Aires, Georgetown</option><option timeZoneId="24" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-3">(GMT-03:00) Greenland</option><option timeZoneId="25" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-3">(GMT-03:00) Montevideo</option><option timeZoneId="26" gmtAdjustment="GMT-02:00" useDaylightTime="1" value="-2">(GMT-02:00) Mid-Atlantic</option><option timeZoneId="27" gmtAdjustment="GMT-01:00" useDaylightTime="0" value="-1">(GMT-01:00) Cape Verde Is.</option><option timeZoneId="28" gmtAdjustment="GMT-01:00" useDaylightTime="1" value="-1">(GMT-01:00) Azores</option><option timeZoneId="29" gmtAdjustment="GMT+00:00" useDaylightTime="0" value="0">(GMT+00:00) Casablanca, Monrovia, Reykjavik</option><option timeZoneId="30" gmtAdjustment="GMT+00:00" useDaylightTime="1" value="0">(GMT+00:00) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London</option><option timeZoneId="31" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="1">(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna</option><option timeZoneId="32" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="1">(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague</option><option timeZoneId="33" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="1">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option><option timeZoneId="34" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="1">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option><option timeZoneId="35" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="1">(GMT+01:00) West Central Africa</option><option timeZoneId="36" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Amman</option><option timeZoneId="37" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Athens, Bucharest, Istanbul</option><option timeZoneId="38" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Beirut</option><option timeZoneId="39" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Cairo</option><option timeZoneId="40" gmtAdjustment="GMT+02:00" useDaylightTime="0" value="2">(GMT+02:00) Harare, Pretoria</option><option timeZoneId="41" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius</option><option timeZoneId="42" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Jerusalem</option><option timeZoneId="43" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Minsk</option><option timeZoneId="44" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="2">(GMT+02:00) Windhoek</option><option timeZoneId="45" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="3">(GMT+03:00) Kuwait, Riyadh, Baghdad</option><option timeZoneId="46" gmtAdjustment="GMT+03:00" useDaylightTime="1" value="3">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option><option timeZoneId="47" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="3">(GMT+03:00) Nairobi</option><option timeZoneId="48" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="3">(GMT+03:00) Tbilisi</option><option timeZoneId="49" gmtAdjustment="GMT+03:30" useDaylightTime="1" value="3.5">(GMT+03:30) Tehran</option><option timeZoneId="50" gmtAdjustment="GMT+04:00" useDaylightTime="0" value="4">(GMT+04:00) Abu Dhabi, Muscat</option><option timeZoneId="51" gmtAdjustment="GMT+04:00" useDaylightTime="1" value="4">(GMT+04:00) Baku</option><option timeZoneId="52" gmtAdjustment="GMT+04:00" useDaylightTime="1" value="4">(GMT+04:00) Yerevan</option><option timeZoneId="53" gmtAdjustment="GMT+04:30" useDaylightTime="0" value="4.5">(GMT+04:30) Kabul</option><option timeZoneId="54" gmtAdjustment="GMT+05:00" useDaylightTime="1" value="5">(GMT+05:00) Yekaterinburg</option><option timeZoneId="55" gmtAdjustment="GMT+05:00" useDaylightTime="0" value="5">(GMT+05:00) Islamabad, Karachi, Tashkent</option><option timeZoneId="56" gmtAdjustment="GMT+05:30" useDaylightTime="0" value="5.5">(GMT+05:30) Sri Jayawardenapura</option><option timeZoneId="57" gmtAdjustment="GMT+05:30" useDaylightTime="0" value="5.5">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option><option timeZoneId="58" gmtAdjustment="GMT+05:45" useDaylightTime="0" value="5.75">(GMT+05:45) Kathmandu</option><option timeZoneId="59" gmtAdjustment="GMT+06:00" useDaylightTime="1" value="6">(GMT+06:00) Almaty, Novosibirsk</option><option timeZoneId="60" gmtAdjustment="GMT+06:00" useDaylightTime="0" value="6">(GMT+06:00) Astana, Dhaka</option><option timeZoneId="61" gmtAdjustment="GMT+06:30" useDaylightTime="0" value="6.5">(GMT+06:30) Yangon (Rangoon)</option><option timeZoneId="62" gmtAdjustment="GMT+07:00" useDaylightTime="0" value="7">(GMT+07:00) Bangkok, Hanoi, Jakarta</option><option timeZoneId="63" gmtAdjustment="GMT+07:00" useDaylightTime="1" value="7">(GMT+07:00) Krasnoyarsk</option><option timeZoneId="64" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="8">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option><option timeZoneId="65" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="8">(GMT+08:00) Kuala Lumpur, Singapore</option><option timeZoneId="66" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="8">(GMT+08:00) Irkutsk, Ulaan Bataar</option><option timeZoneId="67" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="8">(GMT+08:00) Perth</option><option timeZoneId="68" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="8">(GMT+08:00) Taipei</option><option timeZoneId="69" gmtAdjustment="GMT+09:00" useDaylightTime="0" value="9">(GMT+09:00) Osaka, Sapporo, Tokyo</option><option timeZoneId="70" gmtAdjustment="GMT+09:00" useDaylightTime="0" value="9">(GMT+09:00) Seoul</option><option timeZoneId="71" gmtAdjustment="GMT+09:00" useDaylightTime="1" value="9">(GMT+09:00) Yakutsk</option><option timeZoneId="72" gmtAdjustment="GMT+09:30" useDaylightTime="0" value="9.5">(GMT+09:30) Adelaide</option><option timeZoneId="73" gmtAdjustment="GMT+09:30" useDaylightTime="0" value="9.5">(GMT+09:30) Darwin</option><option timeZoneId="74" gmtAdjustment="GMT+10:00" useDaylightTime="0" value="10">(GMT+10:00) Brisbane</option><option timeZoneId="75" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="10">(GMT+10:00) Canberra, Melbourne, Sydney</option><option timeZoneId="76" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="10">(GMT+10:00) Hobart</option><option timeZoneId="77" gmtAdjustment="GMT+10:00" useDaylightTime="0" value="10">(GMT+10:00) Guam, Port Moresby</option><option timeZoneId="78" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="10">(GMT+10:00) Vladivostok</option><option timeZoneId="79" gmtAdjustment="GMT+11:00" useDaylightTime="1" value="11">(GMT+11:00) Magadan, Solomon Is., New Caledonia</option><option timeZoneId="80" gmtAdjustment="GMT+12:00" useDaylightTime="1" value="12">(GMT+12:00) Auckland, Wellington</option><option timeZoneId="81" gmtAdjustment="GMT+12:00" useDaylightTime="0" value="12">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option><option timeZoneId="82" gmtAdjustment="GMT+13:00" useDaylightTime="0" value="13">(GMT+13:00) Nuku\'alofa</option></select>',
title:"{{#_i}}Learn some {{#_iv}}{{language_name}}{{/_iv}}{{/_i}} ",topic:'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner"><div class="box-gray">{{#show_subscriptions}}<h2 style="margin-bottom: 15px;"><button class="btn btn-blue btn-edit-subscriptions btn-small right manage-subscriptions">{{#_i}}Edit{{/_i}}</button>{{#_i}}Your subscriptions:{{/_i}}</h2><ul class="nav-sidebar discussion-topic-list"><li class="divider"></li>{{#subscriptions}}<li class="{{#active}}active{{/active}}" data-id="{{topic_id}}">\x3c!-- <button class="btn btn-white btn-unsubscribe" data-id="{{topic_id}}"><span class="icon icon-trash-black"></span></button> --\x3e<a href="/topic/{{topic_id}}"><span class="icon icon-sidebar {{#language_abbrev}}flag flag-svg-small flag-{{language_abbrev}}{{/language_abbrev}}{{^language_abbrev}}icon-section-{{type}}{{/language_abbrev}}"><span class="flag flag-svg-micro flag-{{flag_abbrev}}"></span></span>{{#language_abbrev}}{{#_i}}{{#_iv}}{{language_string}}{{/_iv}} <span class="gray">from {{#_iv}}{{from_language_string}}{{/_iv}}</span>{{/_i}}{{/language_abbrev}}{{^language_abbrev}}{{#main}}{{#_i}}{{#_iv}}{{name}}{{/_iv}} <span class="gray">in {{#_iv}}{{from_language_string}}{{/_iv}}</span>{{/_i}}{{/main}}{{^main}}{{#_iv}}{{name}}{{/_iv}}{{/main}}{{/language_abbrev}}{{#active}}<span class="icon-arrow-right icon"></span>{{/active}}</a></li>{{/subscriptions}}{{^subscriptions}}<li class="empty-subscriptions">{{#_i}}None{{/_i}}</li>{{/subscriptions}}{{^hide_troubleshoot}}<li class="divider"></li><li><a href="/topic/{{troubleshooting_id}}"><span class="icon icon-sidebar icon-section-troubleshooting {{#rtl}}pseudo-bg-flipped{{/rtl}}"><span class="flag flag-svg-micro flag-{{troubleshoot_ui}}"></span></span>{{#_i}}Troubleshooting{{/_i}}</a></li>{{/hide_troubleshoot}}</ul>{{/show_subscriptions}}{{^show_subscriptions}}<h2>{{#_i}}Sections{{/_i}}</h2><ul class="nav-sidebar">{{#subtopics}}<li class="{{#active}}active{{/active}}"><a href="/topic/{{id}}"><span class="icon icon-sidebar {{#language_abbrev}}flag flag-svg-small flag-{{language_abbrev}}{{/language_abbrev}}{{^language_abbrev}}icon-section-{{type}}{{/language_abbrev}}"></span>{{#_ivar}}name{{/_ivar}}{{#active}}<span class="icon-arrow-right icon"></span>{{/active}}</a></li>{{/subtopics}}</ul>{{/show_subscriptions}}</div><div class="box-gray incubator-ad"><h2>{{#_i}}Looking for more language courses?{{/_i}}</h2><span class="skill-icon small unlocked blue right"><span class="skill-icon-image skill-icon-1"></span></span><p class="gray">{{#_i}}The Language Incubator allows the community to create new courses for Duolingo.{{/_i}}</p><a href="http://incubator.duolingo.com" class="btn btn-standard btn-outline btn-block" target="_blank">{{#_i}}See new courses{{/_i}}</a></div></div></section><section class="page-main main-right">{{^front_page}}{{#logged_in}}{{^trial_account}}<header class="topic-header discussion-header no-border"><button id="ask-question" class="btn btn-green right btn-more-padding">{{#_i}}New Discussion{{/_i}}</button><div class="search-topics"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="{{#_i}}Search{{/_i}}" class="search-box" id="search-comments" maxlength="50"/><div class="clear-button btn" style="display : none">x</div></div><h3 class="gray"><a href="/discussion" class="with-back-arrow"><span class="icon icon-arrow-back-gray"></span> {{#_i}}Discussion stream{{/_i}}</a></h3></header>{{/trial_account}}{{/logged_in}}{{/front_page}}<span class="comment-rankings">{{#front_page}}{{#logged_in}}{{^trial_account}}<button id="ask-question" class="btn btn-green right btn-more-padding">{{#_i}}New Discussion{{/_i}}</button>{{/trial_account}}{{/logged_in}}<div class="search-topics"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="{{#_i}}Search{{/_i}}" class="search-box" id="search-comments" maxlength="50"/><div class="clear-button btn" style="display : none">x</div></div>{{/front_page}}<h1 class="topic-heading">{{#front_page}}{{#_i}}Discussion stream{{/_i}}{{/front_page}}{{^front_page}}{{#learning_language_string}}{{#_i}}{{#_iv}}{{learning_language_string}}{{/_iv}} Discussions{{/_i}}{{/learning_language_string}}{{^learning_language_string}}{{#_i}}{{#_iv}}{{name}}{{/_iv}} Discussions{{/_i}}{{/learning_language_string}}{{/front_page}}</h1><ul class="nav-tabs"><li class="active" data-tab="hot" id="hot"><a href="javascript:;">{{#_i}}Popular||list-sort{{/_i}}</a></li><li data-tab="new" id="new"><a href="javascript:;">{{#_i}}New||list-sort{{/_i}}</a></li>{{^main_topic}}{{^front_page}}<li data-tab="sent" id="sent"><a href="javascript:;">{{#_i}}Sentences{{/_i}}</a></li>{{/front_page}}{{/main_topic}}{{^front_page}}<li data-tab="top" id="top"><a href="javascript:;">{{#_i}}Top All Time{{/_i}}</a></li>{{/front_page}}{{#show_active}}<li data-tab="active" id="active"><a href="javascript:;">{{#_i}}Active{{/_i}} (Mod)</a></li>{{/show_active}}{{#front_page}}<li data-tab="following" id="following"><a href="javascript:;">{{#_i}}Followed{{/_i}}</a></li>{{/front_page}}</ul><div class="comment-search"></div><div class="comment-main"><div id="hot-tab" class="panel"></div><div id="new-tab" class="panel hidden unordered-content"></div>{{^main_topic}}{{^front_page}}<div id="sent-tab" class="panel hidden unordered-content"></div>{{/front_page}}{{/main_topic}}{{^front_page}}<div id="top-tab" class="panel hidden unordered-content"></div>{{/front_page}}{{#show_active}}<div id="active-tab" class="panel hidden unordered-content"></div>{{/show_active}}{{#front_page}}<div id="following-tab" class="panel hidden unordered-content"></div>{{/front_page}}<div id="comments" class=""></div><i id="no-results" class="hidden">{{#_i}}No results found.{{/_i}}</i></div></span><div class="post-comment hidden" id="question-fields"></div></section>{{>footer}}<div id="topic-subscriptions"></div></main> ',
"topic-subscription-modal":'<div id="subscription-modal" class="modal hidden fade" style="margin-top: -200px;"><div class="modal-header"><h4 style="margin: 0;">{{#_i}}Manage your subscriptions{{/_i}}</h4><div class="close" data-dismiss="modal">{{#_i}}close{{/_i}}</div></div><div class="modal-body"><ul class="list-subscriptions">{{#topics}}<li><span class="icon icon-sidebar {{#language_abbrev}}flag flag-svg-small flag-{{language_abbrev}}{{/language_abbrev}}{{^language_abbrev}}icon-section-{{type}}{{/language_abbrev}}"><span class="flag flag-svg-micro flag-{{flag_abbrev}}"></span></span>{{#language_abbrev}}{{#_i}}<strong>{{#_iv}}{{language_string}}{{/_iv}}</strong> <span class="gray">from {{#_iv}}{{from_language_string}}{{/_iv}}</span>{{/_i}}{{/language_abbrev}}{{^language_abbrev}}{{#main}}{{#_i}}<strong>{{#_iv}}{{name}}{{/_iv}}</strong> <span class="gray">in {{#_iv}}{{from_language_string}}{{/_iv}}</span>{{/_i}}{{/main}}{{^main}}<strong>{{#_iv}}{{name}}{{/_iv}}</strong>{{/main}}{{/language_abbrev}}<button class=\'btn btn-small toggle-subscription {{#subscribed}}checkmark btn-green subscribed{{/subscribed}}{{^subscribed}}btn-outline btn-standard{{/subscribed}} right\' data-id="{{topic_id}}" data-subscribe="{{#_i}}Subscribe{{/_i}}" data-unsubscribe="{{#_i}}Subscribed{{/_i}}">{{#subscribed}}{{#_i}}Subscribed{{/_i}}{{/subscribed}}{{^subscribed}}{{#_i}}Subscribe{{/_i}}{{/subscribed}}</button></li>{{/topics}}</ul></div></div> ',
"translate-element":'<div class="challenge-translate"><h1 class="player">{{#_i}}Translate this text{{/_i}}{{#difficulty}}<span style="font-weight: normal; font-size: 13px; color: gray; position: absolute; right: 0px;">DIFFICULTY: {{difficulty}}/10</span>{{/difficulty}}</h1><div class="challenge-row"><div class="challenge-cell"><div class="text-to-translate">{{^need_flash}}<span id="big-speaker"></span>{{/need_flash}}<bdi><span class="hints translation-source">{{sentence}}</span></bdi></div></div><div class="challenge-cell"><div class="relative"><span class="icon icon-arrow-blue-right {{#rtl}}img-flipped{{/rtl}}"></span>{{>blame-popover}}</div><textarea placeholder="{{#_i}}Type in {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}" class="textarea-block textarea-lg textarea-translate" id="text-input" name="text-input" lang="{{target_language}}" tabindex="1" dir="auto" {{#disable_auto_correct_experiment_true}}{{#disable_autocorrect}} autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" {{/disable_autocorrect}}{{/disable_auto_correct_experiment_true}}></textarea><div id="submitted-text"></div><div id="vkeyboard-placeholder"></div></div></div></div> ',
"translation-cheaters":'<h1>Users who cheat on wiki translations, ordered by #reports</h1>{{#translation_directions}}<h2>From {{source_language}} into {{target_language}}</h2><ol>{{#cheaters}}<li><a href="/diagnostics/user_translations?user={{username}}">{{username}}</a> ({{num_reports}} {{#pluralize}}report,reports,{{num_reports}}{{/pluralize}}) {{/cheaters}}</ol>{{^cheaters}} No reports yet. {{/cheaters}}{{/translation_directions}}',"translation-contributors":'<div class="translators-list"><ul class="avatar-grid">{{#translators}}<li><a href="http://www.duolingo.com/{{username}}" target="_blank" class="avatar avatar-small translation-contributor-avatar {{#default}}default-avatar{{/default}}" data-toggle="tooltip" title="{{username}}">{{#default}}<img src="https://duolingo-images.s3.amazonaws.com/avatar/default_2/medium"/>{{/default}}{{^default}}<img src="http://www.duolingo.com/avatars/{{user_id}}/medium"/>{{/default}}<span class="ring"></span></a></li>{{/translators}}</ul>{{^translators}}<div class="no-translators">{{#_i}}No one has translated this article yet. Be the first to contribute!{{/_i}}</div>{{/translators}}</div> ',
"translation-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#_i}}translated {{count}} {{#pluralize}}sentence,sentences,{{count}}{{/pluralize}} of{{/_i}}</p><div class="stream-item-translation">{{#preview_image}}<div class="image" style="background-image: url( \'{{preview_image}}\')"></div>{{/preview_image}}{{^preview_image}}<div class="image" style="background-image: url( \'http://media-cache-cd0.pinimg.com/736x/64/fb/90/64fb90e12704e5556de87e7d44b380a2.jpg\')"></div>{{/preview_image}}<div class="excerpt"><strong class="title"><a href="/translation/{{translation_id}}">{{title}}</a></strong><p>{{blurb}}</p></div></div>{{>event-footer}} ',
"translation-reassigned":'You have successfully re-assigned this translation. <br><br><a href="/diagnostics/paid_translations">View assignments for all paid translations</a>',"translation-upload":'<main class="main-left"><section class="page-sidebar sidebar-right"><div class="inner"><div class="box-gray"><h2>{{#_i}}How does it work?{{/_i}}</h2><p>{{#_i}}You upload a document and language learners interact with it on Duolingo to translate it to the required language. It\u2019s fast and accurate.{{/_i}}</p><div class="owl owl-standard owl-small"></div></div></div></section><section class="page-main main-left"><ul class="nav-tabs upload-tabs"><li class="type-step change-step active" data-tab="type" data-index=1 id="type"><a href="javascript:;">{{#_i}}Type{{/_i}}</a></li><li class="inactive change-step input-step" data-tab="input" data-index=2 id="input"><a href="javascript:;">{{#_i}}Upload{{/_i}}</a></li><li class="inactive change-step prev-step" data-tab="prev" data-index=3 id="prev"><a href="javascript:;">{{#_i}}Preview{{/_i}}</a></li></ul><div id="type-step" class="panel"></div><div id="input-step" class="panel"></div><div id="prev-step" class="panel"></div></section></main> ',
"translations-ranked":'<main class="main-right"><div id="persistent-notifications"></div><section class="page-sidebar sidebar-left"><div class="inner">{{#user_reputation}}{{^trial_account}}<div class="translator-stats box-colored white"><h2>{{#_i}}Your translation tier{{/_i}}<span class="right">{{tier}}</span><span class="translator-tier-flag right"><span class="double-flag-source flag flag-svg-small flag-{{source_language}}"></span><span class="double-flag-target flag flag-svg-small flag-{{target_language}}"></span></span></h2><ul class="document-info"><li><span class="looks-good"></span>{{#_i}}{{#pluralize}}Upvote,Upvotes,{{peer_upvotes}}{{/pluralize}} from peers{{/_i}}<div class="translator-stats-numbers">{{peer_upvotes}}</div></li><li><span class="looks-wrong"></span>{{#_i}}{{#pluralize}}Downvote,Downvotes,{{peer_downvotes}}{{/pluralize}}{{/_i}}<div class="translator-stats-numbers">{{peer_downvotes}}</div></li><li class="show-votes"><a href="javascript:;" id ="show-upvotes">{{#_i}}(Show votes){{/_i}}</a>{{#have_votes}}<div class="upvotes-percentage {{#below_threshold}}under{{/below_threshold}}">{{percent_positive}}%<span id="percent"><br>{{#_i}}positive{{/_i}}</span></div>{{/have_votes}}</li></ul><div class="sidebar-progress" style="{{#current_user}}{{^show_practice}}margin-bottom: 0;{{/show_practice}}{{/current_user}}"><a href="javascript:;" id="explain-translator-tiers">{{#_i}}Progress towards next tier:{{/_i}}<span class="question-mark">?</span></a><div class="sidebar-progress-main"><div class="language-progress-bar-small" data-toggle="tooltip" title="{{#peer_upvotes}}{{#_i}}{{peer_upvotes}}/100 upvotes, {{percent_positive}}% positive{{/_i}}{{/peer_upvotes}}{{^peer_upvotes}}{{#_i}}No upvotes yet!{{/_i}}{{/peer_upvotes}}"><div class="padder"><div class="bar" style="width: {{new_progress_percent}}%;"></div></div><span class="level level-current">{{tier}}</span><span class="level level-next">{{next_tier}}</span></div></div></div></div>{{/trial_account}}{{/user_reputation}}<div class="box-gray">{{#filters}}<h2>{{#_ivar}}name{{/_ivar}}</h2><ul class="list-checkable" id="{{id}}">{{#options}}<li class="{{#preferred}}checked{{/preferred}}"><input class="border" type="checkbox" {{#preferred}}checked{{/preferred}} id="{{id}}" value="{{id}}"><label for="{{id}}">{{#_ivar}}label{{/_ivar}}</label></li>{{/options}}</ul>{{/filters}}<h2>{{#_i}}Categories{{/_i}}</h2><ul class="list-checkable" id="categories" style="margin: 0;"><li><input type="checkbox" class="border" value="all" id="all-categories"><label for="all-categories">{{#_i}}All{{/_i}}</label><div class="num-documents">{{total_documents}}</div></li>{{#categories}}<li class="category-option {{#preferred}}checked{{/preferred}}"><input type="checkbox" class="border category-checkbox" {{#preferred}}checked{{/preferred}} id="{{id}}" value="{{id}}"><label for="{{id}}">{{#_ivaru}}label{{/_ivaru}}</label><div class="num-documents">{{num_documents}}</div></li>{{/categories}}</ul>{{#pg13_filter}}<ul class="list-checkable" id="content-rating"><li><input class="border" type="checkbox" {{#preferred}}checked{{/preferred}} id="{{id}}" value="{{id}}"><label for="{{id}}">{{#_i}}Show PG-13 documents{{/_i}}</label></ul>{{/pg13_filter}}</div></div></section><section class="page-main main-right">{{#logged_in}}{{#show_intro_owl}}<div class="immersion-intro"><div class="speech-bubble arrow-right" id="bubble-hover"><div class="arrow-right-container"><div class="arrow"></div></div><div class="inner ">{{^trial_account}}<h2>{{#_i}}Immerse yourself!{{/_i}}</h2><p>{{#_i}}Practice your skills by reading and translating real articles from the Internet.{{/_i}}</p><p>{{#_i}}Some sentences have been translated by the Duolingo community, while other sentences still need to be translated or improved upon!{{/_i}}</p><div class="btn success dismiss-intro-owl">{{#_i}}Get Started!{{/_i}}</div>{{/trial_account}}{{#trial_account}}<h2>{{#_i}}Immerse yourself!{{/_i}}</h2><p>{{#_i}}Practice your skills by reading and translating real articles from the Internet.{{/_i}}</p><p>{{#_i}}Some sentences have been translated by the Duolingo community, while other sentences still need to be translated or improved upon!{{/_i}}</p><div class="btn success dismiss-intro-owl">{{#_i}}Preview it now!{{/_i}}</div>{{/trial_account}}</div></div><div class="owl-peeking-right-container"><div class="owl owl-standard"></div></div></div>{{/show_intro_owl}}{{/logged_in}}{{^logged_in}}<div id="logged-out-immersion-header"><span id="language-direction">{{#_i}}Show translations from{{/_i}}&nbsp; <label class="blue-select no-focus smaller"><select id="select-translation-direction">{{#translation_directions}}<option {{#selected}}selected{{/selected}} data-source="{{source_language}}" data-target="{{target_language}}">{{#_i}}{{#_ivar}}source_language_name{{/_ivar}} into {{#_ivar}}target_language_name{{/_ivar}}{{/_i}}</option>{{/translation_directions}}</select></label></span><span id="upload-advert">{{#_i}}Want to have your content translated by Duolingo?{{/_i}} <a href="mailto:sales@duolingo.com?subject=Upload account" target="_blank"><br><strong>{{#_i}}Contact us.{{/_i}}</strong></a></span></div>{{/logged_in}}<div class="translate-main {{#show_intro_owl}}intro-fade{{/show_intro_owl}}" id="translation-tabs">{{^trial_account}}<a href="/translations/upload"><button class="btn btn-green right" id="upload-document">{{#_i}}Upload a document{{/_i}}</button></a>{{/trial_account}}{{#immersion_search_bar_ff_true}}<span class="search-topics"><span class="icon icon-search-gray"></span><input type="text" name="search" value="" placeholder="{{#_i}}Search{{/_i}}" class="search-box" id="search-translations" maxlength="50"/><div class="clear-button btn" style="display : none">x</div></span>{{/immersion_search_bar_ff_true}}<h1>{{#_i}}Immersion{{/_i}}</h1><ul class="tabs big nav-tabs" style="position: relative; z-index: 1;"><li class="active" data-tab="all"><a href="javascript:;">{{#_i}}All documents{{/_i}}</a></li><span class="sort-by">{{#_i}}Sort by{{/_i}}<label class="blue-select-inline" id="sort-list-label"><select id="sort-list">{{#sort_options}}<option value="{{rule}}" {{#preferred}}selected{{/preferred}}>{{#_ivar}}label{{/_ivar}}</option>{{/sort_options}}</select></label></span>{{#show_your_edits_ff_true}}{{^trial_account}}{{#logged_in}}<li data-tab="history"><a href="javascript:;">{{#_i}}Your edits{{/_i}}</a></li>{{/logged_in}}{{/trial_account}}{{/show_your_edits_ff_true}}{{#show_your_uploads_ff_true}}{{#user_has_uploaded}}<li data-tab="uploaded"><a href="javascript:;">{{#_i}}Your uploads{{/_i}}</a></li>{{/user_has_uploaded}}{{/show_your_uploads_ff_true}}</ul><div id="default-tab" class="panel hidden"></div><div id="date-tab" class="panel hidden"></div><div id="history-tab" class="panel hidden"></div><div id="uploaded-tab" class="panel hidden"></div><div id="net_upvotes-tab" class="panel hidden"></div></div></section>{{>footer}}</main><div class="modal hidden" id="translator-tier-explanation"><div class="close"></div><div class="modal-header"><h1>{{#_i}}Translation tiers{{/_i}}</h1></div><div class="modal-body"><p>{{#_i}}Each language learner is assigned a <i>tier</i> representing the quality of their translations, as judged by other learners. Your progress within each tier depends on the votes your sentence translations receive from other learners <i>in your tier or higher</i>. You advance to the next tier once you have at least 100 upvotes and at least 90% of your votes are positive.<sup>1</sup>{{/_i}}</p><p>{{#_i}}Because more accurate translations demonstrate greater proficiency in a language, learners at higher tiers earn more skill points for translating, editing, and rating others\' translations.{{/_i}}</p><table class="table table-striped table-test"><thead><tr><th style="width:100px"><strong>{{#_i}}Tier{{/_i}}</strong></th><th><strong>{{#_i}}Reward for each word<br>translated or edited{{/_i}}</strong></th><th><strong>{{#_i}}Reward for each<br>sentence rated{{/_i}}</strong></th></tr></thead><tbody><tr><td>1</td><td><span class="coin tier-explanation-coin fractional">&#8539;</span></td><td>&#8212;</td></tr><tr><td style="width:100px">2</td><td><span class="coin tier-explanation-coin fractional">&#188;</span></td><td><span class="coin tier-explanation-coin">1</span></td></tr><tr><td style="width:100px">3</td><td><span class="coin tier-explanation-coin fractional">&#189;</span></td><td><span class="coin tier-explanation-coin">2</span></td></tr><tr><td style="width:100px">{{#_i}}4 or higher{{/_i}}</td><td><span class="coin tier-explanation-coin">1</span></td><td><span class="coin tier-explanation-coin">5</span></td></tr></tbody></table><div class="modal-footnote">{{#_i}}1. For each sentence translation you do, there is a limit on the number of votes that can affect your progress. The limit is one vote for every five words in the original sentence (so for a 10 word sentence, only the first two votes are counted).{{/_i}}</div></div></div><div class="modal hidden" id="show-your-votes"><div class="close"></div><div id="show-your-votes-body"></div></div> ',
"translations-ranked-item":'<li class="list-document-item"><div class="list-document-item-right" data-toggle="popover" data-popover="#popover2-{{uniquifier}}"><div class="document-progress-bar"><div class="bar" style="width: {{percent_high_quality}}%;"></div><div class="bar-started" style="width: {{percent_sents_started}}%; "></div></div>{{#_i}}<strong>{{num_sents_done}}/{{num_sents_total}}</strong> done{{/_i}}</div><div id="popover2-{{uniquifier}}" class="popover right"><div class="arrow-left-container"><div class="arrow"></div></div><div class="inner"><div class="content" style="padding: 10px;"><ul class="pie-dot-list"><li><span class="pie-dot checked-by-community"></span>{{#_i}}<strong>{{percent_high_quality}}%</strong> of sentences translated and checked.{{/_i}}</li><li><span class="pie-dot needs-checking"></span>{{#_i}}<strong>{{percent_low_quality}}%</strong> have a translation that needs checking.{{/_i}}</li></ul></div></div></div><a href="/translation/{{id}}">{{#document}}{{#preview_image}}<div class="immersion-teaser-image" style="background-image: url( \'{{preview_image}}\')"></div>{{/preview_image}}{{^preview_image}}<div class="immersion-teaser-image owl-default"></div>{{/preview_image}}{{/document}}</a><header class="list-document-item-header"><a href="/translation/{{id}}" {{#translated_title}}data-toggle="tooltip" title="{{cur_translation}}"{{/translated_title}}>{{#document}}{{title}}{{/document}}</a>{{#commercial}}&nbsp;<span class="sponsored">{{#_i}}Sponsored{{/_i}}</span>{{/commercial}}</header>{{#snippet}}<div class="immersion-snippet"> &hellip;{{{snippet}}}&hellip; </div>{{/snippet}}<footer class="list-document-item-footer"><div class="vote-module-small"><div class="vote-count {{#user_upvoted}}active-upvoted{{/user_upvoted}} {{#user_downvoted}}active-downvoted{{/user_downvoted}}">{{votes}}</div>{{#logged_in}}<button class="btn btn-custom vote-up" data-doc="{{id}}"><span class="icon icon-vote-up-small {{#user_upvoted}}active{{/user_upvoted}}"></span></button><button class="btn btn-custom vote-down" data-doc="{{id}}"><span class="icon icon-vote-down-small {{#user_downvoted}}active{{/user_downvoted}}"></span></button>{{/logged_in}}</div><span class="list-document-item-category">{{#_i}}Category:{{/_i}} {{#document}}{{#_ivaru}}category{{/_ivaru}}{{/document}}</span><span class="list-document-item-poster">{{#_i}}Posted by:{{/_i}} {{#uploader}}{{#_i}}{{username}}{{/_i}}{{/uploader}}</span></footer></li>',
"translations-ranked-list":'<ul class="ranked-translations list-documents"></ul>{{^translations}}{{#all_shown}}<div class="no-docs-message">{{#_i}}Looks like you haven\'t uploaded anything yet!{{/_i}}</div>{{/all_shown}}{{^all_shown}}<div class="no-docs-message">{{#_i}}No matching documents, try adjusting your search criteria!{{/_i}}</div>{{/all_shown}}{{/translations}}{{#more}}{{#has_translations}}<img class="translations-spinner" src="/images/medium-loader.gif">{{/has_translations}}{{/more}} ',
"translator-promotion-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type tier-promotion"><span class="translator-tier-flag"><span class="double-flag-source flag flag-svg-small flag-{{source_language}}"></span><span class="double-flag-target flag flag-svg-small flag-{{target_language}}"></span></span></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#_i}}reached translation tier {{new_tier}}!{{/_i}}</p>{{>event-footer}} ',
"trial-overlay":'<div class="trial-overlay {{#profile_overlay}}sidebar{{/profile_overlay}}"><div class="overlay-prompt">{{#store_overlay}}{{#num_rupees}}{{#_i}}You have {{num_rupees}} {{#pluralize}}lingot,lingots,{{num_rupees}}{{/pluralize}}.{{/_i}} {{#_i}}Create a profile to spend {{#pluralize}}it,them,{{num_rupees}}{{/pluralize}} in the store!{{/_i}}{{/num_rupees}}{{^num_rupees}}{{#_i}}Create a profile to get power-ups, bonus skills, and more!{{/_i}}{{/num_rupees}}{{/store_overlay}}{{#comment_overlay}}{{#_i}}Create a profile to join in on discussions!{{/_i}}{{/comment_overlay}}{{#profile_overlay}}{{#_i}}Create a profile to save your progress!{{/_i}}{{/profile_overlay}}<a class="btn btn-block btn-green register-delayed" href="javascript:;" data-track-click="trial account overlay create profile">{{#_i}}Create a profile{{/_i}}</a><a class="btn btn-block btn-blue existing-login" href="javascript:;" data-track-click="trial account overlay login">{{#_i}}Sign in{{/_i}}</a></div></div> ',
"trusted-translator-days-off":'<h1>Trusted translator vacation days ({{source}}&rarr;{{target}})</h1> If a username is checked, it means the user has that day off. <br><br><form action="/diagnostics/set_trusted_translator_days_off" method="POST"><input type="submit" value="Update"><br><br>{{#weeks}}<h3>Week of {{start_date}}</h3><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><th>Username</th>{{#dates}}<th>{{date}} ({{weekday}})</th>{{/dates}}</thead><tbody>{{#user_info}}<tr><td>{{username}}</td>{{#user_date_info}}<td>{{#checked}}<input type="hidden" name="{{date}}_{{username}}" value="0">{{/checked}}<input type="checkbox" name="{{date}}_{{username}}" value="1" {{#checked}}checked{{/checked}}></td>{{/user_date_info}}</tr>{{/user_info}}</tbody></table><br><br>{{/weeks}}</form> ',
"ui-string":'<div class="translate-ui-strings"><h1>Translate this to {{target_language_string}}</h1><div class="pane-left">{{source_text}}</div><div class="pane-right"><textarea id="target-text">{{target_text}}</textarea><button type="submit" class="btn right primary" id="save-button">Save</button></div></div><ul class="details"><li><strong>Context</strong><br/>{{context}}</li><li><strong>Comment</strong><br/>{{comment}}</li><li><strong>Last modifier</strong><br/>{{last_modifier}}</li><li><strong>Last edit</strong><br/>{{last_modification}}</li><li><strong>ID</strong><br/>{{id}}</li></ul> ',
"ui-string-list":'<table class="table translate-jobs"><thead><tr><th>#</th><th>Source</th><th>Target</th></tr></thead><tbody>{{#ui_strings}}<tr id="ui-string-{{id}}" class="comment"></tr>{{/ui_strings}}{{^ui_strings}}<tr><td>No UI Strings here.</td><td></td><td></td><td></td><td></td><td></td></tr>{{/ui_strings}}</tbody></table> ',unfollow_wiki_translation:'<!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e<html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Unsubscribe</title>{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /></head><body><div id="site"><div id="wrapper"><div id="app" class="unsubscribe"><main class="main-center"><section class="page-main"><span class="owl owl-standard"></span><h1>{{#_i}}You will no longer receive emails about sentences in "{{document_title}}".{{/_i}}</h1><br><h2>{{#_i}}And just so you know, you can always unsubscribe from other emails in <a href="/settings/notifications">your settings</a>.{{/_i}}</h2></section></main></div></div></body></html>',
"unlock-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type"><span class="skill-icon micro {{icon_color}} unlocked"><span class="skill-icon-image skill-icon-{{icon_index}}"></span></span></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a></span><span class="stream-item-time">{{datetime_string}}</span></header><p class="stream-item-content">{{#_i}}learned {{#determiner}}{{#_ivar}}language_string{{/_ivar}}{{/determiner}} {{#_ivar}}language_string{{/_ivar}} skill{{/_i}}</p>{{>event-footer}}',
unsubscribe:'<!DOCTYPE html>\x3c!--[if lt IE 7 ]> <html class="ie6"> <![endif]--\x3e\x3c!--[if IE 7 ]> <html class="ie7"> <![endif]--\x3e\x3c!--[if IE 8 ]> <html class="ie8"> <![endif]--\x3e\x3c!--[if IE 9 ]> <html class="ie9"> <![endif]--\x3e\x3c!--[if (gt IE 9)|!(IE)]>\x3c!--\x3e<html class=""> \x3c!--<![endif]--\x3e<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>{{#_i}}Unsubscribe{{/_i}}</title>{{#css}}<link rel="stylesheet" href="{{.}}" />{{/css}}<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" /></head><body><div id="site"><div id="wrapper"><div id="app" class="unsubscribe"><main class="main-center"><section class="page-main"><span class="owl owl-standard"></span>{{#email}}<h1>{{#_i}}You have been unsubscribed from <strong>{{#_iv}}{{notify_type}}||Unsubscribed from X{{/_iv}}</strong>.{{/_i}}</h2><br><h2>{{#_i}}And just so you know, you can always unsubscribe from other emails in <a href="/#/settings/notifications">your settings</a>.{{/_i}}</h2><br><br>{{/email}}{{^email}}<h1>{{#_i}}We had an issue finding your account.{{/_i}}</h1><br><h2>{{#_i}}Please go to your <a href="/settings/notifications">Account Settings</a> to unsubscribe from emails.{{/_i}}</h2><br><br>{{/email}}</section></main></div></div></body></html> ',
"unsupported-landing":'<div class="unsupported-browsers-container"><div class="unsupported-browsers"><h1>{{#_i}}Did you know that your browser is out of date?{{/_i}}</h1><p>{{#_i}}Your browser is out of date and no longer compatible with the new Duolingo. A list of the most popular web browsers can be found below. Just click on the icons to go to their download page.{{/_i}}</p><div class="list-browser"><div class="item"><a href="http://www.microsoft.com/windows/Internet-explorer" target="_blank"><span class="browser-icon icon-ie"></span><span class="name">Internet Explorer</span></a></div><div class="item"><a href="http://www.google.com/chrome" target="_blank"><span class="browser-icon icon-chrome"></span><span class="name">Google Chrome</span></a></div><div class="item"><a href="http://www.mozilla.com/firefox/" target="_blank"><span class="browser-icon icon-ff"></span><span class="name">Mozilla Firefox</span></a></div></div></div></div> ',
"upload-document-input":'<h1>{{#_i}}New upload{{/_i}}</h1><div class="upload-panel">{{^free_upload}}<ul class="nav-tabs upload-tabs"><li data-type=\'automatic\' class="active tab automatic"><a href="javascript:;">{{#_i}}Automatic{{/_i}}</a></li><li data-type=\'manual\' class="tab manual"><a href="javascript:;">{{#_i}}Manual{{/_i}}</a></li></ul>{{/free_upload}}{{#free_upload}}<button class="btn right btn-primary see-preview" disabled="disabled" data-wait="{{#_i}}Submitting...{{/_i}}">{{#_i}}Submit{{/_i}}</button><div class="url-wrapper"><label for="url-input">{{#_i}}Enter a web address{{/_i}}</label><input id="url-input" type="text" class="url"/></div><div id="preview-failed" class="preview-failure hidden">{{#_i}}This web address is invalid or the page could not be loaded.{{/_i}}</div><div id="content-filtered" class="preview-failure hidden"><img src="https://duolingo-images.s3.amazonaws.com/avatars/35443/MkkoL3svF3/medium"><div>{{#_i}}DuoBot thinks this document might not be appropriate for language learners of all ages.{{/_i}}</div></div><div id="is-copyrighted" class="preview-failure hidden"><div>{{#_i}}Only documents released under a creative commons license can be uploaded for free translation.{{/_i}}</div></div>{{/free_upload}}{{^free_upload}}<div class="panel" id="manual-upload"><div class="form-row"><h5>{{#_i}}Headline{{/_i}}</h5><input type="text" class="article-headline"/></div><div class="form-row"><h5>{{#_i}}Body{{/_i}}<span class="word-count">{{#_i}}Word count:{{/_i}} <span id="word-count">{{count}}</span></span><span class="estimated-cost">{{#_i}}Estimated cost:{{/_i}} $ <span id="cost">{{cost}}</span></span></h5><textarea id="paste-text" class="article-body"></textarea></div><div class="form-row"><div class="col-left"><h5>{{#_i}}Translate into this language:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="manual-language"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#preview_data}}{{#target_languages}}<option value="{{id}}}">{{#_ivar}}name{{/_ivar}}</option>{{/target_languages}}{{/preview_data}}</select></label></div><div class="col-right"><h5>{{#_i}}Enter an image url (optional):{{/_i}}</h5><input id="image-url" style="height: 35px;" type="text" class="url"/></div></div><div class="form-row"><div class="col-left"><h5>{{#_i}}Pick a category that best fits:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="manual-category"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#preview_data}}{{#categories}}<option value="{{id}}">{{#_ivaru}}label{{/_ivaru}}</option>{{/categories}}{{/preview_data}}</select></label></div><div class="col-right"><h5>{{#_i}}Enter a document url (optional):{{/_i}}</h5><input id="manual-url" style="height: 35px;" type="text" class="url"/></div></div><div class="footer"><button id="see-preview" class="btn right btn-lg btn-primary manual-submit" disabled="disabled" style="margin-left: 10px;" data-wait="{{#_i}}Submitting...{{/_i}}">{{#_i}}Submit{{/_i}}</button><button class="btn right btn-lg btn-standard cancel-input">{{#_i}}Cancel{{/_i}}</button></div></div><div class="panel" id="automatic-upload"><button class="btn right btn-primary btn-lg see-preview" disabled="disabled" data-wait="{{#_i}}Submitting...{{/_i}}">{{#_i}}Submit{{/_i}}</button><div class="url-wrapper"><label for="url-input">{{#_i}}Enter a web address{{/_i}}</label><input id="url-input" type="text" class="url"/></div><div id="preview-failed" class="hidden">{{#_i}}This web address is invalid or the page could not be loaded.{{/_i}}</div></div>{{/free_upload}}</div>',
"upload-document-preview":'<h1>{{#_i}}Preview{{/_i}}</h1><div class="upload-panel preview-panel"><div id="preview-text" class="wiki-document-body">{{#custom_html}}{{{custom_html}}}{{/custom_html}}{{^custom_html}}<h3>{{title}}</h3><span class="flat-image-wrapper"><a class="fbox fancybox.image" rel="group" href="{{image_url}}" target="_blank" style="display: inline; height: 100%;"><img src="{{image_url}}" class="image-thumb"></a></span>{{#paragraphs}}<p>{{paragraph_text}}</p>{{/paragraphs}}{{/custom_html}}</div><div class="footer">{{#from_url}}<div class="form-row"><div class="col-left"><h5>{{#_i}}Pick a category that best fits:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="category"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#categories}}<option value="{{id}}" {{#selected}}selected{{/selected}}>{{#_ivaru}}label{{/_ivaru}}</option>{{/categories}}</select></label></div><div class="col-right"><h5>{{#_i}}Translate into this language:{{/_i}}</h5><label class="blue-select no-focus smaller"><select id="language"><option value=\'None\' style="color: #999;"><i>{{#_i}}None selected{{/_i}}</i></option>{{#target_languages}}<option value="{{id}}}" {{#selected}}selected{{/selected}}>{{#_ivar}}name{{/_ivar}}</option>{{/target_languages}}</select></label></div></div>{{/from_url}}<div class="button-row">{{^free_upload}}<button id="edit" class="btn left btn-standard btn-large make-edits cancel-preview">{{#_i}}Edit{{/_i}}</button>{{/free_upload}}<button id="submit-upload" class="btn right btn-large btn-primary" style="margin-left: 10px;" data-wait="{{#_i}}Uploading...{{/_i}}">{{#_i}}Upload{{/_i}}</button><button id="cancel-upload" class="btn right btn-large btn-standard cancel-preview">{{#_i}}Cancel{{/_i}}</button></div><div id="upload-failure" class="hidden warning-message" style="margin-top: 10px">{{#_i}}Your document failed to upload, please try a different webpage:{{/_i}}<ul><li id="error-message">{{#_ivar}}upload_failure_reason{{/_ivar}}</li></ul></div></div></div>',
"upload-document-type":'<h1>{{#_i}}Upload for translation{{/_i}}</h1><ul class="pick-upload-plan"><li class="free"><div class="inner"><div class="header"><span class="skill-icon unlocked red small"><span class="skill-icon-image skill-icon-2"></span></span></div><div class="content"><h3>{{#_i}}Non-commercial{{/_i}}</h3><p>{{#_i}}Translation is free for content released under a creative commons license.{{/_i}}</p></div><div class="footer"><a id="free-upload" data-type="free" class="btn btn-block btn-primary upload-type">{{#_i}}Free translation{{/_i}}</a></div></div></li><li class="commercial"><div class="inner"><div class="header"><span class="skill-icon unlocked green small"><span class="skill-icon-image skill-icon-19"></span></span></div><div class="content"><h3>{{#_i}}Commercial{{/_i}}</h3>{{^commercial_user}}<p>{{#_i}}For copyrighted content.<br/>You have to <a href="mailto:sales@duolingo.com?subject=Upload account" target="_blank"><strong>apply</strong></a> for an account.{{/_i}}</p>{{/commercial_user}}{{#commercial_user}}<p>{{#_i}}For partners of Duolingo with copyrighted content.{{/_i}}</p>{{/commercial_user}}</div><div class="footer"><a id="paid-upload" data-type="paid" class="btn btn-primary btn-block upload-type">{{#_i}}Paid translation{{/_i}}</a></div></div></li></ul>',
"user-performance-model-query":' <h1>User performance model query</h1><form> Username: <input type="text" name="username" {{#username}}value="{{username}}"{{/username}}><br>Generator ID: <input type="text" name="generator_id" {{#generator_id}}value="{{generator_id}}"{{/generator_id}}><br>Challenge type: <select name="element_type">{{#element_types}}<option name="{{name}}" {{#selected}}selected{{/selected}}>{{name}}</option>{{/element_types}}</select><br><br><input type="submit" value="Submit"></form><table border="1" rules="groups" cellpadding=10><thead bgcolor="aaddff"><tr><th>Logistic model parameter</th><th>Value (log odds coefficient)</th></tr></thead><tbody>{{#parameters}}<tr><td>{{feature_name}}</td><td>{{coefficient}}</td></tr>{{/parameters}}</tbody></table><br><b>Log odds sum</b>: {{log_odds_sum}}<br><b>Predicted probability</b>: {{predicted_probability}}',
"user-search-results":'{{#users}}<li>{{>avatar_micro}}{{#is_being_blocked}}<button class="btn btn-small right" disabled="disabled">{{#_i}}Blocked{{/_i}}</button>{{/is_being_blocked}}{{^is_being_blocked}}{{^is_a_blocker}}<a href="javascript:;" class="btn btn-small {{#is_following}}btn-green is-friend success{{/is_following}}{{^is_following}}btn-standard{{/is_following}} right" data-toggle="follow" data-follow-text="{{#_i}}Add{{/_i}}" data-unfollow-text="{{#_i}}Friends{{/_i}}" data-user="{{id}}" data-follow-class="" data-unfollow-class="is-friend", data-silent="true">{{#is_following}}{{#_i}}Friends{{/_i}}{{/is_following}}{{^is_following}}{{#_i}}Add{{/_i}}{{/is_following}}</a>{{/is_a_blocker}}{{/is_being_blocked}}<a href="/{{username}}" class="username"><strong>{{username}}</strong></a>{{fullname}}</li>{{/users}}{{^users}}<li id="no-users" style="padding-left: 10px;text-align: center;color: #999;">{{#_i}}No users found.{{/_i}}</li>{{/users}} ',
user_flair:'<ul class="user-flair">{{#flair}}{{#level_data_sorted}}<li><span class="flag flag-svg-micro flag-{{language}}"></span> {{level}}</li>{{/level_data_sorted}}{{#streak}}<li><span class="icon icon-streak-micro {{#rtl}}img-flipped{{/rtl}}"></span> {{streak}}</li>{{/streak}}{{/flair}}</ul>',"vocab-list":'<h1>{{#_i}}{{#_iv}}{{language_string}}{{/_iv}} words learned{{/_i}}</h1><div class="vocab-word-count"><span id="word-count">{{#loading_word_count}}{{#_i}}...||loading symbol{{/_i}}{{/loading_word_count}}{{^loading_word_count}}{{word_count}}{{/loading_word_count}}</span> {{#_i}}Words{{/_i}}</div><table id="vocab-list" class="table table-striped sortable"><thead><th>{{#_i}}Word{{/_i}} <span class="sorting-icon"></span></th><th>{{#_i}}Part of speech{{/_i}} <span class="sorting-icon"></span></th><th class="sorttable_sorted_reverse">{{#_i}}Last practiced{{/_i}} <span class="sorting-icon"></span><span id="sorttable_sortrevind">&nbsp;</span></th><th>{{#_i}}Strength{{/_i}} <span class="sorting-icon"></span></th></thead><tbody id="vocab-rows">{{#vocab_overview}}<tr class="word-cell needs-hint"><td class="word" data-lexeme="{{lexeme_id}}" data-string="{{word_string}}"><span class="hidden">{{normalized_string}}</span><span class="hoverable-word hover">{{word_string}}</span></td><td>{{pos}}</td><td><span class="hidden">{{last_practiced_ms}}</span>{{#pretty_date}}{{last_practiced}}{{/pretty_date}}</td><td><span class="hidden">{{strength}}</span><span class="word-strength-icon strength-{{strength_bars}}"></span></td></tr>{{/vocab_overview}}</tbody></table>{{^has_vocab}}<h2 class="gray center">{{#_i}}You haven\'t learned any words yet!{{/_i}}</h2>{{/has_vocab}} ',
"vocab-overview":'<main class="main-right"><section class="page-sidebar sidebar-left"><div class="inner"><div class="box-colored white spaced-rep"><span id="default-sidebar"><h2>{{#_i}}Spaced repetition{{/_i}}</h2><p>{{#_i}}Duolingo\'s algorithms figure out when you should practice words to get them into your long-term memory.{{/_i}}</p><table><tr><td><span class="word-strength-icon strength-4"></span></td><td>{{#_i}}Still strong{{/_i}}</td></tr><tr><td><span class="word-strength-icon strength-3"></span></td><td>{{#_i}}Pretty good{{/_i}}</td></tr><tr><td><span class="word-strength-icon strength-2"></span></td><td>{{#_i}}Time to practice{{/_i}}</td></tr><tr><td><span class="word-strength-icon strength-1"></span></td><td>{{#_i}}Overdue{{/_i}}</td></tr></table>{{#has_vocab}}<a id="start-flashcards" href="javascript:;" class="btn btn-block btn-blue">{{#_i}}Review flashcards{{/_i}}</a>{{/has_vocab}}</span><span id="word-sidebar" class="hidden"></span></div></div></section><section id="vocabulary-list" class="page-main main-right"></section></main><div id="flashcards-container"></div><div id="word-modal" class="modal fade hidden"></div> ',
"vocab-word":'<h1><span class="listen-button-small"></span>{{surface_form}} {{#pos}}<span class="word-type">{{#pos_string}}({{#_ivar}}pos_string{{/_ivar}}){{/pos_string}}</span>{{/pos}}</h1><div class="vocabulary-main"><ul class="word-info"><li><span class="label">{{#_i}}Strength{{/_i}}</span><ul class="word-strength medium"><li class="filled"></li><li {{#strength_s}}class="filled"{{/strength_s}}></li><li {{#strength_m}}class="filled"{{/strength_m}}></li><li {{#strength_l}}class="filled"{{/strength_l}}></li></ul></li><li>{{#_i}}Times seen{{/_i}}<h3>{{times_seen}}</h3></li>{{#pos}}<li>{{#_i}}Part of speech{{/_i}}<h3>{{#_ivar}}pos_string{{/_ivar}}</h3></li>{{/pos}}{{#gender}}<li>{{#_i}}Gender{{/_i}}<h3>{{gender}}</h3></li>{{/gender}}{{#pronunciation}}<li>{{#_i}}Pronounciation{{/_i}}<h3>{{pronunciation}}</h3></li>{{/pronunciation}}{{#seen_forms}}<li class="forms-seen">{{#_i}}{{#pluralize}}Form,Forms,{{seen_forms}}{{/pluralize}} seen{{/_i}}<h3>{{seen_forms}}</h3></li>{{/seen_forms}}</ul>{{#lexemes_data}}{{#seen}}<table class="translations table table-striped" border="0" cellspacing="0" cellpadding="0"><thead><tr><th style="width: 24%;"><h4>{{surface_form}} {{#gender}}<span class="gender">({{gender}})</span>{{/gender}}<ul class="word-strength xsmall right" style="margin: 5px 0 0 5px;"><li class="filled"></li><li {{#strength_s}}class="filled"{{/strength_s}}></li><li {{#strength_m}}class="filled"{{/strength_m}}></li><li {{#strength_l}}class="filled"{{/strength_l}}></li></ul></h4></th>{{#example_data}}{{#has_examples}}<th style="width: 33%;">{{#_i}}Example sentence{{/_i}}</th><th style="width: 33%;">{{#_i}}Translation{{/_i}}</th>{{/has_examples}}{{/example_data}}</tr></thead><tbody>{{#example_data}}{{#examples}}<tr><td style="background: white;"><strong class="translation">{{hint}}</strong></td>{{#example}}<td>{{value}}</td><td>{{translation}}</td>{{/example}}</tr>{{#sentences}}<tr class="more"><td style="border-top: none; background: white;"></td><td>{{value}}</td><td>{{translation}}</td></tr>{{/sentences}}{{/examples}}{{^has_examples}}<tr><td><strong class="translation">{{hint}}</strong></td><td></td><td></td></tr>{{/has_examples}}{{/example_data}}</tbody></table>{{/seen}}{{/lexemes_data}}{{#is_verb}}<h4>{{#_i}}Conjugation table{{/_i}}</h4><div id="verb-table"></div>{{/is_verb}}</div><div class="vocabulary-sidebar"><div class="box-practice"><a href="/word_practice/{{language}}/{{lemma_value}}/{{pos_key}}" class="btn primary large">{{#_i}}Practice word{{/_i}}</a>{{#dnp}}<div class="remove allow"><strong>{{#_i}}Word is removed from practice{{/_i}}</strong><a href="javascript:;" id="allow-word" class="btn">{{#_i}}Add to practice again{{/_i}}</a></div>{{/dnp}}{{^dnp}}{{^strength_l}}<div class="remove"><strong>{{#_i}}Know this word perfectly?{{/_i}}</strong><a href="javascript:;" id="dnp-word" class="btn">{{#_i}}Remove from practice{{/_i}}</a></div>{{/strength_l}}{{/dnp}}</div>{{#image}}<div class="image"><img src="{{image}}"><span class="caption">{{noun_phrase}}</span><span class="overlay"></span></div>{{/image}}</div> ',
"welcome-event":'{{#user}}{{>avatar_medium}}{{/user}}<span class="stream-item-type default"></span><header class="stream-item-header"><span class="left"><a href="/{{#user}}{{username}}{{/user}}" class="username">{{#user}}{{username}}{{/user}}</a> {{#_i}}did the {{#_ivar}}language_string{{/_ivar}} welcome lesson{{/_i}}</span><span class="stream-item-time">{{datetime_string}}</span></header>{{>event-footer}}',"welcome-fb-friends":'<div class="player-inner"><section class="player-container" style="opacity: 1;">{{>player-header}}<div class="player-main intro-end"><div class="friend-boxes">{{#num_friends}}<h1 class="player">{{#_i}}Your Facebook friends on Duolingo{{/_i}}</h1><div class="pane"><h3>{{num_friends}} of your friends are already here</h3><div class="subline"><p class="gray" style="margin: 0;">{{#_i}}You are now following them:{{/_i}}</p></div><ul id="followed-friends" class="list-users-small lines">{{#show_friends}}<li {{#not_shown}} style="display: none"{{/not_shown}}><a class="follow-button btn btn-small right success" data-user="{{user_id}}">Following</a><a href="/{{username}}" class="has-twipsy avatar-small" data-original-title="{{name}}"><img src="{{#picture}}{{#data}}{{url}}{{/data}}{{/picture}}" class="avatar"></a><a href="/{{username}}" class="username">{{name}}</a><span class="language">{{#_i}}{{#_ivar}}learning_language_string{{/_ivar}} Level {{learning_language_level}}{{/_i}}</span></li>{{/show_friends}}</ul>{{#num_more_friends}}<p class="more-friends-on-duo">{{#_i}}<strong>+{{num_more_friends}} more</strong> of your friends are already here{{/_i}} <a id="show-more-friends" href="javascript:;">\u2192 {{#_i}}show them{{/_i}}</a></p>{{/num_more_friends}}</div>{{/num_friends}}{{^num_friends}}<h1 class="player">{{#_i}}None of your Facebook friends are here yet. Invite them!{{/_i}}</h1>{{/num_friends}}<div class="pane">{{#num_friends}}<h3>{{#_i}}Now invite others to the party!{{/_i}}</h3>{{/num_friends}}<div class="subline"><div class="form-row"><input type="text" class="input-block" id="search-friends" placeholder="{{#_i}}Search for friends to invite{{/_i}}"></div></div><ul id="invite-friends" class="list-users-small lines">{{>other-fb-friends}}</ul></div></div></div><footer id="controls" class="player-footer"><div class="col-right"><button class="btn btn-lg btn-blue right margin-left" id="next-button">{{#_i}}Next{{/_i}}</a></div></footer></section></div> ',
"welcome-session-end-coach":'<div class="player-inner welcome-end"><section class="player-container">{{>player-header}}<div class="player-main intro-end coach-intro-end {{#coach_email_signup_experiment_true}}email-option{{/coach_email_signup_experiment_true}}">{{#coach_email_signup_experiment_true}}<h1 class="player">{{#_i}}Choose a daily XP goal{{/_i}}</h2>{{/coach_email_signup_experiment_true}}{{^coach_email_signup_experiment_true}}<h1 class="player">{{#_i}}Choose a daily XP goal that will help you stay motivated!{{/_i}}</h2>{{/coach_email_signup_experiment_true}}<span class="coach-intro-screen">{{^coach_email_signup_experiment_true}}<span class="owl owl-small owl-coach"></span>{{/coach_email_signup_experiment_true}}<span class="coach-goal-chooser"><ul class="goal-chooser"><li><label class="btn btn-standard btn-outline daily-goal-option"><input type="radio" name="daily-goal" data-goal="10"/> <span class="title">{{#_i}}Casual{{/_i}}</span> <span class="xp-text">{{#_i}}10 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-outline daily-goal-option"><input type="radio" name="daily-goal" data-goal="20"/> <span class="title">{{#_i}}Regular{{/_i}}</span> <span class="xp-text">{{#_i}}20 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-outline daily-goal-option"><input type="radio" name="daily-goal" data-goal="30"/> <span class="title">{{#_i}}Serious{{/_i}}</span> <span class="xp-text">{{#_i}}30 XP per day{{/_i}}</span></label></li><li><label class="btn btn-standard btn-outline daily-goal-option"><input type="radio" name="daily-goal" data-goal="50"/> <span class="title">{{#_i}}Insane{{/_i}}</span> <span class="xp-text">{{#_i}}50 XP per day{{/_i}}</span></label></li></ul></span>{{#coach_email_signup_experiment_true}}<span class="email-prompt"><span class="email-prompt-text">{{#_i}}Enter your email to receive notifications that will help you keep your daily goal.{{/_i}}</span><input name="coach-email-address" type="text" placeholder="{{#_i}}Email{{/_i}} {{#_i}}(optional){{/_i}}"/><div class="error-flag hidden" id="invalid-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Invalid email{{/_i}}</div><div class="error-flag hidden" id="taken-email-error" ><span class="arrow-left-container"><span class="arrow"></span></span>{{#_i}}Email already taken{{/_i}}</div></span>{{/coach_email_signup_experiment_true}}</span></div>{{#coach_email_signup_experiment_true}}<span class="owl owl-small owl-coach-up owl-coach-email"></span>{{/coach_email_signup_experiment_true}}<footer id="controls" class="player-footer"><div class="col-right"><span class="btn btn-lg btn-blue right margin-left continue-home" disabled=disabled>{{#_i}}Continue to Duolingo homepage{{/_i}}</span></div></footer></section></div> ',
"welcome-session-end-fb":'<div class="player-inner"><section class="player-container">{{>player-header}}<div class="player-main intro-fb"><h1 class="player">{{#_i}}Find your friends on Facebook!{{/_i}}</h1><h2 class="player">{{#_i}}Learners with friends have 200% more success{{/_i}}</h2><div class="owl-friends"></div><div class="owl-peeking-container"><div class="owl owl-standard {{#rtl}}img-flipped{{/rtl}}"></div><div class="owl owl-sporty"></div><div class="owl owl-graduation {{#rtl}}img-flipped{{/rtl}}"></div></div></div><footer id="controls" class="player-footer"><div class="col-right"><button id="facebook-connect" class="btn btn-lg btn-blue right fb-connect margin-left">{{#_i}}Connect using Facebook{{/_i}}</button><button id="skip-button" type="submit" class="btn btn-standard btn-lg right margin-right">{{#_i}}Skip this step{{/_i}}</button></div></footer></section></div>',
"wiki-document-body":'{{#custom_html}}{{{custom_html}}}{{/custom_html}}{{^custom_html}}{{#document_paragraphs}}<div class="wiki-paragraph" style="display:block" id="{{pane}}paragraph-{{paragraph_index}}">{{#sentences}}{{#second}}<span class="flat-image-wrapper">{{#has_images}}<a class="fbox fancybox.image" rel="group" href="{{first_image_url}}" style="display: inline; height: 100%;"><img src="{{first_image_url}}" class="image-thumb"></a>{{#hidden_images}}<a class="fbox fancybox.image" rel="group" href="{{.}}" style="display: none;"></a>{{/hidden_images}}{{/has_images}}{{^has_images}}<img src="/images/owl-waving-gray.png" class="image-thumb"/>{{/has_images}}</span>{{/second}}{{^index}}<h1 class="wiki-document-title"><span class="sentence-wrapper" data-index="{{index}}" id="{{pane}}sentence-wrapper-{{index}}"></span></h1>{{/index}}{{#index}}<span class="sentence-wrapper" data-index="{{index}}" id="{{pane}}sentence-wrapper-{{index}}"></span>{{/index}}{{/sentences}}</div>{{/document_paragraphs}}{{/custom_html}}',
"wiki-document-sentence":'<span id="{{pane}}sentence-{{index}}" data-index="{{index}}" class="show-hints sentence {{#cur_translation}}{{^cur_translation_quality}}low-quality{{/cur_translation_quality}}{{#cur_translation_quality}}high-quality{{/cur_translation_quality}}{{/cur_translation}} {{#show_translated}}{{^cur_translation}}translation-placeholder{{/cur_translation}} show-translated{{/show_translated}}">{{#show_translated}}{{!For now, custom_html is used only for images.}}{{#is_image_sentence}}{{{sentence_custom_html}}}<div class="translated-image-text">{{cur_translation}}</div>{{/is_image_sentence}}{{^is_image_sentence}}{{#content_edit}}{{content_edit}}{{/content_edit}}{{^content_edit}}{{#cur_translation}}{{cur_translation}}{{/cur_translation}}{{^cur_translation}}{{{no_translation_placeholder}}}{{/cur_translation}}{{/content_edit}}{{/is_image_sentence}}{{/show_translated}}{{^show_translated}}{{#sentence_custom_html}}{{{sentence_custom_html}}}{{/sentence_custom_html}}{{^sentence_custom_html}}{{#sentence_hunks}}<span class="token {{#marked}}marked{{/marked}}" data-token-index="{{token_index}}" id="token_{{token_index}}">{{hunk}}</span>{{/sentence_hunks}}{{/sentence_custom_html}}{{/show_translated}}</span><span style="{{^index}}letter-spacing: 0;{{/index}} position:relative;"> &nbsp; <span id="{{pane}}sentence-coin-{{index}}" class="edit-translation-coin coin animated"></span></span>',
"wiki-document-sentence-sidebar":'<div class="inner {{^cur_translation}}no-translation{{/cur_translation}}"><div class="content">{{^just_finished_article}}<div class="close-header"><a href="javascript:;" data-margin="5" data-toggle="tooltip" title="{{#_i}}Press Esc to go back{{/_i}}" class="close close-container with-back-arrow"><span class="icon icon-arrow-back-gray"></span>{{#_i}}Back{{/_i}}</a></div>{{#cur_translation_or_no_need}}<div class="cur-translation">{{#cur_translation}}{{cur_translation}}{{^multiple_revisions}}{{#explanation}}<div class="comment" style="margin-top: 10px;"><strong>{{#_i}}Comment by {{username}}:{{/_i}}</strong> {{explanation}}</div>{{/explanation}}{{/multiple_revisions}}{{/cur_translation}}{{#user_says_no_need_to_translate}}<i>{{#_i}}This image contains no text.{{/_i}}</i>{{/user_says_no_need_to_translate}}</div>{{/cur_translation_or_no_need}}{{#editable}}<div class="wiki-textarea-container"><div class="form-row no-margin"><textarea id="edit-text-input-{{index}}" name="edit-text-input" placeholder="{{#_iv}}Type in {{target_language_name}}{{/_iv}}" class="wiki-textarea textarea-block edit-text-input" >{{^user_input}}{{cur_translation}}{{/user_input}}{{#user_input}}{{user_input}}{{/user_input}}</textarea><div class="error-flag" id="invalid-translation-error" style="display: hidden;">{{#_i}}Translation does not seem correct.{{/_i}}</div></div><div class="form-row no-margin" style="margin-top: 10px;"><textarea class="textarea-block wiki-edit-explanation" id="edit-explanation-{{index}}" type="text" name="edit-reason" style="" {{#cur_translation_or_no_need}} placeholder="{{#_i}}Explain your correction (optional){{/_i}}" {{/cur_translation_or_no_need}}{{^cur_translation_or_no_need}} placeholder="{{#_i}}Add a comment (optional){{/_i}}" {{/cur_translation_or_no_need}} ></textarea></div>{{#cur_translation}}{{^latest_translation_from_self}}<div class="share-credit"><form><input type="checkbox" name="share-credit" {{^user_disapproved}}checked{{/user_disapproved}}>{{#_i}}Share credit with previous translator.{{/_i}}<span class="question-mark">?</span><div class="share-credit-explanation hidden">{{#_i}}When you share credit, both you and the previous translator get credit for any upvotes your translation receives (in terms of tier progress).{{/_i}}&nbsp; <a href="javascript:;" class="dismiss-share-credit-explanation">{{#_i}}Okay, got it.{{/_i}}</a></div></form></div>{{/latest_translation_from_self}}{{/cur_translation}}<div style="margin-top: 10px"><a href="javascript:;" style="margin-right: 10px" class="save-edit btn success" data-margin="5" data-toggle="tooltip" title="{{^cur_translation}}{{#_i}}Press Enter to Submit{{/_i}}{{/cur_translation}}{{#cur_translation}}{{#_i}}Press Enter to Save{{/_i}}{{/cur_translation}}">{{#cur_translation}}{{#_i}}Save{{/_i}}{{/cur_translation}}{{^cur_translation}}{{#_i}}Submit translation{{/_i}}{{/cur_translation}}</a><a href="javascript:;" class="cancel-edit btn btn-standard" data-toggle="tooltip" title="{{#_i}}Press Esc to Cancel{{/_i}}">{{#_i}}Cancel{{/_i}}</a>{{#is_image_sentence}}{{^user_says_no_need_to_translate}}<span style="margin-left: 10px"></span><a href="javascript:;" style="margin-top: 10px" class="image-contains-no-text btn btn-standard">{{#_i}}This image contains no text{{/_i}}</a>{{/user_says_no_need_to_translate}}{{/is_image_sentence}}</div></div>{{/editable}}{{^editable}}<div class="report-translator-cheating-wrapper"><span class="last-edit right">{{#_i}}Last edit by:{{/_i}}<a href="http://www.duolingo.com/{{username}}" target="_blank"><strong>{{username}}</strong></a><span class="translator-tier-flag-micro"><span class="double-flag-source flag flag-svg-micro flag-{{source_language}}"></span><span class="double-flag-target flag flag-svg-micro flag-{{target_language}}"></span></span><span class="reputation-tier">{{user_reputation_tier}}</span><a href="http://www.duolingo.com/{{username}}" target="_blank" class="avatar avatar-micro"><img src="http://www.duolingo.com/avatars/{{user_id}}/medium"/></a></span>{{^latest_translation_from_self}}{{^reported_cheating}}<a class="report-translator-cheating left" href="javascript:;"><span class="icon-flag-micro icon"></span>{{#_i}}Report abuse{{/_i}}<a>{{/reported_cheating}}{{#reported_cheating}}<a class="report-translator-cheating reported" href="javascript:;">{{#_i}}You have reported this translator (undo){{/_i}}</a>{{/reported_cheating}}{{/latest_translation_from_self}}</div><div class="translation-action"><a href="javascript:;" class="btn btn-blue btn-small rate-translation-option vote-up {{#user_approved}}active{{/user_approved}}" data-rating="1" data-margin="5" data-toggle="tooltip" title="{{#_i}}Press + to Rate &quot;Looks good&quot;{{/_i}}" style="margin-right: 10px"><span class="icon icon-check-white-small"></span>{{#_i}}Looks good{{/_i}}</a><a href="javascript:;" class="btn btn-blue btn-small rate-translation-option vote-down {{#user_disapproved}}active{{/user_disapproved}}" data-rating="-1" data-margin="5" data-toggle="tooltip" title="{{#_i}}Press - to Rate &quot;Looks wrong&quot;{{/_i}}" style="margin-right: 10px"><span class="icon icon-x-white-small"></span>{{#_i}}Looks wrong{{/_i}}</a><a href="javascript:;" class="btn btn-standard btn-small edit-translation edit-button right" data-margin="5" data-toggle="tooltip" title="{{#_i}}Press Enter to Edit{{/_i}}"><span class="icon"></span>{{#_i}}Edit{{/_i}}</a></div>{{#user_rating}}<ul class="translation-votes hidden" id="translation-votes-{{index}}"><li class="upvotes"><span class="icon icon-person-micro"></span> {{num_upvotes}}</li><li class="upvotes"><span class="icon icon-person-micro"></span> {{num_downvotes}}</li></ul>{{/user_rating}}{{/editable}}<div id="revisions-stream" style="{{#multiple_revisions}}{{#user_rating}}margin-top: 20px;{{/user_rating}}{{^user_rating}}margin-top: 30px;{{/user_rating}}{{/multiple_revisions}}"></div>{{/just_finished_article}}{{#just_finished_article}}<div class="wiki-translation-end"><div class="wiki-translation-end-header">{{#_i}}Pretty sweet! <br> You finished the article!{{/_i}}</div><div class="lighter">{{#_i}}{{#pluralize}}+{{user_num_points}} XP,+{{user_num_points}} XP,{{user_num_points}}{{/pluralize}}{{/_i}}</div>{{!If next_level is not set, it means the user is at the max. level, so don\'t show the bar.}}{{#next_level}}<div id="level-bar" class="language-progress-bar-big opacity-0 slide-in"><div class="level-next level">{{next_level}}</div><div class="bar" style="width: {{cur_level_percent_done}}%;"><div id="next-hook" class="popover-hook"><div id="next-level" class="popover popover-blue progress-xp-popover" style="display: block;"><div class="arrow-bottom-container"><div class="arrow"></div></div><div class="popover-content"><strong>{{#_i}}Next level{{/_i}}</strong>{{#_i}}{{#pluralize}}<span id="level_points">{{user_points_within_level}}</span>/{{level_total_points}} XP,<span id="level_points">{{user_points_within_level}}</span>/{{level_total_points}} XP,{{user_points_within_level}}{{/pluralize}}{{/_i}}</div></div></div></div><div class="level-current level">{{prev_level}}</div></div>{{/next_level}}</div>{{/just_finished_article}}</div>{{#machine_translation}}{{#allow_toggle_machine_translation}}<hr style="margin: 30px 0 30px 0"><h4 class="toggle-machine-translation {{#show_machine_translation}}active{{/show_machine_translation}}"><span class="triangle"></span>{{#_i}}DuoBot\u2019s translation{{/_i}}</h4>{{#show_machine_translation}}<div class="machine-translation"><a class="medium-circular-avatar left" href="http://www.duolingo.com/duobot"><img src="https://duolingo-images.s3.amazonaws.com/avatars/35443/MkkoL3svF3/medium"/></a>{{machine_translation}}</div>{{/show_machine_translation}}{{/allow_toggle_machine_translation}}{{/machine_translation}}</div> ',
"wiki-sentence-mini-popover":'<div class="inner {{^cur_translation}}no-translation{{/cur_translation}} mini-popover-action"><div class="content">{{#editable}}<btn class="btn btn-small btn-green save-translation" data-toggle="tooltip" data-margin="5" title="{{^cur_translation}}{{#_i}}Press Enter to Submit{{/_i}}{{/cur_translation}}{{#cur_translation}}{{#_i}}Press Enter to Save{{/_i}}{{/cur_translation}}">{{^cur_translation}}{{#_i}}Submit translation{{/_i}}{{/cur_translation}}{{#cur_translation}}{{#_i}}Save edit{{/_i}}{{/cur_translation}}</btn><div class="btn btn-small btn-standard cancel-translation" data-toggle="tooltip" data-margin="5" title="{{#_i}}Press Esc to Cancel{{/_i}}">{{#_i}}Cancel{{/_i}}</div>{{/editable}}{{^editable}}<div class="btn btn-blue btn-small rate-translation-option vote-up {{#user_approved}}active{{/user_approved}}" data-toggle="tooltip" title="{{#_i}}Press + to Rate &quot;Looks good&quot;{{/_i}}" data-rating="1" data-margin="5"><span class="icon icon-check-white-small"></span><span class="coin rate-translation-coin animated" data-rating="1">1</span></div><div class="btn btn-blue btn-small rate-translation-option vote-down {{#user_disapproved}}active{{/user_disapproved}}" data-toggle="tooltip" title="{{#_i}}Press - to Rate &quot;Looks wrong&quot;{{/_i}}" data-rating="-1" data-margin="5"><span class="icon icon-x-white-small" style="margin-right: -2px;"></span><span class="coin rate-translation-coin animated" data-rating="-1">1</span></div>{{/editable}}{{^show_more}}<div class="btn btn-standard btn-small show-more" data-index="{{index}}">{{#_i}}Show more{{/_i}}</div>{{/show_more}}{{#show_more}}<div class="btn btn-standard btn-small show-less" data-index="{{index}}">{{#_i}}Show less{{/_i}}</div>{{/show_more}}</div></div>',
"wiki-sentence-revision":'{{#user_says_no_need_to_translate}}<i>{{#_i}}This image contains no text.{{/_i}}</i>{{/user_says_no_need_to_translate}}{{^user_says_no_need_to_translate}}{{#show_diff_with_earlier}}{{#diff_with_earlier}}{{#equal}}{{new_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{new_text}}</span>{{/equal}}{{/diff_with_earlier}}{{/show_diff_with_earlier}}{{#show_diff_with_later}}{{#diff_with_later}}{{#equal}}{{old_text}}{{/equal}}{{^equal}}<span style="background-color:yellow">{{old_text}}</span>{{/equal}}{{/diff_with_later}}{{/show_diff_with_later}}{{#no_diff}}{{text}}{{/no_diff}}{{^revision_from_self}}<div class="report-translator-cheating-wrapper">{{^reported_cheating}}<a class="report-translator-cheating" href="javascript:;">{{#_i}}Report abuse{{/_i}}<a>{{/reported_cheating}}{{#reported_cheating}}<a class="report-translator-cheating reported" href="javascript:;">{{#_i}}You have reported this translator (undo){{/_i}}</a>{{/reported_cheating}}</div>{{/revision_from_self}}{{/user_says_no_need_to_translate}} ',
"wiki-sentence-revisions":'{{^view_both}}{{#multiple_revisions}}<hr/><h4 class="toggle-revisions {{#show_revisions}}active{{/show_revisions}}"><span class="triangle"></span>{{#_i}}All {{num_revisions}} versions{{/_i}}</h4><div class="revisions-stream-body {{^show_revisions}}hidden{{/show_revisions}}"><ul class="simple-revisions">{{#revisions}}<li class="revision-item" data-index="{{index}}"><label><div class="radio"><input id="radio" type="radio" name="revision" value="{{text}}" data-first="{{#first}}true{{/first}}" {{#first}}checked{{/first}}></div><h5><a href="http://www.duolingo.com/{{username}}"><span class="avatar avatar-micro"><img src="http://www.duolingo.com/avatars/{{user_id}}/medium"/></span></a> <a href="http://www.duolingo.com/{{username}}">{{username}}</a><span class="translator-tier-flag-micro"><span class="double-flag-source flag flag-svg-micro flag-{{source_language}}"></span><span class="double-flag-target flag flag-svg-micro flag-{{target_language}}"></span></span><span class="reputation-tier">{{user_reputation_tier}}</span><span class="time">{{date}}</span></h5><p class="sentence" id="revision-{{index}}" style="margin: 0;"></p>{{#explanation}}<div class="comment" style="margin-top: 10px;"><strong>{{#_i}}Comment by {{username}}:{{/_i}}</strong> {{explanation}}</div>{{/explanation}}</label></li>{{/revisions}}</ul><div class="clearfix"><div class="btn btn-small btn-green left" id="follow-revisions">{{#_i}}Follow revisions{{/_i}}</div><div class="btn btn-small btn-green left is-friend success" id="following-revisions" style="display:none">{{#_i}}Following{{/_i}}</div><a href="javascript:;" class="revert btn-small btn-standard btn right" style="margin: 0 0 0 10px;" disabled="disabled">{{#_i}}Revert to selected translation{{/_i}}</a></div></div>{{/multiple_revisions}} &nbsp; {{!This hacks around a crazy bug in Safari.}}{{/view_both}}{{#view_both}}<div class="inner"><div class="content"><h4>{{#_i}}Revision history{{/_i}}</h4><div class="revisions-stream-body"><ul class="simple-revisions">{{#revisions}}<li class="revision-item" data-index="{{index}}"><label><div class="radio"><input id="radio" type="radio" name="revision" value="{{text}}" data-first="{{#first}}true{{/first}}" {{#first}}checked{{/first}}></div><h5><a href="http://www.duolingo.com/{{username}}"><span class="avatar avatar-micro"><img src="http://www.duolingo.com/avatars/{{user_id}}/medium"/></span></a> <a href="http://www.duolingo.com/{{username}}">{{username}}</a> <span class="time">{{date}}</span></h5><p class="sentence" id="revision-{{index}}" style="margin: 0;"></p>{{#explanation}}<p class="comment" style="margin-top: 10px;">{{#_i}}Comment by {{username}}:{{/_i}} {{explanation}}</p>{{/explanation}}</label></li>{{/revisions}}</ul><div class="clearfix"><div class="btn btn-small btn-green left" id="follow-revisions">{{#_i}}Follow revisions{{/_i}}</div><div class="btn btn-small btn-green left is-friend success" id="following-revisions" style="display:none">{{#_i}}Following{{/_i}}</div><a href="javascript:;" class="revert btn btn-small btn-standard right" style="margin: 0 0 0 10px;" disabled="disabled">{{#_i}}Revert to selected translation{{/_i}}</a></div></div></div></div>{{/view_both}} ',
"wiki-translation":'{{#temporary_ban_lift_date}}<div class="clearfix" style="width:650px; margin-top:100px; margin-left:auto; margin-right:auto"><div style="width:200px; float:left; display:block"><img src="/images/owl-standing-crying.png" class="owl"/></div><div class="pane-right" style="width:400px; float:right; display:block"><p>{{#_i}}Uh-oh. Duolingo users have reported you for entering bogus translations. We\'ve taken away your translation points, and you\'re not allowed to translate documents again until {{temporary_ban_lift_date}}. Next time please play nice!{{/_i}}</p><a href="http://www.duolingo.com"><img src="/images/duolingo-logo-small-blue.png" class="duolingo"/></a></div></div>{{/temporary_ban_lift_date}}{{^temporary_ban_lift_date}}{{^logged_in}}<div class="pane-top-container"><div class="pane-top"><a href="{{#trial_account}}javascript:;{{/trial_account}}{{^trial_account}}/register{{/trial_account}}" target="_blank" class="btn right primary join-duo" style="margin: 5px 0 0 0;"><b>{{#_i}}Join Duolingo{{/_i}}</b></a><div class="description"><div class="arrows"></div>{{^quality_high}}{{#_i}}This {{#_ivar}}source_language_name{{/_ivar}} article is being translated into {{#_ivar}}target_language_name{{/_ivar}} by Duolingo, a community of language learners.{{/_i}}{{/quality_high}}{{#quality_high}}{{#_i}}This {{#_ivar}}source_language_name{{/_ivar}} article was translated to {{#_ivar}}target_language_name{{/_ivar}} by Duolingo, a community of language learners.{{/_i}}{{/quality_high}}<br><a href="/translations/{{source_language}}/{{target_language}}">{{#_i}}View more Duolingo translations{{/_i}}</a></div></div></div>{{/logged_in}}<main class="main-left lesson-like-document {{#view_original}}view-original{{/view_original}} {{#view_both}}view-both{{/view_both}} {{#view_discussion}}view-discussion{{/view_discussion}} {{#hide_instructions}}hide-instructions{{/hide_instructions}}">{{#logged_in}}<div id="document-hider"></div>{{/logged_in}}<section class="page-main main-left">{{#logged_in}}<div class="document-header-new"><span class="progress-bar-dynamic simplified-bar" data-toggle="tooltip" style="" title="{{#_i}}You have finished {{num_sentences_done}}/{{num_sentences}} sentences.{{/_i}}"><div class="bar wiki-progress-bar" style="width: 0%"></div></span><span class="coin-count"><span class="icon icon-xp-small"></span> <span style="position: relative; top: 2px;" id="xp-counter">{{#_i}}+{{user_num_points}} {{#pluralize}}XP,XP,{{user_num_points}}{{/pluralize}}{{/_i}}</span></span><span id="toggle-instructions"><span id="hide-instructions-arrow" class="toggle-instructions-arrow icon icon-vote-up-small offset {{#hide_instructions}}hidden{{/hide_instructions}}" data-toggle="tooltip" title="{{#_i}}Hide instructions{{/_i}}" {{^view_original}}style="visibility:hidden"{{/view_original}} ></span><span id="show-instructions-arrow" class="toggle-instructions-arrow icon icon-vote-down-small {{^hide_instructions}}hidden{{/hide_instructions}}" data-toggle="tooltip" title="{{#_i}}Show instructions{{/_i}}" {{^view_original}}style="visibility:hidden"{{/view_original}} ></span></span><ul class="tab-switch document-switch"><li><a href="javascript:;" id="view-original" {{#view_original}}class="active"{{/view_original}}><span class="flag flag-svg-micro flag-{{source_language}}"></span>{{#_i}}Translate{{/_i}}</a></li><li><a href="javascript:;" id="view-both" {{#view_both}}class="active"{{/view_both}}><span class="translator-tier-flag-micro"><span class="flag flag-svg-micro flag-{{source_language}} double-flag-source"></span><span class="flag flag-svg-micro flag-{{target_language}} double-flag-target"></span></span>{{#_i}}Proofread{{/_i}}</a></li>{{#social_enabled}}<li><a href="javascript:;" id="view-discussion" {{#view_discussion}}class="active"{{/view_discussion}}><span style="margin-right: 10px" class="icon icon-discussion"></span><span id="discuss-button-text">{{#num_comments}}{{#_i}}Discuss ({{num_comments}}){{/_i}}{{/num_comments}}{{^num_comments}}{{#_i}}Discuss{{/_i}}{{/num_comments}}</span></a></li>{{/social_enabled}}</ul><div id="document-instructions" {{#hide_instructions}}class="hidden"{{/hide_instructions}}{{^hide_instructions}}{{^view_original}}class="hidden"{{/view_original}}{{/hide_instructions}}></div></div>{{/logged_in}}{{#document_paragraphs}}{{#sentences}}<div id="mini-popover-{{index}}" class="popover document-sentence-mini-popover hidden"></div><div id="show-more-{{index}}" class="popover new document-sentence-show-more hidden"></div>{{/sentences}}{{/document_paragraphs}}{{#view_original}}<div class="responsive-container"><div id="original-body-container"><div id="original-body"></div></div><div id="document-omnibox" class="translation-sidebar"><div id="global-sidebar"></div>{{#document_paragraphs}}{{#sentences}}<div id="sentence-sidebar-{{index}}" class="document-sentence-sidebar"></div>{{/sentences}}{{/document_paragraphs}}</div></div>{{/view_original}}{{#view_both}}<div id="view-both-container"><table><tr><td style="width:46%" valign="top"><div id="original-body"></div></td><td style="width:8%" valign="top"></td><td style="width:46%" valign="top"><div id="translated-body"></div></td></tr></table></div>{{/view_both}}{{^view_discussion}}{{#logged_in}}<div class="translation-footer">{{#_i}}Do you like this article?{{/_i}} <strong>{{#_i}}Vote it up!{{/_i}}</strong><div class="vote-module-small"><div class="vote-count">{{document_vote_sum}}</div><button class="rate-option rate-document-option btn btn-custom vote-up" data-rating="1"><span class="icon icon-vote-up-small" data-rating="1"></span></button><button class="rate-option rate-document-option btn-custom vote-down" data-rating="-1"><span class="icon icon-vote-down-small" data-rating="-1"></span></button></div></div>{{/logged_in}}{{/view_discussion}}{{#view_discussion}}<div id="translation-discussion"></div>{{/view_discussion}}</section></main><div class="modal hidden report" id="flag-translation-reason-modal"><div class="modal-body"><h2>{{#_i}}What is the issue?{{/_i}}</h2><ul><li><label><input name="flag-translation-reason" type="radio" value="CONTENT" checked>{{#_i}}Violent, sexual, or other inappropriate content.{{/_i}}</label></li><li><label><input name="flag-translation-reason" type="radio" value="COPYRIGHT">{{#_i}}Copyright violation{{/_i}}</label></li></ul><h5>{{#_i}}Provide additional details (optional):{{/_i}}</h5><textarea class="report-translation-details" id="additional-details"></textarea></div><div class="modal-footer"><a href="javascript:;" class="btn btn-blue right" style="margin: 0 0 0 10px;" id="report-inappropriate-reason">{{#_i}}Submit{{/_i}}</a><a href="javascript:;" class="btn-standard btn right" id="cancel-report-inappropriate">{{#_i}}Cancel{{/_i}}</a></div></div><div class="modal hidden" id="pg13-warning-modal"><div class="modal-body"><h2>{{#_i}}Warning: this document contains PG-13 content.{{/_i}}</h2><div style="margin-top: 10px"><a id="pg13-continue" href="javascript:;" class="btn btn-green">{{#_i}}Continue{{/_i}}</a></div><div id="take-me-back"><a href="/translations">{{#_i}}Take me back.{{/_i}}</a></div><div class="close"></div></div></div>{{/temporary_ban_lift_date}} ',
"wiki-translation-strengthened-words":'{{^strengthened_lexemes}}<li><ul class="word-strength small dimmed right"><li class="filled"></li><li></li><li></li><li></li></ul><i>{{#_i}}None yet{{/_i}}</i></li>{{/strengthened_lexemes}}{{#strengthened_lexemes}}<li><ul class="word-strength small right"><li class="filled"></li><li class="filled"></li class="filled"><li class="filled"></li><li class="filled"></li></ul>{{surface_form}}</li>{{/strengthened_lexemes}} ',"word-lookup":'<span class="search-icon"></span><label for="lookup-word-{{id}}">{{#_i}}Translate English word{{/_i}}</label><input type="text" id="lookup-word-{{id}}" class="left"/><button class="translate-lookup btn left" style="margin: 0 0 0 5px; display: none">{{#_i}}Translate{{/_i}}</button><div class="lookup-hints translation-source"></div>',
"word-modal":'<div class="close"></div><div class="modal-header"><h1 style="text-align: center"><span id="speaker-audio-1-button" class="speaker-small"><span class="listen-button-small icon icon-speaker-small {{#rtl}}img-flipped{{/rtl}}"></span></span><span id="word-header">{{word_string}}</span></h1>{{#gender}}<div class="gender">({{gender}})</div>{{/gender}}</div><div class="modal-body"><table id="example-sentences" class="table"><thead><th>{{#_i}}Word{{/_i}}</th>{{#show_gender_column}}<th>{{#_i}}Gender{{/_i}}</th>{{/show_gender_column}}<th>{{#_i}}Example{{/_i}}</th><th>{{#_i}}Example Translation{{/_i}}</th></thead><tbody><tr><td>{{word_string}}</td>{{#show_gender_column}}<td>{{gender}}</td>{{/show_gender_column}}{{#ex_sentence}}<td>{{text}}</td><td>{{translation}}</td>{{/ex_sentence}}{{^ex_sentence}}<td></td><td></td>{{/ex_sentence}}</tr>{{#related_words}}<tr><td><span class="related-word-link" data-lexeme="{{lexeme_id}}">{{word_string}}</span></td>{{#show_gender_column}}<td>{{gender}}</td>{{/show_gender_column}}{{#ex_sentence}}<td>{{text}}</td><td>{{translation}}</td>{{/ex_sentence}}{{^ex_sentence}}<td></td><td></td>{{/ex_sentence}}</tr>{{/related_words}}</tbody></table>{{#has_verb_table}}<div id="verb-table"></div>{{/has_verb_table}}</div> ',
"word-overview":'<a href="javascript:;" class="with-back-arrow"><span class="icon icon-arrow-back-gray"></span> {{#_i}}BACK{{/_i}}</a><h1 style="text-align: center"><span id="speaker-audio-1-button" class="speaker-small"><span class="listen-button-small icon icon-speaker-small {{#rtl}}img-flipped{{/rtl}}"></span></span><span id="word-header">{{word_string}}</span></h1>{{#gender}}<div class="gender">({{gender}})</div>{{/gender}}<div class="info-top"><div class="top-hint left"><h3>{{#_i}}TRANSLATION{{/_i}}</h3><div>{{top_hint}}</div></div><div class="word-strength right"><h3>{{#_i}}STRENGTH{{/_i}}</h3><div class="word-strength-icon strength-{{strength_bars}}"></div></div></div><div class="info-bottom"><div class="word-skill left"><h3>{{#_i}}SKILL{{/_i}}</h3>{{^locked}}<a href="javascript:;" class="nav-skill" data-url="{{skill_url_title}}">{{skill}}</a>{{/locked}}{{#locked}}<span>{{skill_url_title}}</span>{{/locked}}</div><div class="word-type right"><h3>{{#_i}}PART OF SPEECH{{/_i}}</h3><div>{{pos}}</div></div></div><button class="btn btn-standard btn-outline btn-block open-word-modal">{{#_i}}More details{{/_i}}</button> ',
"word-strength":'{{#strength}}<ul class="word-strength small"><li class="filled {{#blink_0}}animated flash{{/blink_0}}"></li><li class="{{#strength_s}}filled{{/strength_s}} {{#blink_s}}animated flash{{/blink_s}}"></li><li class="{{#strength_m}}filled{{/strength_m}} {{#blink_m}}animated flash{{/blink_m}}"></li><li class="{{#strength_l}}filled{{/strength_l}} {{#blink_l}}animated flash{{/blink_l}}"></li></ul>{{/strength}} ',"your-translation-votes":'<div class="modal-header"><h1>{{#_i}}Your translation votes{{/_i}}</h1></div><div class="modal-body">{{#translations}}<div class="from-document">{{#_i}}From <a href="/translation/{{translation_id}}">{{title}}</a>:{{/_i}}</div><table class="table table-striped table-test"><thead><tr><th style="width: 40%;">{{#_i}}Original sentence{{/_i}}</th><th style="width: 40%;">{{#_i}}Your translation{{/_i}}</th><th style="width:20%;">{{#_i}}Votes{{/_i}}</th></tr></thead><tbody>{{#sentences}}<tr><td><a href="/translation/{{translation_id}}$index={{sent_index}}">{{^is_image_sentence}}{{original_text}}{{/is_image_sentence}}{{#is_image_sentence}}{{{custom_html}}}{{/is_image_sentence}}</a></td><td>{{^user_says_image_contains_no_text}}{{user_translation}}{{/user_says_image_contains_no_text}}{{#user_says_image_contains_no_text}}<i>{{#_i}}This image contains no text.{{/_i}}</i>{{/user_says_image_contains_no_text}}</td><td><div><span style="width: 100px;">{{upvotes}} <span class="looks-good-small"></span></span> &nbsp;&nbsp;<span style="width: 100px;">{{downvotes}} <span class="looks-wrong-small"></span></span></div></td></tr>{{/sentences}}</tbody></table>{{/translations}}<div class="center missing-votes">{{^num_missing_votes}}{{^num_translations}}{{#_i}}No votes received yet. Try translating some more sentences or come back later!{{/_i}}<br>{{/num_translations}}{{/num_missing_votes}}</div><div class="modal-footnote">{{^user_has_initial_reputation}}<br>{{#_i}}Note: only votes that contribute to your progress within tier {{tier}} are shown.{{/_i}}{{/user_has_initial_reputation}}{{#num_missing_votes}}<br><br>{{#_i}}{{#pluralize}}{{num_missing_votes}} vote received before November 2013 is not shown.,{{num_missing_votes}} votes received before November 2013 are not shown.,{{num_missing_votes}}{{/pluralize}}{{/_i}}{{/num_missing_votes}}</div></div>',
zendesk:"<script type=\"text/javascript\"> duo.zendesk_ids = {'en': 20147203, 'es': 20155406, 'pt': 20155198, 'it': 20155416, 'fr': 20175838, 'de': 20098790, 'zs': 20176764}; (function() { {{#logged_in}} var ui_language = duo.user.get('ui_language'); {{/logged_in}}{{^logged_in}} var ui_language = '{{browser_language}}'; {{/logged_in}} var id = ui_language in duo.zendesk_ids ? duo.zendesk_ids[ui_language] : undefined; duo.hide_zendesk = false; if (!id) { duo.hide_zendesk = true; return; } if (zen_opt) Zenbox.update({'dropboxID': 20155416}); var zen_opt = { dropboxID: id, url: \"https://duolingotest.zendesk.com\", tabID: \"Feedback\", tabColor: \"black\", tabPosition: \"Left\", hide_tab: \"true\" }; {{#logged_in}}{{^trial_account}} zen_opt.requester_email = encodeURIComponent(duo.user.get('email')); zen_opt.requester_name = encodeURIComponent(duo.user.get('username')); {{/trial_account}}{{/logged_in}} $.getScript('//asset0.zendesk.com/external/zenbox/v2.5/zenbox.js', function() { _.defer(function() { Zenbox.init(zen_opt); }); }); })(); \x3c/script>"}};
duo.SessionElement=Backbone.Model.extend({isOpener:function(){return"translate"===this.get("type")&&this.get("unknown")},getDisplayText:function(){return this.has("text")?this.get("text"):this.has("sentence")?this.get("sentence"):this.get("hint")}});duo.SessionElementList=Backbone.Collection.extend({model:duo.SessionElement});
duo.SessionElementSolution=Backbone.Model.extend({initialize:function(){duo.user.get("locale")&&this.set({locale:duo.user.get("locale")});this.set({use_report_messages:!0})},url:function(){return this.has("session_type")?this.has("session_element")&&this.get("session_element").has("type")?"/session_element_solutions/"+this.get("session_type")+"/"+this.get("session_element").get("type"):"/session_element_solutions/"+this.get("session_type"):"/session_element_solutions"},parse:function(b){b.session_element=
new duo.SessionElement(b.session_element);"correct_solutions"in b&&(b.num_solutions=b.correct_solutions.length);return b},isDone:function(){return"speak"==this.get("session_element").get("type")?this.has("try_again")&&!this.get("try_again"):!0},getDisplayText:function(){if(this.has("value"))return this.get("value");if(this.has("sentence"))return this.get("sentence");if(this.has("word"))return(this.has("article")?this.get("article")+" ":"")+this.get("word");if(this.has("choices")){var b=_.filter(this.get("session_element").get("sentences"),
function(a,b){return"correct"===this.get("choices")[b]},this);return JSON.stringify(_.pluck(b,"sentence"))}return this.get("session_element").getDisplayText()},isSkipped:function(){return this.has("skipped")&&Boolean(this.get("skipped"))},isCorrect:function(){return Boolean(this.get("correct"))}});duo.Grade=Backbone.Model.extend({});
duo.Session=Backbone.Model.extend({transitions:{"empty,rendered":"render","rendered,ready":"input","ready,rendered":"clear","ready,submitted":"submit","submitted,ready":"retry","submitted,graded":"grade","graded,empty":"continue","graded,ended":"end","submitted,failed":"fail","ready,failed":"fail","rendered,failed":"fail"},url:function(){var b=this.get("activity_uuid");void 0===b&&(b=Math.floor(1E12*Math.random()));return"/sessions/"+b},fetch:function(b){b=b||{};b.data=b.data||{};b.data.type=this.type;
b.data.id=this.id;b.data.locale=duo.user.get("locale");b.data.speak_capable=0>navigator.userAgent.toLowerCase().indexOf("ipad")&&0>navigator.userAgent.toLowerCase().indexOf("iphone");b.data.web_speech_enabled=duo.isWebSpeechEnabled();b.data.kc_strength_model_version=duo.kcStrengthModelVersion();Backbone.Model.prototype.fetch.call(this,b)},initialize:function(){this.set({session_element_solutions:[],state:"empty",position:-1,failed:!1,answer_feedback:!0});this.bind("change:state",this.fireStateEvents,
this);this.bind("error",this.defaultErrorHandler)},parse:function(b){console.log("new data in session");b.session_elements=new duo.SessionElementList(b.session_elements);null==b.tts_enabled&&(b.tts_enabled=!0);return b},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);b.session_elements=void 0;b.session_element_solutions=_.map(this.get("session_element_solutions"),function(a){return _.map(a,function(a){a=a.toJSON();a.session_element=void 0;return a})});b.language_information=void 0;
b.choose_language=!!b.available_languages;b.choose_language&&(b.available_languages=duo.available_languages);return b},defaultErrorHandler:function(b,a){window.location="/"},fireStateEvents:function(b,a){var c=b.previous("state");b.trigger(this.transitions[c+","+a])},incrementPosition:function(){this.set({position:this.get("position")+1})},currentElement:function(){return this.get("session_elements").at(this.get("position"))},previousElement:function(){return this.get("session_elements").at(this.get("position")-
1)},initializeHearts:function(b){for(var a=[],c=0;c<b;c++){var d=null,d=duo.user.get("ab_options").hover_heart_experiment?_.map([1,3,2,4],function(a){return{quarter:a,used:!1,value:c+a/4,index:4*c+a-1}}):{used:!1,value:c+1,index:c+1};a.push(d)}this.set({num_hearts:b,hearts:a,max_hearts:b})},adjustHearts:function(b){var a=_.min([this.get("num_hearts")+b,this.get("max_hearts")]);b=this.get("hearts");_.each(b,function(b){_.each(b.parts,function(b){b.used=b.value>a})});this.set({num_hearts:a});return a},
addSolution:function(b){b.set({learning_language:this.get("language"),session_type:this.get("type"),skill_id:this.get("skill_id"),lesson_number:this.get("lesson_number"),from_language:this.get("ui_language")});b.get("session_element").set({activity_uuid:this.get("activity_uuid")});var a=b.get("session_element");b.set({depth:a.get("depth"),type:a.get("type"),solution_key:a.get("solution_key"),total_times_correct:a.get("total_times_correct"),total_times_asked:a.get("total_times_asked")});this.get("session_element_solutions").length<=
this.get("position")&&this.get("session_element_solutions").push([]);if(this.get("session_element_solutions").length!=this.get("position")+1)throw"";this.get("session_element_solutions")[this.get("position")].push(b)},getSubmittedSolution:function(){var b=this.get("session_element_solutions")[this.get("position")];return b?_.last(b):void 0},calculateExtraTime:function(b){var a=2.54;switch(b.get("language")||b.get("target_language")){case "de":a+=-0.1392;break;case "en":a+=0.4381;break;case "es":a+=
-0.0328;break;case "fr":a+=-0.1947;break;case "it":a+=0.0032;break;case "pt":a+=-0.0747}switch(b.get("type")){case "judge":a+=-0.8097;break;case "listen":a+=0.1465;break;case "name":a+=0.0067;break;case "reverse_speak":a+=1.1075;break;case "speak":a+=0.3766;break;case "translate":a+=-0.219;break;case "form":a+=-0.6087}b="translate"==b.get("type")?b.get("sentence"):b.get("text");void 0!=b&&(a+=0.0707*b.split(" ").length,a+=0.024*b.length);a=Math.round(Math.pow(2,a));return Math.min(20,Math.max(5,a))},
getNumberSubmittedSolutionsForCurrentElement:function(){var b=this.get("session_element_solutions")[this.get("position")];return b?b.length:0},getNumberCorrectSolutionsForCurrentElement:function(){var b=this.get("session_element_solutions")[this.get("position")];if(b)return _.reduce(b,function(a,b){return a+Number(b.isCorrect())},0)},getNumberCorrectOnFirstTry:function(){return _.filter(this.get("session_element_solutions"),function(b){return b[0].get("correct")}).length},getNumberQuestionsAnswered:function(){return this.get("session_element_solutions").length},
isTest:function(){return!1},isTimed:function(){return Boolean(this.get("timed"))},fetchDocumentRecommendations:function(b){var a=this;$.getJSON("/recommend_translations",function(c){a.set(c);b()})},getSpecificSessionType:function(){var b=this.get("type");return"practice"==b?this.get("skill_id")?"skill_practice":"global_practice":b},updateStrength:function(b,a,c,d){this.strength_updater||(this.strength_updater=new StrengthUpdater(this));this.strength_updater.updateStrength(b,a,c,d)},getKCStates:function(){this.strength_updater||
(this.strength_updater=new StrengthUpdater(this));return this.strength_updater.student_model.getKCStates()}});duo.WordsPracticeSession=duo.Session.extend({type:"words_practice"});duo.SkillPracticeSession=duo.Session.extend({type:"skill_practice"});
duo.GlobalPracticeSession=duo.Session.extend({type:"global_practice",fetch:function(b){this.has("language")&&(b=b||{},b.data=b.data||{},b.data.language=this.get("language"));b.data.web_speech_enabled=duo.isWebSpeechEnabled();b.data.kc_strength_model_version=duo.kcStrengthModelVersion();duo.Session.prototype.fetch.call(this,b)}});duo.DebugSession=duo.Session.extend({type:"debug"});
duo.WelcomeSession=duo.Session.extend({type:"welcome",parse:function(b){b=duo.Session.prototype.parse.call(this,b);var a=b.special_hints,c={Duo:{value:"Duo",hint_table:{rows:[{cells:[{colspan:1,hint:"Duo"}]}]}}},d;for(d in a)c[d]={value:d,hint_table:{rows:[{cells:[{colspan:1,hint:a[d]}]}]}};b.special_hints=c;return b}});duo.TestSession=duo.Session.extend({type:"test",isTest:function(){return!0}});duo.BigTestSession=duo.TestSession.extend({type:"big_test"});duo.PlacementTestSession=duo.TestSession.extend({type:"placement_test"});
duo.CertificationTestSession=duo.TestSession.extend({type:"certification_test",initialize:function(){duo.TestSession.prototype.initialize.call(this);this.set({answer_feedback:!1})}});
duo.LessonSession=duo.Session.extend({type:"lesson",fetch:function(b){b=b||{};b.data=b.data||{};b.data.type=this.type;b.data.skill_id=this.get("skill_id");b.data.lesson_number=this.get("lesson_number");b.data.locale=duo.user.get("locale");b.data.speak_capable=0>navigator.userAgent.toLowerCase().indexOf("ipad")&&0>navigator.userAgent.toLowerCase().indexOf("iphone");b.data.web_speech_enabled=duo.isWebSpeechEnabled();b.data.kc_strength_model_version=duo.kcStrengthModelVersion();Backbone.Model.prototype.fetch.call(this,
b)}});function StrengthUpdater(b){this.model=b;this.strength=0;this.introduced_lexeme_ids={};this.student_model=new StudentModel(b);this.extra_strength=0;this.initial_log_prob=this.student_model.logProbAllCorrect();this.min_strength_increment=b.get("min_strength_increment");this.min_strength_decrement=b.get("min_strength_decrement");this.pass_strength=b.get("pass_strength");this.pass_strength_fraction=0.97}
StrengthUpdater.prototype.updateStrength=function(b,a,c,d){var f=this.student_model.logProbAllCorrect()-this.initial_log_prob;this.student_model.update(b,a,c,d);c=this.student_model.logProbAllCorrect()-this.initial_log_prob;f=c-f;a&&f<this.min_strength_increment&&(this.extra_strength+=this.min_strength_increment-f);!a&&f>-this.min_strength_decrement&&(this.extra_strength-=f+this.min_strength_decrement,0>c+this.extra_strength&&(this.extra_strength=-c));this.strength=c+this.extra_strength;this.strength=
Math.max(0,this.strength);b=b.get("teaches_lexeme_ids");for(a=0;a<b.length;a++)lexeme_id=b[a],this.introduced_lexeme_ids[lexeme_id]=!0;b=this.strength/this.pass_strength;b>this.pass_strength_fraction&&(b=1);this.model.set("introduced_lexeme_ids",Object.keys(this.introduced_lexeme_ids));this.model.set("strength_fraction",b)};
function StudentModel(b){var a=b.get("mixture_models");this.kc_models={};for(var c in a){var d=a[c],f=d.prior,d=d.learning_curves;2==b.get("kc_strength_model_version")?this.kc_models[c]=new LogisticKCStrengthModel(f,d):this.kc_models[c]=new LearningCurveMixtureModel(f,d)}}StudentModel.prototype.getNumKCs=function(){return _.size(this.kc_models)};StudentModel.prototype.getKCStates=function(){var b={},a;for(a in this.kc_models)b[a]=this.kc_models[a].getState();return b};
StudentModel.prototype.logProbAllCorrect=function(){var b=0,a;for(a in this.kc_models)b+=Math.log(this.kc_models[a].probCorrect());return b};StudentModel.prototype.minProbCorrect=function(b){var a=1,c;for(c in this.kc_models)c in b&&(a=Math.min(a,this.kc_models[c].probCorrect()));return a};
StudentModel.prototype.update=function(b,a,c,d){var f=b.get("type");b=b.get("knowledge_components");for(var g=1,h=0;h<b.length;h++){var k=b[h];k in this.kc_models&&(g*=this.kc_models[k].probCorrect())}for(h=0;h<b.length;h++)if(k=b[h],k in this.kc_models){var l=1;if(!a)if(c&&0<Object.keys(c).length)l=k in c?c[k]:0;else var l=this.kc_models[k].probCorrect(),m=g/l,l=l*(1-m)/(1-l*m);this.kc_models[k].update(f,l,d&&k in d)}};
function LearningCurveMixtureModel(b,a){this.prior=b;this.dist=b.slice();this.curves=a;this.t=0;this.initial_prob_correct=this.probCorrect()}LearningCurveMixtureModel.prototype.probCorrect=function(){for(var b=0,a=0;a<this.dist.length;a++)var c=this.curves[a],b=b+this.dist[a]*c[Math.min(this.t,c.length-1)];return b};LearningCurveMixtureModel.prototype.getState=function(){return this.dist};
LearningCurveMixtureModel.prototype.update=function(b,a,c){b=[];for(var d=c=0;d<this.dist.length;d++){var f=this.curves[d],g=this.dist[d],f=f[Math.min(this.t,f.length-1)],g=g*(a*f+(1-a)*(1-f));b.push(g);c+=g}for(d=0;d<this.dist.length;d++)this.dist[d]=b[d]/c;this.probCorrect()<this.initial_prob_correct&&(this.dist=this.prior.slice());this.t+=1};function LogisticKCStrengthModel(){this.logit=this.initial_logit=1.34}LogisticKCStrengthModel.prototype.probCorrect=function(){return 1/(1+Math.exp(-this.logit))};
LogisticKCStrengthModel.prototype.update=function(b,a,c){var d=0,f=0;"translate"==b?(d=c?0.6:1.88,f=1):"select"!=b?(d=0.96,f=0.5):(d=0.36,f=0.48);this.logit+=a*d-(1-a)*f;this.logit=Math.max(this.logit,this.initial_logit)};LogisticKCStrengthModel.prototype.getState=function(){return this.logit};
duo.Router=Backbone.Router.extend({switchView:function(b,a,c,d){$("#app").replaceWith(b.render().el);$("#app").removeClass(duo.view);duo.body_class&&$("body").removeClass(duo.body_class);a&&$("#app").addClass(a);c&&$("body").addClass(c);d&&$("#meta-description").attr("content",d);duo.view=a;duo.body_class=c;$(document).scrollTop(0);$(".logged-out-message").empty();$("#join").hide();$("#topbar-menu").show();duo.topbar&&duo.topbar.closeMobileMenu&&duo.topbar.closeMobileMenu();$("body").css({overflow:"auto"})}});
duo.Event=Backbone.Model.extend({urlRoot:"/events",parse:function(b){"comment_data"in b&&(b.comments=new duo.EventCommentList(duo.EventCommentList.prototype.parse.call(this,b.comment_data)),b.comments.event_id=this.id||b.id);return b},deletePost:function(){var b=this;$.post("/events/"+this.id+"/delete",{user_id:this.get("for_user").id},function(a){b.set(duo.Event.prototype.parse.call(b,a))})},like:function(){var b=this;$.post("/events/"+this.id+"/like",function(a){b.set(duo.Event.prototype.parse.call(b,
a))})},isBlocked:function(){var b=duo.user&&(duo.user.isBlocking(this.get("user").id)||"stream_post"==this.get("type")&&duo.user.isBlocking(this.get("for_user").id)),a=duo.user&&(duo.user.isBlockedBy(this.get("user").id)||"stream_post"==this.get("type")&&duo.user.isBlockedBy(this.get("for_user").id));return b||a}},{getView:function(b){b=b.replace(RegExp("_","g")," ");b=b.toTitleCase();b=b.replace(RegExp(" ","g"),"")+"EventView";return duo[b]}});duo.LevelEvent=duo.Event.extend({});
duo.FollowEvent=duo.Event.extend({});duo.PracticeEvent=duo.Event.extend({});duo.LessonEvent=duo.Event.extend({});duo.TranslationEvent=duo.Event.extend({});duo.UnlockEvent=duo.Event.extend({});duo.WelcomeEvent=duo.Event.extend({});duo.CollapsedEvent=duo.Event.extend({});duo.StreamPost=duo.Event.extend({url:"/post"});duo.DeleteEvent=duo.Event.extend({});
duo.EventList=Backbone.Collection.extend({model:duo.Event,url:function(){if(void 0===this.user_id)throw Error(JSON.stringify({user_id:this.user_id,before:this.before}));return"/stream/"+this.user_id},fetch:function(b){b=b||{};b.data=b.data||{};b.data.before=this.before;b.data.p_view=this.p_view;Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){var a=b;b.before&&(this.before=b.before,this.more_events=b.more_events,a=b.events);return _.map(a,function(a){return duo.Event.prototype.parse.call(this,
a)})}});
duo.EventView=Backbone.View.extend({tagName:"li",className:"stream-item",template:duo.templates.event,events:{"click .show-comments":"showComments","click .upvotes .vote":"like","click .event-context":"showContext","click .follow-channel":"followChannel","click .unfollow-channel":"unfollowChannel","click .delete-stream-post":"deleteStreamPost"},initialize:function(b){this.show_time=b.show_time;this.model.bind("change",this.reRender,this)},render:function(){var b=0;this.model.has("skills")&&(b=_.reduce(this.model.get("skills"),
function(a,b){return a+b.improvement},0));$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.getRenderData(),{total_improvement:b,following_short_list:this.model.get("followings")?duo.createShortList(this.model.get("followings")):null}),duo.templates));b=!0;"friends"===this.model.get("channel")&&(b=_.contains(_.pluck(duo.user.get("following"),"id"),this.model.get("channel_source")));this.$(".event-context").attr("data-channel-subscribed",b);this.renderComments();return this},
getRenderData:function(){var b=this.model.has("comments")&&0<this.model.get("comments").length;return{is_blocked:this.model.isBlocked(),show_time:this.show_time,has_comments:b,merged:1<this.model.get("count"),liked_short_list:duo.createShortList(this.model.get("liked_users"))}},reRender:function(){var b=0===this.$(".show-comments").size(),a=0<this.$(".post-footer:visible").size();this.render();b&&(this.$(".stream-comments").show(),this.$(".show-comments").remove(),a&&this.$(".stream-comments .post").focus().blur())},
renderComments:function(){this.model.has("comments")&&(new duo.EventCommentsView({model:this.model,el:this.$(".stream-comments")})).render()},showComments:function(){this.$(".stream-comments").show();this.$(".show-comments").remove();this.$(".stream-comments .post").focus()},like:function(){duo.track("like event");this.model.like()},showContext:function(){this.$(".event-context").toggleClass("active");this.$(".even-context-menu").toggle();var b=this;$(document).one("click.event",function(){b.$(".even-context-menu").hide()});
return!1},followChannel:function(){"friends"===this.model.get("channel")?duo.user.follow(this.model.get("channel_source")):"topics"===this.model.get("channel")&&(new duo.Topic({id:this.model.get("channel_source")})).follow(function(){duo.user.trigger("change")});this.$el.closest(".activity-stream").find(".event-context[data-channel="+this.model.get("channel")+"][data-channel-source="+this.model.get("channel_source")+"]").attr("data-channel-subscribed",!0)},unfollowChannel:function(){"friends"===this.model.get("channel")?
duo.user.unfollow(this.model.get("channel_source")):"topics"===this.model.get("channel")&&(new duo.Topic({id:this.model.get("channel_source")})).unfollow(function(){duo.user.trigger("change")});this.$el.closest(".activity-stream").find(".event-context[data-channel="+this.model.get("channel")+"][data-channel-source="+this.model.get("channel_source")+"]").attr("data-channel-subscribed",!1)},deleteStreamPost:function(){this.model.deletePost()}});
duo.SkillEventView=duo.EventView.extend({render:function(){duo.EventView.prototype.render.call(this);this.renderSkills();return this},renderSkills:function(){var b=this;_.each(this.model.get("skills"),function(a){var c=null;"improvement"in a?(a.skill&&(c=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(b,a.skill)),improvement:a.improvement,size:"small",current_user:duo.user?b.model.get("user").id==duo.user.id:null,disable_hover:null!=duo.user})),a=a.skill):c=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(b,
a)),size:"small",current_user:duo.user?b.model.get("user").id==duo.user.id:null,disable_hover:null!=duo.user});c&&b.$("#event-skills-"+a.id).append(c.render().el)})}});duo.LevelEventView=duo.EventView.extend({template:duo.templates["level-event"]});duo.FollowEventView=duo.EventView.extend({template:duo.templates["follow-event"]});duo.PassEventView=duo.EventView.extend({template:duo.templates["pass-event"]});duo.CommentEventView=duo.EventView.extend({template:duo.templates["comment-event"]});
duo.DeleteEventView=duo.EventView.extend({template:duo.templates["delete-event"]});duo.MasterEventView=duo.SkillEventView.extend({template:duo.templates["master-event"]});
duo.PracticeEventView=duo.EventView.extend({template:duo.templates["practice-event"],getRenderData:function(){var b=0,a=this.model.has("skills")&&0<this.model.get("skills").length,b=a?_.reduce(this.model.get("skills"),function(a,b){return a+b.improvement},0):10;return _.extend(duo.EventView.prototype.getRenderData.call(this),{refresh:a,total_improvement:b})}});duo.WelcomeEventView=duo.EventView.extend({template:duo.templates["welcome-event"]});
duo.LessonEventView=duo.EventView.extend({template:duo.templates["lesson-event"],getRenderData:function(){var b=duo.EventView.prototype.getRenderData.call(this);b.just_one=1===this.model.get("count");return b}});
duo.TranslationEventView=duo.EventView.extend({template:duo.templates["translation-event"],getRenderData:function(){var b=0;this.model.has("skills")&&(b=_.reduce(this.model.get("skills"),function(a,b){return a+b.improvement},0));return _.extend(duo.EventView.prototype.getRenderData.call(this),{total_improvement:b,disable_upvotes:!0})}});
duo.TestEventView=duo.SkillEventView.extend({template:duo.templates["test-event"],getRenderData:function(){var b=this.model.has("skills")?this.model.get("skills").length:0;return _.extend(duo.EventView.prototype.getRenderData.call(this),{any_unlocked:this.model.has("unlocked")&&0<this.model.get("unlocked").length,unlocked_string:_.pluck(this.model.get("unlocked"),"title").join(", "),num_skills:b,shortcut:1<b})}});
duo.UnlockEventView=duo.SkillEventView.extend({template:duo.templates["unlock-event"],getRenderData:function(){var b=this.model.get("skills").length;return _.extend(duo.EventView.prototype.getRenderData.call(this),{any_unlocked:0<this.model.get("unlocked").length,unlocked_string:_.pluck(this.model.get("unlocked"),"title").join(", "),icon_index:0<b?this.model.get("skills")[b-1].new_index:1,icon_color:0<b?this.model.get("skills")[b-1].icon_color:"red",multiple_unlocked:1<this.model.get("skills").length})}});
duo.StreamPostEventView=duo.EventView.extend({template:duo.templates["stream-post"],getRenderData:function(){var b=duo.user&&(this.model.get("for_user").id==duo.user.id||this.model.get("user").id==duo.user.id||duo.user.get("admin")||duo.user.get("global_moderator"));return _.extend(duo.EventView.prototype.getRenderData.call(this),{processed_text:this.replaceURLs(this.model.get("text")),deletable:b,stream_post:!0})},replaceURLs:function(b){return b.replace(/\b(?:(?:https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gi,
function(a){return'<a href="'+a+'" class="blue-link" target="_blank">'+a+"</a>"})}});duo.TranslatorPromotionEventView=duo.EventView.extend({template:duo.templates["translator-promotion-event"]});
duo.CollapsedEventView=duo.EventView.extend({template:duo.templates["collapsed-event"],initialize:function(){this.collapsed=_.map(this.model.attributes,function(b){return new duo.Event(b)})},render:function(){$(this.el).html($.duostache(this.template,{events:this.collapsed},duo.templates));var b=this;_.each(this.collapsed,function(a){var c=a.get("type").replace("_"," ").toTitleCase().replace(" ",""),c=new duo[c+"EventView"]({model:a});b.$("#collapsed-event-"+a.id).replaceWith(c.render().el)});return this}});
duo.StandaloneEventView=Backbone.View.extend({id:"app",template:duo.templates["standalone-event"],initialize:function(){this.event_view=new (duo.Event.getView(this.model.get("type")))({model:this.model})},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));this.$(".activity-stream").append(this.event_view.render().el);return this}});
duo.EventsView=Backbone.View.extend({template:duo.templates.events,events:{"click #more-stream":"moreStream"},initialize:function(b){this.collection=b.collection;this.home_view=b.home_view;this.collection.bind("add",this.addOne,this);this.collection.bind("remove",this.render,this);this.collection.bind("change:deleted",this.eventDeleted,this);_.bindAll(this,"render","moreStream");this.last_request_length=0;Backbone.history.once("route",this.cleanUp,this)},render:function(){$(this.el).html($.duostache(this.template,
_.extend(this.model.toJSON(),{more_events:this.collection.more_events,error:this.collection.error,current_user_profile:duo.user&&duo.user.get("id")==this.model.get("id"),user:duo.user?duo.user.toJSON():void 0,viewer_trial_account:duo.user&&duo.user.get("trial_account")}),duo.templates));this.$("#stream-post-btn").attr("disabled","disabled");this.addAll();var b=this;$(document).unbind(".stream_scroll").bind("scroll.stream_scroll.infinite_scroll",function(a){a=$(document).height()-$(document).scrollTop();
var c=$(window).height();a<1.5*c&&b.collection.length>b.last_request_length&&(b.$("#more-stream").hide(),b.last_request_length=b.collection.length,b.moreStream())});return this},addAll:function(){this.collection.each(this.addOne,this)},addOne:function(b,a,c){a=null;a="level unlock test comment follow stream_post translation store_purchase streak welcome translator_promotion".split(" ");if(b.has("type")){if(-1==a.indexOf(b.get("type")))return;a=void 0===this.last_datetime||b.get("datetime_string")!==
this.last_datetime;a=new (duo.Event.getView(b.get("type")))({model:b,show_time:a});this.last_datetime=b.get("datetime_string")}else a=new duo.CollapsedEventView({model:b});0===c.at?this.$(".activity-stream>li:nth-child(1)").after(a.render().el):this.$(".activity-stream").append(a.render().el)},eventDeleted:function(b){this.collection.remove(b)},moreStream:function(){this.model.get("events").fetch({update:!0,remove:!1,data:{home_view:this.home_view}})},cleanUp:function(){$(document).unbind(".stream_scroll")}});
duo.EventCommentsView=Backbone.View.extend({template:duo.templates["event-comments"],events:{"click .post-event-comment":"postComment","click .post":"onCommentBox","focus .post":"onCommentBox"},initialize:function(){this.collection=this.model.get("comments");this.collection.bind("sync",this.render,this)},render:function(){$(this.el).html($.duostache(this.template,{is_blocked:this.model.isBlocked(),comments:this.collection.toJSON(),has_comments:0<this.collection.length,id:this.model.id},duo.templates));
duo.user&&(this.$(".post").vkeyboard({language:duo.user.get("learning_language"),placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:!1,caps:!1}),this.$(".search-box").wordLookup({templates:duo.templates,source_language:duo.user.get("ui_language"),target_language:duo.user.get("learning_language"),id:this.model.id,callback:this.lookedupWord,callback_context:this}));var b=this;_.defer(function(){b.$("label").inFieldLabels();b.$("textarea").autosize()})},postComment:function(){var b=
$.trim(this.$(".post").val());0<b.length&&(this.collection.create({message:b,wait:!0}),duo.track("post_activity_comment",{event_type:this.model.get("event_type")}))},onCommentBox:function(){this.$(".post-footer").show();this.$(".post").addClass("focus");return!0},lookedupWord:function(){duo.track("post_hints_lookup")}});
function translate_text(b){if(duo.ui_translations){var a=b.replace(/{{/g,"<%").replace(/}}/g,"%>");if(a in duo.ui_translations)return b=duo.ui_translations[a],null==b?"":b.replace(/<%/g,"{{").replace(/%>/g,"}}");console.debug("NO TRANSLATION FOR",b)}return(a=/^(.+)\|\|([^\{]+)$/.exec(b))?a[1]:b}
(function(b){function a(){var a=arguments[arguments.length-1];if(arguments.length!=duo.ui_language_plurals+1)return 1!=a?arguments[1]:arguments[0];a=duo.ui_language_pluralize(a);return arguments[a]}function c(b,c){var d=null,f=c(b);if(0==f.indexOf("[")&&f.lastIndexOf("]")==f.length-1)try{d=JSON.parse(f)}catch(h){}d||(d=f.split(","));return a.apply(this,d)}function d(a,b){return{m:"masculine",f:"feminine",nt:"neuter",pl:"plural"}[b(a)]}function f(a,b){return{sg:"singular",pl:"plural"}[b(a)]}function g(a,
b){var c=b(a).split(",");return 1<c.length?"this":{nom:"nominative",acc:"accusative",dat:"dative",gen:"genitive"}[c[0]]}function h(a,b){var c=parseInt(b(a)),d=c%100;if(20>d&&10<d)return c+"th";switch(c%10){case 1:return c+"st";case 2:return c+"nd";case 3:return c+"rd";default:return c+"th"}}function k(a,b){return parseInt(b(a))+1}function l(a,b){var c=parseInt(b(a));return translate_text("Mon Tue Wed Thu Fri Sat Sun".split(" ")[c])}function m(a,c){var d=c(a).split(",").slice(0,-1);return 0===d.length?
"":b.duostache(duo.templates.short_list,{one:d[0],two:d[1],more_two:2<d.length,three:3<d.length?null:d[2],more:3>=d.length?null:d.length-2})}function n(a){return 10>a?"0"+a:a}function p(a,b){var c=parseInt(b(a)),d=n(parseInt(Math.floor(c/60))),c=n(parseInt(c)%60);return d+":"+c}function q(a,c){var d=c(a),f=new Date(d||""),f=((new Date).getTime()-f.getTime())/1E3,h=Math.floor(f/86400);if(isNaN(h)||0>h)f=new Date((d||"").replace(/-/g,"/").replace(/[TZ]/g," ")),f=((new Date).getTime()-f.getTime())/1E3,
h=Math.floor(f/86400);if(isNaN(h)||0>h)f=1,h=0;return b.duostache(duo.templates.pretty_date,0==h&&(60>f&&{just:!0}||120>f&&{minute:!0}||3600>f&&{minutes:!0,n:Math.floor(f/60)}||7200>f&&{hour:!0}||86400>f&&{hours:!0,n:Math.floor(f/3600)})||1==h&&{yesterday:!0}||7>h&&{days:!0,n:h}||31>h&&{weeks:!0,n:Math.floor(h/7)}||365>h&&{months:!0,n:Math.floor(h/30)}||{years:!0,n:Math.floor(h/365)})}function s(a,b){return b(a).toLowerCase().charAt(0)in t?"an":"a"}function u(a,b){return b(translate_text(a))}function y(a,
b){return b(a)}function x(a,b){var c=b("{{"+a+"}}");return b(translate_text(c))}function A(a,b){var c=b("{{{"+a+"}}}");return b(translate_text(c))}function B(a,b){var c=b(a);return b(translate_text(c))}function z(a,b){var c=b(a).split(",");return parseFloat(c[0],10).toFixed(parseInt(c[1]))}function v(a,b){var c=b(a);c.indexOf("default_1");return b(c.replace("default_1","default_2"))}var t={a:!0,e:!0,i:!0,o:!0,u:!0},w={pluralize:function(){return c},ranked_number:function(){return h},_i:function(){return u},
_ivar:function(){return x},_ivaru:function(){return A},_iv:function(){return B},_i_in:function(){return u},_i_en:function(){return y},genderize:function(){return d},caserize:function(){return g},numberize:function(){return f},from_index:function(){return k},day_of_week:function(){return l},short_list:function(){return m},format_seconds:function(){return p},pretty_date:function(){return q},determiner:function(){return s},toFixed:function(){return z},default_avatar:function(){return v}};b.duostache=
function(a,c,d,f){var h={};_.each(duo.ab_options,function(a,b){h[b+"_"+a]=!0});duo.user?(_.extend(h,duo.user.toJSON().ab),h.logged_in=!0,h.trial_account=!!duo.user.get("trial_account"),h.prebeta_experimental_mode=duo.prebeta_experimental_mode,h.immersion_enabled=duo.immersion_enabled,h["ui_language_"+duo.user.get("ui_language")]=!0,h.social_enabled=duo.social_enabled):h["ui_language_"+duo.browser_language]=!0;h.in_house_localized=duo.in_house_localized;h.dir=duo.script_direction;h.rtl="rtl"==duo.script_direction;
_.each(duo.feature_flags,function(a,b){h[b+"_ff_"+a]=!0});c=b.extend({},w,h,c);d=b.extend({},d);return b.mustache(a,c,d)}})(jQuery);DictionarySettings={HOST_PHASE1:"d.duolingo.com/",HOST_PHASE2:"d2.duolingo.com/"};
(function(b){function a(a,b){var c=a,d=0;_.each(b,function(a){c=c.slice(0,a[0]+d)+"<b>"+c.slice(a[0]+d,a[1]+d)+"</b>"+c.slice(a[1]+d);d+=7});return c}function c(a){return-1==a.indexOf("://")?window.location.protocol+"//"+a:a}function d(a,d,f){b.ajax({url:c(a),dataType:"jsonp",data:{tokens:JSON.stringify(_.pluck(f,"text"))},type:"GET",success:function(a){a=_.map(a,function(a,b){0<a.length&&_.isArray(a[0])&&(a=a[0][1]);return{value:b,hint_table:{rows:_.map(a,function(a){return{cells:[{hint:a}]}})},
id:b}});var c=new h.TokenList;c.reset(a);_.each(f,function(a){var f=c.get(a.text);f?(new h.TextTokenSideView({model:f,settings:d,el:b(a.el)})).render():console.error(a.text,"is missing from hints")})}})}var f=DictionarySettings.HOST_PHASE1,g={m:"masculine",f:"feminine",nt:"neuter"},h={},k=0,l=!1;h.settings={url:f+"words/hints",verb_table_url:f+"words/verb_tables",source_language:"es",target_language:"en",callback:null,callback_context:null,show_hints:3,hover_options:{sensitivity:3,interval:120},templates:{"hints-sentence":'<span class="hints-sentence"></span>',
"hints-token":'<span class="token" id="token_{{index}}">{{value}}</span>',"hints-link":'<a class="hints-link" href="{{value}}"></a>'},example:!1,show_tokens:[],top:20,highlights:null,language_information:null,reverse:!1,highlight_verb_endings:!1,style_mapping:null,explanations:null,new_explanation_ids:[],reorder_using_machine_translations:!1,is_document_sentence:!1};h.verb_table_settings={url:f+"words/verb_tables",source_language:"es",templates:{"hints-sentence":'<span class="hints-sentence"></span>',
"hints-token":'<span class="token" id="token_{{index}}">{{value}}</span>',"hints-link":'<a class="hints-link" href="{{value}}"></a>'},language_information:null};h.token_hints_settings={url:DictionarySettings.HOST_PHASE2+"api/1/dictionary/hints",source_language:"es",target_language:"en",templates:{"hints-sentence":'<span class="hints-sentence"></span>',"hints-token":'<span class="token" id="token_{{index}}">{{value}}</span>',"hints-link":'<a class="hints-link" href="{{value}}"></a>'},show_hints:3,
language_information:null};h.Token=Backbone.Model.extend({defaults:{type:"text",index:null},toJSON:function(){var a=Backbone.Model.prototype.toJSON.call(this);0===b.trim(a.value).length&&(a.is_space=!0);b.support.leadingWhitespace||(a.value=a.value.replace(" ","&nbsp; "));if("hint_table"in a&&!("headers"in a.hint_table))for(var c=0;c<a.hint_table.rows.length;c++)for(var d=a.hint_table.rows[c],f=0;f<d.cells.length;f++){var h=d.cells[f];"infinitives"in h&&0<h.infinitives.length&&(h.has_infinitives=
!0,h.infinitives_string=JSON.stringify(h.infinitives))}return a},getHints:function(){return!this.has("hint_table")?"":this.get("hint_table").rows[0].cells[0].hint}});h.TokenList=Backbone.Collection.extend({model:h.Token});h.VerbTable=Backbone.Model.extend({defaults:{title:!0},fetch:function(a){a=a||{};a.data=a.data||{};a.data.infinitives=JSON.stringify(this.get("infinitives"));a.data.verb_patterns=!0;a.dataType="jsonp";Backbone.Model.prototype.fetch.call(this,a)},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);
if(!("language_information"in b)||!b.language_information)return b;b.infinitives_data={};for(var c=0;c<b.infinitives.length;c++){var d=b.infinitives[c],f={};b.infinitives_data[d]={infinitive:d,tables:f};for(var h in b.language_information.tenses){var g=b.language_information.tenses[h];b.infinitives_data[d]["has_"+h]=!0;f[h]=[];for(var k=0;k<Math.ceil(g.length/3);k++)f[h].push({tenses:g.slice(3*k,3*(k+1)),table:[],more_tables:k<Math.ceil(g.length/3)-1});var l=b.language_information.pronoun_mapping;
"others"==h&&(l=l.slice(0,1));for(var m=0;m<l.length;m++){for(var z=[],v=l[m],k=0;k<g.length;k++){var t=g[k].tense,w=b.data[d][v.tenses[t]];v.tenses[t]in b.data[d]||(w=b.data[d][v.tenses[t].split("_")[0]]);"de"==this.get("language")&&"present_first_person_singular"==v.tenses[t]&&(w=w.slice(0,1));t=_.map(w,function(b){return a.apply(this,b)}).join(", ");z.push({word:t})}for(k=0;k<Math.ceil(g.length/3);k++)f[h][k].table.push({pronoun:v.pronoun,row:z.slice(3*k,3*(k+1))})}}}return b},parse:function(a){for(var b=
{},c=0;c<this.get("infinitives").length;c++){var d=this.get("infinitives")[c];b[d]=a[c]}return{data:b}}});h.SentenceView=Backbone.View.extend({tagName:"span",initialize:function(a){this.settings=a.settings;this.template=this.settings.templates["hints-sentence"];k=0;l=!1;b(this.el).html(b.duostache(this.template));this.addAll();this.$(".verb-table-modal").modal({backdrop:!0,show:!1});void 0!=a.render_callback&&a.render_callback()},addAll:function(){this.collection.each(this.addOne,this)},addOne:function(a){var b=
a.get("type").toTitleCase()+"TokenView";this.settings.specials&&a.get("value")in this.settings.specials&&a.set(this.settings.specials[a.get("value")]);this.settings.bold&&0<=_.indexOf(this.settings.bold,a.get("value").toLowerCase())&&a.set({bold:!0});a=new h[b]({model:a,settings:this.settings});this.$(".hints-sentence").append(a.render().el)}});h.TextTokenView=Backbone.View.extend({tagName:"span",events:{"hover .more-hints":"moreHints","click .btn.conjugate":"showVerbTable","click .conjugate-small":"showReverseVerbTable",
"click .btn.explain":"showExplanation","click .btn.dismiss":"hideExplanation"},initialize:function(a){this.settings=a.settings;this.template=this.settings.templates["hints-token"];if((a=this.model.get("hint_table"))&&a.rows.length>this.settings.show_hints){for(var b=this.settings.show_hints;b<a.rows.length;b++)a.rows[b].hide=!0;a.more_hints=!0}a&&0<a.rows.length&&(a.max_colspan=1,"colspan"in a.rows[0].cells[0]&&(a.max_colspan=a.rows[0].cells[0].colspan));null!=this.settings.explanations&&null!=this.model.get("index")&&
(a=this.settings.explanations[this.model.get("index")],null!=a&&this.model.set("explanation",a));this.ignore_mouse_leave=!1},bindHover:function(){var a=this,c=function(b){a.renderHints.apply(a,[b])},c={over:c,out:c,sensitivity:this.getSensitivity()};b.extend(c,this.settings.hover_options);this.$(".token-wrapper").hoverIntent(c)},render:function(){if(null!=this.settings.highlights){for(var c=this.model.get("value"),d=0;d<this.settings.highlights.length;d++){var f=this.settings.highlights[d];k>=f[0]&&
k<f[1]&&this.model.set({highlighted:!0})}k+=c.length}null!=this.settings.new_words&&0<=_.indexOf(this.settings.new_words,this.model.get("value").toLowerCase())&&this.model.set({new_word:!0});var h=this.settings.style_mapping||{},f="language_information"in this.settings&&null!=this.settings.language_information,d=this.model.get("infinitives"),c=this.model.get("PoS"),d="VERB"===c&&null!=d&&0<d.length,d=f&&!this.settings.reverse&&d,f=f&&this.settings.reverse,h=h[this.model.get("value").toLowerCase()],
m=this.model.get("modifiers"),y=this.model.get("hint_table"),x=null!=m&&"gender"in m&&m.gender in g,c=(x=(x=x&&("POS"in m&&"n"==m.POS||"NOUN"===c))&&null!=y&&null==y.headers)?g[m.gender]:null,A=this.prettifyHint;b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{prettify_hint:function(){return A},show_verb_table:d,show_reverse_verb_table:f,render_verb_table_div:d||f,position:this.getPosition(),gender:c,style_classes:h}),this.settings.templates,!0));this.bindHover();!l&&null!=
this.model.get("explanation")&&(c=this.model.get("explanation"),-1!=_.indexOf(this.settings.new_explanation_ids,c.id)&&(l=!0,_.defer(_.bind(this.renderNewExplanation,this))));c=this.model.get("value").toLowerCase();!l&&-1!=_.indexOf(this.settings.show_tokens,c)&&(this.settings.show_tokens=_.without(this.settings.show_tokens,c),_.defer(_.bind(this.renderNewWord,this)));this.settings.highlight_verb_endings&&(!this.settings.reverse&&this.model.has("verb_patterns"))&&(c=a(this.model.get("value"),this.model.get("verb_patterns")),
this.model.get("highlighted")?this.$(".token strong").html(c):this.$(".token").html(c));return this},renderNewWord:function(){var a=this.model.get("hint_table");if(a){if(this.settings.callback){var c=[this.model.get("value"),this.model.get("index"),this.el,void 0,!0];if(!1===this.settings.callback.apply(this.settings.callback_context,c))return}c=b(this.el).parents(".hints-sentence");this.$(".token").toggleClass("highlighted");if(a.references)for(var d=0;d<a.references.length;d++)c.find("#token_"+
a.references[d]).toggleClass("highlighted");b(this.el).css("position","relative");this.$(".hint-table").toggle();this.centerHints()}},renderNewExplanation:function(){this.$(".content").hide();this.$(".explanation").show();this.renderNewWord()},showExplanation:function(){this.ignore_mouse_leave=!0;this.$(".content").hide();this.$(".explanation").show();this.centerHints();this.resetMoreHints()},hideExplanation:function(){this.ignore_mouse_leave=!0;this.$(".explanation").hide();this.$(".content").show();
this.$(".fadeInUp").removeClass("animated").removeClass("fadeInUp");this.centerHints()},renderHints:function(a){if(this.model.get("hint_table")){var b=this.ignore_mouse_leave;this.ignore_mouse_leave=!1;"mouseenter"===a.type?this.$(".hint-table").is(":visible")||(this.hideAllHints(),this.toggleHintClasses(),this.$(".hint-table").show(),this.centerHints(),this.settings.callback&&(args=[this.model.get("value"),this.model.get("index"),this.el,this.model.getHints()],this.settings.callback.apply(this.settings.callback_context,
args))):"mouseleave"===a.type&&!b&&(this.hideAllHints(),this.$(".explanation").hide(),this.$(".content").show(),this.$(".fadeInUp").removeClass("animated").removeClass("fadeInUp"),this.resetMoreHints())}},moreHints:function(a){this.$("tr.hidden").show();this.$(".more-hints").hide();this.centerHints()},resetMoreHints:function(){this.$("tr.hidden").hide();this.$(".more-hints").show()},getPosition:function(){return"below"},getSensitivity:function(){return 7},centerHints:function(){var a=this.$(".token"),
c=this.$(".hint-table"),d=a.outerWidth(),f=a.offset().left,h=c.outerWidth(),g=d/2-h/2;-10>f+g?(g=100*(f- -10+d/2)/h,this.$(".arrow").css({left:g+"%"}),g=-10-f):this.$(".arrow").css({left:"50%"});d=this.settings.top;"fixed"==c.css("position")&&(d=a.offset().top+a.outerHeight()-b(document).scrollTop(),g+=f);c.css({top:d,left:g})},hideAllHints:function(){var a=b(this.el).parents(".hints-sentence");if(null==a||0==a.length)a=b(this.el).parents("#app");a.find(".explanation").hide();a.find(".content").show();
a.find(".fadeInUp").removeClass("animated").removeClass("fadeInUp");a.find(".hint-table").hide();a.find(".token").removeClass("highlighted");a.find(".new").fadeOut(400)},toggleHintClasses:function(){var a=this.model.get("hint_table"),c=b(this.el).parents(".hints-sentence");this.$(".token").toggleClass("highlighted");if(a.references)for(var d=0;d<a.references.length;d++)c.find("#token_"+a.references[d]).toggleClass("highlighted");b(this.el).css("position","relative")},prettifyHint:function(a,b){return b(a).replace(/\((.+?)\)/g,
"<i>($1)</i>")},showVerbTable:function(){if(this.model.get("infinitives")){var a=new h.VerbTable({infinitives:this.model.get("infinitives"),language_information:this.settings.language_information,language:this.settings.source_language});a.url=c(this.settings.verb_table_url+"/"+this.settings.source_language);var b=this.$(".verb-table-modal").clone().appendTo("body").modal({backdrop:!0});new h.VerbTableView({settings:this.settings,model:a,el:b.find(".modal-body")});b.on("hidden",function(){b.remove()})}else console.log(this.model.get("value"),
"has no infinitives")},showReverseVerbTable:function(a){a=b(a.target);if(a.data("infinitives")){a=new h.VerbTable({infinitives:a.data("infinitives"),language_information:this.settings.language_information,language:this.settings.target_language});a.url=c(this.settings.verb_table_url+"/"+this.settings.target_language);var d=this.$(".verb-table-modal").clone().appendTo("body").modal({backdrop:!0});new h.VerbTableView({settings:this.settings,model:a,el:d.find(".modal-body")});d.on("hidden",function(){d.remove()})}else console.log("hint in",
this.model.get("value"),"has no infinitives")}});h.HintTableView=h.TextTokenView.extend({events:{"hover .more-hints":"moreHints","mouseleave .hint-table":"lessHints","click .conjugate-container .btn":"showVerbTable","click .conjugate-small":"showReverseVerbTable"},initialize:function(a){h.TextTokenView.prototype.initialize.call(this,a);this.template=this.settings.templates["hints-table"];this.anchor=a.anchor},render:function(){h.TextTokenView.prototype.render.call(this);this.centerHints();this.$(".hint-table").show();
return this},centerHints:function(){this.$(".hint-table").anchor({anchor:this.anchor,type:"below"})},moreHints:function(){h.TextTokenView.prototype.moreHints.call(this);this.centerHints()},lessHints:function(){this.$("tr.hidden").hide();0<this.$(".hint-footer").find(".footer-container").size()?this.$(".more-hints").show():this.$(".hint-footer").show();this.centerHints()}});h.TextTokenSideView=h.TextTokenView.extend({centerHints:function(){this.$(".hint-table").anchor({anchor:b(this.el),container:b(this.el),
type:"right"});b(this.el).css("position","")},toggleHintClasses:function(){},getPosition:function(){return"right"},getSensitivity:function(){return 7}});h.LinkTokenView=Backbone.View.extend({tagName:"span",initialize:function(a){this.settings=a.settings;this.template=this.settings.templates["hints-link"];b(this.el).html(b.duostache(this.template,this.model.toJSON()));this.collection=new h.TokenList;this.collection.reset(this.model.get("tokens"));this.addAll()},addAll:function(){this.collection.each(this.addOne,
this)},addOne:function(a){a.set({in_link:!0,url:this.model.get("value")});a=new h.TextTokenView({model:a,settings:this.settings});this.$(".hints-link").append(a.render().el)}});h.VerbTableView=Backbone.View.extend({events:{"click .tabs li":"switchTables","click a[data-infinitive]":"switchInfinitive","click .more-tenses":"moreTenses"},initialize:function(a){this.settings=a.settings;this.template=this.settings.templates["hints-verb-table"];this.model.bind("sync",this.render,this);this.model.fetch()},
render:function(){var a=this,c=this.model.toJSON();void 0===this.current_infinitive&&(this.current_infinitive=this.model.get("infinitives")[0]);var d=_.indexOf(this.model.get("infinitives"),this.current_infinitive);b(this.el).html(b.duostache(this.template,_.extend({},c,{verb_table:function(){return a.getEntry},current_infinitive:this.current_infinitive,pre_infinitives:_.first(this.model.get("infinitives"),d),post_infinitives:_.rest(this.model.get("infinitives"),d+1),current_infinitive_data:c.infinitives_data[this.current_infinitive]}),
this.settings.templates));this.$("#subjunctive-tables").hide();this.$(".verb-table").hide();this.$(".verb-tables .verb-table:first, .verb-tables .more-tenses:first").show();return this},switchTables:function(a){a=b(a.currentTarget);var c=a.data("table");this.$(".tabs li").removeClass("active");a.addClass("active");this.$(".verb-tables").hide();this.$("#"+c+"-tables").show();this.$("#"+c+"-tables .verb-table:first, .verb-tables .more-tenses:first").show()},switchInfinitive:function(a){this.current_infinitive=
b(a.currentTarget).data("infinitive");this.render()},moreTenses:function(a){a=b(a.currentTarget);a.hide();a.next(".verb-table").show();a.next(".more-tenses").show()}});h.WordLookup=Backbone.View.extend({events:{"keyup input":"onLookup","click .translate-lookup":"lookupWord","click .lookup-hints .close":"closeHints"},initialize:function(a){this.settings=a.settings;this.template=this.settings.templates["word-lookup"]},render:function(){b(this.el).html(b.duostache(this.template,{id:this.settings.id},
this.settings.templates));var a=this;b(document).bind("click.hints",function(){a.offSearchBox()});return this},onLookup:function(a){0<this.$("input").val().length?(this.$(".translate-lookup").show(),13===a.which?this.lookupWord():this.closeHints()):this.$(".translate-lookup").hide();return!1},closeHints:function(){this.$(".hint-table").remove();this.$(".lookup-hints").hide()},offSearchBox:function(){0<b("textarea:focus").size()||0<this.$("input:focus").size()||(this.$(".lookup-hints .hint-table").remove(),
this.$(".lookup-hints").hide())},lookupWord:function(a){a=b.trim(this.$("input").val());this.$("input").hints({text:a,word_only:!0,source_language:this.settings.source_language,target_language:this.settings.target_language,templates:this.settings.templates,reverse:!0,container:this.$(".lookup-hints")});this.$(".lookup-hints").show();this.settings.callback&&this.settings.callback.apply(this.settings.callback_context);return!1}});b.fn.hints=function(a){return this.each(function(){var d=b.extend({},
h.settings,a),f=b(this),g=d.text?d.text:f.text();url=[d.url,d.source_language,d.target_language];url=url.join("/")+"?callback=?";g={format:"new",sentence:g,cache:!duo.prebeta_experimental_mode,reorder_using_machine_translations:a.reorder_using_machine_translations,is_document_sentence:a.is_document_sentence};duo.user&&(g.locale=duo.user.get("locale"));b.getJSON(c(url),g,function(b){d.example&&(b=m);if(d.manual_hints){b=d.manual_hints;for(var c={tokens:[]},g=0;g<b.length;g++){var k={};_.isArray(b[g])?
k.value=b[g][0]:k.value=b[g];1<b[g].length&&(k.hint_table={rows:[{cells:[{hint:b[g][1]}]}]},k.index=g+1);c.tokens.push(k)}b=c}b&&(d.word_only?(b=new h.Token(b.tokens[0]),b=new h.HintTableView({model:b,settings:d,el:d.container,anchor:f}),b.render()):(c=new h.TokenList,c.reset(b.tokens),b=new h.SentenceView({collection:c,settings:d,render_callback:a.render_callback}),f.empty().append(b.render().el)),d.render_callback&&d.render_callback.call(d.callback_context))},"json")})};b.fn.wordLookup=function(a){return this.each(function(){(new h.WordLookup({el:this,
settings:a})).render()})};b.fn.verbTable=function(a){return this.each(function(){var d=b.extend({},h.verb_table_settings,a),f=new h.VerbTable({infinitives:[d.infinitive],language_information:d.language_information,language:d.source_language,title:!1});f.url=c(d.url+"/"+d.source_language);new h.VerbTableView({settings:d,model:f,el:b(this)})})};b.fn.tokenHints=function(a){a=b.extend({},h.token_hints_settings,a);for(var c=[a.url,a.source_language,a.target_language],c=c.join("/"),f=0,g=_.map(this,function(a){return{text:b(a).text(),
el:a}});f<g.length;){for(var k=[],l=f;l<g.length;l++)if(k.push(g[l]),500>(c+encodeURI(JSON.stringify(_.pluck(k,"text")))).length)f=l+1;else{k.pop();break}d(c,a,k)}return this};var m={tokens:[{index:1,value:"The",hint_table:{rows:[{cells:[{hint:"el"}]},{cells:[{hint:"la"}]}]}},{value:" "},{index:2,value:"dog",hint_table:{rows:[{cells:[{hint:"perro"}]},{cells:[{hint:"macho"}]},{cells:[{hint:"tipo"}]},{cells:[{hint:"perseguir"}]}]}},{value:" "},{index:3,value:"is",hint_table:{rows:[{cells:[{hint:"(\u00e9l/ella) es"}]}]}},
{value:" "},{index:4,value:"black",hint_table:{references:[5,6],headers:[{token:"black",selected:!0},{token:"and"},{token:"white"}],rows:[{cells:[{hint:"blanco y negro",colspan:3}]},{cells:[{hint:"negro"},{},{}]}]}},{value:"-"},{index:5,value:"and",hint_table:{references:[4,6],headers:[{token:"black"},{token:"and",selected:!0},{token:"white"}],rows:[{cells:[{hint:"blanco y negro",colspan:3}]},{cells:[{},{hint:"y"},{}]},{cells:[{},{hint:"e"},{}]}]}},{value:"-"},{index:6,value:"white",hint_table:{references:[4,
5],headers:[{token:"black"},{token:"and"},{token:"white",selected:!0}],rows:[{cells:[{hint:"blanco y negro",colspan:3}]},{cells:[{},{},{hint:"blanco"}]}]}},{value:";"},{value:" "},{index:7,value:"ruft",hint_table:{separable:!0,references:[10],headers:[{token:"ruft",selected:!0},{token:" \u2026 "},{token:"an"}],rows:[{cells:[{hint:"(he/she/it) calls (up)"}]},{cells:[{hint:"(he/she/it) is calling (up)"}]}]}},{value:" "},{type:"link",value:"http://www.duolingo.com",tokens:[{index:8,value:"the",hint_table:{rows:[{cells:[{hint:"la"}]},
{cells:[{hint:"el"}]}]}},{value:" "},{index:9,value:"compoundword",hint_table:{headers:[{token:"compound",selected:!0},{token:"word",selected:!0}],rows:[{cells:[{hint:"palabra compuesta",colspan:2}]},{cells:[{hint:"compuesta"},{hint:"palabra"}]},{cells:[{hint:"compuesto"},{}]},{cells:[{hint:"mezcla"},{}]}]}},{value:" "},{index:10,value:"an",hint_table:{separable:!0,references:[7],headers:[{token:"ruft"},{token:" \u2026 "},{token:"an",selected:!0}],rows:[{cells:[{hint:"(he/she/it) calls (up)"}]},{cells:[{hint:"(he/she/it) is calling (up)"}]}]}}]},
{value:"."}]}})(jQuery);
(function(b){var a=0,c=[];b.need_flash=!1;b.tts={};b.tts.playerError=function(a){console.error(a);b.post("/diagnostics/js_error",{msg:a,name:"TTS flash error",url:window.location.href})};b.tts.setUp=function(a){soundManager.setup({preferFlash:a})};b.tts.setupSoundManager=function(){var a=-1!=navigator.userAgent.toLowerCase().indexOf("chrome")&&-1==navigator.userAgent.toLowerCase().indexOf("chromium");soundManagerNew.setup({url:"/swf/sm2",debugMode:!1,preferFlash:!a,flashLoadTimeout:8E3,onready:function(){console.debug("Duolingo is hiring software engineers: https://www.duolingo.com/jobs");
soundManager.passedSound=soundManager.createSound({id:"pass",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/lesson_complete.mp3",volume:50});soundManager.pageSound=soundManager.createSound({id:"page",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/page.mp3"});soundManager.bonusSound=soundManager.createSound({id:"bonus",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/lesson_bonus.mp3",volume:50});soundManager.failedSound=soundManager.createSound({id:"fail",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/lesson_failed.mp3",
volume:50});soundManager.rightSound=soundManager.createSound({id:"rightAnswer",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/right_answer.mp3",volume:35});soundManager.wrongSound=soundManager.createSound({id:"wrongAnswer",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/wrong_answer.mp3",volume:35});soundManager.testSound=soundManager.createSound({id:"testAnswer",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/test_answer.mp3",volume:40});soundManager.retrySound=soundManager.createSound({id:"tryAgain",
url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/try_again.mp3",volume:40});soundManager.timerSound=soundManager.createSound({id:"timer",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/timer_click.mp3",volume:60});soundManager.levelSound=soundManager.createSound({id:"levelUp",url:"https://s3.amazonaws.com/duolingo-data/s3/sounds/level_up.mp3",volume:50})},ontimeout:function(a){a.error?("NO_FLASH"===a.error.type&&(b.need_flash=!0),b.tts.playerError("SM2 failed to start. Status: "+a.success+
"; Error type: "+a.error.type)):b.tts.playerError("SM2 failed to start. Status unavailable.")}});soundManager=soundManagerNew};b.tts.cleanAll=function(){for(var a=0;a<c.length;a++)soundManager.destroySound(c[a]);c=[]};b.fn.tts=function(d){var f={host:null,path:null,voice_map:null,voice:null,language:null,tts_type:null,tts_id:null,autoplay:!0,visible:!0,slowEnabled:!1,beginner:!1,size:"small"};return this.each(function(){if("cleanUp"===d){f=b(this).data("tts");for(var g=0;g<c.length;g++)if(c[g]===
f.speaker_id||c[g]===f.slow_speaker_id)soundManager.destroySound(c[g]),c.splice(g,1),g--}else{d&&(d.aid||(d.aid="audio-"+ ++a),b.extend(f,d));g="speaker-"+f.aid;f.speaker_id=g;null==f.host&&(f.host=duo.tts_base_url);null==f.path&&(f.path=duo.tts_path);null==f.voice_map&&(f.voice_map=duo.tts_voices);null==f.voice&&(f.voice=f.language in f.voice_map?f.voice_map[f.language]:f.language);null==f.sound_path&&(f.sound_path=duo.tts_base_url+duo.tts_path,f.sound_path=f.sound_path.replace("{voice}",f.voice),
f.sound_path=f.sound_path.replace("{type}",f.tts_type),f.sound_path=f.sound_path.replace("{id}",f.tts_id));null==f.slow_sound_path&&(f.slow_sound_path=f.sound_path+"_slow");f.template&&b(this).html(b.duostache(f.template,f,{},!0));var h=soundManager.createSound({id:g,url:f.sound_path,autoPlay:f.autoplay&&!f.beginner,onload:function(){if(f.onload)f.onload()}});c.push(g);var k=null;if(f.slowEnabled){f.slow_speaker_id=g+"-slow";var l=f.slow_sound_path;duo.mobile_web_view||(k=soundManager.createSound({id:f.slow_speaker_id,
url:l,autoPlay:f.autoplay&&f.beginner}));c.push(f.slow_speaker_id)}b(this).data("tts",f);f.click&&(f.play_trigger="click");f.visible?(b(this).find("#"+g+"-button").click(function(){soundManager.stopAll();h.play()}),b(this).find("#"+g+"-slow-button").click(function(){duo.mobile_web_view&&(k=soundManager.createSound({id:f.slow_speaker_id,url:l,autoPlay:f.autoplay&&f.beginner}));soundManager.stopAll();k.play()})):f.play_trigger&&b(this).bind(f.play_trigger,function(){soundManager.stopAll();h.play()})}})}})(jQuery);
$(function(b){function a(a,c){FB.api("/me?access_token="+c,function(d){d=d.first_name;d={method:"feed",picture:"http://static.duolingo.com/images/facebook/owl.png",access_token:c,name:a.name.replace("%firstname%",d),link:"http://www.duolingo.com/",caption:a.caption.replace("%firstname%",d),description:a.description.replace("%firstname%",d)};console.log(d);try{b(document).scrollTop(0)}catch(f){}FB.ui(d,function(a){a&&a.post_id&&duo.track("facebook shared")})})}duo.Model=Backbone.Model.extend({getDefault:function(a,
b){return this.has(a)?this.get(a):b},multiGet:function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.get(d)}return b}});duo.View=Backbone.View.extend({addChildView:function(a){!a||!a.close?console.log("WARNING: calling addChildView with bad argument!"):(this.childViews||(this.childViews=[]),this.childViews.push(a))},closeChildViews:function(){if(this.childViews)for(var a=0;a<this.childViews.length;a++)this.childViews[a].close();this.childViews=void 0},close:function(){this.closeChildViews();
this.unbind();this.stopListening();if(this.onClose)this.onClose()}});duo.vent=_.extend({},Backbone.Events);duo.show404=function(){window.location.replace("/errors/404.html")};duo.loginWithFacebook=function(a,c,d,f){c=c||function(){};d=d||function(){};f=f||function(){};duo.getFBAccessToken(function(g){b.post("/facebook/register",{access_token:g},null,"json").done(function(b){"OK"===b.response?duo.track("login old id",{login_method:"facebook",ui_location:a},c,300):b.error?(FB.getLoginStatus(function(){},
!0),f()):d(b)}).fail(f)},f,!0)};duo.getFBAccessToken=function(a,b,c){a=a||function(){};b=b||function(){};FB.login(function(c){"connected"==c.status?a(c.authResponse.accessToken):b()},{scope:"email,publish_actions"})};duo.postFacebookAction=function(a,b,c){FB.api("/me/"+a+":"+b,"post",c,function(a){!a||a.error?console.log("error posting open graph action"):console.log(a.id)})};duo.loginWithGoogle=function(a,c,d,f){c=c||function(){};d=d||function(){};f=f||function(){};var g=_.once(function(){gapi.client.load("oauth2",
"v2",function(){gapi.client.oauth2.userinfo.get().execute(function(g){g.email?b.post("/gplus/register",{auth:gapi.auth.getToken().access_token,email:g.email},null,"json").done(function(n){!0==n.has_account?duo.track("login old id",{login_method:"gplus",ui_location:a},c,300):gapi.client.load("plus","v1",function(){gapi.client.plus.people.get({userId:"me"}).execute(function(c){var k=(new Date).getTime(),n=duo.user&&duo.user.get("trial_account")?"/register_delayed":"/register";b.post(n,{one_click:!0,
email:g.email,fullname:c.result.displayName,profile_image:c.image.url,gplus_id:c.id,ui_language:c.result.language},function(){},"json").done(function(b){var c=(new Date).getTime()-k;if("OK"===b.response){var g=duo.user?d:_.after(2,d);duo.track("register",{through:"gplus",ui_location:a,successful:!0,latency_ms:c},g,300);duo.user||duo.track("$create_alias",{alias:String(b.user_id)},g,300)}else duo.track("register",{successful:!1,ui_location:a,through:"gplus",error:_.keys(b.failures).join(", "),latency_ms:c},
f,300)}).fail(f)})})}).fail(f):f()})})});gapi.auth.signIn({clientid:"450298686065.apps.googleusercontent.com",cookiepolicy:"single_host_origin",scope:"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.login",apppackagename:"com.duolingo",callback:function(a){a.status.signed_in&&g()}})};duo.scrollToElement=function(a,c,d){try{var f=Math.max(b("html").scrollTop(),b("body").scrollTop()),g=Math.max(0,a.offset().top+a.height()/2-b(window).height()/2);c=c||Math.min(1500,
1.8*Math.abs(g-f));b("html, body").stop().animate({scrollTop:g},c,d)}catch(p){}};duo.formatTime=function(a,b,c){var d=duo.user.get("ui_language");return"pt"==d||"fr"==d?a+":00":b+c};duo.generatePracticeTimes=function(a){return _.map(_.range(24),function(b){var c=b%12,d=60*b;0===c&&(c=12);return{offset:d,time:duo.user&&duo.formatTime(b,c,12>b?"am":"pm"),selected:d==a}})};duo.wordStrengthData=function(a){var b={};a=Math.round(4*a);b.strength_s=1<a;b.strength_m=2<a;b.strength_l=3<a;b.strength_l?b.blink_l=
!0:b.strength_m?b.blink_m=!0:b.strength_s?b.blink_s=!0:b.blink_0=!0;return b};duo.createShortList=function(a){var b=a.length;return shortListData={num_items:b,one:1==b,two:2==b,three:3==b,more:3<b,item_one:0<b?a[0]:null,item_two:1<b?a[1]:null,item_three:2<b?a[2]:null,remainder:b-2}};var c=/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;duo.isEmail=function(a){return c.test(a)};duo.isTrialEmail=function(a){return 0===a.indexOf("tu.8zPhL")&&-1!==a.indexOf("@duolingo.com",a.length-
13)};var d=/^([a-zA-Z0-9_\.\-])+$/;duo.isUsername=function(a){return 3>a.length||16<a.length?!1:d.test(a)};duo.isPassword=function(a){return 6<=a.length};duo._diagnostic_track=function(a,c,d){mixpanel.cookie?(c=_.extend({},mixpanel.cookie.properties(),c),b.post("/diagnostics/track_mixpanel_event",JSON.stringify({event:a,properties:c}),d)):_.delay(duo._diagnostic_track,50,a,c,d)};duo.track=function(a,b,c,d){"$create_alias"==a&&/^[0-9]*$/.test(mixpanel.get_property("distinct_id"))?c&&c():("object"!==
typeof b&&(b={}),c&&(d&&(c=_.once(c),window.setTimeout(c,d)),c=_.after(2,c)),duo&&(duo.user&&duo.user.has("created_dt"))&&(b.creation_age=(new Date).getTime()-duo.user.get("created_dt")),mixpanel.track.call(mixpanel,a,b,c),duo._diagnostic_track(a,b,c))};duo.trackAndReload=function(a,b,c){duo.track(a,b,function(){window.location.reload(!0)},300)};duo.getDayDiff=function(a,b){a=a?new Date(a):new Date;b=b?new Date(b):new Date;var c=a.getTime(),d=b.getTime();return parseInt((d-c)/864E5)};duo.currUserTimezoneOffset=
function(a){if(!duo.user)return 0;a=duo.user.get("timezone_offset");return 36E5*parseInt(a.charAt(0)+"1")*(parseInt(a.slice(1,3))+parseInt(a.slice(3,5))/60)};duo.getCalendar=function(){var a=duo.currUserTimezoneOffset(),b=6E4*(new Date).getTimezoneOffset(),c=new Date((new Date(duo.user.get("current_time"))).getTime()+a),d=new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),0,0,0,0),d=new Date(d.getTime()-b-5184E5),b=c.getUTCDay(),c=duo.user.get("calendar"),c=_.chain(c).map(function(b){return{datetime:new Date(b.datetime+
a),improvement:b.improvement}}).filter(function(a){return a.datetime>d}).groupBy(function(a){return a.datetime.getUTCDay()}).value();_.each(c,function(a,b,c){a=_.reduce(a,function(a,b){return null===b.improvement?a:a+b.improvement},0);c[b]=a});for(var f=[],g=(b-b+6)%7,q=0;7>q;q++){var s={},u=(q+b+1)%7;s.state=u===b?"current":q<g?"done":"";u in c?(s.points=c[u],s.stack=Math.min(10,Math.ceil(s.points/10))):(s.stack=0,s.points=0);s.index=q;s.day=(u+6)%7;f.push(s)}return f};b(document).ready(function(){b("body").on("click",
"[data-track-click]",function(a){a.originalEvent&&duo.track("click",{which:b(a.currentTarget).data("track-click")})});b("body").on("click",'[data-toggle="facebook-share"]',function(c){window.FB&&(c=b(c.currentTarget),c={name:c.data("name"),description:c.data("description"),caption:c.data("caption")},duo.track("facebook share click"),duo.getFBAccessToken(_.bind(a,this,c)))});b("body").on("click",'[data-toggle="facebook-invite"]',function(a){if(window.FB){var c=b(a.currentTarget);a=c.data("user");duo.track("facebook invite click",
{from:c.data("trackFrom")});FB.ui({method:"send",link:"http://duolingo.com/#/register?ib="+duo.user.id,to:a,name:c.data("name"),description:c.data("description"),picture:"http://static.duolingo.com/images/facebook/owl.png"},function(a){a&&(duo.track("facebook invited"),c.attr("disabled","disabled").text(c.data("sent")))})}});b("body").on("click",'[data-toggle="tweet"]',function(a){var c=(b(window).width()-575)/2,d=(b(window).height()-400)/2;a=this.href;var f=b(this),c="status=1,width=575,height=400,top="+
d+",left="+c,d={};f.data("text")&&(d.text=f.data("text"));f.data("url")&&(d.url=f.data("url"));f.data("via")&&(d.via=f.data("via"));console.log(a+"?"+b.param(d));window.open(a+"?"+b.param(d),"twitter",c);return!1});b("body").on("mouseenter",'[data-toggle="popover"]',function(a){var c=b(a.currentTarget);a=b(c.data("popover"));if(!c.offset()||0==c.offset().left&&0==c.offset().top&&0==c.width()&&0==c.height())c=!1;else{var d=c.data("placement")||"right",f=c.data("margin")||0;a.anchor({type:d,anchor:c,
margin:f,container:b("#app")});"left"==(c.data("justification")||"center")&&a.css("left",c.position().left);c=parseInt(c.data("x-offset")||"0");a.css("left",parseInt(a.css("left"))+c);c=!0}c&&a.show()}).on("mouseleave",'[data-toggle="popover"]',function(a){a=b(a.currentTarget);b(a.data("popover")).hide()});b("body").on("click",'[data-toggle="follow"]',function(a){a=b(a.currentTarget);var c=a.data("user");a.hasClass("success")?(duo.user.unfollow(c,a.data("silent")),a.removeClass("success").text(a.data("followText")),
a.data("followClass")&&a.addClass(a.data("followClass")),a.data("unfollowClass")&&a.removeClass(a.data("unfollowClass"))):(duo.user.follow(c,a.data("silent")),a.addClass("success").text(a.data("unfollowText")),a.data("followClass")&&a.removeClass(a.data("followClass")),a.data("unfollowClass")&&a.addClass(a.data("unfollowClass")))});b("body").on("click",'[data-toggle="tab"]',function(a){a=b(a.currentTarget);var c=b(a.data("selector"));b('[data-group="'+a.data("group")+'"]').each(function(){b(this).removeClass("active");
b(b(this).data("selector")).hide()});c.show();a.addClass("active")})});duo.validateEmail=function(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)};duo.showIntroVideo=function(a){var c={en:"8OebgtUjLg4",it:"VF4tOxFgMVo",de:"eKRFT4Rnpwg",fr:"V8GBagCa2F8",pt:"XjLZ5nh44kw",es:"F9tUaDKUQ8A",ru:"zwAEaXwjLdM"};b.fancybox({padding:0,autoScale:!1,transitionIn:"none",transitionOut:"none",
width:680,height:495,href:"https://www.youtube.com/v/"+c[a in c?a:"en"]+"?rel=0&feature=player_embedded",type:"swf",swf:{wmode:"transparent",allowfullscreen:"true"}})};duo.checkValidDirection=function(a,b){var c=[];duo.available_languages&&(c=_.filter(duo.available_languages,function(c){return c.from_language==a&&c.learning_language==b}));return c.length};duo.modalAlert=function(a){a.el=b("#alert-modals");(new duo.AlertModal(a)).render()};duo.switchTeamsWarning=function(a){duo.modalAlert({type:"confirm",
message_type:"leave_group",callback:a,oldGroupName:duo.user.get("group").name})};b.fn.absoluteTableCell=function(){var a=-1;this.find(".wrapper").each(function(){a=a>b(this).height()?a:b(this).height()});this.find(".wrapper").each(function(){$el=b(this);var c=b("<div />",{"class":"innerWrapper",css:{height:a,width:"100%",position:"relative"}});$el.wrapInner(c)})};b.fn.visible=function(a){var c=b(this),d=b(window),f=d.scrollTop(),d=f+d.height()-0.4*d.height(),g=c.offset().top,c=g+c.height();return(!0===
a?g:c)<=d&&(!0===a?c:g)>=f};b.fn.fixedSidebar=function(){_.defer(function(){var a=b(".page-sidebar .inner"),c=b(window),d=c.height()<a.height()+150?"absolute":"fixed";a.css({position:d});c.resize(function(){var b=c.height()<a.height()+150?"absolute":"fixed";a.css({position:b})})})};duo.getEditDistance=function(a,b){if(0==a.length)return b.length;if(0==b.length)return a.length;var c=[],d,f;for(d=0;d<=b.length;d++)c[d]=[d];for(f=0;f<=a.length;f++)c[0][f]=f;for(d=1;d<=b.length;d++)for(f=1;f<=a.length;f++)b.charAt(d-
1)==a.charAt(f-1)?c[d][f]=c[d-1][f-1]:c[d][f]=Math.min(c[d-1][f-1]+1,Math.min(c[d][f-1]+1,c[d-1][f]+1));return c[b.length][a.length]};duo.wordHighlightDiff=function(a,b){var c=new diff_match_patch,d=c.diff_linesToWords_(a,b),f=d.lineArray,d=c.diff_main(d.chars1,d.chars2,!1);c.diff_charsToLines_(d,f);return d};var f={es:{a:/[\u00e1]/g,e:/[\u00e9]/g,i:/[\u00ed]/g,o:/[\u00f3]/g,u:/[\u00fa\u00fc]/g,b:/[v]/g,s:/[z]/g},fr:{a:/[\u00e0\u00e2\u00e6]/g,e:/[\u00e8\u00e9\u00ea\u00eb]/g,i:/[\u00ee\u00ef]/g,o:/[\u00f4\u0153]/g,
u:/[\u00f9\u00fb\u00fc]/g,s:/[\u00e7]/g}};duo.normalizeHomophones=function(a,b){b=b.toLowerCase();if(a in f)for(var c in f[a])b=b.replace(f[a][c],c);return b};duo.logout=function(){b('<form action="/logout" method="post"></form>').appendTo(b("body")).submit()};var g={en:{0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",12:"twelve",13:"thirteen",14:"fourteen",15:"fifteen",16:"sixteen",17:"seventeen",18:"eighteen",19:"nineteen",20:"twenty",
30:"thirty",40:"forty",50:"fifty",60:"sixty",70:"seventy",80:"eighty",90:"ninety",100:"hundred",1E3:"thousand"},de:{0:"null",1:"ein",2:"zwei",3:"drei",4:"vier",5:"f\u00fcnf",6:"sechs",7:"sieben",8:"acht",9:"neun",10:"zehn",11:"elf",12:"zw\u00f6lf",13:"dreizehn",14:"vierzehn",15:"f\u00fcnfzehn",16:"sechzehn",17:"siebzehn",18:"achtzehn",19:"neunzehn",20:"zwanzig",30:"drei\u00dfig",40:"vierzig",50:"f\u00fcnfzig",60:"sechzig",70:"siebzig",80:"achtzig",90:"neunzig",100:"hundert",1E3:"tausend"},es:{0:"cero",
1:"uno",2:"dos",3:"tres",4:"cuatro",5:"cinco",6:"seis",7:"siete",8:"ocho",9:"nueve",10:"diez",11:"once",12:"doce",13:"trece",14:"catorce",15:"quince",16:"diecis\u00e9is",17:"diecisiete",18:"dieciocho",19:"diecinueve",20:"veinte",21:"veintiuno",22:"veintid\u00f3s",23:"veintitr\u00e9s",24:"veinticuatro",25:"veinticinco",26:"veintis\u00e9is",27:"veintisiete",28:"veintiocho",29:"veintinueve",30:"treinta",40:"cuarenta",50:"cincuenta",60:"sesenta",70:"setenta",80:"ochenta",90:"noventa",100:"cien",1E3:"mil"},
pt:{0:"zero",1:"um",2:"dois",3:"tr\u00eas",4:"quatro",5:"cinco",6:"seis",7:"sete",8:"oito",9:"nove",10:"dez",11:"onze",12:"doze",13:"treze",14:"catorze",15:"quinze",16:"dezesseis",17:"dezessete",18:"dezoito",19:"dezenove",20:"vinte",30:"trinta",40:"quarenta",50:"cinquenta",60:"sessenta",70:"setenta",80:"oitenta",90:"noventa",100:"cem",1E3:"mil"},it:{0:"zero",1:"uno",2:"due",3:"tre",4:"quattro",5:"cinque",6:"sei",7:"sette",8:"otto",9:"nove",10:"dieci",11:"undici",12:"dodici",13:"tredici",14:"quattordici",
15:"quindici",16:"sedici",17:"diciassette",18:"diciotto",19:"diciannove",20:"venti",30:"trenta",40:"quaranta",50:"cinquanta",60:"sessanta",70:"settanta",80:"ottanta",90:"novanta",100:"cento",1E3:"mille"},fr:{0:"z\u00e9ro",1:"un",2:"deux",3:"trois",4:"quatre",5:"cinq",6:"six",7:"sept",8:"huit",9:"neuf",10:"dix",11:"onze",12:"douze",13:"treize",14:"quatorze",15:"quinze",16:"seize",17:"dix-sept",18:"dix-huit",19:"dix-neuf",20:"vingt",30:"trente",40:"quarante",50:"cinquante",60:"soixante",70:"soixante-dix",
80:"quatre-vingts",90:"quatre-vingt-dix",100:"cent",1E3:"mille"}};duo.normalizeTranscript=function(a,b){"en"==a&&(b=b.replace(/'s/g," is"));if(a in g)for(var c in g[a])b=b.replace(RegExp("\\b"+c+"\\b","g"),g[a][c]);return b}}(window.jQuery));
duo.Skill=Backbone.Model.extend({url:function(){return"/skills/"+this.get("language")+"/"+encodeURIComponent(this.get("name"))},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);b.learned_more=5<=b.progress_percent-b.learning_threshold_percentage;return b},getActiveLesson:function(){return _.find(this.get("path"),function(b){return!0==b.active})}});
duo.SkillList=Backbone.Collection.extend({model:duo.Skill,parse:function(b){return _.map(b,function(a){return duo.Skill.prototype.parse.call(this,a)})},checkFinished:function(){return void 0===this.find(function(b){return!b.get("learned")&&"bonus"!=b.get("category")})}});
duo.Comment=Backbone.Model.extend({urlRoot:"/comments",toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this),a=b.marked_down_message;"marked_down_message"in b||(a=b.message);!("processed_message"in b)&&"message"in b&&(b.processed_message=this.replaceURLs(b.message));a&&(b.short_message=this.replaceURLs(a.substring(0,300)),b.shortened_message=300<b.message.length);if("best_comment"in b&&b.best_comment){var c=b.best_comment,d=c.marked_down_message;"marked_down_message"in c||(a=c.message);
c.best_short_message=this.replaceURLs(d.substring(0,300));c.best_shortened_message=300<c.message.length}else"comments"in b&&(b.comments=b.comments.toJSON());_.each(b.followers,function(a){a.expert=0<=_.indexOf(b.experts,a.id)},this);return b},replaceURLs:function(b){return 0<=b.indexOf("<a href")?b:b.replace(/(src=")?\b(((https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$]))/gi,function(a,b,d,f,g){if(b)return a;
"www."===f&&!g&&(d="http://"+d);return'<a href="'+d+'" class="blue-link" target="_blank">'+d+"</a>"})},parse:function(b){"user"in b&&b.user.flair&&(b.user.flair.level_data_sorted=b.user.flair.level_data.sort(function(a,b){return b.level-a.level}));if("comments"in b){b.comments=_.map(b.comments,function(a){_.extend(a,{experts:b.experts||this.get("experts")});return duo.Comment.prototype.parse.call(this,a)},this);b.comments=new duo.CommentList(b.comments);b.comments.parent=this;"votes"in b&&(b.hidden=
-2>b.votes);var a=0;b.comments.each(function(c){2<c.get("votes")&&(b.hidden=!1);c.get("hidden")&&(a+=1,a+=c.get("num_comments"));c.get("user")&&c.get("user").flair&&(c.get("user").flair.level_data_sorted=c.get("user").flair.level_data.sort(function(a,b){return b.level-a.level}))},this);b.num_hidden=a}else"best_comment"in b&&null!==b.best_comment&&(b.best_comment.processed_message=this.replaceURLs(b.best_comment.marked_down_message));"message"in b&&(b.processed_message=this.replaceURLs(b.marked_down_message));
return b},voteUp:function(){var b=this;duo.track("comment upvote");$.post("/comments/"+this.id+"/upvote",{best_only:this.has("best_only")},function(a){b.set(duo.Comment.prototype.parse.call(b,a))})},voteDown:function(){var b=this;duo.track("comment downvote");$.post("/comments/"+this.id+"/downvote",{best_only:this.has("best_only")},function(a){b.set(duo.Comment.prototype.parse.call(b,a))})},del:function(b){var a=this;duo.track("comment delete");$.post("/comments/"+this.id+"/delete",{del_thread:b},
function(b){console.log(b);a.set(duo.Comment.prototype.parse.call(a,b))})},giveLove:function(){var b=this;$.post("/comments/"+this.id+"/love",function(a){"love"in a&&b.set({love:a.love})})},undel:function(b){var a=this;duo.track("comment undelete");$.post("/comments/"+this.id+"/undelete",{del_thread:b},function(b){console.log(b);a.set(duo.Comment.prototype.parse.call(a,b))})},reply:function(b){var a=this;$.post("/comments/"+this.id+"/reply",{message:b,best_only:this.has("best_only")},function(b){console.log(b);
duo.track("Questions reply");a.set(duo.Comment.prototype.parse.call(a,b))})},watch:function(){var b=this;$.post("/comments/"+this.id+"/watch",{best_only:this.has("best_only")},function(a){b.set(a,{silent:!0})})},unwatch:function(){var b=this;$.post("/comments/"+this.id+"/unwatch",{best_only:this.has("best_only")},function(a){b.get("all_topics");b.set(a,{silent:!0})})}});
duo.EventComment=duo.Comment.extend({url:function(){return this.collection?_.result(this.collection,"url"):duo.Comment.prototype.url.call(this)},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);b.processed_message=this.replaceURLs(b.message);return b}});
duo.Topic=Backbone.Model.extend({currentPanel:"hot",searchResults:{},url:function(){return this.id?"/topics/"+this.id:"/topics"},parse:function(b){if(b.comments){var a=new duo.CommentList;a.reset(duo.CommentList.prototype.parse.call(a,b));a.sort_by="hot";a.page=1;a.more=b.more_comment;a.limits=b.limits;b.comments=a;b.new_comments=new duo.CommentList;b.new_comments.sort_by="new";b.new_comments.more=!0;b.top_comments=new duo.CommentList;b.top_comments.sort_by="top";b.top_comments.more=!0;b.sent_comments=
new duo.CommentList;b.sent_comments.sort_by="sent";b.sent_comments.more=!0;b.active_comments=new duo.CommentList;b.active_comments.sort_by="active";b.active_comments.more=!0;b.following_comments=new duo.CommentList;b.following_comments.sort_by="following";b.following_comments.more=!0}return b},follow:function(){var b=this;$.post("/topics/"+this.id+"/follow",function(a){"OK"===a.response&&b.set(a.topic)})},unfollow:function(b,a){var c=this;$.post("/topics/"+this.id+"/unfollow",function(d){"OK"===d.response&&
c.set(d.topic);b&&b.call(a||this)})}});duo.CommentList=Backbone.Collection.extend({model:duo.Comment,url:function(){return"/comments"},fetch:function(b){b=b||{};b.data=b.data||{};b.data.sort_by=this.sort_by;b.data.filter=this.filter_option;Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){this.page=b.page;this.more=b.more;this.user_skills=b.user_skills;this.experts=b.experts;this.limits=b.limits;return _.map(b.comments,function(a){return duo.Comment.prototype.parse(a)})}});
duo.SkillCommentList=duo.CommentList.extend({url:function(){return"/skills/"+this.skill.id+"/comments"}});duo.EventCommentList=duo.CommentList.extend({model:duo.EventComment,url:function(){return"/events/"+this.event_id+"/comments"},parse:function(b){return b}});duo.TranslationComment=duo.EventComment.extend({});duo.TranslationCommentList=duo.CommentList.extend({model:duo.TranslationComment,url:function(){return"/translations/"+this.translation_id+"/comments"},parse:function(b){return b}});
duo.SearchResults=duo.CommentList.extend({fetch:function(b){var a=this;b=b||{};b.data=b.data||{};b.data=_.extend({wt:"json",q:this.q,fq:this.fq,start:this.length},b.data);0===$.trim(b.data.q).length?this.reset([]):$.ajax({url:window.location.protocol+"//"+duo.search_host+"/solr/select",data:b.data,success:function(c){var d=c.response.docs;a.num_results=c.response.numFound;d.length?$.getJSON("/comments/load",{comment_ids:JSON.stringify(_.pluck(d,"parent_id"))},function(f){var g=c.highlighting;d=_.map(d,
function(a,b){var c=g[a.id].title||g[a.id].message;c||(c=a.title||a.message,c=c.substring(0,50)+"...");a.parent_title=f[a.parent_id]?f[a.parent_id].title:a.title;a.extract=c;return a});b.data.start?a.add(d):a.reset(d)}):b.data.start||a.reset([])},dataType:"jsonp",jsonp:"json.wrf"})}});
duo.CommentView=Backbone.View.extend({id:"app",template:duo.templates.comment,events:{"click .vote-up":"upvote","click .vote-down":"downvote","click #post-comment":"reply","click .delete-comment":"deleteComment","click .delete-thread":"deleteThread","click .freeze-thread":"freezeThread","click .unfreeze-thread":"unfreezeThread","click .make-sticky":"stickThread","click .make-unsticky":"unstickThread","click .edit-comment":"editComment","click .update-comment":"updateComment","click .add-reply":"addReply",
"click .give-love":"giveLove","click #post-reply":"postReply","click .cancel-update-comment":"cancelUpdate","click #watch":"toggleWatch","click #post-text-box":"focusReplyBox","click #show-toggle":"showHiddenComments"},_DICT_HOST:"d2.duolingo.com/api/1/dictionary/hints",initialize:function(b){this.model.bind("change",this.render,this);this.has_hidden=!1;this.document_comment=b&&b.document_comment},render:function(){var b=this.model.get("title");'"'==b[0]&&'"'==b[b.length-1]&&(b=b.slice(1,-1));this.$(".modal").modal("hide");
var a=duo.user?{id:duo.user.id,avatar:duo.user.get("avatar"),username:duo.user.get("username"),admin:duo.user.get("admin"),mod:this.model.get("mod_user")}:null,c=duo.user?duo.user.get("ui_language"):duo.browser_language;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{different_ui:c!=this.model.get("topic").from_language_abbrev,got_related:this.model.has("related")&&0<this.model.get("related").length,num_followers:this.model.has("followers")?this.model.get("followers").length:
0,logged_in_user:a,show_badges:!0,num_hidden:this.model.get("num_hidden"),format_title:b,show_tts:this.model.get("show_tts"),show_date:!this.model.get("sentence_comment")||!this.model.get("old_comment"),document_comment:this.document_comment,rupees:duo.user&&0<duo.user.get("rupees")&&duo.user.get("id")!=this.model.get("user").id,delete_thread:duo.user&&duo.user.get("delete-permissions")||this.model.get("mod_user"),freeze_thread:duo.user&&duo.user.get("freeze-permissions")||this.model.get("mod_user"),
show_dropdown:this.model.get("mod_user")||this.model.get("admin_user")}),duo.templates,!0));(new duo.TrialOverlayView({el:this.$(".trial-account-overlay"),type:"comment"})).render();this.model.has("skill")&&(new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,this.model.get("skill"))),el:this.$("#comment-skill")})).render();this.model.get("comments").each(function(a){var b=new duo.NestedCommentView({model:a,el:this.$("#comment-"+a.id),sentence_comment:this.model.get("sentence_comment")});
a.get("hidden")&&(this.$("#comment-"+a.id).addClass("hidden-comment"),this.$("#comment-"+a.id).hide(),this.has_hidden=!0,this.num_hidden+=1);b.render()},this);!1==this.has_hidden&&this.$("#show-toggle").hide();var d=this.model.get("is_forward")?this.model.get("sentence_language"):this.model.get("translation_language"),f=this.model.get("is_forward")?this.model.get("sentence_id"):this.model.get("translation_id"),g=this;duo.user?_.defer(function(){g.$(".listen-button-small").tts({language:d,tts_type:"sentence",
tts_id:f,template:duo.templates.speaker,visible:!1,autoplay:!1,click:!0})}):this.$(".listen-button-small").css({opacity:0.3,cursor:"default"});_.defer(function(){g.$("label").inFieldLabels()});this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});this.model.get("sentence_comment")&&(this.model.get("is_forward")?this.$(".title").hints({url:this._DICT_HOST,templates:duo.templates,source_language:g.model.get("sentence_language"),target_language:g.model.get("translation_language"),top:20}):this.$(".trans").hints({url:this._DICT_HOST,
templates:duo.templates,source_language:g.model.get("translation_language"),target_language:g.model.get("sentence_language"),top:5}));this.options.comment_id&&_.defer(function(){g.scrollToComment(g.options.comment_id);g.options.comment_id=void 0});return this},reply:function(){var b=$.trim(this.$("#post-text-box").val());0<b.length&&(this.$("#post-text-box, #post-comment").attr("disabled","disabled"),this.$("#post-text-box").val(""),this.$(".save-message").fadeIn(250).delay(400).fadeOut(250),this.model.reply(b))},
focusReplyBox:function(){this.$("#post-button").show();this.$(".comment-box").autosize({append:"\n"})},upvote:function(b){this.model.voteUp();b.stopPropagation();return!1},downvote:function(b){this.model.voteDown();b.stopPropagation();return!1},deleteComment:function(b){if(confirm(translate_text("Delete this comment?")))return this.model.del(),duo.commentRouter.navigate("/topic/"+this.model.get("root").id,!0),!1},deleteThread:function(b){if(confirm("Delete this thread?"))return this.model.del(!0),
duo.commentRouter.navigate("/topic/"+this.model.get("root").id,!0),!1},freezeThread:function(b){$.post("/comments/"+this.model.id+"/freeze",{},function(a){window.location.reload()});return!1},unfreezeThread:function(b){$.post("/comments/"+this.model.id+"/unfreeze",{},function(a){window.location.reload()});return!1},stickThread:function(){$.post("/comments/"+this.model.id+"/stick",{},function(b){window.location.reload()});return!1},unstickThread:function(){$.post("/comments/"+this.model.id+"/unstick",
{},function(b){window.location.reload()});return!1},editComment:function(b){(new duo.PostModalView({el:this.$("#edit-modal"),edit:!0,type:this.model.get("question")?"question":"insight",model:this.model,all_topics:this.model.get("all_topics"),selected:this.model.get("topic").id,success:this.onPost})).render();this.$("#edit-modal").show();this.$(".page-main > .discussion-header").hide();this.$(".discussion-comments").hide();this.$(".discussion-main").hide();return!1},updateComment:function(b){b=$.trim(this.$(".comment-head .title-edit-box").val());
var a=$.trim(this.$("#main-post-edit").val());0<b.length?this.model.save({title:b,message:a}):alert("Title cannot be empty!")},cancelUpdate:function(){this.$("#post-text-box").val("");this.$("#post-text-box").animate({height:"45px"},500);this.$("#post-button").hide();return!1},giveLove:function(){if(!confirm(translate_text("You're about to give a lingot away! Are you sure you love this comment so much?")))return!1;this.model.giveLove();return!1},addReply:function(){this.$("#postreply-"+this.model.id).autosize({append:"\n"});
this.$("#reply-box-"+this.model.id).fadeToggle(400);this.$("#postreply-"+this.model.id).focus();return!1},postReply:function(b){b=$.trim(this.$("#postreply-"+this.model.id).val());0<b.length&&(this.$("#post-reply, #postreply-"+this.model.id).attr("disabled","disabled"),this.$("#postreply-"+this.model.id).val(""),this.model.reply(b))},onPost:function(){this.$(".modal").modal("hide")},toggleWatch:function(){this.model.get("watching")?(this.model.unwatch(),this.$("#watch").removeClass("success").removeClass("checkmark"),
this.$("#watch").attr("value",translate_text("Follow Discussion")),this.$("#watch").text(translate_text("Follow Discussion"))):(this.model.watch(),this.$("#watch").addClass("success"),this.$("#watch").attr("value",translate_text("Following Discussion")),this.$("#watch").text(translate_text("Following Discussion")),this.$("#watch").addClass("checkmark"))},showHiddenComments:function(b){var a=$(".discussion-comments-list > .hidden-comment").fadeIn(400);a.find(".hidden-comment").show();a.find(".show-toggle").hide();
this.$("#show-toggle").hide();b.stopPropagation();return!1},scrollToComment:function(b){0<$("#nested-comment-"+b).length&&$("html, body").animate({scrollTop:$("#nested-comment-"+b).offset().top-0.2*$(window).height()},500)}});
duo.CompactCommentView=duo.CommentView.extend({template:duo.templates["compact-comment"],events:{"click .vote-up":"upvote","click .vote-down":"downvote","click .reply":"reply","click .show-answer-input":"showAnswerInput","click .body .more":"moreMessage","click .nested-comment .more":"moreComment"},initialize:function(b){this.model.bind("change",this.render,this);this.experts=b.experts},render:function(){var b=duo.user?duo.user.get("ui_language"):duo.browser_language;$(this.el).html($.duostache(this.template,
_.extend(this.model.toJSON(),{show_badges:!0,front_page:!this.options.list_topic_id,different_ui:b!=this.model.get("topic").from_language_abbrev}),duo.templates));this.model.has("skill")&&(b=this.model.get("skill"),skill_view=new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,b)),size:"xxsmall",current_user:"points"in b}),this.$(".skill-"+b.id).append(skill_view.render().el));return this},reply:function(){var b=$.trim(this.$(".comment-reply-box").val());0<b.length&&this.model.reply(b)},
showAnswerInput:function(){this.$(".answer-input").show().find("textarea").focus();this.$(".show-answer-input").hide()},moreMessage:function(){this.$(".body").html(this.model.get("processed_message"))},moreComment:function(){this.$(".nested-body p").remove();this.$(".nested-body").append(this.model.get("best_comment").processed_message)}});
duo.NestedCommentView=duo.CommentView.extend({template:duo.templates["nested-comment"],events:{"click .vote-up":"upvote","click .vote-down":"downvote","click #post-comment":"reply","click .delete-comment":"deleteComment","click .undelete-comment":"undeleteComment","click .edit-comment":"editComment","click .update-comment":"updateComment","click .add-reply":"addReply","click .give-love":"giveLove","click .post-reply":"postReply","click .cancel-reply":"cancelReply","click .cancel-update-comment":"cancelUpdate",
"click #post-text-box":"focusReplyBox","click .edit-data":"dropDownEdit","hover #self-comment":"hoverNested","click .show-toggle":"showHiddenComments"},initialize:function(b){this.model.bind("change",this.rerender,this);this.sentence_comment=b.sentence_comment;this.model.bind("change:model_deleted",this.onDelete,this);this.model.bind("change:model_removed",this.onRemove,this);this.model.bind("change:model_undeleted",this.onUnDelete,this);this.has_hidden=!1},render:function(b){$(this.el).html($.duostache(this.template,
_.extend(this.model.toJSON(),{frozen:this.model.collection?this.model.collection.parent.get("frozen"):this.model.get("frozen"),show_badges:!0,sentence_comment:this.sentence_comment,session_comment:this.options.session_comment,show_date:!this.sentence_comment||!this.model.get("old_comment"),rupees:duo.user&&0<duo.user.get("rupees")&&duo.user.get("id")!=this.model.get("user").id,lazy_avatars:!b}),duo.templates));this.model.get("comments").each(function(a){(new duo.NestedCommentView({model:a,el:this.$("#comment-"+
a.id),sentence_comment:this.sentence_comment,session_comment:this.options.session_comment})).render(b);a.get("hidden")&&(this.$("#comment-"+a.id).addClass("hidden-comment"),this.$("#comment-"+a.id).hide(),this.has_hidden=!0,this.num_hidden+=1)},this);!1==this.has_hidden&&this.$("#show-toggle-"+this.model.id).hide();var a={threshold:150,container:this.options.session_comment?$("#discussion-modal"):void 0};this.$("img.lazy").lazyload(a);var c=this;_.defer(function(){c.$("img.lazy").slice(0,1).lazyload(a);
c.$('[data-toggle="tooltip"]').tooltip()});return this},rerender:function(){this.render(!0)},deleteComment:function(b){this.$("#edit-data-drop-"+this.model.id).hide();if(!confirm(translate_text("Delete this comment?")))return!1;this.model.del();b.stopPropagation();return!1},undeleteComment:function(b){if(confirm("Undelete this comment?"))return this.model.undel(),!1},onDelete:function(){if(this.model.get("model_deleted")){var b=this.model.collection;void 0!==b&&(b.remove(this.model),b.parent.set({num_comments:b.parent.get("num_comments")-
1}))}},onRemove:function(){if(this.model.get("model_removed")){var b=this.model.collection;void 0!==b&&(this.model.set("model_removed",!1),b.parent.set({num_comments:b.parent.get("num_comments")-1},{silent:!0}))}},onUnDelete:function(){if(this.model.get("model_undeleted")){var b=this.model.collection;this.model.set("model_undeleted",!1);b.parent.set({num_comments:b.parent.get("num_comments")+1},{silent:!0})}},editComment:function(b){this.$("#edit-data-"+this.model.id).hide();this.$("#edit-data-drop-"+
this.model.id).hide();this.$("#body-"+this.model.id).hide();this.$(".title-edit-box, #edit-box-"+this.model.id).show();this.$(".edit-post-box textarea").val(this.model.get("message"));this.$("#edit-box-"+this.model.id+" textarea").focus();b.stopPropagation();return!1},updateComment:function(b){var a=$.trim(this.$(".post-edit-box").val());this.model.save({message:a});b.stopPropagation();return!1},cancelUpdate:function(b){this.render();b.stopPropagation();return!1},dropDownEdit:function(b){this.$("#edit-data-"+
this.model.id).addClass("active");this.$("#edit-data-drop-"+this.model.id).fadeToggle(100);var a=this;$(document).one("click.event",function(){a.$("#edit-data-drop-"+a.model.id).fadeOut(100)});b.stopPropagation();return!1},cancelReply:function(b){this.$("#reply-box-"+this.model.id).fadeToggle(400);b.stopPropagation();return!1},hoverNested:function(b){this.$("#edit-data-"+this.model.id).fadeToggle(100);this.$("#edit-data-drop-"+this.model.id).fadeOut(100);b.stopPropagation();return!1},showHiddenComments:function(b){this.$(".hidden-comment").fadeIn(400);
this.$(".show-toggle").hide();b.stopPropagation();return!1}});
duo.CommentListView=Backbone.View.extend({template:duo.templates["comment-list"],events:{"click #load-more-comments":"onClickLoad"},initialize:function(b){this.collection=b.collection;this.collection.bind("add",this.render,this);this.collection.bind("change",this.render,this);this.collection.bind("reset",this.render,this);this.buttons=void 0!=b.buttons?b.buttons:!0;this.infinite_scrolling=b.infinite_scrolling;this.topic_id=b.topic_id;this.topic_name=b.topic_name;this.experts=b.experts},render:function(){$(this.el).html($.duostache(this.template,
{comments:this.collection.toJSON(),more:this.collection.more,buttons:this.buttons,topic_id:this.topic_id,topic_name:this.topic_name,infinite_scrolling:this.infinite_scrolling,experts:this.experts,has_subscriptions:this.options.has_subscriptions,followed_tab:"following"==this.collection.sort_by},duo.templates));var b=this;this.collection.each(function(a){(new duo.CompactCommentView({model:a,el:b.$("#comment-"+a.id),experts:b.experts?b.experts:b.collection.experts,list_topic_id:b.topic_id})).render()});
this.$("textarea").characterLimit(65E3);this.$('a.topic-label[data-topic="'+this.topic_id+'"]').remove();_.defer(function(){b.$("label").inFieldLabels()});return this},onClickLoad:function(){this.loadMoreComments()},loadMoreComments:function(b){b=b||{};b=_.extend(b,{page:this.collection.page+1});this.collection.fetch({data:b,update:!0,remove:!1})}});
duo.TopicSearchView=Backbone.View.extend({template:duo.templates["community-search"],events:{"click #load-more-comments":"loadMoreComments"},initialize:function(b){this.collection=b.collection;this.collection.bind("reset",this.onReset,this);this.collection.bind("add",this.render,this)},render:function(){$(this.el).html($.duostache(this.template,{comments:this.collection.toJSON(),results_count:this.collection.num_results,has_more:this.collection.length<this.collection.num_results},duo.templates));
return this},loadMoreComments:function(){this.collection.fetch()},onReset:function(){this.last_request_length=0;this.render()}});
duo.TopicView=Backbone.View.extend({id:"app",template:duo.templates.topic,events:{"click #ask-question":"toggleQuestion","click .follow":"toggleFollow","click .comment-main .tabs li":"switchTab","click .nav-tabs li":"switchTab","click .clear-button":"clearSearch","keyup #search-comments":"keyCheckSearch","click .manage-subscriptions":"manageSubscriptions"},initialize:function(){this.throttledSearch=_.debounce(this.throttledSearch,500);this.model.bind("change",this.render,this);this.last_request_length=
0;this.user_subscriptions=this.model.get("subscriptions");_.bindAll(this,"onPost");Backbone.history.once("route",this.cleanup,this)},render:function(){var b=duo.user?duo.user.get("ui_language"):duo.browser_language,a=!1,c=duo.user&&!duo.user.get("trial_account");_.each(this.model.get(c?"subscriptions":"subtopics"),function(b,c){b.active=b.topic_id===this.model.id||b.id===this.model.id;b.type=!b.language_abbrev?b.name.toLowerCase():null;b.main="Duolingo"==b.name;b.trouble="Troubleshooting"==b.name;
a=b.topic_id==this.model.get("troubleshooting_id")||a;b.flag_abbrev=b.from_language_abbrev},this);$(this.el).html($.duostache(this.template,_.extend({},this.model.toJSON(),{show_subscriptions:c,main_topic:"Duolingo"==this.model.get("name")||"Troubleshooting"==this.model.get("name")||"Incubator"==this.model.get("name"),duo_topic:"Duolingo"==this.model.get("name"),trouble_topic:"Troubleshooting"==this.model.get("name"),show_active:(this.model.get("admin_user")||this.model.get("mod_user"))&&this.model.get("id"),
front_page:!this.model.get("id"),hide_troubleshoot:a,troubleshoot_ui:b}),duo.templates));b=0<this.model.get("subscriptions").length;this.hot_comments=new duo.CommentListView({el:this.$("#hot-tab"),collection:this.model.get("comments"),buttons:!1,infinite_scrolling:!0,topic_id:this.model.id,sort:"hot",experts:this.model.get("experts"),has_subscriptions:b});this.hot_comments.render();this.new_comments=new duo.CommentListView({el:this.$("#new-tab"),collection:this.model.get("new_comments"),infinite_scrolling:!0,
experts:this.model.get("experts"),topic_id:this.model.id,has_subscriptions:b});this.top_comments=new duo.CommentListView({el:this.$("#top-tab"),collection:this.model.get("top_comments"),infinite_scrolling:!0,experts:this.model.get("experts"),topic_id:this.model.id});this.sent_comments=new duo.CommentListView({el:this.$("#sent-tab"),collection:this.model.get("sent_comments"),infinite_scrolling:!0,experts:this.model.get("experts"),topic_id:this.model.id});this.active_comments=new duo.CommentListView({el:this.$("#active-tab"),
collection:this.model.get("active_comments"),infinite_scrolling:!0,experts:this.model.get("experts"),topic_id:this.model.id});this.following_comments=new duo.CommentListView({el:this.$("#following-tab"),collection:this.model.get("following_comments"),infinite_scrolling:!0,topic_id:this.model.id});this.search_collection||(this.search_collection=new duo.SearchResults,this.search_view=new duo.TopicSearchView({collection:this.search_collection,el:this.$(".comment-search")}),this.search_collection.bind("all",
this.toggleSearchView,this));b=window.location.href;b=b.substr(b.lastIndexOf("/")+1);-1<"top hot new active sent following".split(" ").indexOf(b)&&duo.user&&this.changeSort(b);this.model.has("user_skill")&&(new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(this,this.model.get("user_skill"))),el:this.$("#comment-skill")})).render();(new duo.PostModalView({el:this.$("#question-fields"),type:"question",edit:!1,success:this.onPost,model:this.model})).render();this.topic_subscriptions=
new duo.TopicSubscriptionModal({el:this.$("#topic-subscriptions"),parent_view:this});this.topic_subscriptions.render();this.$("textarea").characterLimit(65E3);var d=this;this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});this.$("#topic-subscriptions").bind("hide",function(){d.user_subscriptions!=d.model.get("subscriptions")&&d.model.fetch({data:{},success:function(){d.render()}})});_.defer(function(){d.$("label").inFieldLabels()});$(document).unbind(".topic_scroll").bind("scroll.topic_scroll.infinite_scroll",
function(a){a=$(document).height()-$(document).scrollTop();var b=$(window).height();a<1.5*b&&(a=d.hot_comments,"top"==d.current_panel?a=d.top_comments:"new"==d.current_panel?a=d.new_comments:"sent"==d.current_panel?a=d.sent_comments:"active"==d.current_panel?a=d.active_comments:"following"==d.current_panel&&(a=d.following_comments),!1!=a.collection.more&&(d.search_on&&(a=d.search_view),void 0===a.last_request_length&&(a.last_request_length=0),a.collection.length>a.last_request_length&&(a.last_request_length=
a.collection.length,a.loadMoreComments({topic_id:d.model.id,per_page:10,limits:a.collection.limits}))))});$(this).fixedSidebar();return this},toggleFollow:function(){this.model.get("is_following")?this.model.unfollow():this.model.follow()},toggleQuestion:function(){this.$("#question-fields").show();this.$(".comment-rankings").hide();this.$(".topic-header").hide()},onPost:function(b){var a=parseInt(b.get("topic_id"));0<=_.indexOf(this.model.get("included_topics"),a)&&this.model.get("new_comments").length&&
this.model.get("new_comments").add(b,{at:0});this.$(".modal").modal("hide");duo.commentRouter.navigate("/comment/"+b.get("id"),!0)},keyCheckSearch:function(b){b=$.trim(this.$("#search-comments").val());this.throttledSearch(b);b.length?this.$(".clear-button").show():this.$(".clear-button").hide()},toggleSearchView:function(){""!=this.$("#search-comments").val()?(this.$(".comment-search").show(),this.$(".comment-main").hide(),this.search_on=!0):(this.$(".comment-search").hide(),this.$(".comment-main").show(),
this.search_on=!1)},throttledSearch:function(b){duo.track("Questions Search");null==this.model.get("id")?this.search_collection.fq="":this.search_collection.fq=duo.user?"-(learning_language:* AND -learning_language:"+this.model.get("learning_language")+") AND from_language:"+this.model.get("from_language"):"from_language:"+this.model.get("from_language");this.search_collection.q=b;this.search_collection.reset([]);this.search_collection.fetch()},typeSelect:function(){var b=this.$menu.find(".active").data("id");
this.$menu.remove();duo.commentRouter.navigate("/comment/"+b,!0)},changeLanguage:function(){this.model.fetch()},cleanup:function(){duo.topbar.unbind("navigate",this.cleanUp,this);$(document).unbind(".topic_scroll");duo.user&&duo.user.unbind("change:learning_language",this.changeLanguage,this)},switchTab:function(b){b=$(b.currentTarget).data("tab");if(b==this.current_panel)return!1;this.$(".panel").fadeOut("fast");this.changeSort(b);duo.commentRouter.navigate("/topic/"+(!duo.user||this.model.id?this.model.id:
"subscriptions")+"/"+b,!1)},changeSort:function(b){var a=$("#"+b),c=this.$("#"+b+"-tab");this.$(".panel").hide();c.fadeIn("fast");this.$(".comment-main .tabs li").removeClass("active");this.$(".nav-tabs li").removeClass("active");a.addClass("active");this.current_panel=b;var d=this;"hot"!==b&&0===this.model.get(b+"_comments").length?this.model.get(b+"_comments").fetch({data:{topic_id:this.model.id},success:function(){d[b+"_comments"].render()}}):this[b+"_comments"].render()},clearSearch:function(){this.$("#search-comments").val("").keyup().blur()},
manageSubscriptions:function(){var b=this;$.get("/api/1/topics/list",{},function(a){b.topic_subscriptions.topics=a;b.topic_subscriptions.render();b.$("#subscription-modal").modal("show")})}});duo.GroupTopicView=duo.TopicView.extend({id:"discussion-container",template:duo.templates["group-discussion"]});
duo.TopicSubscriptionModal=Backbone.View.extend({template:duo.templates["topic-subscription-modal"],events:{"click .toggle-subscription":"toggleSubscription"},initialize:function(b){this.topics=void 0},render:function(){_.each(this.topics,function(b,a){b.type=!b.language_abbrev?b.name.toLowerCase():null;b.main="Duolingo"==b.name;b.trouble="Troubleshooting"==b.name;b.flag_abbrev=b.from_language_abbrev},this);$(this.el).html($.duostache(this.template,{topics:this.topics},duo.templates));return this},
toggleSubscription:function(b){var a=this,c=$(b.currentTarget);b=c.data("id");var d=c.hasClass("subscribed");$.post("/api/1/topics/"+b+"/topic_"+(d?"unsubscribe":"subscribe"),function(b){"FAILURE"==b.response?console.log("unable to update subscriptions"):(a.options.parent_view.model.set({subscriptions:b.subscriptions},{silent:!0}),b=d?c.data("subscribe"):c.data("unsubscribe"),c.text(b),c.toggleClass("btn-outline btn-standard subscribed btn-green checkmark"))})}});
duo.PostModalView=Backbone.View.extend({template:duo.templates["post-modal"],events:{"click .submit-post":"submitPost","keyup .skill-list":"onTopic","change .skill-list":"onTopic","click .cancel-post":"cancelPost","click .category-option":"changeCategory","keyup #question-title":"showError","blur #question-title":"hideError"},initialize:function(b){this.type=b.type;this.edit=b.edit;this.success=b.success},render:function(){var b={edit:this.edit,subscriptions:this.model.get("subscriptions"),all_topics:this.model.get("all_topics"),
type:this.type,id:this.model.id,name:this.model.get("name"),show_subscriptions:null===this.model.id||this.model.get("subscribed")};b[this.type]=!0;$(this.el).html($.duostache(this.template,b,duo.templates));if(b=this.edit?this.model.get("topic").id:this.model.id){var b=this.$('.skill-list [data-topic="'+b+'"]'),a=b.data("name");this.$(".skill-list").val(b.attr("value"));this.$("#category").attr("data-id",b.data("topic"));a&&(this.$(".topic").text(translate_text(a)),this.$("#category").text(translate_text("Topic:")+
" "+b.data("name")))}this.edit&&(this.$(".post-field").text(this.model.get("message")),this.$(".title-field").text(this.model.get("title")));_.defer(_.bind(function(){this.$("label").inFieldLabels()},this));return this},submitPost:function(){var b=$.trim(this.$(".title-field").val()),a=$.trim(this.$(".post-field").val()),c=this.$("#category").data("id");this.$(".skill-list").val();0===b.length||!c&&!this.edit?(this.$(".list-discussion-errors").show(),0===b.length&&this.$(".no-title").show(),c||this.$(".no-topic").show()):
(this.$("input, textarea, .submit-post").attr("disabled","disabled"),this.edit?(c||(c=this.selected),this.model.save({title:b,message:a,topic_id:c},{success:this.success})):(b=new duo.Comment({title:b,message:a,type:this.type}),b.set({topic_id:String(c)}),b.save(null,{success:this.success}),duo.track("Questions Post",{type:this.type}),this.$("#posted-label").show().delay(3E3).fadeOut(1E3),this.render()))},onTopic:function(){var b=this.$(".skill-list").val(),b=this.$('.skill-list [value="'+b+'"]').data("name");
this.$(".topic").text(translate_text(b))},cancelPost:function(){$(".comment-rankings").show();$(".page-main > .discussion-header").show();$(".discussion-main").show();$(".discussion-comments").show();$(".discussion-main").show();this.$el.hide()},changeCategory:function(b){var a=$(b.currentTarget).data("name");this.$("#category").text(translate_text("Topic:")+" "+a);this.$("#category").attr("data-id",$(b.currentTarget).data("topic"));this.hideError()},showError:function(){100==this.$(".title-field").val().length?
this.$(".max-error").fadeIn():this.hideError()},hideError:function(){this.$(".max-error").fadeOut();this.$(".list-discussion-errors").hide()}});
duo.CommentModalView=Backbone.View.extend({template:duo.templates["discussion-page"],_DICT_HOST:"d2.duolingo.com/api/1/dictionary/hints",events:{"click #post-text-box":"focusReplyBox","click .cancel-update-comment":"cancelUpdate","click #post-comment":"reply","click #show-discussion":"showDiscussion","click #watch":"toggleWatch","click #show-toggle":"showHiddenComments","click .close-modal-background":"closeModal"},initialize:function(b){this.model.bind("change",this.onChange,this);this.correct=b.correct;
this.modal_shown=!0;this.has_hidden=!1;this.ui_language=b.ui_language;this.learning_language=b.learning_language;this.document_sentence_discussion=b.document_sentence_discussion||!1;Backbone.history.once("route",this.cleanUp,this)},render:function(){var b=this;if(duo.feature_flags.serialized_sentence_discussions?this.model.get("has_comment"):this.model.get("comment")){this.view=new duo.CommentView({model:this.model.get("comment"),el:this.$("discussion-modal")});$(this.el).html($.duostache(this.template,
_.extend(this.model.toJSON(),{correct:this.correct,comments:this.model.get("comment").get("comments").toJSON(),frozen:this.model.get("comment").get("frozen"),got_related:this.model.has("related")&&0<this.model.get("related").length,num_followers:this.model.has("followers")?this.model.get("followers").length:0,logged_in_user:duo.user?{id:duo.user.id,username:duo.user.get("username"),avatar:duo.user.get("avatar")}:null,num_comments:this.model.get("comment").get("num_comments"),num_hidden:this.model.get("comment").get("num_hidden"),
show_badges:!0,sentence_comment:!0,show_date:!this.model.get("old_comment"),admin_user:duo.user?duo.user.get("admin"):!1,following:this.model.get("comment").get("watching")}),duo.templates,!0));this.model.get("comment").get("comments").each(function(a){var b=new duo.NestedCommentView({model:a,el:this.$("#comment-"+a.id),sentence_comment:!0,session_comment:!0});a.get("hidden")&&(this.$("#comment-"+a.id).addClass("hidden-comment"),this.$("#comment-"+a.id).hide(),this.has_hidden=!0,this.num_hidden+=
1);b.render()},this);!1==this.has_hidden&&this.$("#show-toggle").hide();var a=this.model.get("comment").get("watching")?translate_text("Following Discussion"):translate_text("Follow Discussion");this.model.get("comment").get("watching")&&this.$("#watch").addClass("success");this.$("#watch").attr("value",a);this.model.get("comment").unbind();this.model.get("comment").bind("change",this.onChange,this)}else $(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{correct:this.correct,
logged_in_user:duo.user?{id:duo.user.id,username:duo.user.get("username"),avatar:duo.user.get("avatar")}:null,show_badges:!0,disable_commenting:duo.prebeta_experimental_mode,comment:!1}),duo.templates,!0));this.document_sentence_discussion||0<this.$("#discussion-modal").size()?this.$("#discussion-modal").modal("show"):this.$("#discussion-modal").modal({show:this.modal_shown}).on("hidden",function(){b.modal_shown=!1}).delegate(".medium-circular-avatar, .username","click",function(a){$(this).closest(".modal").modal("hide")});
_.defer(function(){b.$("label").inFieldLabels();setTimeout(function(){b.$("#discussion-modal").scrollTop(0);b.$("#discussion-modal").trigger("scroll")},250)});var c=this.learning_language;if(this.model.get("sentence_language")==this.learning_language){this.$(".title").hints({url:this._DICT_HOST,templates:duo.templates,source_language:this.learning_language,target_language:this.ui_language,top:20});var d=this.model.get("sentence_id")}else this.$(".trans").hints({url:this._DICT_HOST,templates:duo.templates,
source_language:this.learning_language,target_language:this.ui_language,top:10}),d=this.model.get("translation_id");_.defer(function(){b.$(".listen-button-small").tts({language:c,tts_type:"sentence",tts_id:d,template:duo.templates.speaker,visible:!1,autoplay:!1,click:!0})});return this},focusReplyBox:function(){this.$(".comment-box").autosize({append:"\n"});this.$("#post-button").show();this.document_sentence_discussion||this.$(".player-discuss-guide").fadeIn(500)},reply:function(){var b=$.trim(this.$("#post-text-box").val());
0<b.length&&(this.$("#post, #post-comment").attr("disabled","disabled"),this.model.get("comment")&&this.model.get("comment").unbind(),this.model.addComment(b,this.ui_language,this.learning_language))},cancelUpdate:function(){this.$("#post-button").hide();this.$("#post-text-box").val("");this.$(".player-discuss-guide").fadeOut(500);return!1},showDiscussion:function(){this.$("#discussion-modal").modal("show");this.modal_shown=!0},onChange:function(){this.$("#discussion-modal").modal("hide");this.modal_shown=
!0;this.render()},toggleWatch:function(){this.model.get("comment").get("watching")?(this.model.get("comment").unwatch(),this.$("#watch").removeClass("success").removeClass("checkmark"),this.$("#watch").attr("value",translate_text("Follow Discussion")),this.$("#watch").text(translate_text("Follow Discussion"))):(this.model.get("comment").watch(),this.$("#watch").addClass("success"),this.$("#watch").attr("value",translate_text("Following Discussion")),this.$("#watch").text(translate_text("Following Discussion")),
this.$("#watch").addClass("checkmark"))},cleanUp:function(){duo.topbar.unbind("navigate",this.cleanUp,this);this.$("#discussion-modal").modal("hide");this.remove()},showHiddenComments:function(b){var a=$(".discussion-comments-list > .hidden-comment").fadeIn(400);a.find(".hidden-comment").show();a.find(".show-toggle").hide();this.$("#show-toggle").hide();b.stopPropagation();return!1},closeModal:function(){this.$("#close-discussion-modal").click()}});duo.Translation=duo.Model.extend({});
duo.setTranslationPreference=function(b,a){$.post("/translations/set_translation_preference",{preference_name:b,preference_value:a})};
duo.TranslationsOverview=duo.Model.extend({url:"/translations",parse:function(b){if(b.translations){var a={source_lang:b.language,target_lang:b.target_language};this.self_service&&(a.self_service=!0);var c=new duo.RankedTranslationList([],a);c.reset(duo.RankedTranslationList.prototype.parse.call(c,b.translations));c.page=1;c.sort=b.sort;c.category=b.category;c.more=b.more;a=_.extend(a,{more:!0});this.self_service?(b.translations=c,b.monthly_translations=new duo.RankedTranslationList([],_.extend(a,
{sort:"uploaded"})),b.uploaded_translations=new duo.RankedTranslationList([],_.extend(a,{sort:"uploaded"}))):_.each(["default","date","net_upvotes","history","uploaded"],function(d){b[d+"_translations"]=d==b.sort?c:new duo.RankedTranslationList([],_.extend(a,{sort:d}))})}return b},fetch:function(b){b.data.per_page=50;this.self_service&&(b.data.self_service=!0);var a=(new Date).getTime(),c=b.success;b.success=function(b,f){var g={latency_ms:(new Date).getTime()-a,backend_latency_ms:f.backend_latency_ms,
overview:!0};duo.track("fetch_ranked_translations",g);c&&c(b,f)};Backbone.Model.prototype.fetch.call(this,b)}});
duo.RankedTranslationList=Backbone.Collection.extend({url:"/ranked_translations",model:duo.Translation,initialize:function(b,a){a&&(this.sort=a.sort||"default",this.self_service=!!a.self_service,this.more=a.more||!0,this.source_lang=a.source_lang,this.target_lang=a.target_lang)},fetch:function(b){b=b||{};b.data=b.data||{};b.data.sort=this.sort;b.data.source_lang=this.source_lang;b.data.target_lang=this.target_lang;this.self_service&&(b.data.self_service=!0);b.data.per_page||(b.data.per_page=50);var a=
(new Date).getTime(),c=b.success;b.success=function(b,f){var g={latency_ms:(new Date).getTime()-a,backend_latency_ms:f.backend_latency_ms};duo.track("fetch_ranked_translations",g);c&&c(b,f)};Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){this.encoded_iterator_state=b.encoded_iterator_state;this.page=b.page;this.more=b.more;return _.map(b.data,function(a){return duo.Translation.prototype.parse.call(this,a)})}});
duo.WikiTranslation=duo.Model.extend({urlRoot:"/wiki_translations",parse:function(b){for(var a=0;a<b.document_paragraphs.length;a++)b.document_paragraphs[a]=new duo.WikiDocumentParagraph(b.document_paragraphs[a],{parse:!0});return b},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);return JSON.parse(JSON.stringify(b))},forEachSentence:function(b){for(var a=this.get("document_paragraphs"),c=0;c<a.length;c++)for(var d=a[c].get("sentences"),f=0;f<d.length;f++)b(d[f])},reportUserFinishedTranslation:function(b){if(!this.get("user_finished_translation")){var a=
"/wiki_translation/"+this.get("translation_id")+"/user_finished_translation",c=this;$.post(a,{},function(a){c.set("user_finished_translation",!0);b(a);0<a.num_points_awarded&&duo.track("user_finished_wiki_translation",{translation_id:c.get("translation_id")})})}},addTranslator:function(){for(var b=duo.user.id,a=this.get("translators"),c=0;c<a.length;c++)if(a[c].user_id==b)return;a.push({user_id:b,username:duo.user.get("username")});this.set("num_translators",1+this.get("num_translators"))},fetch:function(b){duo.user&&
(b.data.ui_language=duo.user.get("ui_language"));Backbone.Model.prototype.fetch.call(this,b)},mixpanelProperties:function(){var b=this.get("source_language")==duo.user.get("learning_language")&&this.get("target_language")==duo.user.get("ui_language");return _.extend(this.multiGet(["from_skill_id","from_skill_name"]),{view_both:!!this.get("view_both"),lesson_mode:!!this.get("lesson_mode"),sponsored:this.get("paid_translation"),document_title:this.get("title"),is_trusted_translator:this.get("is_trusted_translator"),
is_forward_direction:b})}});duo.WikiDocumentParagraph=duo.Model.extend({parse:function(b){for(var a=0;a<b.sentences.length;a++)b.sentences[a]=new duo.WikiDocumentSentence(b.sentences[a],{parse:!0});return b}});duo.CurrentWikiTranslation=duo.Model.extend({url:function(){var b=duo.browser_language;duo.user&&(b=duo.user.get("ui_language"));return"/wiki_translations/"+this.get("id")+"/"+b+"/cur_translation"}});
duo.WikiDocumentSentence=duo.Model.extend({addRevision:function(b,a,c,d,f,g){this.addRevisionOrSuggestEdit(b,a,c,d,!1,f,g)},suggestEdit:function(b,a,c,d){this.addRevisionOrSuggestEdit(b,a,!1,!1,!0,c,d)},addRevisionOrSuggestEdit:function(b,a,c,d,f,g,h){var k=this,l="/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id")+"/add_revision",m={translation:b,is_revert:c,is_edit_suggestion:f,share_credit:d};a&&(m.explanation=a);var n=(new Date).getTime();$.post(l,m,function(l){var m=
(new Date).getTime()-n;k.set(l);f&&k.set("edit_suggestion_text",b);duo.user.incrementSkillPoints(l.num_points_awarded);g(l);var s=l.first_translation?"submit_wiki_translation":"edit_wiki_translation",m={source_language:k.get("source_language"),target_language:k.get("target_language"),translation_id:k.get("translation_id"),document_sentence_id:k.get("document_sentence_id"),is_revert:c,is_edit_suggestion:f,cur_translation_quality:k.get("cur_translation_quality"),has_comment:!!a,sentence_num_words:k.get("num_words"),
latency_ms:m,backend_latency_ms:l.backend_latency_ms};l.first_translation||(m.share_credit=d);k.get("machine_translation")&&(l=duo.getEditDistance(b,k.get("machine_translation")),m.duobot_edit_distance=l);h&&(m=_.extend(m,h));duo.track(s,m)})},imageContainsNoText:function(b){var a="/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id")+"/add_revision",c=this;$.post(a,{image_contains_no_text:!0},function(a){c.set(a);b(a.num_points_awarded,a.level_event)})},rateCurrentTranslation:function(b,
a,c,d){var f=this,g="/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id")+"/"+this.get("cur_sent_trans_id")+"/rate",h=(new Date).getTime();$.post(g,{rating:b,undo:a},function(g){var l=(new Date).getTime()-h,m=a?0:b;f.set({user_approved:1==m,user_disapproved:-1==m,user_rating:m,num_upvotes:g.num_upvotes,num_downvotes:g.num_downvotes});duo.user.incrementSkillPoints(g.num_points_awarded);c(g);m=a?"undo_approve_wiki_translation":"approve_wiki_translation";g={rating:b,
source_language:f.get("source_language"),target_language:f.get("target_language"),translation_id:f.get("translation_id"),document_sentence_id:f.get("document_sentence_id"),cur_translation_quality:f.get("cur_translation_quality"),sentence_num_words:f.get("num_words"),latency_ms:l,backend_latency_ms:g.backend_latency_ms};d&&(g=_.extend(g,d));duo.track(m,g)})},update:function(b){var a="/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id")+"/get_sentence",c=this;
$.post(a,{},function(a){c.set(a);b&&b()})},numCharacters:function(){for(var b=0,a=this.get("sentence_hunks"),c=0;c<a.length;c++)b+=a[c].hunk.length;return b},reportTranslatorCheating:function(b,a,c){var d=this;$.post("/wiki_translations/report_translator_cheating/"+b,{translation_id:this.get("translation_id"),undo:a},function(f){d.get("user_id")==b&&d.set("reported_cheating",!a);if(c){f=c.get("revisions");for(var g=0;g<f.length;g++)f[g].get("user_id")==b&&f[g].set("reported_cheating",!a)}a||duo.track("wiki_translation_report_abuse")})}});
duo.WikiDocumentSentenceRevisionHistory=Backbone.Model.extend({url:function(){return"/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id")+"/get_revisions"},parse:function(b){for(var a=0;a<b.revisions.length;a++)b.revisions[a]=new duo.WikiDocumentSentenceRevision(b.revisions[a]);return b},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);return JSON.parse(JSON.stringify(b))},follow:function(b){this.followOrUnfollow(b,!0)},unfollow:function(b){this.followOrUnfollow(b,
!1)},followOrUnfollow:function(b,a){var c=this,d="/wiki_translation_sentence/"+this.get("translation_id")+"/"+this.get("document_sentence_id");$.post(a?d+"/follow":d+"/unfollow",{},function(d){b(d.success);d.success?c.set("following",a):alert("Back-end failed.  Please try again later.")})},fetch:function(b){b=b||{};var a=(new Date).getTime(),c=b.success;b.success=function(b,f){var g={latency_ms:(new Date).getTime()-a,backend_latency_ms:f.backend_latency_ms};duo.track("fetch_sentence_revision_history",
g);c&&c(b,f)};Backbone.Model.prototype.fetch.call(this,b)},addRevision:function(b){this.get("revisions").splice(0,0,b);this._recomputeIndices()},removeLastRevision:function(){var b=this.get("revisions");0!=b.length&&(b.pop(),this._recomputeIndices())},_recomputeIndices:function(){var b=this.get("revisions");this.set({num_revisions:b.length,multiple_revisions:1<b.length});for(var a=0;a<b.length;a++)b[a].set("index",a)}});duo.WikiDocumentSentenceRevision=duo.Model.extend({});
duo.WikiTranslationStrengthenedWords=duo.Model.extend({update:function(b){if(b){var a=this.get("strengthened_lexemes");a||(a=[]);surface_forms={};for(var c=0;c<a.length;c++)surface_forms[a[c].surface_form]=!0;for(c=0;c<b.length;c++)b[c].surface_form in surface_forms||a.push(b[c]);this.set({strengthened_lexemes:a,num_strengthened_lexemes:a.length})}}});
duo.YourTranslationVotes=duo.Model.extend({url:function(){return"/your_translation_votes/"+this.get("source_lang")+"/"+this.get("target_lang")},fetch:function(b){var a=(new Date).getTime(),c=b.success;b.success=function(b,f){var g={latency_ms:(new Date).getTime()-a,backend_latency_ms:f.backend_latency_ms};duo.track("show_translation_votes",g);c&&c(b,f)};Backbone.Model.prototype.fetch.call(this,b)}});
(function(b){duo.RedditTranslationsView=duo.View.extend({id:"app",template:duo.templates["translations-ranked"],events:{"click .translate-main .tabs li":"switchTab","click #upload-document":"uploadDocument","change #sort-list":"switchSorting","change input[type=checkbox]":"changeFiltering","change #select-translation-direction":"changeTranslationDirection","click #explain-translator-tiers":"showTiersModal","click #learn-more":"showTiersModal","click #dismiss-tier-explanation":"hideTiersModal","click #show-upvotes":"showVotesModal",
"click #show-downvotes":"showVotesModal","click #dismiss-votes-modal":"hideVotesModal","click .modal .close":"hideModals","click .dismiss-intro-owl":"dismissIntroOwl","keyup #search-translations":"keyCheckSearch","click .clear-button":"clearSearch","click .toggle-sidebar-item":"toggleSidebarItem"},initialize:function(){this.listenTo(this.model,"change",this.render);Backbone.history.once("route",this.close,this);this.panel_name=this.model.get("sort");this.throttledSearch=_.debounce(this.refetch,500);
this.model.get("show_intro_owl")&&duo.track("show_immersion_intro_owl")},onClose:function(){this.hideModals()},render:function(){this.closeChildViews();var a=_.extend(this.model.toJSON(),{logged_in:!!duo.user,trial_account:duo.user&&duo.user.get("trial_account")});this.$el.html(b.duostache(this.template,a,duo.templates));a=[];this.model.get("show_tier_sentence_length_notification")&&a.push("immersion_tier_points_depend_on_sentence_length");this.model.get("show_tier_percent_positive_notification")&&
a.push("immersion_tier_percent_positive");a=["default","date","net_upvotes","history"];1==this.$("#uploaded-tab").size()&&a.push("uploaded");for(var c=0;c<a.length;c++){var d=a[c],f=new duo.RankedTranslationsView({el:this.$("#"+d+"-tab"),collection:this.model.get(d+"_translations"),sort:d,parent_view:this});d==this.panel_name&&f.render();this.addChildView(f)}this.updateAllCheckbox();this.$("#"+this.panel_name+"-tab").removeClass("hidden");return this},switchTab:function(a){a=b(a.currentTarget);var c=
a.data("tab");"all"==c&&(c=this.saved_sort_val?this.saved_sort_val:this.$("#sort-list").val());var d=this.$("#"+c+"-tab");this.$(".panel").hide();d.show();a.data("tab")&&(this.$(".translate-main .tabs li").removeClass("active"),a.addClass("active"));"history"==c||"uploaded"==c?(this.disableSorting(),this.disableCheckBoxes(),this.disableSearchBar()):(this.reenableSorting(),this.reenableCheckBoxes(),this.reenableSearchBar());this.panel_name=c;this.refetch()},switchSorting:function(){var a=this.$("#sort-list").val(),
c=this.$("#"+a+"-tab");this.$(".panel").hide();c.show();this.panel_name=a;this.refetch();duo.user&&b.post("/translations/set_preferred_sorting_rule",{rule:a})},uploadDocument:function(){this.$("#paid-translation-upload").hide();this.upload||(this.upload=new duo.TranslationUploadView({model:new Backbone.Model}),this.upload.render());this.$("#translation-tabs").hide();this.$("#translation-upload").show();this.$("#upload-url").focus()},selectedPanelName:function(){var a=this.$(".translate-main .tabs li.active").data("tab");
return"history"==a||"uploaded"==a?a:this.$("#sort-list").val()},changeFiltering:function(a){var c=this.selectedPanelName(),d=b(a.currentTarget).closest("ul").attr("id"),f=b(a.currentTarget).attr("value"),g=b(a.currentTarget).is(":checked"),h={document_type:f,preferred:g};if("categories"==d)if("all"==f)if(g)this.$(".category-checkbox").prop("checked",!1),b.post("/translations/set_preference_all_document_categories",{preference:!0});else return this.$("#all-categories").prop("checked",!0),!1;else this.$("#all-categories").is(":checked")?
(this.$("#all-categories").prop("checked",!1),duo.user&&b.post("/translations/set_preference_all_document_categories",{preference:!1},function(){b.post("/translations/set_document_type_preference",h)})):0==this.$(".category-checkbox:checked").length?(this.$("#all-categories").prop("checked",!0),duo.user&&b.post("/translations/set_preference_all_document_categories",{preference:!0})):duo.user&&b.post("/translations/set_document_type_preference",h);else if(0<b("#"+d+' input[type="checkbox"]:checked').length||
"content-rating"==d)duo.user&&b.post("/translations/set_document_type_preference",h);else return b(a.currentTarget).prop("checked",!0),!1;a=this.getFilterOptions();a.none_selected||(a.per_page=10,this.model.get(c+"_translations").fetch({data:a}),duo.track("click_immersion_checkbox",{filter_type:d,filter_option:f}))},changeTranslationDirection:function(a){var c=b(a.currentTarget).find(":selected");a=c.data("source");c=c.data("target");duo.loggedOutTranslationRouter.navigate("/translations/"+a+"/"+
c,!0)},updateAllCheckbox:function(){this.$('.category-option input[type="checkbox"]:checked').length==this.$(".category-option").length?(this.$("#all-categories").prop("checked",!0),this.$(".category-checkbox").prop("checked",!1)):this.$("#all-categories").prop("checked",!1)},keyCheckSearch:function(a){b.trim(this.$("#search-translations").val()).length?this.$(".clear-button").show():this.$(".clear-button").hide();13==a.which?this.refetch():this.throttledSearch()},clearSearch:function(){this.$("#search-translations").val("");
this.$(".clear-button").hide();this.refetch()},refetch:function(){var a=this.getFilterOptions(),b=this.panel_name+"_translations";a.none_selected?this.model.get(b).reset([]):this.model.get(b).fetch({data:a})},disableSorting:function(){var a=this.$("#sort-list");a.attr("disabled")||(this.saved_sort_val=a.val(),a.val("date"),a.attr("disabled",!0),this.$("#sort-list-label").attr("disabled",!0))},reenableSorting:function(){var a=this.$("#sort-list");this.saved_sort_val&&(a.val(this.saved_sort_val),this.saved_sort_val=
void 0);a.attr("disabled",!1);this.$("#sort-list-label").attr("disabled",!1)},disableCheckBoxes:function(){if(!this.filtering_disabled){var a=this.$('input[type="checkbox"]');this.was_checked=[];for(var c=0;c<a.length;c++){var d=b(a[c]);this.was_checked.push(d.prop("checked"));d.attr("disabled",!0);d.prop("checked",!d.hasClass("category-checkbox")||"all"==d.attr("id"))}this.filtering_disabled=!0}},reenableCheckBoxes:function(){if(this.filtering_disabled){for(var a=this.$('input[type="checkbox"]'),
c=0;c<a.length;c++){var d=b(a[c]);d.attr("disabled",!1);d.prop("checked",this.was_checked[c])}this.filtering_disabled=!1}},disableSearchBar:function(){this.$("#search-translations").val("").attr("disabled",!0);this.$(".clear-button").hide()},reenableSearchBar:function(){this.$("#search-translations").attr("disabled",!1)},getFilterOptions:function(){var a=[],c='.category-option input[type="checkbox"]';this.$("#all-categories").is(":checked")||(c+=":checked");b(c).each(function(){a.push(b(this).attr("value"))});
for(var c=this.model.get("filters"),d=0;d<c.length;d++){var f=b("#"+c[d].id+' input[type="checkbox"]:checked');if(0==f.length)return{none_selected:"true"};f.each(function(){a.push(b(this).attr("value"))})}c=this.$("#content-rating_2");1==c.length&&c.is(":checked")&&a.push("content-rating_2");c={document_types:a.join("|")};d=b.trim(this.$("#search-translations").val());0<d.length&&(c.search_text=d);return c},showTiersModal:function(){this.$("#translator-tier-explanation").modal("show")},hideTiersModal:function(){this.$("#translator-tier-explanation").modal("hide")},
showVotesModal:function(){var a={source_lang:this.model.get("source_language"),target_lang:this.model.get("target_language")};this.votes_model=new duo.YourTranslationVotes(a);var b=this;this.votes_model.fetch({success:function(){var a=b.$("#show-your-votes-body");(new duo.YourTranslationVotesView({el:a,model:b.votes_model})).render();b.$("#show-your-votes").modal("show");duo.track("show_translation_votes")}})},hideVotesModal:function(){this.$("#show-your-votes").modal("hide")},hideModals:function(){this.hideTiersModal();
this.hideVotesModal()},dismissIntroOwl:function(){this.$(".immersion-intro").hide();this.$(".translate-main").removeClass("intro-fade");duo.user.dismissNotification("immersion_intro_owl");duo.track("dismiss_immersion_intro_owl")},toggleSidebarItem:function(a){var c=b(a.currentTarget);a=c.data("id");c.toggleClass("active",!c.hasClass("active"));c=c.hasClass("active");"your-translation-tier"==a&&this.$(".translator-stats").toggleClass("collapsed",!c);this.$("#"+a).toggle(c);b.post("/translations/set_item_visibility_preference",
{item:a,preference:c})}});duo.RankedTranslationsView=duo.View.extend({template:duo.templates["translations-ranked-list"],initialize:function(a){this.collection=a.collection;this.category_label=a.category_label;this.history=a.history;this.uploaded=a.uploaded;this.draft=!0==a.draft;this.parent_view=a.parent_view;this.listenTo(this.collection,"reset",this.render);this.listenTo(this.collection,"add",this.addOne)},onClose:function(){b(document).unbind(".translations.infinite_scroll")},render:function(){this.closeChildViews();
this.$el.html(b.duostache(this.template,{has_translations:this.collection.length,translations:this.collection.toJSON(),category_label:this.category_label,more:this.collection.more,history:this.history,draft:this.draft,all_shown:this.all_shown},duo.templates));this.collection.each(this.addOne,this);this.last_request_length=0;var a=this,a=this;b(document).unbind(".translations.infinite_scroll").bind("scroll.translations.infinite_scroll",function(c){c=b(document).height()-b(document).scrollTop();var d=
b(window).height();c<1.5*d&&a.collection.length>a.last_request_length&&(a.last_request_length=a.collection.length,a.loadMore())});return this},addOne:function(a,b,d){a=new duo.RankedTranslationView({model:a,draft:this.draft});this.addChildView(a);this.$(".ranked-translations").append(a.render().el)},loadMore:function(a){var b=this;a=a||{};var d=_.extend(this.parent_view.getFilterOptions(),{encoded_iterator_state:this.collection.encoded_iterator_state});a=_.extend(a,d);this.collection.fetch({data:a,
update:!0,remove:!1,success:function(a,d){d.more||b.$(".translations-spinner").remove()}})}});duo.RankedTranslationView=duo.View.extend({tagName:"li",template:duo.templates["translations-ranked-item"],events:{"click .downvote":"voteDown","click .vote-down":"voteDown","click .upvote":"voteUp","click .vote-up":"voteUp"},initialize:function(a){this.listenTo(this.model,"change",this.render);this.draft=a.draft},render:function(){this.closeChildViews();var a=_.extend(this.model.toJSON(),{logged_in:!!duo.user&&
!duo.user.get("trial_account"),trial_account:duo.user&&duo.user.get("trial_account")});this.$el.html(b.duostache(this.template,a,duo.templates));return this},rateDocument:function(a,c){if(1==a&&this.model.get("user_upvoted")||-1==a&&this.model.get("user_downvoted"))a=0;var d=this;b.post("/documents/"+this.model.get("document").id+"/rate",{rating:a},function(b){d.model.set({votes:b.votes,user_upvoted:1===a,user_downvoted:-1===a})});duo.track("rate document",{rating:a,from:"immersion-page"})},voteUp:function(a){this.rateDocument(1,
a);a.stopPropagation()},voteDown:function(a){this.rateDocument(-1,a);a.stopPropagation()}});duo.TranslationUploadView=duo.View.extend({id:"app",template:duo.templates["translation-upload"],events:{"click #submit-upload":"clickSubmit","change #category":"checkSubmit","change #language":"checkSubmit","click .upload-type":"selectUploadType","click .see-preview":"selectPreview","click .change-step":"changeStep","click .cancel-input":"cancelInput","click .cancel-preview":"cancelPreview","click .manual-submit":"manualSubmitToPreview"},
initialize:function(a){this.currentPage="type"},render:function(){var a=this.model.toJSON();a.input_enabled="prev"==this.currentPage;this.$el.html(b.duostache(this.template,a,duo.templates));this.type_view=new duo.TypeUploadView({model:this.model,el:this.$("#type-step")});this.type_view.render();this.input_view=new duo.InputUploadView({model:this.model,el:this.$("#input-step")});this.preview_view=new duo.PreviewUploadView({model:this.model,el:this.$("#prev-step"),parent_view:this});this.addChildView(this.type_view);
this.addChildView(this.input_view);this.addChildView(this.preview_view);this.checkSubmit();return this},clickSubmit:function(){var a=this.$("#submit-upload").text();this.$("#submit-upload").html(b("#submit-upload").data("wait"));if(!this.$("#submit-upload").attr("disabled")){if("text"==this.preview_view.data_source){var c={plaintext:this.model.get("text"),title:this.model.get("title"),target_language:this.model.get("language"),category:this.model.get("category"),image_url:this.model.get("image_url"),
url:this.model.get("document_url")};this.model.image_url&&(c.image_url=this.model.image_url)}else c={url:this.model.get("document_url"),target_language:this.$("#language").val(),category:this.$("#category").val()};"paid"==this.model.get("upload_type")&&(c.cost=this.model.get("cost"));var d=new duo.TranslateJob(c),f=this;this.setEnabled("#cancel-upload",!1);this.setEnabled("#submit-upload",!1);d.save(c,{success:function(c,h){d.get("success")?(duo.translationRouter.navigate("/translation/"+h.translation_id,
!0),duo.track("upload_document",{translation_id:h.translation_id,source_language:h.source_language,target_language:h.target_language})):(f.model.set({upload_failed:!0,upload_failure_reason:d.get("failure_reason")}),f.$("#submit-upload").text(a),f.$("#upload-failure").html(b.duostache("{{#_ivar}}upload_failure_reason{{/_ivar}}",{upload_failure_reason:d.get("failure_reason")})),f.$("#upload-failure").show())}})}},setEnabled:function(a,b){b?this.$(a).removeAttr("disabled"):this.$(a).attr("disabled",
"disabled")},changeStep:function(a){var c=b("#"+this.currentPage).data("index"),d=b(a.currentTarget).data("index");if(c>d||this.preview_view)this.preview_view.data_source&&3==c&&this.$("#prev").addClass("change-step"),this.switchTo(this.currentPage,b(a.currentTarget).data("tab"));return!1},switchTo:function(a,c){if(void 0==this.model.get("upload_type")&&("input"==c||"prev"==c))return!1;"prev"==c&&this.$("#input").addClass("change-step");b("#"+a+"-step").hide();b("#"+c+"-step").show();this.$("#"+a).removeClass("active");
this.$("."+c+"-step").addClass("active").removeClass("inactive");this.currentPage=c},cancelInput:function(){this.switchTo("input","type")},cancelPreview:function(a){"paid"==this.model.get("upload_type")&&"edit"==a.target.id&&this.input_view.changePages("manual");this.switchTo("prev","input");("None"!=this.$("#category").val()||"None"!=this.$("language").val())&&this.model.set({category:this.$("#category").val(),language:this.$("#language").val()});this.$("#prev").addClass("change-step")},checkSubmit:function(){this.input_view&&
(this.input_view.edited=!0);b("#prev").removeClass("change-step").addClass("inactive");var a=this.model.get("category")||this.$("#category").val()&&"None"!=this.$("#category").val(),c=this.model.get("language")||this.$("#language").val()&&"None"!=this.$("#language").val();a&&c?this.$("#submit-upload").removeAttr("disabled"):this.$("#submit-upload").attr("disabled","disabled")},selectUploadType:function(a){if("paid"==b(a.currentTarget).data("type")&&!1==duo.user.get("commercial_user"))return!1;if(a){var c=
b(a.currentTarget).data("type");this.model.get("upload_type")!=c&&b("#prev").removeClass("change-step").addClass("inactive");this.model.set({upload_type:c})}this.input_view.render();this.switchTo("type","input");a.stopPropagation();return!1},selectPreview:function(a){var c=b.trim(this.$("#url-input").val());if(""==c)return!1;this.$(".preview-failure").hide();var d=b(".see-preview").html(),f=this;this.$(".see-preview").html(b(".see-preview").data("wait"));this.$(".see-preview").attr("disabled","disabled");
b.post("/translate_jobs/preview",{url:c},function(b){if(b.preview_failed)return f.$("#preview-failed").show(),f.$(".see-preview").html(d),a.stopPropagation(),!1;if(b.content_filtered)return f.$("#content-filtered").show(),f.$(".see-preview").html(d),a.stopPropagation(),!1;if(b.is_copyrighted&&"paid"!=f.model.get("upload_type"))return f.$("#is-copyrighted").show(),f.$(".see-preview").html(d),a.stopPropagation(),!1;b.success&&(f.$("#paste-text").val(b.text),f.$(".article-headline").val(b.title),f.$("#image-url").val(b.image_url),
f.$("#manual-url").val(b.document_url),window.setTimeout(function(){f.$(".see-preview").html(d);f.$(".see-preview").removeAttr("disabled");f.model.set(b);f.input_view.countWords();duo.track("preview_document",{document_url:c});f.preview_view.data_source="url";f.preview_view.render();f.switchTo("input","prev");f.currentPage="prev"},1E3))});a.stopPropagation();return!1},manualSubmitToPreview:function(a){a=b.trim(this.$("#paste-text").val());var c=b.trim(this.$(".article-headline").val()),d=this.$("#manual-category").val(),
f=this.$("#manual-language").val(),g=this.$("#image-url").val(),h=this.$("#manual-url").val(),k=this.$("#cost").text(),l=b("#see-preview").html(),m=this;this.$("#see-preview").html(b("#see-preview").data("wait"));this.$("#see-preview").attr("disabled","disabled");b.post("/translate_jobs/manual_preview",{text:a,title:c},function(a){m.model.set("custom_html",null);m.model.set(a);m.model.set({language:f,category:d,image_url:g,document_url:h,cost:k});m.preview_view.data_source="text";window.setTimeout(function(){m.preview_view.render();
m.$("#see-preview").html(l);m.$("#see-preview").removeAttr("disabled");m.switchTo("input","prev");m.currentPage="prev"},1E3)});duo.track("preview_document",{manual_upload:!0})}});duo.TypeUploadView=duo.View.extend({template:duo.templates["upload-document-type"],events:{},render:function(){var a=this.model.toJSON();a.commercial_user=duo.user.get("commercial_user");this.$el.html(b.duostache(this.template,a,duo.templates));duo.user.get("commercial_user")||(this.$("#paid-upload").attr("disabled","disabled"),
this.$("#paid-upload").addClass("disabled"));return this}});duo.InputUploadView=duo.View.extend({template:duo.templates["upload-document-input"],events:{"input #url-input":"checkAutoPreviewButton","click .tab":"switchTab","blur #paste-text":"getEditData","change #manual-category":"checkForSubmit","change #manual-language":"checkForSubmit","keyup #paste-text":"keyPressContent","change #paste-text":"keyPressContent","keyup .article-headline":"keyPressContent","change .article-headline":"keyPressContent"},
initialize:function(a){this.tab="automatic";this.edited=!1},render:function(){var a=this.model.toJSON();a.count=0;a.cost=0;a.free_upload="free"==this.model.get("upload_type")?!0:!1;a.commercial_user=duo.user.get("commercial_user");this.$el.html(b.duostache(this.template,a,duo.templates));var c=this;_.defer(function(){c.$("label").inFieldLabels()});this.changePages(this.tab);this.checkForSubmit();return this},checkAutoPreviewButton:function(){""!=b.trim(this.$("#url-input").val())?this.$(".see-preview").removeAttr("disabled"):
(this.$(".see-preview").attr("disabled","disabled"),this.$(".preview-failure").hide());b("#prev").removeClass("change-step").addClass("inactive")},switchTab:function(a){a=b(a.currentTarget).data("type");this.changePages(a)},changePages:function(a){this.$(".tab").removeClass("active");this.$("."+a).addClass("active");this.$(".panel").hide();this.$("#"+a+"-upload").show();this.tab=a;"manual"==a&&b.trim(""!=this.$("#paste-text").val())&&this.getEditData()},getEditData:function(){if(this.model.get("preview_data")||
""==b.trim(this.$("#paste-text").val()))return!1;var a=this.$("#paste-text").val(),c=this.$(".article-headline").val(),d=this;b.post("/translate_jobs/manual_parse",{text:a,title:c},function(a){if(a.preview_failed)return d.$("#preview-failed").show(),e.stopPropagation(),!1;if(a.success){d.model.set({preview_data:a});a=d.model.toJSON();var c=a.preview_data.target_languages;b.each(a.preview_data.categories,function(a,c){d.$("#manual-category").append(b("<option></option>").attr("value",c.id).text(translate_text(c.label)))});
b.each(c,function(a,c){d.$("#manual-language").append(b("<option></option>").attr("value",c.id).text(translate_text(c.name)))});(c=a.preview_data.language)&&b("option[value="+c+"]").attr("selected","selected");(a=a.preview_data.category)&&b('option[value="'+a+'"]').attr("selected","selected");d.checkForSubmit()}"free"!=d.model.get("upload_type")&&d.countWords()})},checkForSubmit:function(){var a=b.trim(this.$("#paste-text").val()),c=b.trim(this.$(".article-headline").val()),d=this.$("#manual-category"),
f=this.$("#manual-language");"None"!=d.val()&&"None"!=f.val()&&""!=a&&""!=c?this.$(".manual-submit").removeAttr("disabled"):this.$(".manual-submit").attr("disabled","disabled")},keyPressContent:function(){b("#prev").removeClass("change-step").addClass("inactive");this.countWords()},countWords:function(a){a=0;var c=b.trim(this.$(".article-headline").val()+" "+this.$("#paste-text").val());c&&(a=c.split(/\s+/g).length);c=(a*duo.user.get("cost")).toFixed(2);this.$("#word-count").html(b.duostache("{{count}}",
{count:a}));this.$("#cost").html(b.duostache("{{cost}}",{cost:c}));this.model.set({cost:c})}});duo.PreviewUploadView=duo.View.extend({template:duo.templates["upload-document-preview"],initialize:function(a){this.data_source=void 0;this.parent_view=a.parent_view},render:function(){var a=this.model.toJSON();a.from_url="url"==this.data_source;a.free_upload="free"==this.model.get("upload_type")?!0:!1;a.commercial_user=duo.user.get("commercial_user");this.$el.html(b.duostache(this.template,a,duo.templates));
void 0==this.data_source?this.$("#submit-upload").attr("disabled","disabled"):this.parent_view.checkSubmit();return this}});duo.LoggedOutWikiTranslationView=duo.View.extend({id:"app",template:duo.templates["wiki-translation"],events:{"click #pg13-continue":"hidePG13Modal","click #pg13-warning-modal .close":"hidePG13Modal","click .join-duo":"join"},initialize:function(a){a.view_both?this.model.set({view_original:!1,view_both:!0}):this.model.set({view_original:!0,view_both:!1});this.listenTo(this.model,
"change:view_original change:view_both",this.render);this.coin_for_rating=!!this.model.get("num_points_for_rating");var c=this.model.get("translation_id"),d=this.model.get("source_language"),f=this.model.get("target_language"),g=this.model.get("target_language_name");this.sentence_models=[];this.revision_history_models=[];var h=this;this.model.forEachSentence(function(a){a.set({translation_id:c,source_language:d,target_language:f,target_language_name:g,editable:!1,hovered:!1,open:!1,no_translation_placeholder:h.noTranslationPlaceholder(a)});
h.sentence_models.push(a);var b=new duo.WikiDocumentSentenceRevisionHistory;b.set({translation_id:c,document_sentence_id:a.get("document_sentence_id"),user_rating:a.get("user_rating"),revisions:[]});h.revision_history_models.push(b)});this.max_visible_sentence_index=0;h=this;b(document).unbind(".translation.infinite_scroll").bind("scroll.translation.infinite_scroll",function(a){h.renderVisibleSentences()});Backbone.history.once("route",function(){h.hidePG13Modal()});this.model.set("no_sentence_selected",
!0)},render:function(){this.closeChildViews();this.sidebar_views={};this.mini_popover_views={};this.show_more_views={};var a=this,c=_.extend(this.model.toJSON(),{logged_in:!!duo.user&&!duo.user.get("trial_account"),trial_account:duo.user&&duo.user.get("trial_account")});this.$el.html(b.duostache(this.template,c,duo.templates,!0));c=new duo.WikiDocumentInstructionsView({el:this.$("#document-instructions"),model:this.model});c.render();this.addChildView(c);c=new duo.WikiGlobalSidebarView({el:this.$("#global-sidebar"),
model:this.model});c.render();this.addChildView(c);this.original_view=new duo.WikiDocumentBodyView({el:this.$("#original-body"),model:this.model});this.original_view.render();this.addChildView(this.original_view);this.model.get("view_both")&&(this.translated_view=new duo.WikiDocumentBodyView({el:this.$("#translated-body"),model:this.model,pane:"trans-"}),this.translated_view.render(),this.addChildView(this.translated_view));this.cur_sentence_index=0;a.renderSentences(this.max_visible_sentence_index+
50);this.updateRatingButtonState();a=this;this.updateProgressBarWidth();b(window).resize(function(){a.resizeThings()});_.defer(function(){window.twttr&&twttr.widgets&&twttr.widgets.load();a.model.get("is_pg13")&&!a.pg13_warning_shown&&(a.$("#pg13-warning-modal").modal("show"),a.pg13_warning_shown=!0);a.resizeThings();a.renderVisibleSentences()});return this},resizeThings:function(){var a=b(window).height(),c=this.$("#original-body"),c=Math.min(c.outerHeight(),a-c.offset().top-20);this.$(".document-sentence-sidebar").css("max-height",
c+"px");this.$(".page-main").toggleClass("short-window",700>a)},updateProgressBarWidth:function(){var a=!0==this.model.get("user_finished_translation"),b=1;a||(b=1-1*this.model.get("num_sentences_left")/this.model.get("num_sentences"));var d=this.$(".wiki-progress-bar");0>=b?d.width("0px"):d.width(100*b+"%");d.toggleClass("fully-done",a)},hidePG13Modal:function(){this.$("#pg13-warning-modal").modal("hide")},updateRatingButtonState:function(){var a=this.model.get("user_document_rating");this.$('.rate-document-option[data-rating="1"]').toggleClass("active",
1==a);this.$('.rate-document-option[data-rating="-1"]').toggleClass("active",-1==a);this.$('.icon[data-rating="1"]').toggleClass("active",1==a);this.$('.icon[data-rating="-1"]').toggleClass("active",-1==a);this.$(".vote-count").toggleClass("active-upvoted",1==a);this.$(".vote-count").toggleClass("active-downvoted",-1==a)},maxVisibleSentenceIndex:function(){(new Date).getTime();var a=b(window).scrollTop()+b(window).height(),c=this.$(".sentence-wrapper");max_i=-1;for(var d=0;d<c.length;d++){var f=b(c[d]);
f.offset().top<a&&(f=f.data("index"),max_i=Math.max(max_i,f))}return max_i},renderVisibleSentences:function(){this.cur_sentence_index!=this.sentence_models.length&&(this.max_visible_sentence_index=this.maxVisibleSentenceIndex(),this.renderSentences(this.max_visible_sentence_index+50))},renderMoreSentences:function(){this.renderSentences(this.cur_sentence_index+50)},renderSentences:function(a){for(;this.cur_sentence_index<=a&&this.cur_sentence_index<this.sentence_models.length;this.cur_sentence_index++)this.renderSentenceViews(this.sentence_models[this.cur_sentence_index]);
this.cur_sentence_index==this.sentence_models.length&&this.$("#load-more-sentences").remove();this.deferAlignParagraphs()},renderSentenceViews:function(a){this.renderDocumentSentence(a,"",!1);!0==this.model.get("view_both")&&this.renderDocumentSentence(a,"trans-",!0)},maybeCreatePopoverViews:function(a){if(!this.sidebar_views[a]&&!this.mini_popover_views[a]){var b=this.sentence_models[a],d=this.revision_history_models[a];if(this.model.get("view_both")){var f=new duo.WikiSentenceMiniPopoverView({model:b,
el:this.$("#mini-popover-"+a),parent_view:this});this.addChildView(f);this.mini_popover_views[a]=f;b=new duo.WikiDocumentSentenceRevisionHistoryView({model:d,sentence_model:b,document_model:this.model,el:this.$("#show-more-"+a),index:a,view_both:!0,parent_view:this});this.addChildView(b);this.show_more_views[a]=b}else f=this.$("#sentence-sidebar-"+a),b=new duo.WikiDocumentSentenceSidebarView({model:b,el:f,parent_view:this,document_model:this.model,revision_history_model:d}),this.addChildView(b),this.sidebar_views[a]=
b}},deferAlignParagraphs:function(){var a=this;_.defer(function(){a.alignParagraphs()})},alignParagraphs:function(){if(!0==this.model.get("view_both"))for(var a=this.original_view.$(".wiki-paragraph,.sub-buzz,.wikipedia-article > * > *"),c=this.translated_view.$(".wiki-paragraph,.sub-buzz,.wikipedia-article > * > *"),d=0;d<a.length;d++){var f=b(a[d]),g=b(c[d]),h=f.position().top,k=g.position().top;if(h!=k){var l=Math.max(h,k);f.css({position:"relative",top:Math.max(0,this.relativeTop(f)+l-h)});g.css({position:"relative",
top:Math.max(0,this.relativeTop(g)+l-k)})}}},relativeTop:function(a){return"relative"==a.css("position")?parseInt(a.css("top")):0},renderDocumentSentence:function(a,b,d){var f=a.get("index"),f=this.$("#"+b+"sentence-wrapper-"+f);a=new duo.WikiDocumentSentenceView({model:a,parent_view:this,el:f,show_translated:d,pane:b});a.render();this.addChildView(a)},renderVotes:function(){this.$(".vote-count").text(this.model.get("document_vote_sum"))},noTranslationPlaceholder:function(a){return Array(1+Math.ceil(0.5*
a.numCharacters())).join("\u2586&#8203;")},join:function(){duo.user&&duo.user.get("trial_account")&&duo.vent.trigger("registerDelayed")}});duo.WikiTranslationView=duo.LoggedOutWikiTranslationView.extend({id:"app",events:{"click .wiki-paragraph":"clickParagraph","click .sentence-wrapper":"clickSentenceHandler","mouseenter .sentence-wrapper":"hoverSentenceHandler","mouseleave p,h1,h2,img,.wiki-paragraph":"unhoverParagraph","click .rate-document-option":"rateDocument","click #report-inappropriate":"reportInappropriate",
"click #cancel-report-inappropriate":"cancelReportInappropriate","click #report-inappropriate-reason":"reportInappropriateReason","click #disable-translation":"disableTranslation","click #enable-translation":"enableTranslation","click #view-original":"viewOriginal","click #view-both":"viewBoth","click #view-discussion":"viewDiscussion","mouseleave .page-main":"hoverBackground","keypress .sentence":"sentenceContentChanged","changed .sentence":"sentenceContentChanged","input .sentence":"sentenceContentChanged",
"click #load-more-sentences":"renderMoreSentences","click #explain-shortcuts":"showShortcutModal","click #dismiss-shortcut-explanation":"hideShortcutModal","click #explain-translator-tiers":"showTiersModal","click #dismiss-tier-explanation":"hideTiersModal","click #show-upvotes":"showVotesModal","click #show-downvotes":"showVotesModal","click #dismiss-votes-modal":"hideVotesModal","click .show-shortcuts":"showShortcuts","click #pg13-continue":"hidePG13Modal","click #pg13-warning-modal .close":"hidePG13Modal",
"click #toggle-instructions":"toggleInstructions","click #show-legend":"clickShowLegend","click #show-translators":"clickShowTranslators"},initialize:function(a){duo.LoggedOutWikiTranslationView.prototype.initialize.call(this,a);this.listenTo(this.model,"change:document_vote_sum",this.renderVotes);this.listenTo(this.model,"change:num_sentences_left",this.updateProgressBarWidth);this.listenTo(this.model,"change:hide_instructions",this.updateInstructionVisibility);this.listenTo(this.model,"change:hide_instructions",
this.resizeThings);var c=this,d=function(a){("wrapper"==a.target.id||"app"==a.target.id)&&c.maybeCloseSentence()};b("#wrapper").click(d);Backbone.history.once("route",function(){b("#wrapper").unbind("click",d)});b(document).unbind(".translation.keyboard-shortcuts").bind("keydown.translation.keyboard-shortcuts",function(a){c.handleKeyPress(a)});Backbone.history.once("route",this.close,this);this.pending_open_sentence_index=this.open_sentence_index=-1;a=this.model.get("translation_comment_id");this.root_comment=
new duo.Comment({id:a});this.root_comment.bind("change",this.updateNumComments,this);a=window.performance||{};var f=a.now||a.mozNow||a.webkitNow||a.msNow||a.oNow;f&&(this.high_res_now=f.bind(a));this.last_translation_timestamp=this.last_rating_timestamp=this.curTimestamp()-60;this.on_windows=!window.navigator.platform||-1!=window.navigator.platform.indexOf("Win");this.enforce_speed_limits=!0},onClose:function(){this.hideVotesModal();this.hideTiersModal();this.hideShortcutModal();b(document).unbind(".translation.keyboard-shortcuts");
b("#dim-site").fadeOut()},handleKeyPress:function(a){if(!this.model.get("view_discussion")){var b=this.editableSentenceIndex();if(-1!=b){if(27==a.which){a.preventDefault();a.stopPropagation();var d=this.open_sentence_index;-1!=d&&this.sentence_models[d].get("editable")&&(this.model.get("view_both")?this.cancelContentEdit(d):this.sidebar_views[d].cancelEdit())}13==a.which&&this.model.get("view_both")&&(a.preventDefault(),a.stopPropagation(),this.saveContentEdit(b))}else if(40==a.which)a.preventDefault(),
a.stopPropagation(),-1==this.pending_open_sentence_index&&(d=this.open_sentence_index,-1==d?this.switchSentence(0):d<this.sentence_models.length-1&&(this.switchSentence(d+1),this.scrollIntoViewIfNeeded(d+1)));else if(38==a.which)a.preventDefault(),a.stopPropagation(),-1==this.pending_open_sentence_index&&(d=this.open_sentence_index,0<d&&(this.switchSentence(d-1),this.scrollIntoViewIfNeeded(d-1)));else if(13==a.which||39==a.which)a.preventDefault(),a.stopPropagation(),this.makeOpenSentenceEditable();
else if(27==a.which||37==a.which)a.preventDefault(),a.stopPropagation(),d=this.open_sentence_index,-1!=d&&!this.model.get("view_both")&&this.maybeCloseSentence();else if(187==a.which||107==a.which||189==a.which||107==a.which)d=this.open_sentence_index,-1!=d&&(a=187==a.which||107==a.which?1:-1,this.model.get("view_both")?this.mini_popover_views[d].rateTranslation(a):this.sidebar_views[d].rateTranslation(a))}},showShortcuts:function(){b("#show-shortcuts").click()},scrollIntoViewIfNeeded:function(a){var b=
this;_.delay(function(){b.model.get("view_both")&&b.$("#mini-popover-"+a).get(0).scrollIntoViewIfNeeded();b.$("#sentence-wrapper-"+a).get(0).scrollIntoViewIfNeeded()})},maybeCloseSentence:function(){this.pendingUserInput()||this.closeSentence()},closeSentence:function(){this.switchSentence(-1);this.setHovered(-1)},updateNumComments:function(){var a=this.root_comment.get("num_comments");this.model.set("num_comments",a);a=translate_text(0<a?"Discuss ("+a+")":"Discuss");this.$("#discuss-button-text").text(a)},
hoverBackground:function(a){if(this.model.get("view_both")){var b=this.$(".page-main");a.pageX>=b.offset().left&&a.pageX<=b.offset().left+b.outerWidth()&&a.pageY>=b.offset().top&&a.pageY<=b.offset().top+b.outerHeight()||this.maybeCloseSentence()}},sentenceContentChanged:function(a){var c=b(a.currentTarget).data("index");this.isContentEditable(c)&&(13==a.which&&(a.preventDefault(),a.stopPropagation(),this.saveContentEdit(c)),a=b.trim(this.$("#trans-sentence-"+c).text()),this.sentence_models[c].set("content_edit",
a))},cancelContentEdit:function(a){this.setContentEditable(a,!1);a=this.sentence_models[a];a.set({editable:!1,rejected:!1,content_edit:null});a.trigger("change:rerender")},saveContentEdit:function(a){if(this.sentence_models[a].get("cur_translation")||this.checkCanTranslate(a)){var c=b.trim(this.$("#trans-sentence-"+a).text()),d=this.sentence_models[a];if(c==d.get("cur_translation"))this.cancelContentEdit(a);else{this.mini_popover_views[a].disableSaveButton();d.get("user_rating");var f=this,g=_.extend(this.model.mixpanelProperties(),
{chars_per_sec:this.translation_chars_per_sec});d.addRevision(c,"",!1,!1,function(b){f.setContentEditable(a,!1);if(b.rejected)d.set({content_edit:null,rejected:!0}),d.trigger("change:rerender"),alert(translate_text("Translation does not seem correct."));else{var c=f.$("#trans-sentence-coin-"+a);f.animateCoin(c,b.num_points_awarded);d.set({editable:!1,rejected:!1,content_edit:null});f.updateNumSentencesDone();f.incrementCoinCount(b.num_points_awarded,b.level_event);f.model.addTranslator();f.sentence_models[a].get("show_more")&&
f.show_more_views[a].fetchAndRender()}},g)}}},showShortcutModal:function(){this.$("#keyboard-shortcut-explanation").modal("show")},hideShortcutModal:function(){this.$("#keyboard-shortcut-explanation").modal("hide")},showTiersModal:function(){var a=this.$("#translator-tier-explanation"),b=this.$(".sidebar").offset().top+250;a.css("top",b);a.modal("show")},hideTiersModal:function(){this.$("#translator-tier-explanation").modal("hide")},showVotesModal:function(){var a={source_lang:this.model.get("source_language"),
target_lang:this.model.get("target_language")};this.votes_model=new duo.YourTranslationVotes(a);var b=this;this.votes_model.fetch({success:function(){var a=b.$("#show-your-votes-body");(new duo.YourTranslationVotesView({el:a,model:b.votes_model})).render();var a=b.$("#show-your-votes"),f=b.$(".sidebar").offset().top+250;a.css("top",f);a.modal("show")}})},hideVotesModal:function(){this.$("#show-your-votes").modal("hide")},toggleInstructions:function(){var a=!this.model.get("hide_instructions");this.model.set("hide_instructions",
a);duo.setTranslationPreference("hide_instructions",a);duo.track("toggle_document_instructions",{hide:a})},clickShowLegend:function(a){this.toggleContributors(a,!1)},clickShowTranslators:function(a){this.toggleContributors(a,!0)},toggleContributors:function(a,c){this.model.set("show_contributors",c);this.$("#document-info").toggleClass("hidden",c);this.$("#translation-contributors").toggleClass("hidden",!c);this.$("#document-sidebar-tabs > li").removeClass("active");b(a.currentTarget).addClass("active");
duo.setTranslationPreference("show_contributors",c)},updateInstructionVisibility:function(){var a=this.model.get("hide_instructions");this.$("#document-instructions").toggleClass("hidden",a);this.$(".lesson-like-document").toggleClass("hide-instructions",a);this.$("#show-instructions-arrow").toggleClass("hidden",!a);this.$("#hide-instructions-arrow").toggleClass("hidden",a)},viewOriginal:function(){this.switchTab(0)},viewBoth:function(){this.switchTab(1)},viewDiscussion:function(){this.switchTab(2)},
switchTab:function(a){if(!this.pendingUserInput()){this.switchSentence(-1);if(2==a){var b=this;this.$("#view-discussion").addClass("active");this.root_comment.fetch({success:function(){b.model.set({view_original:0==a,view_both:1==a,view_discussion:2==a});var d=this.$("#translation-discussion");(new duo.CommentView({el:d,model:b.root_comment,comment_id:b.root_comment.get("id"),document_comment:!0})).render()}})}else this.model.set({view_original:0==a,view_both:1==a,view_discussion:2==a});duo.track("wiki_translation_tab_switch",
{tab:0==a?"original":1==a?"both":"discuss"})}},clickParagraph:function(a){a.stopPropagation();a=this.hoveredSentenceIndex();-1!=a&&this.clickSentence(a)},clickSentenceHandler:function(a){a.stopPropagation();a=b(a.currentTarget).data("index");this.clickSentence(a)},clickSentence:function(a){this.pendingUserInput()||(this.model.get("trusted")?alert("You can't click on sentences in the trusted-translation view."):this.model.get("from_user_id")?alert("You can't click on sentences when from_user_id is specified."):
this.model.get("max_timestamp")?alert("You can't click on sentences when max_timestamp is specified."):this.model.get("revision_number")?alert("You can't click on sentences when revision_number is specified."):this.model.get("view_both")&&!this.sentence_models[a].get("is_image_sentence")?(-1!=this.open_sentence_index&&this.open_sentence_index!=a&&this.cancelContentEdit(this.open_sentence_index),this.switchSentence(a,!0)):this.sentence_models[a].get("open")?this.switchSentence(-1):this.switchSentence(a))},
isContentEditable:function(a){return"true"==this.$("#trans-sentence-"+a).attr("contenteditable")},setContentEditable:function(a,b){var d=this.sentence_models[a];d.get("cur_translation")||d.set("no_translation_placeholder",b?"&nbsp;":this.noTranslationPlaceholder(d));d=this.$("#trans-sentence-"+a);d.attr("contenteditable",b);b&&d.focus()},positionMiniPopover:function(a){var b=this.$("#trans-sentence-wrapper-"+a);a=this.$("#mini-popover-"+a);var d=this.$(".page-main"),f=b.offset().top-d.offset().top,
g=b.offset().left-d.offset().left,d=d.outerWidth()-a.outerWidth(),g=Math.min(g,d);a.css({top:f+b.outerHeight()+5,left:Math.min(this.$el.outerWidth()-a.outerWidth(),g)})},positionShowMore:function(a){var b=this.$("#trans-sentence-wrapper-"+a);a=this.$("#show-more-"+a);var d=this.$(".page-main"),f=b.offset().top-d.offset().top,d=b.offset().left-d.offset().left;a.css({top:f+b.outerHeight()+45,left:d})},updateSelectedSentenceInfo:function(a){var b={selected_sentence_index:a};if(-1==a)b.no_sentence_selected=
!0,b.untranslated_sentence_selected=!1,b.translated_sentence_selected=!1,b.translation_from_self_selected=!1;else{a=this.sentence_models[a];var d=!!a.get("cur_translation"),f=!!a.get("latest_translation_from_self");b.no_sentence_selected=!1;b.untranslated_sentence_selected=!d;b.translated_sentence_selected=d&&!f;b.translation_from_self_selected=d&&f;b.num_points_for_original_translation=a.get("num_points_for_original_translation")}this.model.set(b)},switchSentence:function(a,b){this.updateSelectedSentenceInfo(a);
if(a==this.open_sentence_index)b&&this.makeOpenSentenceEditable();else if(-1!=this.open_sentence_index&&(this.sentence_models[this.open_sentence_index].set({open:!1,editable:!1}),this.open_sentence_index=-1,this.model.set("just_finished_article",!1)),-1!=a)if(this.maybeCreatePopoverViews(a),this.model.get("view_both"))b&&this.setContentEditable(a,!0),this.sentence_models[a].set({open:!0,editable:b}),this.open_sentence_index=a;else{var d=this.sentence_models[a];if(d.get("cur_translation")||d.get("is_image_sentence")||
d.get("machine_translation")){var f=!d.get("cur_translation_or_no_need");d.set({open:!0,editable:b||f});this.open_sentence_index=a;d.update(function(){!b&&(f&&d.get("cur_translation_or_no_need"))&&d.set("editable",!1)});duo.track("wiki_translation_open_popover",{can_edit:d.get("can_edit")})}else{var g=this;this.pending_open_sentence_index=a;d.update(function(){"undefined"===typeof b&&(b=!d.get("cur_translation_or_no_need"));d.set({open:!0,editable:b});g.open_sentence_index=a;g.pending_open_sentence_index=
-1;duo.track("wiki_translation_open_popover",{can_edit:d.get("can_edit")})})}}},makeOpenSentenceEditable:function(){if(-1!=this.open_sentence_index){var a=this.open_sentence_index;this.model.get("view_both")?(this.setContentEditable(a,!0),this.sentence_models[a].set({editable:!0})):this.sidebar_views[a].makeEditable()}},hoverSentenceHandler:function(a){a=b(a.currentTarget).data("index");this.hoverSentence(a)},hoverSentence:function(a){if(!this.sentence_models[a].get("hovered")&&(this.setHovered(a),
this.model.get("view_both")&&!this.sentence_models[a].get("is_image_sentence")&&-1==this.editableSentenceIndex())){var b=this.open_sentence_index;0<=b&&this.sentence_models[b].get("show_more")||this.switchSentence(a,!1)}},pendingUserInput:function(){var a=this.editableSentenceIndex();return-1==a?!1:this.model.get("view_both")&&this.sentence_models[a].get("content_edit")?!0:!0==this.sentence_models[a].get("pending_user_input")},sentenceWithAttribute:function(a){for(var b=0;b<this.sentence_models.length;b++)if(!0==
this.sentence_models[b].get(a))return b;return-1},setSentenceWithAttribute:function(a,b){for(var d=0;d<this.sentence_models.length;d++)this.sentence_models[d].set(a,d==b)},hoveredSentenceIndex:function(){return this.sentenceWithAttribute("hovered")},editableSentenceIndex:function(){return this.sentenceWithAttribute("editable")},setHovered:function(a){this.setSentenceWithAttribute("hovered",a)},setEditable:function(a){this.setSentenceWithAttribute("editable",a)},setPopoverOpen:function(a){this.setSentenceWithAttribute("open",
a)},unhoverParagraph:function(a){this.setHovered(-1)},incrementCoinCount:function(a,c){this.model.set("user_num_points",this.model.get("user_num_points")+a);duo.user.get("calendar").push({datetime:(new Date).getTime(),improvement:a},{silent:!0});b("#xp-counter").text(b.duostache("{{#_i}}+{{user_num_points}} {{#pluralize}}XP,XP,{{user_num_points}}{{/pluralize}}{{/_i}}",{user_num_points:this.model.get("user_num_points")}));var d=this.$("#coin-count");0!=a&&(d.text(this.model.get("user_num_points")),
0<a&&(d.addClass("bounce"),_.delay(function(){d.removeClass("bounce")},1E3)));if(c&&"leveled"==c.status)Backbone.history.once("route",function(){this.model.set("level_event",c);var a=new duo.SlideSessionAwesomeView({model:this.model});a.render();a.$el.appendTo("body").modal({keyboard:!0,backdrop:!0,show:!0}).on("hidden",function(){this.remove()});b("#awesome-modal").modal("show")},this);else c&&"unleveled"==c.status&&Backbone.history.unbind("route")},updateNumSentencesDone:function(){for(var a=this.sentence_models.length,
b=0,d=0;d<a;d++)this.sentence_models[d].get("user_rating")&&(b+=1);this.model.set({num_sentences_left:a-b,num_sentences_done:b});if(b==this.sentence_models.length&&!this.model.get("user_finished_translation")){var f=this;this.model.reportUserFinishedTranslation(function(a){f.incrementCoinCount(a.num_points_awarded,a.level_event);f.model.set(_.extend(a,{prev_level:a.next_level-1}));_.delay(function(){f.model.set("just_finished_article",!0)},1E3)})}},rateDocument:function(a){a.stopPropagation();a=b(a.currentTarget).data("rating");
a==this.model.get("user_document_rating")&&(a=0);this.model.set({user_document_rating:a});this.updateRatingButtonState();var c=this;b.post("/documents/"+this.model.get("document_id")+"/rate",{rating:a},function(a){c.model.set({document_vote_sum:a.votes})},"json");duo.track("rate document",{rating:a,from:"document"})},reportInappropriate:function(a){this.$("#flag-translation-reason-modal").modal("show")},cancelReportInappropriate:function(a){this.$("#flag-translation-reason-modal").modal("hide")},
reportInappropriateReason:function(a){var c=this;a=b.trim(this.$('input[type="radio"]:checked').val());var d=b.trim(this.$("#additional-details").val());a={reason:a,additional_details:d};b.post("/wiki_translations/"+this.model.get("translation_id")+"/report_inappropriate",a,function(a){c.$("#flag-translation-reason-modal").modal("hide");c.model.set("user_reported_inappropriate",!0);c.render()},"json")},disableTranslation:function(a){var c=this;b.post("/wiki_translations/"+this.model.get("translation_id")+
"/disable",{},function(a){c.model.set("translation_disabled",!0);c.render()})},enableTranslation:function(a){var c=this;b.post("/wiki_translations/"+this.model.get("translation_id")+"/enable",{},function(a){c.model.set("translation_disabled",!1);c.render()})},openSentenceView:function(a){0>a||a>=this.sentence_models.length||(this.renderSentences(a+50),this.scrollIntoViewIfNeeded(a),this.renderVisibleSentences(),this.hoverSentence(a),this.clickSentence(a))},animateCoin:function(a,b){0>=b||(a.removeClass("fadeOut"),
a.text(b),a.show(),a.addClass("fadeInUp"),_.delay(function(){a.removeClass("fadeInUp");a.addClass("fadeOut")},2E3))},curTimestamp:function(){return this.high_res_now?this.high_res_now()/1E3:(new Date).getTime()/1E3},checkCanRate:function(a){var b=this.sentence_models[a];if(0<(b.has("num_responses_pending")?b.get("num_responses_pending"):0))return!1;if(b.get("user_rating"))return!0;this.rating_chars_per_sec=this.charsPerSec(a,this.last_rating_timestamp);if(60<this.rating_chars_per_sec&&this.enforce_speed_limits)return duo.track("rating_speed_limit_reached",
{chars_per_sec:this.rating_chars_per_sec}),duo.modalAlert({type:"alert",message_type:"rate_limit"}),!1;this.last_rating_timestamp=this.curTimestamp();return!0},checkCanTranslate:function(a){this.translation_chars_per_sec=this.charsPerSec(a,this.last_translation_timestamp);if(30<this.translation_chars_per_sec&&this.enforce_speed_limits)return duo.track("translation_speed_limit_reached",{chars_per_sec:this.translation_chars_per_sec}),duo.modalAlert({type:"alert",message_type:"rate_limit"}),!1;this.last_translation_timestamp=
this.curTimestamp();return!0},charsPerSec:function(a,b){var d=this.sentence_models[a].numCharacters(),f=this.curTimestamp()-b;this.on_windows&&(f=Math.max(f,1));return d/f},rateTranslation:function(a,b,d){var f=this.sentence_models[a],g=(a=f.get("user_rating"))?parseInt(a):0,h=(a=b==g)?0:b,k=this,l=f.getDefault("num_responses_pending",0);if(!(0<l)){f.set("num_responses_pending",1+l);var l=this.model.get("num_points_for_rating")*(0==g?1:a?-1:0),m={user_approved:1==h,user_disapproved:-1==h,user_rating:h};
f.has("num_upvotes")&&f.has("num_downvotes")&&(m.num_upvotes=f.get("num_upvotes")+(1==h?1:0)-(1==g?1:0),m.num_downvotes=f.get("num_downvotes")+(-1==h?1:0)-(-1==g?1:0));f.set(m);k.updateNumSentencesDone();k.incrementCoinCount(l,null);d&&d(l);d=_.extend(this.model.mixpanelProperties(),{chars_per_sec:this.rating_chars_per_sec});f.rateCurrentTranslation(b,a,function(a){f.set("num_responses_pending",f.get("num_responses_pending")-1);k.incrementCoinCount(0,a.level_event)},d)}}});duo.WikiDocumentBodyView=
duo.View.extend({template:duo.templates["wiki-document-body"],initialize:function(a){this.pane=a.pane||""},render:function(){var a=this.model.toJSON();this.pane&&(a=_.extend(a,{pane:this.pane}));if(a.custom_html){var c='<span class="sentence-wrapper" data-index="{{index}}" id="'+this.pane+'sentence-wrapper-{{index}}"></span>';a.custom_html=a.custom_html.replace(RegExp("{{S([0-9]+)}}","g"),function(a,b){return c.replace(RegExp("{{index}}","g"),b)})}this.$el.addClass("wiki-document-body");this.$el.html(b.duostache(this.template,
a,duo.templates,!0));return this}});duo.WikiDocumentSentenceView=duo.View.extend({template:duo.templates["wiki-document-sentence"],initialize:function(a){this.parent_view=a.parent_view;this.show_translated=!!a.show_translated;this.pane=a.pane||"";this.listenTo(this.model,"change:cur_translation change:rejected change:no_translation_placeholder change:rerender change:open",this.render);this.listenTo(this.model,"change",this.updateObjectClasses);this.listenTo(this.model,"change:hovered",this.show_translated?
this.updateObjectClasses:this.render)},render:function(){var a=this.model.toJSON();this.show_translated&&(a=_.extend(a,{show_translated:this.show_translated}));this.pane&&(a=_.extend(a,{pane:this.pane}));this.$el.html(b.duostache(this.template,a,duo.templates,!0));this.updateObjectClasses();(!0==this.model.get("hovered")||!0==this.model.get("open"))&&(!this.show_translated&&!this.model.get("is_image_sentence"))&&this.showHints(0);return this.el},showHints:function(a){var b=5;0==this.model.get("index")&&
(b=10);a={templates:duo.templates,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),top:b,hover_options:{sensitivity:3,interval:a},reorder_using_machine_translations:!0,is_document_sentence:!0};this.$(".sentence").hints(a)},updateObjectClasses:function(){var a=this.$(".sentence");a.toggleClass("non-translated",!this.model.get("cur_translation"));var b=!0==this.model.get("show_translated");a.toggleClass("user-approved",!0==this.model.get("user_approved")&&
!b);a.toggleClass("user-disapproved",!0==this.model.get("user_disapproved")&&!b);a=(!0==this.model.get("open")||!0==this.model.get("hovered"))&&!(this.show_translated&&this.model.get("editable"));this.$(".sentence").toggleClass("highlighted",a);this.$("img").toggleClass("highlighted",a)}});duo.WikiTranslationContributorsView=duo.View.extend({template:duo.templates["translation-contributors"],initialize:function(){this.listenTo(this.model,"change:num_translators",this.render)},render:function(){this.$el.html(b.duostache(this.template,
this.model.toJSON(),duo.templates));return this}});duo.WikiDocumentInstructionsView=duo.View.extend({template:duo.templates["document-instructions"],initialize:function(){this.listenTo(this.model,"change:selected_sentence_index",this.render)},render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));return this}});duo.WikiGlobalSidebarView=duo.View.extend({template:duo.templates["global-sidebar"],initialize:function(){this.listenTo(this.model,"change:selected_sentence_index",
this.updateVisibility)},render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));var a=new duo.WikiTranslationContributorsView({el:this.$("#translation-contributors"),model:this.model});a.render();this.addChildView(a);return this},updateVisibility:function(){this.$el.toggle(-1==this.model.get("selected_sentence_index"))}});duo.YourTranslationVotesView=duo.View.extend({template:duo.templates["your-translation-votes"],initialize:function(){this.listenTo(this.model,
"change",this.render)},render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));return this}});duo.WikiSentenceMiniPopoverView=duo.View.extend({events:{"click .rate-translation-option":"rateTranslationHandler","click .show-more":"clickShowMore","click .show-less":"clickShowLess","click .save-translation":"saveEdit","click .cancel-translation":"cancelEdit"},template:duo.templates["wiki-sentence-mini-popover"],initialize:function(a){this.parent_view=a.parent_view;
this.revision_history_model=this.parent_view.revision_history_models[this.model.get("index")];this.listenTo(this.model,"change",this.render);this.listenTo(this.model,"change:content_edit",this.reposition);this.listenTo(this.parent_view.model,"change:view_both",this.render)},render:function(){if(!1==this.parent_view.model.get("view_both")||!1==this.model.get("open")||!this.model.get("cur_translation")&&!this.model.get("editable"))this.$el.hide();else return this.$el.html(b.duostache(this.template,
this.model.toJSON(),duo.templates)),this.reposition(),this.$el.show(),this},clickShowMore:function(a){a.stopPropagation();this.model.get("index");a={translation_id:this.model.get("translation_id"),document_sentence_id:this.model.get("document_sentence_id")};var b=this;this.revision_history_model.fetch({data:a,success:function(a){b.model.set({show_more:!0});b.revision_history_model.set("show_more",!0)}})},clickShowLess:function(a){a.stopPropagation();this.model.get("index");this.revision_history_model.set("show_more",
!1);this.model.set("show_more",!1)},saveEdit:function(a){a.stopPropagation();this.parent_view.saveContentEdit(this.model.get("index"))},disableSaveButton:function(){this.$(".save-translation").attr("disabled",!0)},cancelEdit:function(a){a.stopPropagation();this.parent_view.cancelContentEdit(this.model.get("index"))},reposition:function(){this.parent_view.positionMiniPopover(this.model.get("index"))},rateTranslationHandler:function(a){a.stopPropagation();a=parseInt(b(a.currentTarget).data("rating"));
this.rateTranslation(a)},rateTranslation:function(a){var b=this.model.get("index");if(this.parent_view.checkCanRate(b)){var d=this.$(".rate-translation-option[data-rating="+a+"]"),f=d.hasClass("active");this.$(".rate-translation-option").removeClass("active");d.toggleClass("active",!f);this.parent_view.rateTranslation(b,a);!f&&this.parent_view.coin_for_rating&&(a=this.$('.coin[data-rating="'+a+'"]'),b=this.parent_view.model.get("num_points_for_rating"),this.parent_view.animateCoin(a,b))}}});duo.WikiDocumentSentenceSidebarView=
duo.View.extend({template:duo.templates["wiki-document-sentence-sidebar"],events:{"click .cancel-edit":"cancelEdit","click .cancel-open":"cancelOpen","click .save-edit":"saveEdit","click .image-contains-no-text":"clickImageContainsNoText","keypress .wiki-textarea":"handleKeyPress","keypress .wiki-edit-explanation":"handleKeyPress","keyup .wiki-textarea":"handleTextChanged","focus .wiki-textarea":"focusTextArea","click .edit-button":"makeEditable","click .rate-translation-option":"rateTranslationHandler",
"click .close":"closeSentence","click .report-translator-cheating":"reportTranslatorCheating","click .toggle-machine-translation":"toggleMachineTranslation","input .wiki-textarea":"updateShareCreditDefault",'change input[type="checkbox"][name="share-credit"]':"shareCreditChanged","click .share-credit .question-mark":"toggleShareCreditExplanation","click .dismiss-share-credit-explanation":"hideShareCreditExplanation"},initialize:function(a){this.parent_view=a.parent_view;this.document_model=a.document_model;
this.revisions_model=a.revision_history_model;this.listenTo(this.model,"change:open",this.openOrClose);this.listenTo(this.model,"change:editable change:cur_translation change:user_rating change:num_upvotes change:num_downvotes change:multiple_revisions change:num_sentences_left change:just_finished_article change:reported_cheating change:show_machine_translation",this.render);this.listenTo(this.model,"change:document_vote_sum",this.renderVotes);this.listenTo(this.model,"change:user_rating",this.mirrorUserRating);
this.listenTo(this.revisions_model,"change:multiple_revisions",this.mirrorMultipleRevisions)},render:function(){var a=this.model.toJSON();a.allow_toggle_machine_translation=!a.cur_translation&&!a.is_image_sentence&&a.machine_translation&&"None"!=a.machine_translation;this.$el.html(b.duostache(this.template,a,duo.templates));this.$(".wiki-textarea").toggleClass("error",!0==this.model.get("rejected"));this.$(".error-flag").toggle(!0==this.model.get("rejected"));this.updateElementVisibility();this.sizeTextarea();
a=this.$("#revisions-stream");this.revisions_stream_view=new duo.WikiDocumentSentenceRevisionHistoryView({el:a,model:this.revisions_model,document_model:this.document_model,sentence_model:this.model,parent_view:this});this.revisions_stream_view.render();this.addChildView(this.revisions_stream_view);var c=this;_.defer(function(){c.$("label").inFieldLabels();c.model.get("cur_translation_or_no_need")||c.$(".edit-text-input").focus()});this.$(".coin").hide();a=this.$("#translation-votes-"+this.model.get("index"));
this.model.get("user_rating")&&(this.model.previous("user_rating")?a.show():a.slideDown());return this},openOrClose:function(){var a=!0==this.model.get("open");a&&(this.render(),this.fetchRevisions());this.$el.toggle(a)},shouldShow:function(){return!0==this.model.get("open")&&!(this.parent_view&&this.parent_view.model.get("view_both"))},fetchRevisions:function(){var a=this;this.revisions_model.fetch({success:function(b){a.revisions_stream_view.render()}})},renderVotes:function(){this.$(".sent-trans-vote-count").text(this.model.get("vote_sum"))},
mirrorUserRating:function(){this.revisions_model.set("user_rating",this.model.get("user_rating"))},mirrorMultipleRevisions:function(){this.model.set("multiple_revisions",this.revisions_model.get("multiple_revisions"))},rateTranslationHandler:function(a){a=parseInt(b(a.currentTarget).data("rating"));this.rateTranslation(a)},rateTranslation:function(a){var b=this.model.get("index");if(this.parent_view.checkCanRate(b)){var d=this.$(".rate-translation-option[data-rating="+a+"]"),f=d.hasClass("active");
this.$(".rate-translation-option").removeClass("active");d.toggleClass("active",!f);this.parent_view.rateTranslation(b,a)}},toggleShareCreditExplanation:function(a){this.$(".share-credit-explanation").toggle()},hideShareCreditExplanation:function(a){this.$(".share-credit-explanation").hide()},sizeTextarea:function(){var a=this.$(".wiki-textarea");if(0!=a.size()){var b=a[0].scrollHeight-20;b>a.height()&&a.height(b)}},updateElementVisibility:function(){var a=!0==this.model.get("editable");this.$(".cur-translation").toggle(!a);
this.$(".wiki-textarea-container").toggle(a)},cancelEdit:function(a,c){if(!a||!b(a.currentTarget).attr("disabled")){var d=null,f=this.model.get("rejected");c?d=this.$(".wiki-textarea").val():f=!1;this.$(".edit-button").removeClass("active");this.$(".translation-buttons").hide();var g=!this.model.get("cur_translation_or_no_need");this.model.set({editable:g,user_input:d,rejected:f,pending_user_input:!1});this.model.get("cur_translation_or_no_need")||this.parent_view.switchSentence(-1)}},cancelOpen:function(a){this.parent_view.switchSentence(-1)},
saveEdit:function(){var a=!this.model.get("can_edit");this.saveOrSuggestEdit(a)},saveOrSuggestEdit:function(a){if(!this.$(".save-edit").attr("disabled")){var c=b.trim(this.$(".edit-text-input").val());if(""!=c){var d=b.trim(this.$(".wiki-edit-explanation").val()),f=this.model;if(c!=f.get("cur_translation")||duo.user.id==f.get("user_id")&&d!=f.get("explanation"))if(f.get("cur_translation")||this.parent_view.checkCanTranslate(f.get("index"))){var g=this.$('input[type="checkbox"][name="share-credit"]').is(":checked");
this.$(".save-edit").attr("disabled",!0);this.$(".cancel-edit").attr("disabled",!0);f.set({user_input:c});var h=!a,k=0,l=this,m={};if(h){var n={cur_translation:c,cur_translation_or_no_need:!0,user_id:duo.user.id,username:duo.user.get("username"),user_reputation_tier:l.document_model.get("user_reputation_tier"),user_rating:1,user_approved:!0,user_disapproved:!1,num_upvotes:1,num_downvotes:0,latest_translation_from_self:!0,editable:!1,user_input:null,explanation:d,multiple_revisions:!!f.get("cur_translation"),
user_says_no_need_to_translate:!1,rejected:!1},p=[],q;for(q in n)p.push(q);m=f.multiGet(p);f.get("cur_translation")?f.get("latest_translation_from_self")||(k=l.numPointsForEditing(f.get("num_words"),f.get("cur_translation"),c)):k=f.get("num_points_for_original_translation");f.set(n);l.parent_view.updateNumSentencesDone();l.parent_view.incrementCoinCount(k,null);l.document_model.addTranslator();l.parent_view.updateSelectedSentenceInfo(f.get("index"));l.document_model.trigger("change:selected_sentence_index");
r=new duo.WikiDocumentSentenceRevision;r.set({revision_from_self:!0,text:c,no_diff:!0,username:duo.user.get("username"),user_reputation_tier:l.document_model.get("user_reputation_tier"),date:translate_text("just now"),explanation:d});l.revisions_model.addRevision(r);l.revisions_stream_view.render()}n=function(a){a.rejected?(h&&(delete m.rejected,f.set(m),l.parent_view.updateNumSentencesDone(),l.parent_view.incrementCoinCount(-k,null),l.revisions_model.removeLastRevision()),l.render()):(l.model.set({editable:!1,
rejected:!1,user_input:null,num_responses_pending:l.model.get("num_responses_pending")-1}),l.parent_view.updateNumSentencesDone(),l.parent_view.incrementCoinCount(a.num_points_awarded-k,a.level_event),l.document_model.addTranslator(),l.fetchRevisions())};p=_.extend(this.document_model.mixpanelProperties(),{chars_per_sec:this.parent_view.translation_chars_per_sec});a?this.model.suggestEdit(c,d,n,p):this.model.addRevision(c,d,!1,g,n,p)}}}},numPointsForEditing:function(a,b,d){b=b.split(" ");d=d.split(" ");
for(var f=0,g=0;g<d.length;g++)0>b.indexOf(d[g])&&f++;for(var h=0,g=0;g<b.length;g++)0>d.indexOf(b[g])&&h++;a=Math.min(a,f+h);b=this.document_model.get("num_points_per_word");return Math.ceil(b*a)},clickImageContainsNoText:function(){var a=this;this.model.imageContainsNoText(function(b,d){a.model.set({editable:!1,rejected:!1,user_input:null});a.parent_view.updateNumSentencesDone();a.parent_view.incrementCoinCount(b,d);a.fetchRevisions()})},closeSentence:function(a){this.parent_view.closeSentence()},
handleKeyPress:function(a){13==a.which&&(a.preventDefault(),this.$(".save-edit").attr("disabled")||this.saveEdit());a.stopPropagation();this.updateShareCreditDefault()},updateShareCreditDefault:function(){var a=this.model.get("user_rating");if(!this.user_changed_credit_sharing&&!(1==a||-1==a))if(a=this.model.get("cur_translation")){var b=this.$(".wiki-textarea").val(),b=duo.getEditDistance(a,b);this.$('input[type="checkbox"][name="share-credit"]').prop("checked",b<0.2*a.length)}},shareCreditChanged:function(){this.user_changed_credit_sharing=
!0},handleTextChanged:function(a){this.$(".wiki-textarea").removeClass("error");this.$(".error-flag").hide();this.model.set({pending_user_input:!0,rejected:!1});this.sizeTextarea()},reportTranslatorCheating:function(){var a=this.model.get("user_id"),b=!0==this.model.get("reported_cheating");this.model.reportTranslatorCheating(a,b,this.revisions_model)},toggleMachineTranslation:function(a){this.model.set({show_machine_translation:!this.model.get("show_machine_translation"),user_input:this.$(".wiki-textarea").val()});
this.machine_translation_shown||(duo.track("wiki_translation_show_duobot"),this.machine_translation_shown=!0)},focusTextArea:function(){this.$(".translation-buttons").show()},getToken:function(a){return this.$("#sentence-"+this.model.get("index")+"-token-"+a)},makeEditable:function(){if(!(0<this.model.getDefault("num_responses_pending",0))){this.model.set("editable",!0);this.$(".edit-button").addClass("active");this.$(".wiki-textarea").focus();this.$(".translation-action").hide();if(this.model.get("user_id")==
duo.user.id){var a=this.model.get("explanation");a&&this.$(".wiki-edit-explanation").text(a)}this.user_changed_credit_sharing=!1}}});duo.WikiDocumentSentenceRevisionHistoryView=duo.View.extend({template:duo.templates["wiki-sentence-revisions"],events:{"click .revert":"revert","click #follow-revisions":"followRevisions","click #following-revisions":"unfollowRevisions","click .radio":"radioClick","mouseenter .revision-item":"hoverSentence","mouseleave .revision-item":"unhoverSentence","click .toggle-revisions":"toggleRevisions",
"click .inner":"stopPropagation"},initialize:function(a){this.sentence_model=a.sentence_model;this.document_model=a.document_model;this.parent_view=a.parent_view;this.view_both=a.view_both||!1;this.listenTo(this.sentence_model,"change:reported_cheating",this.render);this.view_both&&this.listenTo(this.sentence_model,"change:show_more change:open",this.render)},render:function(){if(this.shouldShow()){this.closeChildViews();var a=this.model.toJSON();a.view_both=this.view_both;a.show=a.view_both||a.multiple_revisions;
this.$el.html(b.duostache(this.template,a,duo.templates));this.model.get("following")?(this.$("#follow-revisions").hide(),this.$("#following-revisions").show()):(this.$("#following-revisions").hide(),this.$("#follow-revisions").show());for(var a=this.model.get("revisions"),c=0;c<a.length;c++){var d=this.$("#revision-"+c),d=new duo.WikiDocumentSentenceRevisionView({model:a[c],el:d,sentence_model:this.sentence_model,revision_history_model:this.model});d.render();this.addChildView(d)}this.view_both&&
this.parent_view.positionShowMore(this.sentence_model.get("index"));this.$el.show();return this}this.$el.hide()},fetchAndRender:function(){var a=this;this.model.fetch({success:function(){a.render()}})},shouldShow:function(){return!this.view_both||this.sentence_model.get("open")&&this.sentence_model.get("show_more")},hoverSentence:function(a){a=b(a.currentTarget).data("index");for(var c=this.model.get("revisions"),d=c.length,f=0;f<d;f++){var g=c[f];g.get("can_diff_with_earlier")&&(f==a&&f+1<d||f==
a-1&&a==d-1)?g.set({show_diff_with_earlier:!0,show_diff_with_later:!1,no_diff:!1}):g.get("can_diff_with_later")&&(f==a+1||0<f&&f==a&&a==d-1)?g.set({show_diff_with_earlier:!1,show_diff_with_later:!0,no_diff:!1}):g.set({show_diff_with_earlier:!1,show_diff_with_later:!1,no_diff:!0})}},unhoverSentence:function(a){a=this.model.get("revisions");for(var b=0;b<a.length;b++)a[b].set({show_diff_with_earlier:!1,show_diff_with_later:!1,no_diff:!0})},radioClick:function(){!0==this.$('input[type="radio"]:checked').data("first")?
this.$(".revert").attr("disabled","disabled"):this.$(".revert").removeAttr("disabled")},revert:function(a){if("disabled"==this.$(".revert").attr("disabled"))return!1;var c=this;a=b.trim(this.$('input[type="radio"]:checked').val());var d=this.document_model.mixpanelProperties();this.sentence_model.addRevision(a,null,!0,!1,function(a){c.sentence_model.set("editable",!1);c.document_model.addTranslator();if(c.view_both)c.fetchAndRender();else{var b=c.parent_view.parent_view;b.updateNumSentencesDone();
b.incrementCoinCount(a.num_points_awarded,a.level_event);c.parent_view.fetchRevisions()}},d)},followRevisions:function(a){var b=this;this.model.follow(function(a){a&&(b.$("#follow-revisions").hide(),b.$("#following-revisions").show())})},unfollowRevisions:function(a){this.model.unfollow(function(a){a&&(self.$("#following-revisions").hide(),self.$("#follow-revisions").show())})},toggleRevisions:function(a){a=b(a.currentTarget);var c=this.$(".revisions-stream-body");this.model.get("show_revisions")?
(c.slideUp(),a.removeClass("active")):(c.slideDown(),a.addClass("active"));this.model.set("show_revisions",!this.model.get("show_revisions"))},stopPropagation:function(a){a.stopPropagation()}});duo.WikiDocumentSentenceRevisionView=duo.View.extend({events:{"click .report-translator-cheating":"reportTranslatorCheating"},template:duo.templates["wiki-sentence-revision"],initialize:function(a){this.sentence_model=a.sentence_model;this.revision_history_model=a.revision_history_model;this.listenTo(this.model,
"change",this.render)},render:function(){var a=this.model.toJSON();this.$el.html(b.duostache(this.template,a,duo.templates));return this},reportTranslatorCheating:function(a){a.stopPropagation();a=this.model.get("user_id");var b=this.model.get("reported_cheating");this.sentence_model.reportTranslatorCheating(a,b,this.revision_history_model)}})})(window.jQuery);
(function(b){duo.SkillListView=duo.View.extend({id:"app",template:duo.templates["skill-list"],events:{"click .store-button":"switchTab","click .back-home":"switchTab","click .show-tree":"switchTab","click .trophy":"showFinishedModal","click #real-world-practice":"clickRealWorldPractice","click #start-flashcards ":"clickStartFlashcards","click .accept-invite":"acceptInvite","click .reject-invite":"rejectInvite","click .register-delayed":"registerDelayed"},initialize:function(){this.model.bind("change:add_bonus_skill change:learning_language",
this.render,this);this.calendar_data=duo.getCalendar();this.show_home_graph=duo.user.get("week_old_account")&&_.any(this.calendar_data,function(a){return 0<a.points});this.xp_today=_.find(this.calendar_data,function(a){return"current"==a.state}).points},scrollToBonusRow:function(){var a=b("html, body"),c=this.$(".skill-tree-row.bonus-row");a.scrollTop(0);a.animate({scrollTop:c.offset().top-c.height()-200},500)},getLevelTests:function(){var a=[],a=this.model.getSkills();return a=_.filter(a.level_tests,
function(a){return 0<a.attempts})},zeroFill:function(a,b){b-=a.toString().length;return 0<b?Array(b+(/\./.test(a)?2:1)).join("0")+a:a+""},buildSkillGrid:function(){var a=this.model.getSkills(),b=a.skills,d=this.getLevelTests(),f=duo.user.getSkills().max_tree_level,g=_.toArray(b.groupBy(function(a){return a.get("coords_y")}));if(duo.user.get("trial_account")&&duo.user.trialExpired())g.push({register_row:!0,level:duo.user.get("ab_options").web_delayed_wall_experiment?duo.user.getSkills().max_depth_learned+
1:2});else for(var h=0;h<d.length;h++)f=b.filter(function(a){return!a.get("learned")&&a.get("coords_y")<d[h].level}),g.push({test_row:!0,level:d[h].level,level_test:d[h].index,attempts:d[h].attempts,done:d[h].level<=a.max_tree_level,num_unlocks:f.length});g=_.sortBy(g,function(a){return a.test_row||a.register_row?a.level-0.5:a[0].get("coords_y")});for(h=0;h<g.length&&8>h;h++)g[h].fade_in=!0;if(duo.user&&0<duo.user.get("language_data")[duo.user.get("learning_language")].bonus_skills.length&&(b=duo.user.get("language_data")[duo.user.get("learning_language")].bonus_rows,
f=duo.user.get("language_data")[duo.user.get("learning_language")].max_tree_level,b[0]<=f)){f=duo.user.getOwnedBonusSkills();f=f.sort(function(a,b){var c=a.date,d=b.date;return c<d?-1:c>d?1:0});for(h=0;h<b.length;h++){for(var k=b[h]-1,l=f.splice(0,3),m=[],h=0;h<3-l.length;h++)m.push("empty");g.splice(k,0,{bonus_row:!0,filled_slots:l,empty_slots:m})}}this.model.get("num_following");return _.map(g,function(b,c){if(b.bonus_row||b.test_row||b.register_row)return b;var d=b[0].get("coords_y"),f=null;a.no_dep?
(f=_.map(b,function(a){return{column:a.get("coords_x"),row:d}}),f=_.sortBy(f,"column")):f=_.map(_.range(1,4),function(a){return{column:a,row:d}});return{row:d,columns:f}},this)},addOne:function(a){var c=a.get("coords_x"),d=a.get("coords_y"),f=a.get("index"),g=null==this.skills_data?!1:this.skills_data.no_dep;a=new duo.SkillItemView({model:a,el:this.$("#skill-"+c+"-"+d),no_dep:g});b(a.render().el).addClass("skill-"+f)},addOneBonus:function(a){var c=a.get("short"),d=null==this.skills_data?!1:this.skills_data.no_dep;
a=new duo.SkillItemView({model:a,el:this.$("#skill-"+c),no_dep:d});b(a.render().el).addClass("skill-"+c)},render:function(){timing.start("SkillListView.render()");this.delegateEvents();var a=this.skills_data=this.model.getSkills(),c=a.skills,d=null,f=null;a.first_time&&(f=c.find(function(a){return 1==a.get("coords_y")}),d=f.get("title"),f=f.get("url_title"));timing.mark("SkillListView MP1");var g={"es-en":899070,"de-en":899070,"fr-en":899070,"it-en":899070,"pt-en":899070,"en-es":899178,"en-pt":899080,
"en-it":899128,"en-fr":899117};duo.user.has("pending_invites")&&_.each(duo.user.get("pending_invites"),function(a){a.time_string_left=86400<a.seconds_remaining?Math.floor(a.seconds_remaining/86400):Math.floor(a.seconds_remaining/3600);a.days_left=86400<a.seconds_remaining;a.short_list=duo.createShortList(a.inviting_users)});var h=this.model.get("learning_language")+"-"+this.model.get("ui_language"),g=h in g?g[h]:null,h=duo.currUserTimezoneOffset(),h=new Date((new Date(duo.user.get("current_time"))).getTime()+
h),k=new Date(h.getTime());k.setUTCDate(h.getUTCDate()+1);k.setUTCHours(0,0,0,0);h=(new Date(k.getTime())-h)/1E3/60/60;d=_.extend(this.model.toJSON(),a,{in_beta:"beta"==a.direction_status,rows:this.buildSkillGrid(),finished_tree:c.checkFinished(),next_level:a.level+1,show_home_graph:this.show_home_graph,calendar:this.calendar_data,xp_today:this.xp_today,met_goal:duo.user.get("daily_goal")&&this.xp_today>=duo.user.get("daily_goal"),points_remaining:duo.user.get("daily_goal")-this.xp_today,time_remaining:Math.floor(h),
loading_word_count:!("word_count"in this.model.getSkills()),basics_title:d,basics_url:f,ui_english:"en"==this.model.get("ui_language"),tree_change_post:g,total_strength:Math.round(5*a.language_strength),show_sidebar_buttons:a.show_practice||this.model.get("trial_account"),show_flashcards:_.contains(duo.vocab_languages,duo.user.get("ui_language"))&&_.contains(duo.vocab_languages,duo.user.get("learning_language"))&&a.show_practice&&duo.user.get("ab_options").web_home_sidebar_flashcards_button,show_fluency_score:-1<
b.inArray(duo.user.get("ui_language"),["hi","ru","tr","hu"])&&!duo.user.get("trial_account")&&duo.user.get("ab_options").web_show_fluency_score_experiment&&2<duo.user.getSkills().fluency_score});b(this.el).html(b.duostache(this.template,d,duo.templates));this.addChildView((new duo.PersistentNotificationsView({el:this.$("#persistent-notifications"),messages:_.compact(_.map(a.notifications,function(a,b){return a?b:null})),message_data:{language_string:duo.user.get("learning_language_string")}})).render());
duo.user.get("daily_goal")&&this.drawDailyGoal();timing.mark("SkillListView MP2");c.each(this.addOne,this);a.bonus_skills.each(this.addOneBonus,this);timing.mark("SkillListView MP2a");this.model.get("trial_account")||(this.leader_view?(this.$("#ranking").replaceWith(this.leader_view.el),this.leader_view.delegateEvents()):(this.leader_view=new duo.LeaderBoard({model:this.model,el:this.$("#ranking")}),this.leader_view.render()));(new duo.TrialOverlayView({el:this.$(".trial-account-overlay"),type:"profile"})).render();
if(duo.enabled_groups_experiment)if(!this.group_leader_view&&duo.user.get("group")){var l=this;b.getJSON("/api/1/groups/"+duo.user.get("group").id+"/leaderboard",{},function(a){_.each(a.leaderboard_info,function(b){b.xp_today>a.daily_goal&&(b.met_goal=!0)});3600<a.day_seconds_remaining?a.num_hours=Math.floor(a.day_seconds_remaining/3600):a.num_minutes=Math.floor(a.day_seconds_remaining/60);l.group_leader_view=new duo.GroupLeaderboardView({model:l.model,el:l.$(".group-leaderboard"),leaderboard_info:a});
l.group_leader_view.render()})}else duo.user.get("group")&&(this.$(".group-leaderboard").replaceWith(this.group_leader_view.el),this.group_leader_view.delegateEvents());l=this;if(!this.store_view&&duo.user){var m=new duo.StoreInfo;m.fetch({success:function(){l.store_view=new duo.StoreView({model:m,el:l.$("#rupee-store-view"),scroll:l.options.scroll});(l.$("#store-panel").is(":visible")||!l.$(".tree").is(":visible"))&&l.store_view.render()}})}else duo.user&&(this.$("#rupee-store-view").replaceWith(this.store_view.el),
this.store_view.delegateEvents());this.flashcardsModalView?this.flashcardsModalView.setElement(this.$("#flashcards-container")):this.flashcardsModalView=new duo.FlashcardsModalView({el:this.$("#flashcards-container")});timing.mark("SkillListView MP3");timing.mark("SkillListView MP4");"word_count"in this.model.getSkills()||b.getJSON("/vocabularies/size",{user_id:this.model.id,language:this.model.getSkills().language},function(a){l.$("#word-count").text(a.vocab_size.total);l.model.getSkills().word_count=
a.vocab_size.total;mixpanel.register({word_count:a.vocab_size.total})});"undefined"!==typeof gapi&&_.defer(function(){gapi.follow.go(".g-follow")});timing.stop("SkillListView.render()");setTimeout(function(){0==document.body.scrollTop?b(".fade-this-in").css({opacity:0}).each(function(a){b(this).delay(100*a).fadeTo("slow","1")}):b(".fade-this-in").css({opacity:1})},a.first_time?2250:0);_.defer(function(){l.show_home_graph&&l.drawWeeklyProgress(l.calendar_data);duo.topbar.bind("navigate",l.cleanUp,
l)});return this},drawWeeklyProgress:function(a){var b="rtl"==duo.script_direction,d=b?15:45,f=_.pluck(a,"points");a=_.min(f);var g=_.max(f);a=10*Math.floor(a/10);g=Math.max(10*Math.ceil(g/10),5);this.r=Raphael(this.$("#weekly-progress").get(0));this.r.setSize(290,180);var h=this,k=[0,1,2,3,4,5,6];b&&(k=k.reverse());a=this.r.linechart(d,0,230,150,[k,[0,6]],[f,[a,g]],{smooth:!1,colors:["#ffa200","transparent"],symbol:"circle",width:1.25,axis:"0 0 1 1",axisystep:4,axisxstep:6,shade:!0});_.each(a.symbols[0],
function(a,b){f[b]<duo.user.get("daily_goal")&&(a.attr({fill:"#fff","stroke-width":2,stroke:"#ffa200"}),h.$("#hover-helper-"+b).addClass("missed-goal"))});a.shades[0].attr({opacity:0.1});a.lines[0].attr({"stroke-opacity":0.5});a.symbols[0].attr({opacity:0.7});for(g=0;g<a.axis[0].text.items.length;g++)a.axis[0].text.items[g].attr({fill:"#cccac9",y:170,font:'500 15px/20px "museo-sans-rounded", sans-serif'}),a.symbols[0][g].attr({title:"fancy tooltip"}),k=140-a.symbols[0][g].attr("cy"),this.$("#hover-helper-"+
g).css({top:"-"+k+"px"});this.$("#weekly-progress a").tooltip();k=b?255:35;for(g=0;g<a.axis[1].text.items.length;g++){a.axis[1].text.items[g].attr({fill:"#cccac9",x:k,font:'500 15px/20px "museo-sans-rounded", sans-serif'});var l=Math.round(a.axis[1].text.items[g].attrs.y);this.r.path(["M",d,l,"H",230+d]).attr({stroke:"#dedede","stroke-width":2,"stroke-opacity":0.5}).toBack()}a.axis[1].attr({stroke:"transparent"});a.axis[0].attr({stroke:"transparent"});var d=new Date(duo.user.get("current_time")),
m=((new Date(d.getTime()+duo.currUserTimezoneOffset())).getUTCDay()+1)%7;b&&(m=7-m);var n=[translate_text("Su"),translate_text("M"),translate_text("Tu"),translate_text("W"),translate_text("Th"),translate_text("F"),translate_text("Sa")];b&&(n=n.reverse());_.each(a.axis[0].text,function(a,b){a.attr("text",n[m]);m=(m+1)%7})},drawDailyGoal:function(){this.r2=Raphael(this.$("#daily-donut").get(0));this.r2.setSize(150,150);var a;duo.user.get("daily_goal")?0==this.xp_today?(a=[1],this.r2.piechart(75,75,
75,a,{colors:["#e2e2e2"]})):0<duo.user.get("daily_goal")-this.xp_today?(a=[this.xp_today,duo.user.get("daily_goal")-this.xp_today],a=this.r2.piechart(75,75,75,a,{colors:["#fec901","#e2e2e2"]}),a.series[0]&&a.series[0].attr({fill:"60-#ffa200:20-#ffbe32"})):(a=this.r2.piechart(75,75,75,[1],{colors:["#F2E9BE"]}),a.series[0].attr({fill:"60-#fcc34b:20-#fe922e"})):(a=[1],this.r2.piechart(75,75,75,a,{colors:["#e2e2e2"]}),this.$("#daily-donut-text").addClass("no-goal"));this.r2.circle(75,75,65).attr({fill:duo.user.get("daily_goal")&&
0>=duo.user.get("daily_goal")-this.xp_today?"#fff6e6":"#fff",stroke:"#fff"});99<this.xp_today&&this.$("#daily-donut-text .stat-text").css({"font-size":999<this.xp_today?"30px":"35px"})},switchToTab:function(a,b){"store"==a?(b||duo.homeRouter.navigate("/show_store"),this.$("#rupee-store-view").show(),document.body.scrollTop=document.documentElement.scrollTop=0,this.$(".tree").hide(),this.store_view&&this.store_view.render()):(this.$("#rupee-store-view").hide(),this.$(".tree").show(),"bonus-row"==a&&
this.scrollToBonusRow())},switchTab:function(a){if(this.tab=a=b(a.currentTarget).data("tab"))this.switchToTab(a),"store"==a&&duo.track("click store")},showFinishedModal:function(){if(duo.user&&!(this.model.get("id")!=duo.user.id||duo.mobile_web_view)){var a=new duo.SlideSessionAwesomeView({skipToAwesome:!0,model:this.model});a.render();a.$el.appendTo("body").modal({keyboard:!0,backdrop:!0,show:!0}).on("hidden",function(){a.remove()});b("#awesome-modal").modal("show")}},clickRealWorldPractice:function(){this.$("#real-world-practice").hasClass("disabled")||
duo.homeRouter.realWorldPractice()},clickStartFlashcards:function(){duo.user.get("ab_options").web_home_sidebar_flashcards_button&&(duo.vent.bind("closeFlashcardsModal",this.refreshSkillsFromFlashcards,this),this.flashcardsModalView.beginNewFlashcards())},refreshSkillsFromFlashcards:function(){var a=duo.user.getStrengths();duo.user.fetch({success:function(){var c=duo.user.getStrengths(),d=500;b.each(a,function(a,g){var h=Math.round(5*g),k=Math.round(5*c[a]);k!=h&&(setTimeout(function(){var c=b("[data-skill="+
a+"]"),d=b(c).find(".skill-icon"),g=b(d).find(".skill-icon-strength");g.removeClass("strength-"+h);g.addClass("strength-"+k);5==k?b(c).addClass("boost-to-5").delay(500).queue(function(a){b(d).removeClass("red blue green purple").addClass("gold").addClass("bounce");a()}):b(c).addClass("boost-to-"+k)},d),d+=500)})}});duo.vent.unbind("closeFlashcardsModal")},acceptInvite:function(a){a=b(a.currentTarget).closest("li").data("id");duo.Group.acceptInvite(a)},rejectInvite:function(a){a=b(a.currentTarget).closest("li").data("id");
duo.Group.rejectInvite(a)},registerDelayed:function(){duo.vent.trigger("registerDelayed")}});duo.HomeView=duo.SkillListView.extend({template:duo.templates.home,initialize:function(a){duo.SkillListView.prototype.initialize.call(this);this.friends_in_tree=!0}});duo.StoreView=Backbone.View.extend({template:duo.templates["rupee-store"],events:{"click .buy-item":"confirmClick","click .take-test":"takeTest","click .leave-store":"leaveStore"},initialize:function(a){this.listenTo(this.model,"change",this.render)},
render:function(){var a=duo.user.getSkills(),a={wager_day:"rupee_wager"in duo.user.get("inventory")?duo.user.get("inventory").rupee_wager:0,language_string:duo.user.get("learning_language_string"),learning_language:duo.user.get("learning_language"),has_certificates:duo.user.has("certificates")&&duo.user.get("certificates").length,num_rupees:duo.user.get("rupees"),store_bonus_skills:0<this.model.get("bonus_skills").length&&"bonus_rows"in a&&0<a.bonus_rows.length&&a.bonus_rows[0]<=duo.user.getSkills().max_tree_level};
b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),a),duo.templates,!0));(new duo.TrialOverlayView({el:this.$(".trial-account-overlay"),type:"store"})).render();var c=this;_.defer(function(){c.$(".store-row").each(function(){b(this).absoluteTableCell()});c.options.scroll&&_.defer(function(){b("html, body").animate({scrollTop:b("#"+c.options.scroll).offset().top-0.2*b(window).height()},500);c.options.scroll=!1;duo.homeRouter.navigate("/show_store",{replace:!0})})});return this},
confirmClick:function(a){var c=b(a.currentTarget).data("type");b(a.currentTarget).closest("div").siblings(".item-headline").text();var d=b(a.currentTarget).closest("ul").hasClass("bonus-skill-items"),f=d?_.findWhere(this.model.get("bonus_skills"),{name:c}).price:this.model.get("prices")[c];if(f>duo.user.rupees)return alert("you can't afford this item"),!1;var g=this;duo.track("purchase_item",{item_name:c});b.post("/store/purchase_item",{item_name:c,learning_language:duo.user.get("learning_language")},
function(a){var k=duo.user.get("inventory");d||"certification"==c?k[c+"_"+duo.user.get("learning_language")]=a[c]:k[c]=a[c];b("#num-rupees").text(duo.user.get("rupees")-f);a=duo.user.get("rupees");duo.user.set({rupees:a-f},d?void 0:{silent:!0});d?(duo.user.set("add_bonus_skill",!0),duo.homeRouter.navigate("/")):(duo.topbar.render(),duo.topbar.homeTab(),a=g.model.updateStoreInfoForUser(),g.model.set(a));"certification"==c&&_.defer(g.takeTest)})},takeTest:function(){duo.modalAlert({type:"test_confirm",
title:translate_text("Do you want to take the quiz now?"),message_type:"custom_message",message:translate_text("The quiz can take up to 20 minutes and cannot be paused once it begins."),callback:function(){duo.track("request_certificate_exam");Backbone.history.navigate("/certification/"+duo.user.get("learning_language"),!0)}})},leaveStore:function(){duo.homeRouter.navigate("/")}});duo.SkillItemView=Backbone.View.extend({template:duo.templates["skill-item"],initialize:function(a){null!==this.model&&
this.model.bind("change",this.render,this)},render:function(){var a=Math.round(5*this.model.get("strength")),c=_.map(_.range(5),function(b){return{filled:a>b}},this),d=_.filter(c,function(a){return a.filled}).length,f=this.model.get("name").toLowerCase(),g="bonus"==this.model.get("category"),h=0<this.model.get("progress_percent")?Math.round(100*this.model.get("missing_lessons")/(100-this.model.get("progress_percent"))):this.model.get("missing_lessons");duo.user&&(duo.user.get("language_data"),duo.user.get("learning_language"));
g=duo.user&&this.model.get("locked")&&!g||g&&!(f+"_"+duo.user.get("learning_language")in duo.user.get("inventory"))||1<this.model.get("coords_y")&&duo.user.get("trial_account")&&!duo.user.get("ab_options").web_delayed_wall_experiment;duo.user.get("trial_account")&&(duo.user.trialExpired()&&!this.model.get("learned"))&&(g=!0);c={short_name:f,locked:g,strengths:c,perfect_strength:5==a,no_dep:this.no_dep,percent_left:100-this.model.get("progress_percent"),lessons_completed:h-this.model.get("missing_lessons"),
total_lessons:h,skill_strength:d};c["strength_"+d]=!0;duo.user.getSkills().first_time&&1==this.model.get("coords_y")&&(c.hide_first_skill=!0);b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),c),duo.templates));var k=this;!1===c.locked&&this.model.get("missing_lessons")&&_.defer(function(){k.$("#overlay-progress").pie({colors:["#abcdef","#fff"],proportion:1.01});k.$("#overlay-progress path").css({opacity:0.3});k.$("#overlay-progress circle").css({opacity:0});k.$('#overlay-progress path[fill="#abcdef"]').css({opacity:0})});
_.defer(function(){0===document.body.scrollTop&&(8>k.model.get("coords_y")||"bonus"==k.model.get("category")?b(k.el).find(".fade-this-in").css("opacity","0"):b(k.el).find(".fade-this-in").css("opacity","1").removeClass("fade-this-in"))});return this}});duo.LeaderBoard=Backbone.View.extend({template:duo.templates.leaderboard,events:{"click .toggle":"changeRankView"},initialize:function(){this.search_results=[];this.page=1},delegateEvents:function(){Backbone.View.prototype.delegateEvents.call(this);
this.ranking_view&&this.ranking_view.delegateEvents();this.addFriends&&this.addFriends.delegateEvents();this.search_view&&this.search_view.delegateEvents()},render:function(){b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),{fb_friends:_.map(duo.user.fb_friends,function(a){return!duo.user?a:_.extend({},a,{is_being_blocked:duo.user.isBlocking(Number(a.user_id)),is_a_blocker:duo.user.isBlockedBy(Number(a.user_id))})}),invite_fb_friends:"fb"===this.board,
list_friends:"fb"===this.board?duo.user.fb_friends:this.search_results}),duo.templates,!0));"search"===this.board&&this.$("#search-friends").show();duo.user.fb_friends&&this.$("#filter-fb-input").typeahead({source:_.pluck(duo.user.fb_friends,"name"),render:this.renderSearch,lookup:this.typeaheadLookup,data:{view:this}});this.renderSubViews();var a=this;_.defer(function(){a.$("label").inFieldLabels()});return this},renderSubViews:function(){this.ranking_view?(this.$("#points-ranking").replaceWith(this.ranking_view.render().el),
this.ranking_view.delegateEvents()):(this.ranking_view=new duo.LeaderRankingView({model:this.model,el:this.$("#points-ranking")}),this.ranking_view.render());this.addFriends?(this.$("#add-friends").replaceWith(this.addFriends.render().el),this.addFriends.delegateEvents()):(this.addFriends=new duo.AddFriendsView({model:this.model,el:this.$("#add-friends"),parent_view:this}),this.addFriends.render());this.search_view?(this.$("#search-list-results").replaceWith(this.search_view.render().el),this.search_view.delegateEvents()):
(this.search_view=new duo.LeaderSearchView({model:this.model,el:this.$("#search-list-results")}),this.search_view.render())},changeRankView:function(a){a=b(a.currentTarget).data("sort");this.$(".toggle").removeClass("active");this.$("."+a).addClass("active");this.ranking_view.changeSort(a)},typeaheadLookup:function(a){this.query=this.$element.val();return!this.query?(this.options.data.view.$("#fb-friends .list-users li").removeClass("filtered-fb-friend").show(),this):this.search(this.query).hide()},
renderSearch:function(a){var c={};_.each(a,function(a){c[a]=!0});this.options.data.view.$("#fb-friends .list-users li").each(function(a,f){duo.user.fb_friends[a].name in c?b(f).removeClass("filtered-fb-friend"):b(f).addClass("filtered-fb-friend")});this.options.data.view.$("#fb-friends .list-users li").show();this.options.data.view.$(".filtered-fb-friend").hide();return this}});duo.GroupLeaderboardView=duo.LeaderBoard.extend({template:duo.templates["group-leaderboard"],render:function(){b(this.el).html(b.duostache(this.template,
_.extend({},{leaderboard:this.options.leaderboard_info,multiple_boards:this.options.multiple_boards,show_manage:1<this.options.leaderboard_info.num_groups_administered,daily_goal:this.options.leaderboard_info.daily_goal}),duo.templates));return this}});duo.LeaderRankingView=Backbone.View.extend({template:duo.templates["leaderboard-ranking"],initialize:function(){this.model.bind("change",this.render,this);this.min_rank=Math.max(0,this.model.getSkills().points_rank-5);this.max_rank=this.model.getSkills().points_rank+
5;this.sorted_leaderboard=[];this.sort_type="weekly"},render:function(){var a=duo.user.getSkills();this.points_map=a.points_ranking_data_dict;this.all_time_sorting=this.storeRanks(a.all_time_rank,"alltime",this.points_map);var c=this;duo.user.getSkills().points_ranking_data_dict.got_weekly&&!this.weekly_sorting&&(this.sorted_leaderboard=this.weekly_sorting=this.storeRanks(this.points_map.ranked_weekly,"weekly",this.points_map),this.sort_type="weekly");b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),
a,{lazy_avatars:!0,leaderboard_data:this.sorted_leaderboard,ranked_weekly:"weekly"==this.sort_type,ranked_all_time:"alltime"==this.sort_type,ranked_monthly:"monthly"==this.sort_type}),duo.templates));b(this.el).css("position","relative");if(duo.user.getSkills().points_ranking_data_dict.got_weekly)_.delay(_.bind(this.scrollToUser,this),0);else{duo.user.getSkills().points_ranking_data_dict.got_weekly=!0;var a=new Date,d=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);d.setDate(a.getDate()-
6);b.getJSON("/friendships/leaderboard_activity",{unit:"week",start_time:d.toJSON()},function(a){_.each(duo.user.getSkills().points_ranking_data_dict,function(b){b.weekly=a.ranking[b.id]||0});c.weekly_sorting=c.storeRanks(a.user_ids_ranked,"weekly",c.points_map);duo.user.getSkills().points_ranking_data_dict.ranked_weekly=a.user_ids_ranked;c.changeSort("weekly")})}_.defer(function(){0<b("#ranked-users").length&&b("img.lazy").lazyload({container:b("#ranked-users")})});return this},scrollToUser:function(){var a=
this.$(".list-users"),b=this.$el.innerHeight(),d=a.children("li.you");if(d.position()&&(this.weekly_sorting||"alltime"==this.sort_type)){var f=d.position().top;a.scrollTop(f-b/2+d.outerHeight()/2+8)}},storeRanks:function(a,b,d){var f={},g=_.map(a,function(a){f[a]=!0;return d[a]});_.each(this.all_time_sorting,function(a){f[a.id]||g.push(d[a.id])});_.each(g,function(a,d){null!=a&&(a[b+"_rank"]=d+1)});return g},onScroll:function(a){a=this.$("ul").height()-b(this.el).scrollTop();var c=b(this.el).height();
a<c&&this.max_rank<this.model.getSkills().points_ranking_data.length&&(this.max_rank+=10,this.render())},changeSort:function(a){this.sort_type=a;"weekly"==a&&(this.sorted_leaderboard=this.weekly_sorting);"alltime"==a&&(this.sorted_leaderboard=this.all_time_sorting);if("monthly"==a)if(this.monthly_sorting)this.sorted_leaderboard=this.monthly_sorting;else{a=new Date;var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);c.setDate(a.getDate()-30);var d=this;b.getJSON("/friendships/leaderboard_activity",
{unit:"month",start_time:c.toJSON()},function(a){_.each(duo.user.getSkills().points_ranking_data_dict,function(b){0<=a.user_ids_checked.indexOf(b.id)&&(b.monthly=a.ranking[b.id]||0,b.has_monthly=!0)});d.monthly_sorting=d.storeRanks(a.user_ids_ranked,"monthly",d.points_map);d.sorted_leaderboard=d.monthly_sorting;d.render()});return}this.render()}});duo.SkillView=Backbone.View.extend({id:"app",template:duo.templates.skill,events:{"click .practice":"practice"},render:function(){var a=[],c=_.map(this.model.get("path"),
function(b){var c=_.clone(b);if(void 0!==b.strength){var d=Math.round(5*b.strength);c.strengths=_.map(_.range(5),function(a){return{filled:d>a}},this);c.words_list=b.words.join(", ").replace(/(,) <\*sf>(, )?/g,"");c.row=Math.floor((b.index-1)/3);c.row in a?a[c.row].lessons.push(c):a[c.row]={lessons:[c]}}return c},this);if(3>this.model.get("num_lessons")){var d={empty:!0};2>this.model.get("num_lessons")&&a[0].lessons.push(d);a[0].lessons.push(d)}var f=this.model.getActiveLesson(),d=1==this.model.get("strength"),
c={skill_id:this.model.id,render_color:d?"gold":this.model.get("icon_color"),points_to_gain:Math.min(10,this.model.get("left_points")),path:c,rows:a,lessons_completed:f?f.index-1:this.model.get("num_lessons"),lessons_left:f?this.model.get("num_lessons")-f.index+1:0,practice_index:this.model.get("num_lessons")+1,total_strength:Math.round(5*this.model.get("strength")),perfect_strength:d,single_lesson:1==this.model.get("num_lessons")};c["strength_"+c.total_strength]=!0;b(this.el).html(b.duostache(this.template,
_.extend(this.model.toJSON(),c),duo.templates));var g=this;_.defer(function(){f&&(g.$("#overlay-progress").pie({colors:["#abcdef","#fff"],proportion:1.01}),g.$("#overlay-progress path").css({opacity:0.2}),g.$('#overlay-progress path[fill="#abcdef"]').css({opacity:0}),1==f.index&&g.$("#overlay-progress circle").css({opacity:0}))});this.model.has("topic")&&this.model.get("topic");this.model.has("topic")&&this.model.get("topic");this.$(".btn-test-out").target_popover({trigger:"hover",target:this.$(".popover"),
placement:"bottom"});b(this).fixedSidebar();return this},practice:function(){duo.skillRouter.navigate("/skill/"+this.model.get("language")+"/"+this.model.get("url_title")+"/practice",!0)}});duo.PersistentNotificationsView=duo.View.extend({template:duo.templates["persistent-notifications"],events:{"click .persistent-notification .close":"dismissNotification","click .persistent-notification .dismiss":"dismissNotification","click .persistent-notification.net_promoter .feedback-widget>ul>li":"trackNetPromoter",
"click .persistent-notification #get-chrome-app":"getChromeApp"},initialize:function(a){this.messages=_.filter(a.messages,function(a){return duo.user.get("trial_account")||"toefl_study"==a&&!duo.user.get("ab_options").toefl_study_notification_experiment||"chrome_app_ad"==a&&(!window.chrome||!window.chrome.app||window.chrome.app.isInstalled)||"lesson_strength_bar"==a||"new_years_resolution"==a||"duolingo_for_schools"==a?!1:!0});this.current_message=this.getRandomMessage();this.message_data={};a.message_data&&
(this.message_data=a.message_data)},getRandomMessage:function(){return 0<this.messages.length?_.shuffle(this.messages)[0]:null},getHtml:function(a){if(a){var c=_.extend(this.message_data,{message:a});c[a]=!0;return b.duostache(this.template,c,duo.templates)}return""},render:function(){this.$el.html(this.getHtml(this.current_message));this.current_message||this.$el.removeClass("message");return this},dismissNotification:function(){_.contains(this.messages,this.current_message)&&("net_promoter"==this.current_message&&
duo.track("net_promoter",{dismiss:!0}),"chrome_app_ad"==this.current_message&&duo.track("chrome_app_ad",{action:"dismiss"}),duo.user.dismissNotification(this.current_message),this.nextMessage())},nextMessage:function(){if(_.contains(this.messages,this.current_message)){this.messages=_.without(this.messages,this.current_message);var a=this.getRandomMessage();a||this.$el.removeClass("message");this.$el.animate({opacity:0},_.bind(function(){this.current_message=a;this.message_data={};this.$el.html(this.getHtml(a)).css({opacity:""})},
this))}},trackNetPromoter:function(a){a=Number(b(a.target).data("score"));duo.track("net_promoter",{npscore:a,npcategory:9<=a?"promoter":6>=a?"detractor":"passive"});duo.user.dismissNotification("net_promoter");a=this.$(".persistent-notification");a.children(":not(.hidden)").css("visibility","hidden");a.children().removeClass("hidden");_.delay(_.bind(function(){this.nextMessage()},this),400)},getChromeApp:function(a){chrome.webstore.install(void 0,_.bind(function(){duo.track("chrome_app_ad",{action:"success"});
this.nextMessage()},this),function(){duo.track("chrome_app_ad",{action:"abort"})});return!1}});duo.StrengthBarNotificationView=duo.PersistentNotificationsView.extend({template:duo.templates["strength-bar-notification"],events:{"click .dismiss-warning":"dismissNotification"},initialize:function(a){this.messages=_.filter(a.messages,function(a){return"lesson_strength_bar"==a});this.current_message=this.getRandomMessage();this.message_data={};a.message_data&&(this.message_data=a.message_data)},render:function(){b(this.el).html(b.duostache(this.template,
{},duo.templates));return this},dismissNotification:function(){b("#modal-notification").modal("hide");duo.user.dismissNotification(this.current_message)}})})(window.jQuery);
(function(b){duo.SessionElementView=Backbone.View.extend({id:"session-element-container",initialize:function(a){this.session=a.session;_.bindAll(this,"graded");this.session.bind("continue",this.clear,this);this.session.bind("end",this.clear,this)},render:function(){b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:b.need_flash}),duo.templates,!0));return this},clear:function(){},graded:function(a,b){this.session.set({state:"graded"});var d=a.toJSON(),f=this.model.get("type");
d[f]=!0;d.has_discussion="name"!==f&&"select"!==f},skip:function(){this.submit()},submit:function(){},save:function(a){if(!_.contains(["submitted","graded"],this.session.get("state"))){"ready"!==this.session.get("state")&&this.session.set({state:"ready"});a.set({time_taken:this.stopTiming()});this.session.addSolution(a);var b=this;this.session.set({state:"submitted"});a.save(null,{success:this.graded,error:function(){a.set({correct:!0});b.graded(a,null)}})}},addGradedSolution:function(a){this.session.addSolution(a);
this.session.set({state:"submitted"});a.set({time_taken:this.stopTiming()});this.graded(a);var c=this.session.getNumberQuestionsAnswered(),d=this;a.save(null,{success:function(){var f=a.get("num_comments");f&&d.session.getNumberQuestionsAnswered()==c&&b("#discussion-toggle").text(b.duostache("{{#_i}}Discuss sentence{{/_i}} {{#num_comments}}({{num_comments}}){{/num_comments}}",{num_comments:f}))}})},startTiming:function(){var a=new Date;this.startTime=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),
a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())},stopTiming:function(){var a=new Date;this.stopTime=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());return this.stopTime-this.startTime},showBlame:function(){var a=this.session.getSubmittedSolution().toJSON();if("wrong_language"!=a.blame){if(a.blame&&"wrong_word"!=a.blame&&""!=b.trim(a.blame_message)){this.$("#blame-1 .icon-warning").after('<span class="blame-text">'+a.blame_message+
"</span>");try{this.$("#blame-1").anchor({type:"above",margin:15,anchor:b(".red-bold"),container:b("#app")})}catch(c){this.$("#blame-1").anchor({type:"above",margin:15,anchor:b(".line-through"),container:b("#app")})}b("#blame-1").show();setTimeout(function(){b("#blame-1").removeClass("slide-in")},500)}void 0!=a.highlights&&(0<a.highlights.length&&!this.hints_shown)&&(a=_.map(a.highlights,function(a){return a[0]}),b(".translation_source").first().highlight("highlight",a),b(".highlight").css({"font-weight":"bold"}))}},
closeFail:function(){}});duo.ExampleNameElementView=duo.SessionElementView.extend({template:duo.templates["example-name-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.session.bind("render",this.readyContinue,this);this.session.bind("render",this.postRender,this)},readyContinue:function(){var a=this;_.defer(function(){a.session.set({state:"ready"});a.session.addSolution(new duo.SessionElementSolution({session_element:a.model}));a.session.set({state:"submitted"});
a.session.set({state:"graded"})})},postRender:function(){this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("language"),tts_type:"sentence",tts_id:this.model.get("phrase_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()}))},clear:function(){this.session.unbind("render",this.readyContinue);this.session.unbind("render",this.postRender)}});duo.NameElementView=duo.SessionElementView.extend({events:{"keyup #word-input":"change","change #word-input":"change",
"change #article-input":"change","click .choose-article li label":"selectArticle",keypress:"keyCheck"},template:duo.templates["name-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.session.bind("render",this.focusInput,this);this.session.get("answer_feedback")&&this.session.bind("grade",this.graded_,this)},render:function(){var a=this.model.get("articles");if(a)for(var c=[],d=0;d<a.length;d++)c.push({index:d+1,article:a[d]});b(this.el).html(b.duostache(this.template,
_.extend(this.model.toJSON(),{articles_map:c}),duo.templates,!0));null!=a&&1==a.length&&(this.$("#article-input").val(a[0]),this.$("#article-input").attr("disabled","disabled"));this.$("#word-input").vkeyboard({language:this.model.get("language"),placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:!0,caps:!1});this.startTiming();return this},focusInput:function(){this.$("#word-input").focus()},getSubmitData:function(){var a=this.$(".active input").val();return{article:a?
a:"",word:b.trim(this.$("#word-input").val()),session_element:this.model}},submit:function(){this.$("#word-input").attr("disabled","disabled").blur();this.$("#article-input").attr("disabled","disabled").blur();var a=new duo.SessionElementSolution(this.getSubmitData());this.save(a)},skip:function(){this.$("#word-input").attr("disabled","disabled").blur();this.$("#article-input").attr("disabled","disabled").blur();var a=new duo.SessionElementSolution({article:"",word:"",session_element:this.model,skipped:!0});
this.save(a)},isValid:function(){var a=this.getSubmitData();return(null==a.article||null==this.model.get("articles")||0<a.article.length)&&0<a.word.length},renderArticle:function(a,b){return-1!=_.indexOf(this.model.get("articles"),a)?(this.$("#article-input").val(a),this.$("#word-input").val(b),a=a.replace("'","\\'"),this.$(".choose-article label input[value="+a+"]").click(),!0):!1},checkArticle:function(){var a=this.getSubmitData(),c=a.word.indexOf(" ");-1==c&&(c=a.word.indexOf("'"));-1==c&&(c=a.word.length-
1);var d=b.trim(a.word.substring(0,c+1).toLowerCase()),a=b.trim(a.word.substring(c+1).toLowerCase());this.renderArticle(d,a)},change:function(a){(32==a.which||222==a.keyCode)&&this.checkArticle();this.isValid()&&"rendered"===this.session.get("state")?this.session.set({state:"ready"}):!this.isValid()&&"ready"===this.session.get("state")&&this.session.set({state:"rendered"})},graded_:function(){var a=this.$("#word-input").val(),c=this.$(".blue-label.active input").val();this.$("#word-input").replaceWith("<bdi><span id='graded-word-input' class='fake-input input-block listen-input input-lg'></span></bdi>");
this.$("#graded-word-input").text(a);this.$("#article-input").replaceWith("<span id='graded-article-input' class='fake-select'>"+c+"</span>");a=this.session.getSubmittedSolution().toJSON();a.has_solutions=a.correct_solutions&&0<a.correct_solutions.length;var d=null==c?-1:c.length;void 0!=a.highlights&&0<a.highlights.length&&(c="wrong_word"==a.blame||"case_gender"==a.blame||"gender"==a.blame?"line-through":"red-bold",0==a.highlights[0][0][0]&&this.$("#graded-article-input").highlight(c,[[0,d]]),a.highlights=
_.map(a.highlights,function(a){var b=[];b[0]=a[1][0]-d-1;b[1]=a[1][1]-d-1;return b}),this.$("#graded-word-input").highlight(c,a.highlights));b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],a,duo.templates,!0));this.showBlame()},clear:function(){this.session.unbind("render",this.focusInput);this.session.unbind("grade",this.graded_);b(document).unbind(".judge")},selectArticle:function(a){this.$(".choose-article li label").removeClass("active");b(a.currentTarget).addClass("active");
this.isValid()&&"rendered"===this.session.get("state")?this.session.set({state:"ready"}):!this.isValid()&&"ready"===this.session.get("state")&&this.session.set({state:"rendered"})},keyCheck:function(a){switch(a.which){case 49:return a.preventDefault(),a.stopPropagation(),this.$("#option-1").click(),!1;case 50:return a.stopPropagation(),a.preventDefault(),this.$("#option-2").click(),!1;case 51:return a.stopPropagation(),a.preventDefault(),this.$("#option-3").click(),!1}}});duo.SelectElementView=duo.SessionElementView.extend({events:{"click .select-images-list li":"onSelect",
"change .select-images-list input":"onInput","keyup .select-images-list input":"onInput","click .select-images-list input":"onInput"},template:duo.templates["select-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.session.bind("render",this.postRender,this);b(document).bind("keyup.judge.session",_.bind(this.keyCheck,this))},render:function(){var a=_.map(this.model.get("options"),function(a,b){a.number=b+1;return a});b(this.el).html(b.duostache(this.template,
_.extend(this.model.toJSON(),{options:a}),duo.templates));this.startTiming();return this},postRender:function(){this.session.get("tts_enabled")&&_.each(this.model.get("options"),function(a,b){this.$("#speaker-"+a.number).tts({language:this.model.get("language"),tts_type:"sentence",tts_id:a.phrase_id,template:"",visible:!1,autoplay:!1,click:duo.user.shouldAutoPlay()})},this)},onSelect:function(a){"ready"!==this.session.get("state")&&"rendered"!==this.session.get("state")||(a=b(a.currentTarget),this.$(".select-images-list li").removeClass("selected"),
a.addClass("selected"),a.find("input").prop("checked",!0).change())},onInput:function(a){a=b(a.currentTarget);"rendered"===this.session.get("state")&&this.session.set({state:"ready"});this.$("#speaker-"+a.data("number")).click()},submit:function(){this.$(".select-images-list").addClass("deactivated");var a=this.$('input[name="selection"]:checked').val(),a=new duo.SessionElementSolution({value:a,correct:a===this.model.get("phrase"),incorrect:a!==this.model.get("phrase"),correct_solutions:[this.model.get("phrase")],
session_element:this.model});this.logGradedSolution(a)},graded:function(a,b){duo.SessionElementView.prototype.graded.call(this,a,b);this.session.get("answer_feedback")&&_.each(this.model.get("options"),function(b,c){b.phrase===a.get("value")?this.$("#option-"+(c+1)).addClass(a.get("correct")?"correct":"incorrect"):b.phrase===this.model.get("phrase")&&this.$("#option-"+(c+1)).addClass("correct")},this)},skip:function(){_.each(this.model.get("options"),function(a,b){a.phrase===this.model.get("phrase")&&
this.$("#option-"+(b+1)).addClass("correct")},this);var a=new duo.SessionElementSolution({value:"",correct:!1,incorrect:!0,correct_solutions:[this.model.get("phrase")],session_element:this.model,skipped:!0});this.logGradedSolution(a)},keyCheck:function(a){switch(a.which){case 49:case 97:this.$("#option-1").click();break;case 50:case 98:this.$("#option-2").click();break;case 51:case 99:this.$("#option-3").click()}},clear:function(){this.session.unbind("render",this.postRender);b(document).unbind(".judge")},
logGradedSolution:function(a){this.session.addSolution(a);this.session.set({state:"submitted"});a.set({time_taken:this.stopTiming()});this.graded(a);b.post("/log_grading_result",JSON.stringify(a.toJSON()))}});duo.SpeakElementView=duo.SessionElementView.extend({template:duo.templates["speak-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.retries=0;this.ses=new duo.SessionElementSolution({session_element:this.model});this.session.addSolution(this.ses);
this.session.bind("render",this.postRender,this);this.session.bind("micoff",this.turnMicOff,this);duo.updateGrade=_.bind(this.receiveScore,this);duo.onSpeakConnect=_.bind(this.onSpeakConnect,this);b(document).bind("keyup.speak.session",_.bind(this.keyCheck,this))},postRender:function(){var a="en"==this.model.get("source_language")||duo.user.get("ab_options").speak_other_speak_grading_test&&duo.feature_flags.other_speak_grading_experiment;this.session.trigger("loading_recorder");swfobject.embedSWF("/swf/speakRecorder-1-1.swf",
"audio-recorder","300","150","10",duo.cdn+"/swf/expressInstall.swf",{challengeType:"speak",server:a?"rtmp://speech2.duolingo.com/SpeechService":"rtmp://speech.duolingo.com/SpeechService",timeLimit:20,text:this.model.get("stripped_text"),lang:this.model.get("source_language"),userid:duo.user.id,streamID:this.model.get("sound_id"),stopString:translate_text("Stop"),playbackString:translate_text("Play")},{allowScriptAccess:"always",wmode:"transparent"},{id:"audio-recorder",name:"audio-recorder",styleclass:"recorder-object"});
this.model.get("source_language")!==duo.user.get("ui_language")&&(this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()})),this.startTiming())},closeRecorder:function(){swfobject.getObjectById("audio-recorder").disable();swfobject.getObjectById("audio-recorder").showPlayback()},retry:function(){this.changeState("next",!0)},receiveScore:function(a){this.canSubmit()&&
(a>=this.model.get("threshold")?(this.session.set({state:"ready"}),this.closeRecorder(),this.ses.set({correctness:a,correct:!0,incorrect:!1,try_again:!1}),this.save(this.ses)):(this.session.set({state:"ready"}),this.ses.set({correctness:a,incorrect:!0,try_again:!0,odd:!this.ses.get("odd"),heart:"lesson"===this.session.get("type"),skip:"lesson"!==this.session.get("type")}),this.save(this.ses),this.retry()))},onSpeakConnect:function(){this.session.trigger("loaded_recorder")},playbackRecording:function(){try{swfobject.getObjectById("audio-recorder").playBack()}catch(a){}},
keyCheck:function(a){if(13===a.which&&this.canSubmit())try{swfobject.getObjectById("audio-recorder").toggleRecording()}catch(b){}},canSubmit:function(){return _.include(["rendered","ready"],this.session.get("state"))||!this.ses.isDone()},save:function(a){if(!a.get("mic_off")){var c={reverse:!1};c.failed=a.get("incorrect")||!a.get("correct");c.empty=c.failed&&!0===a.get("empty");c.skipped=c.failed&&!0===a.get("skipped");c.retries=this.retries;duo.track("speak_graded",c)}this.retries++;"ready"!==this.session.get("state")&&
this.session.set({state:"ready"});this.ses.get("try_again")?(this.session.set({state:"submitted"}),this.session.set({state:"ready"})):(a.set({time_taken:this.stopTiming()}),this.ses.save(null,{success:this.graded}),this.session.set({state:"submitted"}),b(document).unbind(".speak"))},submit:function(){},skip:function(){try{swfobject.getObjectById("audio-recorder").disable()}catch(a){}this.ses.set({correctness:0,correct:!1,incorrect:!0,try_again:!1,next_time:!0,skipped:!0});this.save(this.ses)},turnMicOff:function(a){var b=
{reverse:"reverse_speak"===this.model.get("type")};duo.track("mic_turned_off",b);this.$("#no-mic-link").css("visibility","hidden");this.session.set({state:"ready"});duo.user.save({microphone:!1});try{swfobject.getObjectById("audio-recorder").disable()}catch(d){}var f=this.session.get("session_elements").indexOf(this.model),b=this.session.get("session_elements").filter(function(a,b){return-1!=a.get("type").indexOf("speak")&&b>f});this.session.get("session_elements").remove(b);this.ses.set({correctness:0,
correct:!0,incorrect:!1,mic_off:!0,message:!1!==a,try_again:!1});this.save(this.ses)},clear:function(){this.session.unbind("render",this.postRender);this.session.unbind("micoff",this.turnMicOff);duo.updateGrade=null;duo.onSpeakConnect=null;b(document).unbind(".speak")},graded:function(a,c){var d=duo.SessionElementView.prototype.graded.call(this,a,c),f=a.toJSON();b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],_.extend(f,{speak_challenge:!0}),duo.templates,!0));return d}});
duo.WebSpeechSpeakElementView=duo.SpeakElementView.extend({events:{"click #no-mic-link":"turnMicOff","click #record-button":"record","click #stop-button":"stop"},initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.retries=0;this.model.set({web_speech:!0});this.ses=new duo.SessionElementSolution({session_element:this.model});this.session.addSolution(this.ses);this.session.bind("render",this.postRender,this);this.session.bind("micoff",this.turnMicOff,this);b(document).bind("keydown.speak.session",
_.bind(this.keyCheck,this));this.num_attempts=0;this.dmp=new diff_match_patch;this.lang=this.model.get("source_language");this.recognition=this.model.recognition;this.recognition.lang=this.model.get("ws_language")||this.lang;duo.mobile_web_view||(this.recognition.continuous=!0,this.recognition.interimResults=!0);var c=this;this.original_text=this.model.get("text");this.processReference();this.recognition.onstart=function(a){console.debug("SR started:",c.lang,c.recognition.lang);c.$("#record-button").addClass("loading")};
this.recognition.onaudiostart=function(a){c.$("#record-button").hide();c.$("#record-button").removeClass("loading");c.$("#record-button").addClass("disabled");c.$("#stop-button").addClass("recording");c.$("#stop-button").show();c.$("#web-speech-solution").html('<span id="record-cursor">...</span>');c.is_recording=!0;c.count_results=0};this.recognition.onaudiostop=function(a){c.$("#stop-button").removeClass("recording")};this.recognition.onresult=function(a){c.new_results=!0;for(var b="",g="",h=a.resultIndex;h<
a.results.length;++h)a.results[h].isFinal?b+=a.results[h][0].transcript+" ":g+=a.results[h][0].transcript+" ";b=duo.normalizeTranscript(c.lang,b);g=duo.normalizeTranscript(c.lang,g);if(c.alignSolution(b,g,!0))c.stop();else{c.renderSolution(!1);var k=c.count_results+1;a=c.getTimeout();c.count_results=k;setTimeout(function(){c.handleTimeout(k)},a)}};this.recognition.onend=function(a){c.is_recording=!1;c.renderSolution(!0);c.$("#stop-button").removeClass("recording");c.$("#stop-button").hide();c.$("#record-button").show();
c.computeScore()}},getTimeout:function(){return 0.95>1*(null==this.solution_text?0:this.solution_text.length)/this.reference.length?5E3:1500},processReference:function(){this.reference=this.model.get("stripped_text").toLowerCase();this.referenceN=duo.normalizeHomophones(this.lang,this.reference);this.reference_words=this.reference.split(/[\s]+/);this.reference_wordsN=this.referenceN.split(/[\s]+/)},handleTimeout:function(a){this.is_recording&&null!=this.solution_text&&this.count_results<=a&&this.stop()},
compareWords:function(a,b){return 0==b.length?0:1-1*duo.getEditDistance(b,a)/b.length},replaceWithReference:function(a,c,d){var f=duo.normalizeHomophones(this.lang,a);a=a.split(/[\s]+/);for(var f=f.split(/[\s]+/),g="",h=0;h<f.length;h++){var k=f[h];if(0!=k.length){for(var l=null,m=0.2,n=0;n<this.reference_wordsN.length;n++){var p=this.reference_wordsN[n],q=this.compareWords(k,p),q=q-0.1*Math.abs(k.length-p.length);c&&(q-=0.1*Math.abs(n-h));q>m&&(m=q,l=n)}0.2<m?g+=this.reference_words[l]+" ":d||(g+=
a[h]+" ")}}return b.trim(g)},alignSolution:function(a,c,d){this.transcript=b.trim(this.transcript+" "+a).toLowerCase();d&&(this.transcript=this.replaceWithReference(this.transcript,!0,!0),c=this.replaceWithReference(c,!1,!1));a=b.trim(this.transcript+" "+c).toLowerCase();c=duo.normalizeHomophones(this.lang,a);c=this.dmp.diff_main(c,this.referenceN);this.dmp.diff_cleanupSemantic(c);d=0==this.dmp.diff_levenshtein(c);var f=0;this.solution_text="";this.solution_sequence=[];for(var g=0;g<c.length;g++){var h=
c[g][0],k=c[g][1];1!=h&&(k=a.slice(f,f+k.length),f+=k.length,-1==h&&0==b.trim(k).length||(this.solution_text+=k,0==this.solution_sequence.length&&(k=k.charAt(0).toUpperCase()+k.slice(1)),this.solution_sequence.push({text:k,correct:0==h})))}d||(d=1.25<1*this.solution_text.length/this.reference.length);return d},renderSolution:function(a){for(var b="",d=0;d<this.solution_sequence.length;d++)var f=this.solution_sequence[d].text,b=b+('<span class="speech-'+(this.solution_sequence[d].correct?"correct":
a?"wrong":"unknown")+'" '),b=b+(">"+f+"</span>");this.$("#web-speech-solution").html(b)},postRender:function(){this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()}));this.startTiming()},record:function(){this.num_attempts++;this.transcript="";this.solution_sequence=[];this.solution_text=null;this.$("#web-speech-solution").html("");this.recognition.start()},
stop:function(){this.$("#stop-button").hide();this.$("#record-button").show();null!=this.recognition&&this.recognition.stop()},computeScore:function(){if(null==this.solution_text)this.receiveScore(0);else{var a=duo.normalizeHomophones(this.lang,this.solution_text),a=1-1*duo.getEditDistance(a,this.referenceN)/this.reference.length;this.receiveScore(a)}},receiveScore:function(a){if(this.canSubmit()){var c=this.model.get("ws_threshold");null==c&&(c=this.model.get("threshold"));a>=c?(this.session.set({state:"ready"}),
this.closeRecorder(),this.ses.set({web_speech:!0,correctness:a,correct:!0,perfect:1<=a,incorrect:!1,try_again:!1}),this.save(this.ses)):(this.session.set({state:"ready"}),this.ses.set({web_speech:!0,correctness:a,incorrect:!0,try_again:!0,empty:null==this.solution_text||0==b.trim(this.solution_text).length,heart:"lesson"===this.session.get("type"),skip:"lesson"!==this.session.get("type")}),this.save(this.ses),this.retry())}},closeRecorder:function(){null!=this.recognition&&(this.recognition.onstart=
null,this.recognition.onaudiostart=null,this.recognition.onend=null,this.recognition.onresult=null,this.recognition.stop(),this.recognition=null)},retry:function(){this.$("#record-button").removeClass("disabled")},keyCheck:function(a){13===a.which&&this.canSubmit()&&(a=this.$("#record-button"),a.is(":visible")&&!a.hasClass("loading")&&!a.hasClass("disabled")?this.record():this.$("#stop-button").is(":visible")&&this.stop());return!0},clear:function(a){this.closeRecorder();this.session.unbind("render",
this.postRender);this.session.unbind("micoff",this.turnMicOff);b(document).unbind(".speak")}});duo.ReverseSpeakElementView=duo.SpeakElementView.extend({template:duo.templates["reverse-speak-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.retries=0;this.ses=new duo.SessionElementSolution({session_element:this.model});this.session.addSolution(this.ses);this.session.bind("render",this.postRender,this);this.session.bind("micoff",this.turnMicOff,this);duo.updateGrade=
_.bind(this.receiveScore,this);duo.updateHeard=_.bind(this.receiveHeard,this);duo.onSpeakConnect=_.bind(this.onSpeakConnect,this);b(document).bind("keyup.speak.session",_.bind(this.keyCheck,this))},postRender:function(){var a=duo.user.get("ab_options").speak_en_reverse_speak_grading_test&&"en"==this.model.get("learning_language")&&duo.feature_flags.en_reverse_speak_grading_experiment;this.session.trigger("loading_recorder");swfobject.embedSWF("/swf/speakRecorder-1-1.swf","audio-recorder","300","150",
"10",duo.cdn+"/swf/expressInstall.swf",{challengeType:"reverse-speak",server:a?"rtmp://speech2.duolingo.com/SpeechService":"rtmp://speech.duolingo.com/SpeechService",timeLimit:20,text:this.model.get("stripped_text"),lang:this.model.get("learning_language"),userid:duo.user.id,streamID:this.model.get("sound_id"),delay:0,stopString:translate_text("Stop"),playbackString:translate_text("Play")},{allowScriptAccess:"always",wmode:"transparent"},{id:"audio-recorder",name:"audio-recorder",styleclass:"recorder-object"});
this.startTiming()},receiveScore:function(a){this.canSubmit()&&this.ses.set({correctness:a})},receiveHeard:function(a){this.canSubmit()&&(null==a&&this.ses.set({correct:!1,incorrect:!0}),this.ses.set({value:a,attempt:this.retries,try_again:2>this.retries}),this.save(this.ses))},save:function(a){"ready"!==this.session.get("state")&&this.session.set({state:"ready"});a.set({time_taken:this.stopTiming()});this.session.set({state:"submitted"});if(!0===a.get("skipped")||null==a.get("value"))this.graded(a,
null);else{var b=this;a.save(null,{success:this.graded,error:function(){a.set({correct:!0});b.graded(a,null)}})}},graded:function(a,c){if(!a.get("mic_off")){var d={reverse:!0};d.failed=a.get("incorrect")||!a.get("correct");d.skipped=d.failed&&!0===a.get("skipped");d.empty=!d.skipped&&(!a.get("value")||0==a.get("value").length);d.retries=this.retries;duo.track("speak_graded",d)}if(a.get("incorrect")&&a.get("try_again"))this.retries++,this.session.set({state:"ready"}),a.unset("incorrect"),a.unset("try_again"),
this.retry();else{this.$(".col-left").removeClass("retry");a.set({next_time:!0===a.get("incorrect"),remove_heart:!0===a.get("skipped"),try_again:!1});this.closeRecorder();b(document).unbind(".speak");var d=duo.SessionElementView.prototype.graded.call(this,a,c),f=a.toJSON();b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],_.extend(f,{speak_challenge:!0,solution_translation:"closest_translation"in f?f.closest_translation:void 0}),duo.templates,!0));return d}},retry:function(){},
closeRecorder:function(){try{swfobject.getObjectById("audio-recorder").disable()}catch(a){}},skip:function(){this.ses.set({correct:!1,incorrect:!0,try_again:!1,skipped:!0});this.save(this.ses)}});duo.WebSpeechReverseSpeakElementView=duo.ReverseSpeakElementView.extend({events:{"click #no-mic-link":"turnMicOff","click #record-button":"record","click #stop-button":"stop"},initialize:function(a){duo.WebSpeechSpeakElementView.prototype.initialize.call(this,a);null==this.model.get("source_language")&&this.model.set({source_language:duo.user.get("ui_language")});
this.lang=this.model.get("learning_language");this.recognition.lang=this.model.get("ws_language")||this.lang;this.retries=0},processReference:function(){for(var a=this.model.get("stripped_text").toLowerCase(),a=a.slice(a.indexOf("|")+1),b=duo.normalizeHomophones(this.lang,a),a=a.split(/[\s|]+/),b=b.split(/[\s|]+/),d={},f=0;f<b.length;f++)d[b[f]]=a[f];this.reference_words=[];this.reference_wordsN=[];for(var g in d)this.reference_wordsN.push(g),this.reference_words.push(d[g])},compareWords:function(a,
b){return duo.WebSpeechSpeakElementView.prototype.compareWords.call(this,a,b)},replaceWithReference:function(a,b,d){return duo.WebSpeechSpeakElementView.prototype.replaceWithReference.call(this,a,b,d)},alignSolution:function(a,c,d){if(null!=this.reference)return duo.WebSpeechSpeakElementView.prototype.alignSolution.call(this,a,c,!1);this.transcript=b.trim(this.transcript+" "+a).toLowerCase();this.transcript=this.replaceWithReference(this.transcript,!1,!0);c=this.replaceWithReference(c,!1,!1);this.solution_text=
this.transcript;0<b.trim(this.transcript).length?(this.transcript=this.transcript.charAt(0).toUpperCase()+this.transcript.slice(1),c=this.transcript+" "+c):c=c.charAt(0).toUpperCase()+c.slice(1);this.solution_sequence=[];this.solution_sequence.push({text:c,correct:!1});return!1},graded:function(a,c){this.reference=a.get("reference");var d=this.original_text.length;null!=this.reference&&(this.referenceN=duo.normalizeHomophones(this.lang,this.reference),this.alignSolution("",""),duo.WebSpeechSpeakElementView.prototype.renderSolution.call(this,
!0),d=duo.normalizeHomophones(this.lang,this.solution_text),d=duo.getEditDistance(d,this.referenceN));a.set({web_speech:!0,perfect:0>=d,empty:null==this.solution_text||0==b.trim(this.solution_text).length});duo.ReverseSpeakElementView.prototype.graded.call(this,a,c)},renderSolution:function(a){duo.WebSpeechSpeakElementView.prototype.renderSolution.call(this,!1)},getTimeout:function(){return 1500},handleTimeout:function(a){duo.WebSpeechSpeakElementView.prototype.handleTimeout.call(this,a)},render:function(){duo.SessionElementView.prototype.render.call(this);
var a={url:this.session.get("hints_url"),templates:duo.templates,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),language_information:this.session.get("language_information"),reverse:!0,highlight_verb_endings:!1};this.$(".hints").hints(a);return this},postRender:function(){this.startTiming()},record:function(){duo.WebSpeechSpeakElementView.prototype.record.call(this)},stop:function(){duo.WebSpeechSpeakElementView.prototype.stop.call(this)},computeScore:function(){this.receiveHeard(this.solution_text)},
closeRecorder:function(){duo.WebSpeechSpeakElementView.prototype.closeRecorder.call(this)},retry:function(){this.reference=null;duo.WebSpeechSpeakElementView.prototype.retry.call(this)},keyCheck:function(a){return duo.WebSpeechSpeakElementView.prototype.keyCheck.call(this,a)},clear:function(a){duo.WebSpeechSpeakElementView.prototype.clear.call(this,a)}});duo.JudgeElementView=duo.SessionElementView.extend({events:{"change input":"mark"},template:duo.templates["judge-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,
a);this.session.bind("render",this.postRender,this);b(document).bind("keyup.judge.session",_.bind(this.keyCheck,this));a=this.model.get("sentences");for(var c=0;c<a.length;c++)a[c].number=c+1},render:function(){duo.SessionElementView.prototype.render.call(this);var a={url:this.session.get("hints_url"),callback:this.hintHover,callback_context:this,templates:duo.templates,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),language_information:this.session.get("language_information"),
reverse:this.model.get("target_language")===this.session.get("language"),highlight_verb_endings:!0};this.$(".hints").hints(a);return this},postRender:function(){this.startTiming();this.model.get("source_language")!==duo.user.get("ui_language")&&this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()}))},mark:function(a){var c=this;a=b(a.currentTarget);
0<this.$("input[type=checkbox]:checked").length?_.defer(function(){c.session.set({state:"ready"})}):_.defer(function(){c.session.set({state:"rendered"})});a.prop("checked")?a.closest(".cb-container-long").addClass("active"):a.closest(".cb-container-long").removeClass("active")},submit:function(){this.$(".dotted-frame").addClass("disabled");this.submitted=!0;var a=this.$("input[type=checkbox]").map(function(){return b(this).is(":checked")?"correct":"incorrect"}).get();this.$("input[type=checkbox]").attr("disabled",
"disabled").blur();this.gradeClientSide()||(a=new duo.SessionElementSolution({session_element:this.model,choices:a}),this.save(a))},gradeClientSide:function(){for(var a=!0,c=this.model.get("sentences"),d=[],f=[],g=[],h=this.$("input[type=checkbox]"),k=0;k<h.length;k++){var l=b(h[k]).is(":checked"),m=c[k].correct;if(void 0===m)return!1;l!=m&&(a=!1);m&&d.push(c[k].sentence);f.push(l?"correct":"incorrect");g.push(m?"correct":"incorrect")}a=new duo.SessionElementSolution({session_element:this.model,choices:f,
correct:a,correct_solutions:d,correct_choices:g,incorrect:!a,choices:f});this.addGradedSolution(a);return!0},skip:function(){var a=this.$(":checked").map(function(){return"skip"}).get();this.$("input[type=checkbox]").attr("disabled","disabled").blur();a=new duo.SessionElementSolution({session_element:this.model,choices:a,skipped:!0});this.save(a)},keyCheck:function(a){if(b("#report-options").is(":visible"))return!0;switch(a.which){case 49:case 97:this.$("#sentence-0").click().change();this.$("input[type=checkbox]").blur();
break;case 50:case 98:this.$("#sentence-1").click().change();this.$("input[type=checkbox]").blur();break;case 51:case 99:this.$("#sentence-2").click().change(),this.$("input[type=checkbox]").blur()}},graded:function(a,c){duo.SessionElementView.prototype.graded.call(this,a,c);this.model.get("target_language");this.session.get("language");a.get("incorrect");var d=a.get("correct_choices"),f=a.get("choices");this.session.get("answer_feedback")&&this.$(".cb-container-long").each(function(a,c){"correct"===
f[a]?b(c).addClass(d[a]):"correct"===d[a]&&b(c).addClass(d[a])})},clear:function(){this.session.unbind("render",this.postRender);b(document).unbind(".judge")}});duo.FormElementView=duo.SessionElementView.extend({events:{"change select":"change","keyup select":"change"},template:duo.templates["form-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.session.bind("render",this.postRender,this)},postRender:function(){this.$("select").first().focus();this.startTiming()},
submit:function(){this.$(".medium").attr("disabled","disabled").blur();if(!this.gradeClientSide()){var a=this.selectedSentence(),a=new duo.SessionElementSolution({session_element:this.model,sentence:a});this.save(a)}},buildSentenceFromOption:function(a){return _.map(this.model.get("tokens"),function(b){return b.word?b.display_value:a}).join("")},selectedSentence:function(){return _.map(this.model.get("tokens"),function(a){return a.word?a.display_value:this.$("select#options_"+a.i).val()}).join(" ")},
gradeClientSide:function(){for(var a=void 0,b=[],d=this.selectedSentence(),f=this.model.get("tokens"),g=0;g<f.length;g++)if(f[g].options)for(var h=this.$("select#options_"+g).val(),k=f[g].options,l=0;l<k.length;l++)if(k[l].display_value==h&&(a=k[l].correct),k[l].correct){var m=this.buildSentenceFromOption(k[l].display_value);b.push(m)}if(void 0===a)return!1;a=new duo.SessionElementSolution({session_element:this.model,sentence:m,correct:a,correct_solutions:b,sentence:d,incorrect:!a});this.addGradedSolution(a);
return!0},graded:function(a,c){duo.SessionElementView.prototype.graded.call(this,a,c);if(this.session.get("answer_feedback")){var d=a.toJSON();d.has_solutions=d.correct_solutions&&0<d.correct_solutions.length;b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],d,duo.templates,!0))}},skip:function(){this.$(".medium").attr("disabled","disabled").blur();var a=new duo.SessionElementSolution({session_element:this.model,sentence:"",skipped:!0});this.save(a)},change:function(a){this.$(".blue-select").addClass("no-focus");
a=b(a.target);a.val()&&(0<a.val().length&&0<a.children(".placeholder").size())&&a.children(".placeholder").remove();0==this.$("select .placeholder").size()&&"rendered"===this.session.get("state")&&this.session.set({state:"ready"})},clear:function(a){this.session.unbind("render",this.postRender)}});duo.ListenElementView=duo.SessionElementView.extend({events:{"keyup #word-input":"change","change #word-input":"change","click #big-speaker":"speakerClick","click .alert-message .close":"closeAlert","click .icon_speaker":"largeClick",
"click .slow-button":"slowClick"},template:duo.templates["listen-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.session.bind("render",this.postRender,this);this.session.bind("retry",this.retry,this);this.session.bind("grade",this.graded_,this)},render:function(){b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:b.need_flash}),duo.templates,!0));this.$("#word-input").vkeyboard({language:this.model.get("language"),placeholder:this.$("#vkeyboard-placeholder"),
toggle_button:this.$("#toggle_vkeyboard"),shown:!0});return this},postRender:function(){if(this.model.get("language")!==duo.user.get("ui_language")){var a=this,b={language:this.model.get("language"),tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,size:"big",slowEnabled:this.session.get("tts_enabled")};duo.mobile_web_view||(this.session.trigger("loading_tts"),b.beginner=this.session.get("beginner")&&this.session.get("tts_enabled"),b.onload=function(){a.session.trigger("loaded_tts")});
this.$("#big-speaker").tts(b);duo.mobile_web_view||this.$("#word-input").focus();this.startTiming()}},graded_:function(){var a=this.session.getSubmittedSolution();if(this.session.get("answer_feedback")||a.get("try_again")){a=this.$("#word-input").val();this.$("#word-input").replaceWith("<bdi><div id='graded-word-input' class='one-line-input fake-input input-block listen-input input-lg'></div></bdi>");this.$("#graded-word-input").text(a);a=this.session.getSubmittedSolution().toJSON();if(void 0!=a.highlights&&
0<a.highlights.length){a.highlights=_.map(a.highlights,function(a){return a[1]});var c="wrong_word"==a.blame||"case_gender"==a.blame||"gender"==a.blame?"line-through":"red-bold";this.$("#graded-word-input").highlight(c,a.highlights)}a.has_solutions=a.correct_solutions&&0<a.correct_solutions.length;b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],a,duo.templates,!0));this.showBlame()}},speakerClick:function(){duo.mobile_web_view||this.$("#word-input").focus()},change:function(){0<
b.trim(this.$("#word-input").val()).length&&"rendered"===this.session.get("state")?this.session.set({state:"ready"}):0===b.trim(this.$("#word-input").val()).length&&"ready"===this.session.get("state")&&this.session.set({state:"rendered"})},submit:function(){var a=b.trim(this.$("#word-input").val());this.$("#word-input").attr("disabled","disabled").blur();if(this.correctWithNoBlame(a))c=new duo.SessionElementSolution({session_element:this.model,value:a,correct:!0}),this.addGradedSolution(c);else{var c=
null;this.ses?(this.ses.set({value:a}),c=this.ses):c=new duo.SessionElementSolution({session_element:this.model,value:a});this.save(c)}},correctWithNoBlame:function(a){var b=this.model.get("text");return this.normalizeForGrading(a)==this.normalizeForGrading(b)},normalizeForGrading:function(a){return a.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ").toLowerCase()},graded:function(a,b){if("wrong_language"===a.get("blame"))a.set({try_again:!0}),this.session.set({state:"ready"}),this.session.set({state:"rendered"}),
a.unset("incorrect"),a.unset("wrong_language"),a.unset("try_again"),this.$("#vkeyboard-placeholder").show(),this.$("#toggle_vkeyboard").show();else return duo.SessionElementView.prototype.graded.call(this,a,b)},save:function(a){if(!("submitted"===this.session.get("state")||"graded"===this.session.get("state"))){this.ses||("ready"!==this.session.get("state")&&this.session.set({state:"ready"}),a.set({time_taken:this.stopTiming()}),this.session.addSolution(a),this.ses=a);var b=this;this.session.set({state:"submitted"});
a.save(null,{success:this.graded,error:function(){a.set({correct:!0});b.graded(a,null)}})}},skip:function(){this.$("#word-input").attr("disabled","disabled").blur();var a=new duo.SessionElementSolution({session_element:this.model,value:"",skipped:!0});this.save(a)},retry:function(){this.$("#word-input").removeAttr("disabled").focus()},clear:function(){this.session.unbind("render",this.postRender);this.session.unbind("grade",this.graded_);this.session.unbind("retry",this.retry)},closeAlert:function(){this.$(".alert-message").remove()},
largeClick:function(){},slowClick:function(){},closeFail:function(){this.postRender()}});duo.TranslateElementView=duo.SessionElementView.extend({events:{"keyup #text-input":"change","change #text-input":"change","click .suggest-edit":"edit","click .cancel-edit":"cancelEdit","click .save-edit":"saveEdit","click .word-tooltip":"hideWordTooltip"},template:duo.templates["translate-element"],initialize:function(a){duo.SessionElementView.prototype.initialize.call(this,a);this.model.set({hovered_words:[],
hovered_lexeme_ids:{}});this.session.bind("render",this.postRender,this);this.session.get("answer_feedback")&&this.session.bind("grade",this.graded_,this);this.session.bind("retry",this.retry,this);this.session.bind("clear",this.postRender,this);this.submitted=!1;this.other_translations_view=a.other_translations_view;this.explanations={};this.new_explanation_ids=[];a=this.session.get("first_translate");var b=this.model.get("explanations");null!=b&&(this.explanations=b);a||(a=this.model.get("new_explanation_ids"),
null!=a&&(this.new_explanation_ids=a))},render:function(){b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{need_flash:b.need_flash,disable_autocorrect:duo.user.get("browser_language")!=this.model.get("target_language")}),duo.templates));this.$input_field=this.$("#text-input");this.startPlugins();return this},startPlugins:function(){var a=this.model.get("target_language"),c=this.model.get("target_language")!=duo.user.get("ui_language"),d="";!b.vkeyboard.hasKeyboard(this.model.get("target_language"))&&
(this.model.get("has_accents")||this.model.get("unknown"))?(a=this.model.get("source_language"),c=!1,d=b.vkeyboard.getAccentedChars(this.model.get("sentence"),this.model.get("source_language"))):b.vkeyboard.hasKeyboard(this.model.get("target_language"))&&(d=b.vkeyboard.getAccentedChars(this.model.get("sentence"),this.model.get("target_language")));this.$input_field.vkeyboard({language:a,placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:c,custom_keys:d});
var a=[],f={},c=null;this.model.has("highlight")&&(this.model.has("unknown_words")&&1===this.model.get("unknown_words").length)&&(a=this.model.get("highlight").slice(0,1));_.each(this.model.get("highlight"),function(a){f[a]="highlighted-new-word"});c=this.session.isTest()?_.extend({},duo.templates,{"hints-token":duo.templates["hints-token-test"]}):duo.templates;0<this.new_explanation_ids.length&&(d=this.session.get("seen_explanations"),this.new_explanation_ids=_.difference(this.new_explanation_ids,
d),this.session.set({seen_explanations:_.union(d,this.new_explanation_ids)}));var g=this,a={url:this.session.get("hints_url"),callback:this.hintHover,callback_context:this,templates:c,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),show_tokens:a,style_mapping:f,render_callback:function(){g.postHintRender()},language_information:this.session.get("language_information"),reverse:this.model.get("target_language")===this.session.get("language"),highlight_verb_endings:this.model.get("known"),
explanations:this.explanations,new_explanation_ids:this.new_explanation_ids,new_words:this.model.get("highlight")};this.$(".hints").hints(a);this.$(".fbox").fancybox({prevEffect:null,nextEffect:null})},graded_:function(){this.other_translations_view&&(this.$("#other-translations").replaceWith(this.other_translations_view.render().el),this.$(".website-images").hide());var a=this.session.getSubmittedSolution(),c=a.toJSON();if(!0!=a.get("hover_trial")){a=this.getVal();this.setVal(this.getVal());a=this.getFakeAreaData(a);
this.$input_field.hide();this.$("#submitted-text").html(b.duostache(duo.templates["fake-textarea"],a,duo.templates,!0));if(void 0!=c.highlights&&0<c.highlights.length){var a=_.map(c.highlights,function(a){return a[1]}),d="wrong_word"==c.blame||"case_gender"==c.blame||"gender"==c.blame?"line-through":"red-bold";this.$("#graded-text-input").highlight(d,a)}c.has_solutions=c.correct_solutions&&0<c.correct_solutions.length;b("#correct-solutions").html(b.duostache(duo.templates["correct-solutions"],c,duo.templates,
!0));this.showBlame()}},hintHover:function(a,c,d,f,g){clearTimeout(this.hover_idle_timer);if(!this.session.isTest()){var h=this.model.get("highlight"),k=this.model.get("known_words"),l=a.toLowerCase(),h=null!=h&&0<=_.indexOf(h,l),m="#new-word",n=null!=this.new_explanation_ids&&null!=this.explanations[c]&&-1!=_.indexOf(this.new_explanation_ids,this.explanations[c].id);n?(h=!0,m="#new-concept",this.$(".word-tooltip").hide()):h?this.$("#multiple-new-words").fadeOut(200):this.$(".word-tooltip").fadeOut(200);
var p=b(d);g=!g;this.session.get("tts_enabled")&&(this.model.get("source_language")!==duo.user.get("ui_language")&&duo.user.shouldAutoPlay())&&("tts"in p.data()?p.trigger("play"):p.tts({language:this.model.get("source_language"),tts_type:"token",tts_id:encodeURIComponent(l),autoplay:g,visible:!1,play_trigger:"play"}));if(!this.submitted){p=b(d);a=l;if(g&&(this.model.get("hovered_words").push(a),(d=this.model.get("kc_surface_forms"))&&a in d))d=d[a],this.model.get("hovered_lexeme_ids")[d]=!0;if(h){var q=
p.find(".word-tooltip");0===q.size()&&(q=b(m).clone(),q.attr("id","#new-word-"+c).appendTo(p.find(".token-wrapper")).anchor({type:"horizontal",anchor:p}),p.css("position","relative"));q.show();p.mouseleave(function(){q.fadeOut(400)});this.session.trigger("hovered",a,f,!0);return n}if(null==k||0<=_.indexOf(k,l)){var s=b("#peek").clone();s.find(".word-tooltip-strength").hide();s.attr("id","#peek-"+c).appendTo(p).anchor({type:"horizontal",anchor:p}).show();p.mouseleave(function(){s.fadeOut(400)}).addClass("peeked-at");
this.session.trigger("hovered",a,f)}}}},hideWordTooltip:function(a){b(a.currentTarget).fadeOut(400)},postRender:function(){duo.mobile_web_view||(this.$input_field.focus(),this.$input_field.autosize());this.model.get("source_language")!==duo.user.get("ui_language")&&(!1===this.model.get("has_tts")?this.$("#big-speaker").hide():this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,
autoplay:duo.user.shouldAutoPlay()})),this.session.get("beginner")&&(this.hover_idle_timer=setTimeout(_.bind(this.showIdleMessage,this),5E3)),this.startTiming())},postHintRender:function(){this.$("#multiple-new-words").appendTo(this.$(".hints-sentence").css("position","relative")).anchor({type:"horizontal",anchor:this.$(".hints-sentence")}).show()},showIdleMessage:function(){this.$("#idle-message").fadeIn()},change:function(a){13==a.which?a.preventDefault():0<b.trim(this.$input_field.val()).length&&
"rendered"===this.session.get("state")?this.session.set({state:"ready"}):0===b.trim(this.$input_field.val()).length&&"ready"===this.session.get("state")&&this.session.set({state:"rendered"})},getVal:function(){return this.$input_field.textInputVal()},setVal:function(a){this.$input_field.val(a).trigger("autosize.resize")},disableTextInput:function(){this.$input_field.attr("disabled","disabled").blur()},enableTextInput:function(){this.$input_field.removeAttr("disabled")},submit:function(){var a=b.trim(this.getVal());
this.disableTextInput();this.save(new duo.SessionElementSolution({session_element:this.model,value:a}))},skip:function(){if("graded"===this.session.get("state"))this.$("#correct-solutions").show();else{this.disableTextInput();var a=this.session.getSubmittedSolution(),a=a?a.get("value"):"";this.setVal(a);this.$(".blame-popover").hide();a=new duo.SessionElementSolution({session_element:this.model,skipped:!0,value:a});this.save(a)}},retry:function(){this.enableTextInput();this.graded_();var a=this;this.$(".fake-input-area").one("click",
function(c){a.$(".fake-input-area").remove();a.$(".blame-popover").fadeOut(600,function(){b(".blame-text").remove()});a.$input_field.show().focus()})},edit:function(){this.$("#graded-text-input").hide();this.$(".save-edit, .cancel-edit").show();this.$input_field.show().focus();this.$input_field.data("orig-val",this.getVal());this.enableTextInput();this.$input_field.focus();return!1},cancelEdit:function(){this.$("#graded-text-input").show();this.$(".save-edit, .cancel-edit").hide();this.$input_field.hide();
this.setVal(this.$input_field.data("orig-val"));return!1},saveEdit:function(){var a=this.getVal(),c=this.getFakeAreaData(a);this.$input_field.hide();this.$(".fake-input-area").replaceWith(b.duostache(duo.templates["fake-textarea"],c,duo.templates));a=new duo.SessionElementSolution({session_element:this.model,value:a});this.session.addSolution(a);a.save();this.$(".suggest-edit").removeAttr("style");return!1},getFakeAreaData:function(a){return{text:a,unknown:this.model.get("unknown")}},closeFail:function(){this.$("#correct-solutions").show()},
clear:function(){this.session.unbind("render",this.postRender);this.session.unbind("grade",this.graded_);this.session.unbind("retry",this.retry);this.session.unbind("clear",this.postRender);this.$(".fake-input-area").unbind()}});duo.StackTranslateElementView=duo.TranslateElementView.extend({template:duo.templates["stack-translate-element"],render:function(){b(this.el).html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.$input_field=this.$("#text-input");this.$input_field.vkeyboard({language:this.model.get("target_language"),
placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:this.model.get("target_language")!=duo.user.get("ui_language")});var a={url:this.session.get("hints_url"),show_hints:1,templates:duo.templates,callback:this.hintHover,callback_context:this,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),manual_hints:this.model.has("manual_hints")?this.model.get("manual_hints"):null};this.$(".hints").hints(a);return this},
hintHover:function(a,b,d){clearTimeout(this.hover_idle_timer);this.submitted||this.session.trigger("hover",a)},change:function(a){0<b.trim(this.getVal()).length&&"rendered"===this.session.get("state")||0===b.trim(this.getVal()).length&&this.session.get("state");duo.TranslateElementView.prototype.change.call(this,a)}});duo.ExtractElementView=duo.StackTranslateElementView.extend({initialize:function(a){duo.StackTranslateElementView.prototype.initialize.call(this,a);this.variable=this.model.get("sentence").match(/\$\$(.+)\$\$/);
this.regexes=_.map(this.model.get("correct_translations"),function(a){return RegExp("^"+a.replace(".","\\.?").replace(/\$\$(.+)\$\$|__(.+)__/g,"(.+?)")+"$","i")})},render:function(){var a={};a[this.variable[0]]={value:"\u00abtype in your "+this.variable[1]+"\u00bb",hint_table:{rows:[{cells:[{colspan:1,hint:"Put your "+this.variable[1]+" here"}]}]},class_name:"extract-token"};b(this.el).html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.$input_field=this.$("#text-input");this.$input_field.vkeyboard({language:this.model.get("target_language"),
placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:this.model.get("target_language")!=duo.user.get("ui_language")});a={url:this.session.get("hints_url"),show_hints:1,templates:duo.templates,specials:a};this.$(".hints").hints(a);return this},postRender:function(){this.$input_field.focus();this.model.get("source_language")!==duo.user.get("ui_language")&&(this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),tts_type:"sentence",
tts_id:this.model.get("tts_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()})),this.startTiming())},tryExtraction:function(){for(var a=b.trim(this.getVal()),c=0;c<this.regexes.length;c++){var d=this.regexes[c].exec(a);if(d)return d[1]}return!1},change:function(){0<b.trim(this.getVal()).length&&"rendered"===this.session.get("state")?this.tryExtraction()&&this.session.set({state:"ready"}):"ready"===this.session.get("state")&&(this.tryExtraction()||this.session.set({state:"rendered"}))},
submit:function(){this.submitted=!0;this.$input_field.attr("disabled","disabled").blur();var a=b.trim(this.getVal()),c="";if("name"===this.variable[1]){var d=this.tryExtraction(),c="Hello "+d+", nice to meet you!";duo.user.set({fullname:d})}else"location"===this.variable[1]&&(d=this.tryExtraction(),c=this.tryExtraction()+" seems like a nice place!",duo.user.set({location:d}));this.ses=new duo.SessionElementSolution({session_element:this.model,value:a,greeting:c});this.save(this.ses)}});duo.TitleElementView=
duo.ExampleNameElementView.extend({render:function(){return this}});duo.HoverElementView=duo.TranslateElementView.extend({template:duo.templates["hover-element"],initialize:function(a){duo.TranslateElementView.prototype.initialize.call(this,a);a=this.model.get("text");var b=this.session.get("context_variables"),d;for(d in b)a=a.replace("$$"+d+"$$",b[d]);this.model.set({text:a});this.notHovered=!0},render:function(){b(this.el).html(b.duostache(this.template,this.model.toJSON(),duo.templates));var a=
this.session.get("context_variables"),c=null;if(this.model.has("manual_hints"))for(var c=this.model.get("manual_hints"),d=0;d<c.length;d++)if(c[d].match){var f=c[d].match(/\$\$(.+)\$\$/);f&&(c[d]=[a[f[1]],a[f[1]]])}a={url:this.session.get("hints_url"),show_hints:1,templates:duo.templates,callback:this.hintHover,callback_context:this,source_language:this.model.get("source_language"),target_language:this.model.get("target_language"),manual_hints:this.model.has("manual_hints")?this.model.get("manual_hints"):
null};this.$(".hints").hints(a);return this},hintHover:function(a,c,d){var f=this;this.notHovered&&_.defer(function(){f.notHovered=!1;f.session.set({state:"ready"});f.session.addSolution(new duo.SessionElementSolution({session_element:f.model,correct:!0,hover_trial:!0}));b("#hover-owl").addClass("peek-from-bottom");setTimeout(function(){b("#bubble-hover").addClass("slide-in-left-right")},1E3);f.session.set({state:"submitted"});f.session.set({state:"graded"});f.session.trigger("hover",a)});b(".owl-standing-big").removeClass("pointing")},
postRender:function(){this.startTiming()}});duo.ContextTranslateElementView=duo.StackTranslateElementView.extend({initialize:function(a){duo.StackTranslateElementView.prototype.initialize.call(this,a);a=this.model.get("text");var b=this.session.get("context_variables"),d;for(d in b)a=a.replace("$$"+d+"$$",b[d]);this.sentence=a;this.regexes=_.map(this.model.get("correct_translations"),function(a){for(var d in b)a=a.replace(".",".?").replace("$$"+d+"$$",b[d]);return RegExp("^"+a+"$","i")})},render:function(){b(this.el).html(b.duostache(this.template,
_.extend(this.model.toJSON(),{sentence:this.sentence}),duo.templates));this.$input_field=this.$("#text-input");this.$input_field.vkeyboard({language:this.model.get("target_language"),placeholder:this.$("#vkeyboard-placeholder"),toggle_button:this.$("#toggle_vkeyboard"),shown:this.model.get("target_language")!=duo.user.get("ui_language")});var a=this.session.get("context_variables"),c=null;if(this.model.has("manual_hints"))for(var c=this.model.get("manual_hints"),d=0;d<c.length;d++)if(c[d].match){var f=
c[d].match(/\$\$(.+)\$\$/);f&&(c[d]=[a[f[1]],a[f[1]]])}a={url:this.session.get("hints_url"),show_hints:1,callback:this.hintHover,callback_context:this,manual_hints:c,templates:duo.templates,source_language:this.model.get("source_language"),target_language:this.model.get("target_language")};this.$(".hints").hints(a);return this},postRender:function(){this.$input_field.focus();this.model.get("source_language")!==duo.user.get("ui_language")&&(this.$("#big-speaker").tts(_.extend(this.model.toJSON(),{language:this.model.get("source_language"),
tts_type:"sentence",tts_id:this.model.get("tts_id"),template:duo.templates.speaker,autoplay:duo.user.shouldAutoPlay()})),this.startTiming())},tryMatch:function(){for(var a=b.trim(this.getVal()),c=0;c<this.regexes.length;c++)if(this.regexes[c].exec(a))return!0;return!1},submit:function(){this.$input_field.attr("disabled","disabled").blur();var a=b.trim(this.$getVal());this.ses=new duo.SessionElementSolution({session_element:this.model,value:a,context_variables:this.session.get("context_variables")});
this.save(this.ses)}});duo.GradeView=Backbone.View.extend({id:"grade",template:duo.templates.grade,events:{},initialize:function(a){this.model.bind("grade",this.graded_,this);this.model.bind("retry",this.graded_,this);this.model.bind("continue",this.next,this);this.data={};this.points_per_correct=a.points;this.extra_time=a.extra_time;this.long_sentence_bonus=a.long_sentence_bonus;this.sentence={}},render:function(){if(!0===this.data.judge){var a=this.data.correct_solutions;this.data.formatted_judge=
'"'+a.slice(0,a.length).join('" and "')+'"'}this.data.session_element&&(this.data.source_language_name=this.getSourceName(this.data.session_element.get("source_language")));this.data.language_name=this.getSourceName(this.data.learning_language);this.data.has_audio=this.data.session_element?this.data.session_element.get("source_language")==this.data.learning_language:!1;this.data.correct_solutions&&1<this.data.correct_solutions.length&&(this.data.solution_string=this.data.correct_solutions.join(", "));
b(this.el).html(b.duostache(this.template,_.extend(this.data,{}),duo.templates,!0));this.hints_shown=!1;if(this.data.session_element&&(this.data.session_element.get("target_language")===this.model.get("language")||this.data.session_element.get("language")===this.model.get("language")))this.hints_shown=!0,a={url:this.model.get("hints_url"),templates:duo.templates,top:10,source_language:this.model.get("language"),target_language:duo.user.get("ui_language"),highlights:this.data.highlights,language_information:this.model.get("language_information")},
this.$(".translation_source").first().hints(a);this.$(".free-write-box").autosize({append:"\n"});this.$("#submit-problem").attr("disabled","disabled");this.$("label").inFieldLabels();return this},highlight:function(){void 0!=this.data.highlights&&(0<this.data.highlights.length&&!this.hints_shown)&&(b(".translation_source").first().highlight("highlight",this.data.highlights),b(".highlight").css({"font-weight":"bold"}))},graded_:function(){var a=this.model.getSubmittedSolution(),c=a.get("session_element"),
d=c.get("type"),f=b.trim(a.getDisplayText()),g=c.get("backoff"),h=c.get("num_correct");this.data=a.toJSON();a.set("backoff",g);a.set("num_correct",h);this.data[d]=!0;this.data.has_solutions=this.data.correct_solutions&&0<this.data.correct_solutions.length;this.data.user_solution=f;void 0!==this.data.highlights&&(this.data.highlights=_.map(this.data.highlights,function(a){return a[0]}),this.data.num_highlights=this.data.highlights.length);this.data.points_per_correct=this.points_per_correct;this.data.extra_time=
1E3*this.model.calculateExtraTime(c);if("score"in this.data){var k=this.data.score;this.data.score_bracket={88:100,71:85,55:65,38:50,21:35,5:15,0:0}[_.find([88,71,55,38,21,5,0],function(a){return k>=a})]}this.data["session_"+this.model.get("type")]=!0;this.data.has_discussion="name"!==d&&"select"!==d;if("judge"===d&&!a.get("correct")){var l=a.get("correct_choices"),a=a.get("choices"),m=0;_.each(a,function(a,b){"correct"===a&&"correct"===l[b]?this.data.judge_one_correct=!0:"correct"===a&&"incorrect"===
l[b]&&m++},this);this.data.judge_one_wrong=1==m;this.data.judge_more_wrong=1<m;this.data.judge_missed=0==m}a=this.model.getSubmittedSolution();!this.model.get("answer_feedback")&&!a.get("try_again")&&this.data.session_element.set("covert",!0);this.render();void 0!=this.data.highlights&&this.highlight()},clear:function(){this.data={};this.render()},next:function(){this.clear()},getSourceName:function(a){return{en:"English",es:"Spanish",pt:"Portuguese",fr:"French",de:"German",it:"Italian"}[a]}});duo.SlideSessionEndView=
Backbone.View.extend({id:"app",className:"slide-session-end",template:duo.templates["slide-session-end"],events:{"click .carousel-dot":"moveCarousel","click .continue":"onContinue","click .end-continue":"onPractice","click .start-translating":"clickStartTranslating","click .show-different-document":"showDifferentDocument","click .external-link":"openExternalLink","hover .scroll-wrap":"showOverflow","click #facebook-post-action:not(.shared)":"postFacebook","change #fb-auto-post":"changeAutoPost","keyup #fb-auto-post":"changeAutoPost",
"click .share":"showShareDropdown","click #show-review-modal":"showReviewModal","click #certify-my-score":"certifyMyScore","click .facebook-share-fluency:not(.shared)":"postFacebook"},initialize:function(a){this.skill_strength=a.skill_strength;b(document).unbind(".session");setTimeout(_.bind(function(){b(document).bind("keyup.session",_.bind(this.keyCheck,this))},this),2E3);this.soundEffectsEnabled=duo.user.playEffects()&&soundManager;this.animated={};this.calendar=duo.getCalendar();this.xp_today=
_.find(this.calendar,function(a){return"current"==a.state}).points;this.show_coach_session_end=duo.user.get("daily_goal")},render:function(){var a={};if(this.model.has("points_data")){var c=this.model.get("points_data");a.level_left_before=c.level_left+this.model.get("gained_skill_points");c=(c.level_progress-this.model.get("gained_skill_points"))/c.level_points;a.level_before_bar_width=Math.max(0,250*c)}null!=this.model.get("words_strengthened")?(_.each(this.model.get("words_strengthened"),function(a){_.extend(a,
duo.wordStrengthData(a.strength))}),a.num_strengthened=this.model.get("num_words_strengthened")||this.model.get("words_strengthened").length,a.num_strengthened=Math.max(a.num_strengthened,this.model.get("words_strengthened").length),a.more_strengthened=a.num_strengthened-this.model.get("words_strengthened").length):(a.num_strengthened=0,a.more_strengthened=0);a.learned=this.model.has("learned_skills")&&this.model.get("learned_skills").length;var c=duo.user.getSkills(),d=a.learned&&c.language==this.model.get("language")&&
c.skills.checkFinished();a.home=a.learned||!this.model.has("skill_id")&&!this.model.has("skill_name")||d;a.index=0<this.model.get("learned_skills").length?this.model.get("learned_skills")[0].index:null;a.num_learned=this.model.get("learned_skills").length;a.num_unlocked=this.model.get("unlocked_skills").length;a.has_hearts=this.model.has("hearts")&&!this.model.isTimed()&&!this.model.get("placement");a.placement_test="placement_test"==this.model.get("type");a.certification_test="certification_test"==
this.model.get("type");a.practice="practice"===this.model.get("type")||"skill_practice"===this.model.get("type")||"words_practice"===this.model.get("type");a.skill_practice="skill_practice"===this.model.get("type");a.word_practice="words_practice"===this.model.get("type");c=parseInt(Math.ceil(this.model.get("num_hearts")));a["hearts-"+c]=!0;a.showing_rupees_screen=this.model.has("new_rupees");a.auto_facebook_post=duo.user.get("auto_facebook_post");a.has_awesome_event=this.model.has("level_event");
a.learned_short_list=duo.createShortList(this.model.get("learned_skills"));a.global_practice="practice"==this.model.get("type");a.old_points_in_level=this.model.get("points_data").level_progress-this.model.get("gained_skill_points");a.old_points=0<a.old_points_in_level?a.old_points_in_level:0;a.delta_strengths=duo.user.get("delta_strengths");a.strengthen=duo.user.has("delta_strengths")&&0<duo.user.get("delta_strengths").length||a.learned;a.big_test=this.model.has("big_test");duo.user.has("delta_strengths")&&
0<duo.user.get("delta_strengths").length&&(a.delta_short_list=duo.createShortList(duo.user.get("delta_strengths")));c=duo.mobile_web_view?1:3;a.max_3_learned_skills=a.learned&&this.model.get("learned_skills").length>c?this.model.get("learned_skills").slice(0,c):this.model.get("learned_skills");a.max_3_strengthened_skills=a.strengthen&&duo.user.has("delta_strengths")&&duo.user.get("delta_strengths").length>c?duo.user.get("delta_strengths").slice(0,c):duo.user.get("delta_strengths");a.show_coach_session_end=
this.show_coach_session_end;a.daily_goal=duo.user.get("daily_goal");a.old_xp_today=this.xp_today-this.model.get("gained_skill_points");a.met_goal=a.old_xp_today>=a.daily_goal;a.just_met_goal=!a.met_goal&&this.xp_today>=duo.user.get("daily_goal");a.streak_extended_today=duo.user.get("streak_extended_today");this.model.get("percentile")&&(duo.user.get("ab_options").web_session_end_par_experiment&&this.model.get("position")&&this.model.get("use_strength")&&duo.in_house_localized)&&(a.num_challenges=
this.model.get("position")?this.model.get("position")+1:void 0,a.min_challenges="Basics-1"==this.model.get("skill_name")&&1==this.model.get("lesson_number")?14:17,a.perfect_lesson=a.num_challenges==a.min_challenges,a.show_par_experiment=!0);duo.user.get("auto_facebook_post")&&a.learned&&this.autoPostFacebook();this.model.get("testcenter_event")&&(!duo.user.get("trial_account")&&2<duo.user.getSkills().fluency_score)&&(a.new_fluency_score=duo.user.getSkills().fluency_score,duo.user.get("ab_options").web_show_fluency_score_experiment&&
-1<b.inArray(duo.user.get("ui_language"),["hi","ru","tr","hu"])?a.show_fluency_score=!0:_.contains("de en es fr it pt hi ru tr hu".split(" "),duo.user.get("ui_language"))&&2<duo.user.getSkills().tc_estimate&&(a.tc_estimate=duo.user.getSkills().tc_estimate,a.show_test_center_ad=!0));var f=this,c={award_index:0};if("certification_test"!=this.model.get("type")&&(a.strengthen&&(c.skill_index=_.size(c)),a.showing_rupees_screen&&(c.lingots_index=_.size(c)),this.model.get("have_document_recommendations")&&
!duo.mobile_web_view&&(c.immersion_index=_.size(c)),this.model.get("testcenter_event")&&(a.show_test_center_ad||a.show_fluency_score)))c.tc_index=_.size(c);_.extend(a,c);a.one_carousel=1==Object.keys(c).length;a.mobile_web_view=duo.mobile_web_view;this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),a),duo.templates,!0));this.$("#share-footer-button").hide();this.$("#end-carousel").carousel({interval:8E3,pause:"false"});this.$("#end-carousel").bind("slide",_.bind(this.onSlide,this));
this.$("#end-carousel").bind("slid",_.bind(this.onSlid,this));duo.user.get("trial_account")&&this.updateTrialCookie();f=this;setTimeout(function(){f.animateSlidePanel("award_slide")},500);_.defer(function(){f.show_coach_session_end&&f.drawDailyGoal();window.twttr&&twttr.widgets&&twttr.widgets.load();"rtl"==duo.script_direction?this.$("#next-level").css({right:"-70px",top:"-80px",width:"140px"}):this.$("#next-level").css({left:"-70px",top:"-80px",width:"140px"});if(f.model.has("level_event")||d)Backbone.history.once("route",
f.showAwesomeEvent,f)});return this},updateTrialCookie:function(){var a=this.model.has("learned_skills")&&0<this.model.get("learned_skills").length&&"lesson"==this.model.get("type");duo.user.get("ab_options").web_delayed_wall_experiment&&a&&duo.setCookie("skill_finished_"+duo.user.get("learning_language"),!0,31536E3)},drawpath:function(a,b,d,f,g){var h=a.path(b).attr({stroke:"none",fill:"none"}),k=a.path(h.getSubpath(0,1)).attr(f),l=h.getTotalLength(h);h.getPointAtLength(0);var m=(new Date).getTime(),
n=setInterval(function(){var a=(new Date).getTime()-m,b=h.getSubpath(0,a/d*l);f.path=b;k.animate(f,50);a>=d&&(clearInterval(n),void 0!=g&&g(),h.remove())},50);return k},plotProgress:function(){var a="rtl"==duo.script_direction,c=a?20:60,d=_.pluck(this.calendar,"points"),f=_.min(d),g=_.max(d),f=10*Math.floor(f/10),g=10*Math.ceil(g/10);this.r=Raphael(b("#progress-line-graph").get(0));var h=[0,1,2,3,4,5,6];a&&(h=h.reverse());progress_chart=this.r.linechart(c,60,225,175,[h,[0,6]],[d,[f,g]],{smooth:!1,
colors:["transparent","transparent"],symbol:"circle",axis:"0 0 1 1",axisystep:4,axisxstep:6,r:2});for(f=0;f<progress_chart.axis[0].text.items.length;f++)progress_chart.axis[0].text.items[f].attr({fill:"#cccac9",y:255,font:'500 15px/20px "museo-sans-rounded", sans-serif'});g=a?270:40;for(f=0;f<progress_chart.axis[1].text.items.length;f++)progress_chart.axis[1].text.items[f].attr({fill:"#cccac9",x:g,font:'500 15px/20px "museo-sans-rounded", sans-serif'}),h=Math.round(progress_chart.axis[1].text.items[f].attrs.y),
this.r.path(["M",c,h,"H",225+c]).attr({stroke:"#dedede","stroke-width":2,"stroke-opacity":this.show_coach_session_end?0.5:1});progress_chart.axis[1].attr({stroke:"transparent"});progress_chart.axis[0].attr({stroke:"transparent"});var c=new Date(duo.user.get("current_time")),k=((new Date(c.getTime()+duo.currUserTimezoneOffset())).getUTCDay()+1)%7;a&&(k=7-k);var l=[translate_text("Su"),translate_text("M"),translate_text("Tu"),translate_text("W"),translate_text("Th"),translate_text("F"),translate_text("Sa")];
a&&(l=l.reverse());_.each(progress_chart.axis[0].text,function(a,b){a.attr("text",l[k]);k=(k+1)%7});var m=progress_chart.lines[0].attr("path"),n=1,p=this,q="M"+m[0][1]+","+m[0][2],s=this.show_coach_session_end?"#ffa200":"#ffc300";p.animateGraph=function(c){if(4E3<Date.now()-c||n>=d.length)clearInterval(p.showDots);else{var f=!1;duo.user.get("daily_goal")&&d[n]<duo.user.get("daily_goal")&&(f=!0);var g={fill:s,r:8,"fill-opacity":1,stroke:"#fff","stroke-width":4,"stroke-opacity":1},h={fill:"#fff",r:4,
"fill-opacity":0.7,stroke:s,"stroke-width":2,"stroke-opacity":0.7},k={fill:s,r:5,"fill-opacity":0.7};c=q+m[n][0]+m[n][1]+","+m[n][2];1==n&&(progress_chart.symbols[0][0].attr({fill:"#fff",stroke:"#fff",r:2}),p.show_coach_session_end?d[0]<duo.user.get("daily_goal")?progress_chart.symbols[0][0].animate(h,900,"bounce"):progress_chart.symbols[0][0].animate(k,900,"bounce"):progress_chart.symbols[0][0].animate(g,900,"bounce"));p.drawpath(p.r,c,200,{stroke:s,"stroke-width":2,"stroke-opacity":0.5,fill:"none",
"fill-opacity":0},function(){progress_chart.symbols[0][n].attr({fill:"#fff",stroke:"#fff",r:2});n==d.length-1?p.show_coach_session_end?f?progress_chart.symbols[0][n].animate(h,900,"bounce"):progress_chart.symbols[0][n].animate(k,900,"bounce"):progress_chart.symbols[0][n].animate(_.extend(g,{r:12}),900,"bounce"):p.show_coach_session_end?f?progress_chart.symbols[0][n].animate(h,900,"bounce"):progress_chart.symbols[0][n].animate(k,900,"bounce"):progress_chart.symbols[0][n].animate(g,900,"bounce");progress_chart.symbols[0][n-
1].toFront();progress_chart.symbols[0][n].toFront();q="M"+m[n][1]+","+m[n][2];n+=1})}n==d.length-1&&setTimeout(function(){p.$(".today-points").text(parseInt(d[d.length-1]));var c=a?progress_chart.symbols[0][d.length-1].attr("cx")+35:progress_chart.symbols[0][d.length-1].attr("cx")-35,f=progress_chart.symbols[0][d.length-1].attr("cy")-90;p.show_coach_session_end&&(f+=10);b("#today-hook").css({left:c+"px",top:f+"px"});p.$("#today-popover").addClass("slide-in")},1E3)}},drawDailyGoal:function(){this.r2=
Raphael(this.$("#daily-donut").get(0));this.r2.setSize(170,170);this.r2.customAttributes.segment=function(a,b,c,h,k){var l=180<k-h;h=h%360*Math.PI/180;k=k%360*Math.PI/180;return{path:[["M",a,b],["l",c*Math.cos(h),c*Math.sin(h)],["A",c,c,0,+l,1,a+c*Math.cos(k),b+c*Math.sin(k)],["z"]]}};if(this.xp_today-this.model.get("gained_skill_points")<duo.user.get("daily_goal")){var a=this.xp_today-this.model.get("gained_skill_points"),b=[a,duo.user.get("daily_goal")-a];0==a&&this.r2.circle(85,85,85).attr({fill:"#e2e2e2",
stroke:"#fff"});total=duo.user.get("daily_goal");start=270;this.paths=this.r2.set();for(i=0;1>=i;i++)size=360/total*b[i],a=this.r2.path(),a.attr({segment:[85,85,85,start,start+size],stroke:"#fff",fill:0==i?"60-#fcc34b:20-#fe922e":"#e2e2e2"}),a.angle=start-size/2,this.paths.push(a),start+=size}else this.r2.circle(85,85,85).attr({fill:"60-#fcc34b:20-#fe922e",stroke:"#fff"});this.r2.circle(85,85,73).attr({fill:"#fff",stroke:"#fff"});999<this.xp_today&&this.$("#daily-donut-text .stat-text").css({"font-size":"35px"})},
animateDailyGoal:function(a){if(a){var c=this.xp_today>=duo.user.get("daily_goal")&&this.xp_today-this.model.get("gained_skill_points")<duo.user.get("daily_goal");newPoints=this.xp_today<duo.user.get("daily_goal")?[this.xp_today,duo.user.get("daily_goal")-this.xp_today]:[99,1];a=newPoints[0]+newPoints[1];start=270;for(i=0;1>=i;i++)size=360/a*newPoints[i],this.paths[i].animate({segment:[85,85,85,start,start+size]},1E3,function(){c&&b(".animate-me").removeClass("hidden")}),this.paths[i].angle=start-
size/2,start+=size}var d=this.xp_today-this.model.get("gained_skill_points"),f=this.xp_today;a=Math.abs(Math.floor(1E3/this.model.get("gained_skill_points")));var g=1;0==a&&(g=Math.floor(this.model.get("gained_skill_points")/250));var h=this.$(".numerator"),k=setInterval(function(){d+=g;h.text(d);d>=f&&clearInterval(k)},a)},showOverflow:function(){b(".scroll-wrap").css({overflow:"visible"});b(".session-end-slider").css({overflow:"visible"})},animateCoins:function(){var a=0;this.$(".animated-pieces").each(function(c,
d){(function(){var c=b(d);setTimeout(function(){c.find("[data-style]").each(function(a,c){b(c).toggleClass("hidden "+b(c).data("style"))})},a)})();a+=500});this.timer_view&&data.seconds_left&&(a+=250,setTimeout(_.bind(function(){this.$("#timer-text").animate({seconds_left:data.seconds_left},{step:function(a,d){b(this).text(b.duostache({name:"seconds-left",tmpl:"{{#format_seconds}}{{seconds_left}}{{/format_seconds}}"},{seconds_left:a},{},!0))},duration:500});this.$("#timer-container").arc({stroke:"#5b9700",
fill:"#7ec200",strokewidth:1,value:0,total:this.timer_view.original_total_time/1E3,width:12}).arc({animate:!0,duration:500,value:Math.min(this.timer_view.original_total_time/1E3,data.seconds_left),total:this.timer_view.original_total_time/1E3})},this),a),a+=500);setTimeout(_.bind(function(){var a=this.$(".session-end-progress .bar").width(),b=this.model.get("points_data").level_left+this.model.get("gained_skill_points"),f=this.model.get("points_data").level_percent*this.$(".session-end-progress").width()/
100-a;this.$(".session-end-progress .bar").animate({manualwidth:f,points:this.model.get("gained_skill_points")},{step:_.bind(function(f,h){"points"===h.prop?this.$("#left-in-level").text(parseInt(b-f)):this.$(".session-end-progress .bar").width(a+f)},this),duration:1E3})},this),a);if(this.model.has("level_event")||this.model.has("learned_skills")&&0<this.model.get("learned_skills").length)Backbone.history.once("route",this.showAwesomeEvent,this)},onSlid:function(a){a=b(".item.active").attr("id");
this.animateSlidePanel(a)},onSlide:function(a){a=b(a.relatedTarget).data("slide");this.$(".carousel-dot").size();this.$(".carousel-dot").removeClass("active");var c=this.$(".carousel-dot:eq("+a+")");0===c.next(".carousel-dot").size()&&!this.carousel_paused&&_.defer(_.bind(function(){this.$(".carousel").carousel("pause");this.carousel_paused=!0},this));c.addClass("active");"skill-slide"==this.$(".item[data-slide="+a+"]").attr("id")?this.$("#share-footer-button").fadeIn(500):this.$("#share-footer-button").fadeOut(500)},
moveToSlide:function(a){this.$(".carousel").carousel("pause");this.$("#end-carousel").carousel(a)},moveCarousel:function(a){var c=b(a.currentTarget).data("slide");b(".scroll-wrap").css({overflow:"hidden"});b(".session-end-slider").css({overflow:"hidden"});this.moveToSlide(c);a.stopPropagation()},keyCheck:function(a){13===a.which&&!b("#review-page").is(":visible")&&this.$(".session-end-footer > .buttons > .continue").click()},maybeShowCreateProfileNag:function(a){duo.user.get("trial_account")&&"welcome"!=
this.model.get("type")?(a=new duo.CreateProfileNagView({callback:a}),b(this.el).replaceWith(a.render().el)):a()},onContinue:function(a){a=b(a.currentTarget);if(this.$("#end-carousel .item:last").hasClass("active")){var c=a.data("href"),d=a.data("r");this.maybeShowCreateProfileNag(function(){window.location.hash==="#"+c||window.location.hash==="#/"+c?this.reloadPage():duo[d+"Router"].navigate(c,!0)})}else this.$(".carousel").carousel("next")},onPractice:function(a){this.maybeShowCreateProfileNag(function(){window.location.reload(!0)})},
showAwesomeEvent:function(){if(this.soundEffectsEnabled){var a=soundManager.levelSound;a&&a.play()}var c=new duo.SlideSessionAwesomeView({model:this.model});c.render();c.$el.appendTo("body").modal({keyboard:!0,backdrop:!0,show:!0}).on("hidden",function(){c.remove()});b("#awesome-modal").modal("show")},clickStartTranslating:function(){var a=this.model.get("recommendations")[0],b=a.translation_id;duo.translationRouter.navigate("/translation/"+b+"$from_skill="+this.model.get("skill_id"),!0);a={skill_name:this.model.get("skill_name"),
skill_id:this.model.get("skill_id"),recommended_document_title:a.document_title,translation_id:b};duo.track("translation_from_session_end",a)},showDifferentDocument:function(){this.model.fetchDocumentRecommendations(function(){self.render()})},openExternalLink:function(a){window.open(b(a.currentTarget).data("href"),"_blank")},animateSlidePanel:function(a){if(!(a in this.animated)){this.animated[a]=!0;var c=this;if("award_slide"==a||void 0==a)if(b(".active h1").removeClass("opacity-0").addClass("slide-in"),
this.soundEffectsEnabled&&soundManager.passedSound&&soundManager.passedSound.play(),"certification_test"!=this.model.get("type")){this.show_coach_session_end?this.$(".daily-goal-container").delay(500).queue(function(){c.$(".daily-goal-container").removeClass("opacity-0").addClass("slide-in")}):this.$("#level-bar").delay(500).queue(function(){c.$("#level-bar").removeClass("opacity-0").addClass("slide-in")});this.$("#progress-line-graph").delay(1E3).queue(function(){c.$("#progress-line-graph").removeClass("opacity-0").addClass("slide-in");
c.plotProgress()});if(this.show_coach_session_end){var d=this.xp_today-this.model.get("gained_skill_points")<duo.user.get("daily_goal");setTimeout(function(){c.animateDailyGoal(d)},1500)}else setTimeout(function(){this.$("#level-bar").hasClass("finished")||(this.$("#level-bar").addClass("finished"),c.animateBar())},1500);setTimeout(function(){var a=Date.now();c.showDots=setInterval(function(){"function"==typeof c.animateGraph?c.animateGraph(a):clearInterval(c.showDots)},250)},2500)}else this.$(".certificate-container").delay(500).queue(function(){c.$(".certificate-container").removeClass("opacity-0").addClass("slide-in")}),
this.$(".store-icon-certification").delay(500).queue(function(){c.$(".store-icon-certification").addClass("bounce")});"review-slide"==a&&setTimeout(function(){c.$(".review-container").show()},250);if("skill-slide"==a){var f=500;b.each(b(".skill-badge-big"),function(){var a=Math.round(5*parseFloat(b(this).data("strength"))),c=this;setTimeout(function(){var d=b(c).find(".skill-icon-strength");d.removeClass("strength-0");d.addClass("strength-"+a);5==a?b(c).addClass("boost-to-5").delay(500).queue(function(a){b(c).find(".skill-icon").removeClass("red blue green purple").addClass("gold").addClass("bounce");
a()}):b(c).addClass("boost-to-"+a)},f);f+=500});this.soundEffectsEnabled&&soundManager.bonusSound&&soundManager.bonusSound.play();0<this.model.get("learned_skills").length&&setTimeout(function(){this.$(".strengthened-message").removeClass("opacity-0").addClass("slide-in")},f+=1E3);if(0==this.model.get("learned_skills").length){var g=f+500*b(".skill-badge-big").length;setTimeout(function(){c.$(".strengthened-message").removeClass("opacity-0").addClass("slide-in")},g)}}"lingot-slide"==a&&(setTimeout(function(){this.$(".lingot-bill-cell").removeClass("opacity-0").addClass("slide-in")},
500),setTimeout(function(){this.$(".icon-lingot-medium").addClass("bounce")},1E3));"translation-slide"==a&&(setTimeout(function(){this.$(".immersion-card").removeClass("opacity-0").addClass("slide-in")},500),setTimeout(function(){this.$(".start-translating").addClass("bounce")},1E3));"test-center-slide"==a&&setTimeout(function(){this.$(".icon-fluency-score").addClass("bounce")},500)}},animateBar:function(){var a=this.$(".session-end-progress .bar").width(),b=Math.max(this.model.get("points_data").level_progress-
this.model.get("gained_skill_points"),0),d=this.model.get("points_data").level_percent*this.$(".session-end-progress").width()/100-a,f=0<b?this.model.get("gained_skill_points"):this.model.get("points_data").level_progress;this.$(".session-end-progress .bar").animate({manualwidth:d,points:f},{step:_.bind(function(d,f){"points"===f.prop?this.$("#level_points").text(parseInt(b+d)):this.$(".session-end-progress .bar").width(a+d)},this),duration:1E3})},postFacebook:function(a){var c=b(a.currentTarget).hasClass("share-skills");
if(window.FB){var d=this;duo.track("facebook share click");FB.login(function(a){a.authResponse&&(c?d.postToFacebook(a.authResponse):d.postFluencytoFacebook(a.authResponse),duo.user.get("facebook_id")||(a=a.authResponse.userID,b.post("/facebook_connect",{facebook_id:a,facebook_friends:"[]",auto_follow:!1}),duo.user.set({facebook_id:a})))},{scope:"publish_actions"})}},autoPostFacebook:function(){window.FB&&FB.getAuthResponse()&&(duo.track("facebook auto post"),this.postToFacebook())},postToFacebook:function(){this.$("#facebook-post-action").addClass("shared").text(this.$("#facebook-post-action").data("shared"));
this.$("#facebook-post-action").attr("disabled","disabled");var a=duo.debug?"skill_debug":"skill";_.each(this.model.get("learned_skills"),function(b){duo.postFacebookAction(duo.fb_app,"learn",{skill:"http://www.duolingo.com/og/"+a+"/"+b.id,"fb:explicitly_shared":!0})});duo.track("facebook shared")},postFluencytoFacebook:function(){this.$(".facebook-share-fluency, .icon-facebook-box").addClass("shared");var a={fluency_score:"http://www.duolingo.com/og/"+(duo.debug?"fluency_debug":"fluency")+"/"+this.model.get("language")+
"/"+duo.user.getSkills().fluency_score,"fb:explicitly_shared":!0};duo.postFacebookAction(duo.fb_app,"improve",a);duo.track("fluency facebook shared")},changeAutoPost:function(){var a=this.$("#fb-auto-post").is(":checked");duo.track("toggle auto post",{new_value:a});a&&this.$("#facebook-post-action").click();duo.user.save({auto_facebook_post:a})},showShareDropdown:function(){this.$(".dropdown-menu").toggle();this.$(".carousel").carousel("pause")},showReviewModal:function(){this.$(".carousel").carousel("pause");
this.review_modal?b("body > #review-modal").modal("show"):(this.$("#review-modal").appendTo("body").modal({keyboard:!0,backdrop:!0,show:!0}),this.review_modal=new duo.ReviewModalView({el:b("body > #review-modal"),model:this.model}),this.review_modal.render());Backbone.history.once("route",this.cleanUp,this)},certifyMyScore:function(){console.log("certify");window.open("https://testcenter.duolingo.com/","_blank")},cleanUp:function(){this.review_modal.remove()}});duo.CreateProfileNagView=Backbone.View.extend({id:"app",
className:"create-profile-nag",template:duo.templates["create-profile-nag"],events:{"click .create":"createProfile","click .later":"callCallback","click .discard":"discard"},initialize:function(a){this._callback=a.callback},render:function(){this.$el.html(b.duostache(this.template,{ultimatum:duo.user.trialExpired()},duo.templates),!0);return this},createProfile:function(){duo.vent.trigger("registerDelayed")},callCallback:function(){this._callback()},discard:function(){duo.logout()}});duo.ReviewModalView=
Backbone.View.extend({template:duo.templates.review_page,events:{"click .challenge":"showReviewPopover","click .speaker-medium":"stopPropagation","click .popover":"stopPropagation","click .close":"closeReviewPopover"},render:function(){this.num_per_row=4;data=this.formatReviewData();b(this.el).html(b.duostache(this.template,data,duo.templates,!0));var a=this;_.defer(function(){"certification_test"!=a.model.get("type")&&(new diff_match_patch,_.each(data.review_data,function(c,d){if(c.user_response&&
c.correct_solution&&!c.judge_challenge){var f=/[\.,-\/#?!$%\^&\*;:{}=\-_`~()]/g,g=c.correct_solution.replace(f,"").replace(/\s{2,}/g," ").toLowerCase(),f=c.user_response.replace(f,"").replace(/\s{2,}/g," ").toLowerCase(),g=duo.wordHighlightDiff(g,f);_.each(g,function(a){if(0!=a[0]){var c=-1==a[0]?"correct_solution":"user_response",f=a[1].length,g=b("#"+c+"_"+d).text().toLowerCase().indexOf(a[1].toLowerCase());if(-1<g){var h=b("#"+c+"_"+d).text().substring(g,g+f);b("#"+c+"_"+d+':contains("'+h+'")').html(function(b,
c){return c.replace(h,'<span class="'+(-1==a[0]?"correct_highlight":"highlight")+'">'+h+"</span>")})}}})}var h=c.tts_id;_.defer(function(){a.$(".listen-"+d).tts({language:a.model.get("language"),tts_type:"sentence",tts_id:h,template:duo.templates.speaker,visible:!0,autoplay:!1,click:!0,size:"medium"})})}))});return this},formatReviewData:function(){var a=[],b=this.model.get("session_element_solutions"),d=this;_.each(b,function(f,g){var h=f[0],k=h.get("session_element"),l={};l.type=h.get("type");l.prompt=
k.get("sentence")?k.get("sentence"):k.get("hint");l.user_response=h.get("value")?h.get("value"):h.get("article")+" "+h.get("word");!h.get("value")&&!h.get("word")&&(l.user_response=h.get("sentence"));if("form"==l.type){l.prompt="";_.each(k.get("tokens"),function(a){l.prompt+=a.word?a.display_value:"___"});var m=l.user_response;l.user_response=m.slice(0,m.length-2)+"."}l.correct=h.get("correct");if("speak"==l.type||"reverse_speak"==l.type)h.get("mic_off")&&(l.mic_off=!0),l.prompt=k.get("text"),l.correct_solution=
k.get("text"),"reverse_speak"==l.type&&(h.get("closest_translation")?l.correct_solution=h.get("closest_translation"):(m=k.get("stripped_text"),m=m.split("|")[1],l.correct_solution=m.charAt(0).toUpperCase()+m.slice(1)));else if(h.get("correct_solutions")||h.get("closest_translation"))l.correct_solution=h.get("closest_translation")?h.get("closest_translation"):h.get("correct_solutions")[0];if("judge"==h.get("type")){var n=[],p=[];_.each(k.get("sentences"),function(a,b){"correct"==h.get("choices")[b]&&
n.push({sentence:a.sentence,incorrect:"incorrect"==h.get("correct_choices")[b]});"correct"==h.get("correct_choices")[b]&&p.push({sentence:a.sentence,missed:"correct"!=h.get("choices")[b]})});l.user_response=n;l.correct_solution=p;l.prompt=k.get("text")}l.highlights=h.get("highlights");l.blame=h.get("blame");l[h.get("type")+"_challenge"]=!0;l[h.get("type")]=!0;if("reverse_speak"==h.get("type")||"speak"==h.get("type"))l.speak=!0;h.get("skipped")&&(l.skipped=!0);l.num_comments=h.get("num_comments");
l.tts_id=k.get("tts_id");l.index=g;b.length>d.num_per_row-1&&(1==(g+1)%d.num_per_row?l.left_align=!0:0==(g+1)%d.num_per_row&&(l.right_align=!0));if(g>d.num_per_row-1&&b.length-(b.length%d.num_per_row?b.length%d.num_per_row:d.num_per_row)<=g)g>2*d.num_per_row-1?l.last_row=!0:l.alt_last=!0;l.row=Math.floor(g/d.num_per_row);a.push(l)});return{review_data:a}},showReviewPopover:function(a){this.$(".carousel").carousel("pause");var c=b(a.currentTarget).find(".popover"),d=c.parent().data("index");if(b(a.currentTarget).parents(".popover, .speaker-container").length)return!1;
if(c.is(":visible"))this.closeReviewPopover(void 0,d);else{var f=this.$("#review-page .popover:visible").not(c).closest(".challenge").data("index"),g=this.$("#review-page .popover:visible").not(c).closest(".challenge").data("last"),d=2<=Math.ceil(f/this.num_per_row)-Math.ceil(d/this.num_per_row);void 0!=f&&(g&&c.parent().data("last")||d?(this.$("#review-page .popover").not(c).hide(),g&&!c.parent().data("last")&&this.$(".footer-owl").hide()):this.closeReviewPopover(void 0,f));c.fadeIn();f=this.$(".review-container");
c.parent().data("last")&&this.$(".footer-owl").show();a=c.closest(".challenge").position().top-(0==b(a.currentTarget).data("row")?0:110);0!=a&&f.animate({scrollTop:f.scrollTop()+a},"slow")}},closeReviewPopover:function(a,c){void 0==c&&(c=b(a.currentTarget).closest(".challenge").data("index"));var d=this.$('.challenge[data-index="'+c+'"]').find(".popover");if(d.parent().data("last")||d.parent().data("alt-last")){var f=this;this.$(".review-container").animate({scrollTop:b(".review-container").scrollTop()+
f.$('.challenge[data-index="'+(c-f.num_per_row)+'"]').position().top-110},"slow",function(){f.$(".footer-owl").hide()});d.fadeOut("slow")}else d.fadeOut()},stopPropagation:function(a){var c=b(a.currentTarget);if(c.hasClass("speaker-medium")){var c=c.closest(".challenge").data("index"),d=this.$("#review-page .popover:visible").closest(".challenge").data("index");d&&c!=d&&this.closeReviewPopover(void 0,d)}a.stopPropagation();return!1}});duo.SlideSessionAwesomeView=Backbone.View.extend({id:"awesome-modal",
template:duo.templates["awesome-modal"],className:"hidden",events:{"click .continue":"hideModal","click #facebook-post-action:not(.shared)":"postFacebook","change #fb-auto-post":"changeAutoPost","keyup #fb-auto-post":"changeAutoPost","click .share":"showShareDropdown"},initialize:function(a){!0==a.skipToAwesome?this.skipToAwesome=!0:(this.skipToAwesome=!1,this.model.bind("change",this.render,this))},render:function(){_.defer(function(){window.twttr&&twttr.widgets&&twttr.widgets.load()});if(!1==this.skipToAwesome){var a=
duo.user.getSkills().skills;this.model.set({finished_tree:this.model.has("learned_skills")&&this.model.get("learned_skills").length&&a.checkFinished()},{silent:!0});b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{num_unlocked:this.model.has("unlocked_skills")?this.model.get("unlocked_skills").length:null,learned:this.model.has("learned_skills")&&this.model.get("learned_skills").length,index:this.model.get("learned_skills")&&0<this.model.get("learned_skills").length?this.model.get("learned_skills")[0].index:
null,auto_facebook_post:duo.user.get("auto_facebook_post"),learned_short_list:duo.createShortList(this.model.get("learned_skills")),unlocked_short_list:duo.createShortList(this.model.get("unlocked_skills"))}),duo.templates,!0));duo.user.get("auto_facebook_post")&&this.autoPostFacebook()}else this.model.set({finished_tree:!0},{silent:!0}),b(this.el).html(b.duostache(this.template,{finished_tree:!0,ui_language:this.model.get("ui_language"),language:this.model.get("learning_language"),language_string:this.model.get("learning_language_string")},
duo.templates,!0))},hideModal:function(){this.$el.modal("hide");this.remove()},postFacebook:function(){if(window.FB){var a=this;duo.track("facebook share click");FB.login(function(c){c.authResponse&&(a.postToFacebook(c.authResponse),duo.user.get("facebook_id")||(c=c.authResponse.userID,b.post("/facebook_connect",{facebook_id:c,facebook_friends:"[]",auto_follow:!1}),duo.user.set({facebook_id:c})))},{scope:"publish_actions"})}},autoPostFacebook:function(){window.FB&&FB.getAuthResponse()&&(duo.track("facebook auto post"),
this.postToFacebook())},postToFacebook:function(){this.$("#facebook-post-action").addClass("shared").text(this.$("#facebook-post-action").data("shared")).attr("disabled","disabled");if(this.model.get("finished_tree")){var a=duo.debug?"og_debug":"og",b=this.model.get("language")||this.model.get("learning_language"),a={language:"http://www.duolingo.com/"+a+"/"+b,"fb:explicitly_shared":!0};duo.postFacebookAction(duo.fb_app,"conquer",a)}else this.model.has("level_event")&&(a=duo.debug?"og_debug":"og",
a={level:"http://www.duolingo.com/"+a+"/"+this.model.get("language")+"/"+this.model.get("level_event").new_level,"fb:explicitly_shared":!0},duo.postFacebookAction(duo.fb_app,"reach",a));duo.track("facebook shared")},changeAutoPost:function(){var a=this.$("#fb-auto-post").is(":checked");duo.track("toggle auto post",{new_value:a});a&&this.$("#facebook-post-action").click();duo.user.save({auto_facebook_post:a})},showShareDropdown:function(){this.$(".dropdown-menu").toggle()}});duo.SessionFailedView=
Backbone.View.extend({id:"app",events:{"click #retry-button":"retry","click #home-button":"goToHome","click #home-button-reload":"goToHomeWithReload","click .close-fail":"closeFail","click #show-report-options":"reportProblem","click #discussion-toggle":"displayDiscussion","click #too-difficult":"tooDifficult","click #too-easy":"tooEasy","click #submit-suggestion":"sendSuggestionMessage","click #cancel-report":"cancelSuggestion","click #submit-problem":"submitProblem","focus .free-write-box":"checkFreeWrite",
"click input[type=checkbox]":"checkSubmit"},template:duo.templates["session-failed"],initialize:function(a){this.appClasses=a.appClasses;this.progress_view=a.progress_view;this.hearts_view=a.hearts_view;this.explanation_view=a.explanation_view;this.grade_view=a.grade_view;this.elementView=a.elementView;this.loading_comments=!1;this.used_refill=a.used_refill;b(document).unbind(".session").bind("keyup.session",_.bind(this.keyCheck,this));this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},
render:function(){var a={};a["learning_"+this.model.get("language")]=!0;b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{session_failed:!0,language_vars:a,lingots:duo.user.get("rupees")}),duo.templates));"undefined"!==typeof this.progress_view&&this.$("#progress-bar").replaceWith(this.progress_view.el);this.hearts_view&&this.$("#hearts").replaceWith(this.hearts_view.el);this.explanation_view&&this.$("#explanation").replaceWith(this.explanation_view.el);this.$("#grade").replaceWith(this.grade_view.el);
b(this.el).addClass(this.appClasses);this.soundEffectsEnabled&&(soundManager.stopAll(),soundManager.failedSound&&soundManager.failedSound.play());return this},goToHome:function(){duo.homeRouter.navigate("",!0)},goToHomeWithReload:function(){duo.homeRouter.navigate("");window.location.reload()},retry:function(){window.location.reload()},closeFail:function(){this.$(".session-end").hide();this.$("#session-element-container").replaceWith(this.elementView.el);this.elementView.closeFail();b("#app").attr("class",
this.appClasses)},keyCheck:function(a){if(13===a.which){if(b("#report-options").is(":visible")||b("#discussion-modal").is(":visible")||b("body").hasClass("modal-open"))return!0;b(document).unbind(".session");this.$("#home-button").click()}},reportProblem:function(a){if(b(a.target).closest("#report-options").size())return!0;if(b("#report-options").is(":hidden"))b("#report-options").fadeIn(),b(".player-inner").addClass("show-report-stuff");else{var c=this;b(".player-inner").removeClass("show-report-stuff");
b("html, body").animate({scrollTop:0},"slow",function(){c.$("#report-options").fadeOut()})}return!1},displayDiscussion:function(){if(0<this.$("#discussion-modal").size())this.$("#discussion-modal").modal("show");else if(!this.loading_comments){this.loading_comments=!0;var a=this,b=new duo.Sentence({id:this.elementView.session.getSubmittedSolution().get("session_element").get("solution_key")});b.fetch({data:{ui_language:this.model.get("ui_language"),learning_language:this.model.get("language")},success:function(d){this.$("#discussion-modal-container").appendTo(document.body);
d=new duo.CommentModalView({el:this.$("#discussion-modal-container"),correct:a.model.getSubmittedSolution().get("correct"),model:b,ui_language:a.model.get("ui_language"),learning_language:a.model.get("language")});duo.track("show sentence comment");d.render();a.loading_comments=!1}});this.$("#discussion-modal").on("hidden",function(){return!1})}},redoChallenge:function(){alert("redo")},sendSuggestionMessage:function(){this.submitSuggestion(this.$(".free-write-box").val(),this.$("#user-solution").val())},
submitSuggestion:function(a,c,d,f){var g=this.model.getSubmittedSolution();a={referer:window.location.href,flashversion:FlashDetect.installed?FlashDetect.raw:"",session_element_solution:JSON.stringify(g.toJSON()),user_solution:c,message:a,correct_solutions:JSON.stringify(g.get("correct_solutions")),language:this.model.get("language"),ui_language:this.model.get("ui_language"),report_types:d,free_write_message:f};var h=this;duo.track("submit suggestion/feedback",{language:this.model.get("language"),
ui_language:this.model.get("ui_language"),direction:this.model.get("language")+" <- "+this.model.get("ui_language"),skill_id:this.model.get("skill_id")});b.post("/diagnostics/language_feedback",a,function(){h.continueLearning();b("#solution-suggested").show().delay(4500).fadeOut(1E3)})},submitDifficulty:function(a){var c=this.model.getSubmittedSolution();a={too_easy:a};duo.track("difficulty_feedback",a);b.post("/diagnostics/difficulty_feedback",_.extend(a,{referer:window.location.href,session_element_solution:JSON.stringify(c.toJSON()),
language:this.model.get("language"),ui_language:this.model.get("ui_language")}),function(){b("#solution-suggested").show().delay(4500).fadeOut(1E3)})},tooDifficult:function(){b("#too-difficult").hide();this.submitDifficulty(!1)},tooEasy:function(){b("#too-easy").hide();this.submitDifficulty(!0)},cancelSuggestion:function(){var a=this;b("html, body").animate({scrollTop:0},"slow",function(){a.$("#report-options").fadeOut()})},continueLearning:function(){this.cancelSuggestion();this.$(".submit-solution-box").remove()},
checkFreeWrite:function(){this.$("#report-options #free-write").prop("checked",!0);this.checkSubmit()},submitProblem:function(){var a="",c=[],d=this,f=null;this.$('#report-options input[type="checkbox"]:checked').each(function(){"free-write"==b(this).attr("id")?(c.push("free-write"),f=d.$(".free-write-box").val(),a+="User explanation: "+f+".\n",d.$(".free-write-box").val("")):("translate"==b(this).attr("id")?c.push("translation"):c.push(b(this).attr("id")),a+=b(this).val()+"\n");b(this).prop("checked",
!1)});c=JSON.stringify(c);if(""!=a){var g=this.model.getSubmittedSolution(),g=b.trim(g.getDisplayText());this.submitSuggestion(a,g,c,f);b("html, body").animate({scrollTop:0},"slow",function(){d.$("#report-options").fadeOut();d.checkSubmit()})}return!1},getSourceName:function(a){return{en:"English",es:"Spanish",pt:"Portuguese",fr:"French",de:"German",it:"Italian"}[a]},checkSubmit:function(){var a=0;this.$('#report-options input[type="checkbox"]:checked').each(function(){a++});0<a?this.$("#submit-problem").removeAttr("disabled"):
this.$("#submit-problem").attr("disabled","disabled")}});duo.ProgressView=Backbone.View.extend({id:"progress-bar",template:duo.templates["progress-bar"],initialize:function(){this.model.bind("grade",this.graded,this);this.model.bind("continue",this.continued,this);this.model.bind("change:timed",this.changeIsTimed,this);this.model.bind("change:use_strength",this.render,this);this.model.bind("change:strength_fraction",this.updateStrength,this);this.model.bind("change:position",this.updateChallengeNum,
this);this.model.get("session_elements").bind("remove",this.elementRemoved,this);this.challenge_number=1},render:function(){var a=_.size(this.model.get("session_elements"));this.model.set({elements:_.range(1,a+1)});b(this.el).html(b.duostache(this.template,_.extend({},this.model.toJSON(),{elements:_.range(1,a+1),challenge_num:this.challenge_number})));for(a=0;a<this.model.get("position");a++)this.$(".nothing:first").removeClass("nothing").addClass("done");return this},graded:function(){var a=this.model.currentElement(),
b=this.model.getSubmittedSolution();this.challenge_number+=1;this.model.get("use_strength")&&this.model.updateStrength(a,b.get("correct"),b.get("error_info"),a.get("hovered_lexeme_ids"));(!a||!("title"===a.get("type")||"name"===a.get("type")&&a.get("example")))&&b.isDone()&&1==this.model.getNumberSubmittedSolutionsForCurrentElement()&&this.$(".nothing:first").removeClass("nothing").addClass("done")},continued:function(){var a=this.model.previousElement();a&&("title"===a.get("type")||"name"===a.get("type")&&
a.get("example"))&&this.$(".nothing:first").removeClass("nothing").addClass("done")},elementRemoved:function(a,b){this.$(".nothing:last").remove()},changeIsTimed:function(){this.model.isTimed()&&this.model.set("use_strength",!1)},updateStrength:function(){var a=this.$(".progress-bar-dynamic .bar"),c=this.model.get("strength_fraction");if(0>=c)a.animate({opacity:0},50),a.width("0px"),this.$(".bubbles").fadeOut(),this.$(".triangle-end").hide(),this.$(".icon-lightning-green").addClass("opacity-0").removeClass("bounce-in");
else if(a.css({opacity:1}),a.width(100*c+"%"),duo.user.get("ab_options").web_strength_v2_experiment&&0.06>c&&a.width("6%"),this.$(".bubbles").fadeIn(),this.$(".triangle-end").show(),this.$(".icon-lightning-green").addClass("bounce-in").removeClass("opacity-0"),1<=c){duo.user.get("ab_options").web_strength_v2_experiment&&(a.width("101.0%"),this.$(".progress-bar-dynamic.v2 .bar").addClass("bar-border-radius"));var d=this,f=function(){d.$(".finished-skill").show();d.$(".bubbles",".backing").fadeOut();
var a=d.model.get("global_practice")?"bg-blue":"bg-"+d.model.get("skill_color");d.$(".challenge-num-circle").addClass(a).removeClass("white");d.$(".challenge-number-container").addClass("filled")};if(void 0!=b.support.transition)a.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(a){f()});else f()}},updateChallengeNum:function(){this.$(".challenge-num").text(this.challenge_number)}});duo.HeartsView=Backbone.View.extend({template:duo.templates["session-hearts"],
initialize:function(a){this.model.initializeHearts(a.num_hearts);this.model.bind("grade",this.graded,this);this.model.bind("hovered",this.onHover,this)},render:function(){b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{fraction_hearts:this.getFractionHearts()}),{},!0));return this},graded:function(){var a=this.model.currentElement(),b=this.model.getSubmittedSolution();!1!==b.get("remove_heart")&&!a.get("example")&&b.isDone()&&1==this.model.getNumberSubmittedSolutionsForCurrentElement()&&
(b.isCorrect()||this.adjustHearts(-1))},onHover:function(a,b,d){duo.user.get("ab_options").hover_heart_experiment&&!d&&this.adjustHearts(-0.25)},adjustHearts:function(a){var c=this.model.get("num_hearts"),d=this.model.adjustHearts(a);"heart_refill"in duo.user.get("inventory")&&0>a&&b("#heart-refill-container").fadeIn();0>d&&this.model.set({state:"failed"});c="#heart-"+parseInt(c);0<a&&(c="#heart-"+parseInt(d));0<a?this.$(c).removeClass("falling-heart"):this.$(c).addClass("falling-heart")},getFractionHearts:function(){var a=
this.model.get("num_hearts"),b=parseInt(Math.floor(a)),a=a-b;if(0<a)switch(b+=" ",a){case 0.25:b+="\u00bc";break;case 0.5:b+="\u00bd";break;case 0.75:b+="\u00be"}return b}});duo.ExplanationView=Backbone.View.extend({id:"explanation",tagName:"li",template:duo.templates["session-explanation"],events:{click:"toggle","click .close":"close"},render:function(){b(this.el).html(b.duostache(this.template,this.model.toJSON()));return this},toggle:function(){this.$(".popover").toggle()},close:function(){this.$(".popover").hide();
return!1}});duo.SessionView=Backbone.View.extend({id:"app",events:{"click #submit_button":"submit","click .redesign-check":"submit","click #continue_button":"next","click .redesign-next":"next","click #skip_button":"skip","click #show-report-options":"reportProblem","click #discussion-toggle":"displayDiscussion","click #too-difficult":"tooDifficult","click #too-easy":"tooEasy","click #redo-challenge":"redoChallenge","click #submit-suggestion":"sendSuggestionMessage","click #cancel-report":"cancelSuggestion",
"click #continue-learning":"continueLearning","click #submit-problem":"submitProblem","focus .free-write-box":"checkFreeWrite","click input[type=checkbox]":"checkSubmit","click #heart-refill":"refillHeart","click #quit-button":"quitSession","click #no-mic-link":"turnMicOff"},template:duo.templates.session,reportProblem:function(a){if(b(a.target).closest("#report-options").size())return!0;if(b("#report-options").is(":hidden"))b("#report-options").fadeIn(),b(".player-inner").addClass("show-report-stuff"),
b("html, body").animate({scrollTop:b(document).height()-b(window).height()},"slow");else{var c=this;b(".player-inner").removeClass("show-report-stuff");b("html, body").animate({scrollTop:0},"slow",function(){c.$("#report-options").fadeOut()})}return!1},displayDiscussion:function(){if(0<b("#discussion-modal").size())b("#discussion-modal").modal("show");else if(!this.loading_comments){this.loading_comments=!0;var a=this,c=new duo.Sentence({id:this.model.currentElement().get("solution_key")});c.fetch({data:{ui_language:this.model.get("ui_language")||
void 0,learning_language:this.model.get("language")},success:function(b){this.$("#discussion-modal-container").appendTo(document.body);b=new duo.CommentModalView({el:this.$("#discussion-modal-container"),correct:a.model.getSubmittedSolution().get("correct"),model:c,ui_language:a.model.get("ui_language"),learning_language:a.model.get("language")});duo.track("show sentence comment");b.render();a.loading_comments=!1}});this.$("#discussion-modal").on("hidden",function(){return!1})}},submitDifficulty:function(a){var c=
this.model.getSubmittedSolution();a={too_easy:a};duo.track("difficulty_feedback",a);b.post("/diagnostics/difficulty_feedback",_.extend(a,{referer:window.location.href,session_element_solution:JSON.stringify(c.toJSON()),language:this.model.get("language"),ui_language:this.model.get("ui_language")}),function(){b("#solution-suggested").show().delay(4500).fadeOut(1E3)})},tooDifficult:function(){b("#too-difficult").hide();this.submitDifficulty(!1)},tooEasy:function(){b("#too-easy").hide();this.submitDifficulty(!0)},
redoChallenge:function(){alert("redo")},sendSuggestionMessage:function(){this.submitSuggestion(this.$(".free-write-box").val(),this.$("#user-solution").val())},submitSuggestion:function(a,c,d,f){var g=this.model.getSubmittedSolution();a={referer:window.location.href,flashversion:FlashDetect.installed?FlashDetect.raw:"",session_element_solution:JSON.stringify(g.toJSON()),user_solution:c,message:a,correct_solutions:JSON.stringify(g.get("correct_solutions")),language:this.model.get("language"),ui_language:this.model.get("ui_language"),
report_types:d,free_write_message:f};var h=this;duo.track("submit suggestion/feedback",{language:this.model.get("language"),ui_language:this.model.get("ui_language"),direction:this.model.get("language")+" <- "+this.model.get("ui_language"),skill_id:this.model.get("skill_id")});b.post("/diagnostics/language_feedback",a,function(){h.continueLearning();b("#solution-suggested").removeClass("hidden").delay(4500).fadeOut(1E3)})},cancelSuggestion:function(){var a=this;b("html, body").animate({scrollTop:0},
"slow",function(){a.$("#report-options").fadeOut()})},continueLearning:function(){this.cancelSuggestion();this.$(".submit-solution-box").remove()},checkFreeWrite:function(){this.$("#report-options #free-write").prop("checked",!0);this.checkSubmit()},submitProblem:function(){var a="",c=[],d=this,f=null;this.$('#report-options input[type="checkbox"]:checked').each(function(){"free-write"==b(this).attr("id")?(c.push("free-write"),f=d.$(".free-write-box").val(),a+="User explanation: "+f+".\n",d.$(".free-write-box").val("")):
("translate"==b(this).attr("id")?c.push("translation"):c.push(b(this).attr("id")),a+=b(this).val()+"\n");b(this).prop("checked",!1)});c=JSON.stringify(c);if(""!=a){var g=this.model.getSubmittedSolution(),g=b.trim(g.getDisplayText());this.submitSuggestion(a,g,c,f);b("html, body").animate({scrollTop:0},"slow",function(){d.$("#report-options").fadeOut();d.checkSubmit()})}b(".player-inner").removeClass("show-report-stuff");return!1},getSourceName:function(a){return{en:"English",es:"Spanish",pt:"Portuguese",
fr:"French",de:"German",it:"Italian"}[a]},checkSubmit:function(){var a=0;this.$('#report-options input[type="checkbox"]:checked').each(function(){a++});0<a?this.$("#submit-problem").removeAttr("disabled"):this.$("#submit-problem").attr("disabled","disabled")},bindEvents:function(a){_.bindAll(this,"keyCheck","preventKeys","keyUp","keyDown","keyPress","submit");b(document).unbind(this.getEventClass()).bind("keyup"+this.getEventClass(),this.keyUp).bind("keydown"+this.getEventClass(),this.keyDown).bind("keypress"+
this.getEventClass(),this.keyPress);this.model.bind("input",this.ready,this);this.model.bind("clear",this.notReady,this);this.model.bind("grade",this.graded,this);this.model.bind("retry",this.graded,this);this.model.bind("render",this.rendered,this);this.model.bind("fail",this.failed,this);("undefined"===typeof a||!0===a)&&this.checkSound();b("#box_feedback #activity_uuid").val(this.model.get("activity_uuid"))},keyUp:function(a){return this.preventKeys(a)},keyDown:function(a){return this.keyCheck(a)},
keyPress:function(a){return this.preventKeys(a)},getEventClass:function(){return".session"},initialize:function(){duo.sessionURL=document.URL.slice((window.location.protocol+"//"+window.location.host+Backbone.history.root).length);var a=this.model.get("type");this.model.set("use_strength","lesson"==a||"practice"==a||"skill_practice"==a);b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{notify_comment:duo.user.get("notify_comment"),heart_refill:"heart_refill"in duo.user.get("inventory")&&
"test"!=this.model.get("type")&&"big_test"!=this.model.get("type")}),duo.templates));this.bindEvents();this.loading_comments=!1;a={type:this.model.get("type"),lesson_number:this.model.get("lesson_number"),skill_name:this.model.get("skill_name"),skill_id:this.model.get("skill_id"),global_practice:this.model.get("global_practice"),from_email:this.model.get("from_email"),skill_tree_id:this.model.get("skill_tree_id"),request_hash:this.model.get("request_hash"),challenge_sequence_hash:this.model.get("challenge_sequence_hash")};
"lesson"===this.model.get("type")&&(a.lesson=this.model.get("skill_name")+"--"+this.model.get("lesson_number"),a.num_untaught_lexemes=this.model.get("num_untaught_lexemes"));var c=this.model.get("session_elements");c&&(a.num_elements=c.length);duo.track("session_start",a);this.model.set({start_time:new Date});this.initializeSubViews();swfobject.switchOffAutoHideShow();this.model.set({seen_explanations:[]});this.soundEffectsEnabled=duo.user.playEffects()&&soundManager;this.adaptive_lessons=duo.feature_flags.sg_adaptive_lessons_experiment&&
duo.user.get("ab_options").sg_adaptive_lessons_experiment&&"lesson"==this.model.get("type");this.last_extension_pos=0},initializeSubViews:function(){this.progress_view=new duo.ProgressView({model:this.model});this.$("#progress-bar").replaceWith(this.progress_view.render().el);if(this.model.get("use_strength"))this.model.initializeHearts(this.getNumHearts()),this.model.set("num_hearts",0);else{var a=this.getNumHearts();this.hearts_view=new duo.HeartsView({model:this.model,el:this.$("#hearts"),num_hearts:a});
this.hearts_view.render()}this.explanation_view=new duo.ExplanationView({model:this.model});this.$("#explanation").replaceWith(this.explanation_view.render().el);this.grade_view=new duo.GradeView({model:this.model});this.$("#grade").replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.soundEffectsEnabled=duo.user.playEffects()&&soundManager;a=duo.user.getSkills().notifications;if(this.model.get("use_strength")&&a.lesson_strength_bar){this.$("#modal-notification").appendTo("body").modal({keyboard:!1,
backdrop:"static",show:!0});this.modal_notif_view=new duo.StrengthBarNotificationView({el:b("body > #modal-notification"),messages:_.compact(_.map(a,function(a,b){return a?b:null}))});this.modal_notif_view.render();Backbone.history.once("route",this.cleanUp,this);var c=this;_.defer(function(){if(c.modal_notif_view){var a=this.$("#progress-bar .bar");b("#modal-notification").css({top:parseInt(a.offset().top+280)+"px"})}})}},getNumHearts:function(){var a=this.model.get("beginner")?4:3;duo.user.get("ab_options").hover_heart_experiment&&
(a+=1);return a},getViewName:function(a){var b=a.get("type").replace(/_/g," ").toTitleCase().replace(/ /g,"");return(a.get("example")?"Example":"")+b+"ElementView"},createElementView:function(){var a=this.model.currentElement(),b=this.getViewName(a);-1!=b.indexOf("Speak")&&duo.isWebSpeechEnabled()&&(b="WebSpeech"+b,a.recognition=duo.getSpeechRecognition());return new duo[b]({model:a,session:this.model})},renderElementView:function(){var a=this.createElementView();this.$("#session-element-container #audio-recorder").attr("id",
"old-audio-recorder");var c=this.$("#session-element-container").clone();this.$("#session-element-container").replaceWith(a.render().el);this.$("#prev-session-element-container").append(c.html());if(0<this.model.get("position")||0==this.model.get("position")&&(!0==this.model.get("timed")||this.model.get("placement")))this.$("#prev-session-element-container").addClass("current-challenge "+duo.script_direction),this.$("#session-element-container").addClass("upcoming-challenge "+duo.script_direction);
this.$("#continue_button, #submit_button").attr("disabled","disabled").twipsy("hide");this.changeState("next",!0);b("#app").removeClass("correct incorrect covert");c=this.model.currentElement().get("type");c="speak"==c||"reverse_speak"==c;this.$("#no-mic-link").removeClass("hidden").toggle(c);this.$("#skip_button").toggle(!c);return a},render:function(){this.delegateEvents();this.model.set({state:"empty"});this.element_view=this.renderElementView();this.$(".pagination #element-"+this.model.get("position")).removeClass("active");
this.$(".pagination #element-"+(this.model.get("position")+1)).addClass("active");this.changeState("check",!0);var a=this.model;_.defer(function(){a.set({state:"rendered"})});this.element_view&&"en"!==this.element_view.model.get("target_language")&&this.$("#speller_button").hide();return this},rendered:function(){"welcome"!=this.model.get("type")&&b("body").addClass("player");b("#app").addClass(this.model.get("type"));b("#app").addClass(this.model.currentElement().get("type"));this.model.currentElement().get("unknown")?
b("#app").addClass("unknown").removeClass("known"):b("#app").addClass("known").removeClass("unknown");this.$("label").inFieldLabels();this.$("#submit_button").attr("disabled","disabled").toggle(!_.contains(["title","hover"],this.model.currentElement().get("type")));this.$("#continue_button").attr("disabled","disabled").show();"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||b("#continue_button, #submit_button").twipsy({live:!0,offset:15,animate:!1,placement:function(a,
c){return b(c).data("placement")||"in above"}}).addClass("has-twipsy");setTimeout(_.bind(function(){this.$("#prev-session-element-container").html("");this.$("#controls").hide();this.$("#controls").show();this.$("#prev-session-element-container").removeClass("current-challenge "+duo.script_direction);this.$("#session-element-container").removeClass("upcoming-challenge "+duo.script_direction)},this),1E3)},renderEnd:function(){var a=this;b(document).unbind(this.getEventClass());this.model.save({end_time:new Date},
{success:function(){a.showEndView()}});b("#app").removeClass("leave-warning");window.onbeforeunload=null;return this},showEndView:function(){var a=this,c=duo.user.getStrengths();duo.user.fetch({success:function(){var d=[],f=duo.user.getStrengths();_.each(_.keys(c),function(a){if(c[a]<f[a]){var b=duo.user.getSkills(),k=b.skills.where({name:a}),p=0<k.length?k[0]:b.bonus_skills.where({name:a})[0],b=p.get("icon_color"),k=p.get("new_index"),p=p.get("title");d.push({skill_name:a,strength:f[a],icon_color:b,
new_index:k,skill_title:p});3<=d.length&&duo.user.set({delta_strengths:d},{silent:!0})}});duo.user.set({delta_strengths:d});var k=new duo.SlideSessionEndView({model:a.model});b(a.el).replaceWith(k.render().el)}});var d={failed:this.model.get("failed"),type:this.model.get("type"),num_hearts:this.model.get("num_hearts"),position:this.model.get("position"),times_up:this.model.get("times_up"),timed:this.model.isTimed(),lesson_number:this.model.get("lesson_number"),skill_name:this.model.get("skill_name"),
skill_id:this.model.get("skill_id"),global_practice:this.model.get("global_practice"),from_email:this.model.get("from_email"),num_word_hints:this.getNumHoveredWords(this.model),skill_tree_id:this.model.get("skill_tree_id"),have_document_recommendations:!0==this.model.get("have_document_recommendations"),request_hash:this.model.get("request_hash"),challenge_sequence_hash:this.model.get("challenge_sequence_hash"),tc_web_advertisement:!!this.model.get("testcenter_event"),fluency_gain:this.model.get("fluency_gain")};
"lesson"===this.model.get("type")&&(d.lesson=this.model.get("skill_name")+"--"+this.model.get("lesson_number"));d.gained_skill_points=this.model.get("gained_skill_points")||this.model.get("points");d.have_document_recommendations&&(d.recommended_document_title=this.model.get("recommendations")[0].document_title);var f=this.model.get("position");void 0!==f&&(d.num_challenges_answered=1+f);duo.track("session_end",d)},keyCheck:function(a){if(13==a.which){if(b("#feedback_form").is(":visible")||(this.$("#report-options").is(":visible")||
this.$("#discussion-modal").is(":visible")||b("body").hasClass("modal-open"))||b(a.target).is("#submit_button, #continue_button, #skip_button, #next_button"))return!0;a=this.$("#submit_button").attr("disabled");var c=this.$("#continue_button").attr("disabled")||this.$("#next_button").attr("disabled");"ready"==this.model.get("state")?(!a||"undefined"===typeof a)&&this.submit():"graded"==this.model.get("state")&&(!c||"undefined"===typeof c)&&this.next()}else{if(32==a.which&&a.ctrlKey)return a.shiftKey?
this.$("#big-speaker .icon_speaker_slow, #big-speaker .speaker-slow").click():this.$("#big-speaker .icon_speaker, #big-speaker .speaker-big, #big-speaker .speaker-small").click(),!1;if(8==a.which)return a=b(a.target),a.is('input[type="text"]')||a.is("textarea")||a.is("#text-input")||a.is(".translation-textarea")?!0:!1}return!0},preventKeys:function(a){return 8==a.which?(a=b(a.target),a.is('input[type="text"]')||a.is("textarea")||a.is("#text-input")||a.is(".translation-textarea")?!0:!1):13==a.which&&
(!b("#feedback_form").is(":visible")&&!this.$("#report-options").is(":visible")&&!this.$("#discussion-modal").is(":visible")&&!b("body").hasClass("modal-open"))&&(a=b(a.target),a.is('input[type="text"]')||a.is("textarea")||a.is("#text-input")||a.is(".translation-textarea")||a.is("select"))?!1:!0},skip:function(){this.$(".col-left").removeClass("retry");this.$("#no-mic-link").hide();this.$("#submit_button").attr("disabled","disabled");this.$(":focus").blur();this.$("#skip_button").hide();this.$("#continue_button").show();
this.$(".hint-popover").hide();this.changeState("check",!0);"graded"===this.model.get("state")&&(this.$("#continue_button").removeAttr("disabled").show(),this.$("#submit_button").attr("disabled","disabled").show(),this.soundEffectsEnabled&&(soundManager.stopAll(),soundManager.retrySound&&soundManager.retrySound.play()));this.element_view.skip();return!1},turnMicOff:function(){this.model.trigger("micoff")},next:function(a){this.$(".col-left").removeClass("retry");this.changeState("check",!0);b("#discussion-modal-container").remove();
if(this.model.getSubmittedSolution().isDone())return a=!1,this.model.get("use_strength")?(a=1<=this.model.get("strength_fraction"),!a&&this.model.get("position")>=this.model.get("session_elements").length-5&&this.extendSession()):a=this.model.get("position")===this.model.get("session_elements").length-1,a?"ended"!==this.model.get("state")&&(this.model.set({state:"ended"}),this.renderEnd()):(b("#app").removeClass(this.model.currentElement().get("type")),this.model.incrementPosition(),this.render()),
this.cancelSuggestion(),!1},extendSession:function(){this.extend_session_throttled=!1;var a={skill_id:this.model.get("skill_id"),language:this.model.get("language"),session_type:this.model.getSpecificSessionType(),lesson_number:this.model.get("lesson_number"),device:"browser",kc_strength_model_version:duo.kcStrengthModelVersion(),activity_uuid:this.model.get("activity_uuid")},c;if(this.adaptive_lessons){for(var d=[],f=this.model.get("session_elements"),g=this.model.get("session_element_solutions"),
h=0;h<g.length+1&&h<f.length&&50>h;h++){var k=f.at(h),k={generator_id:k.get("generator_id"),specific_type:k.get("specific_type"),correct:k.get("correct")};h<g.length&&(k.correct=g[h][0].get("correct"));d.push(k)}c=d.length;a.history=JSON.stringify(d);a.kc_states=JSON.stringify(this.model.getKCStates())}else a.introduced_lexeme_ids=this.model.get("introduced_lexeme_ids").join();var l=this;b.post("/extend_session",a,function(a){var b=l.model.get("session_elements");a=a.session_elements;var d=b.length;
this.adaptive_lessons&&(d=Math.max(l.model.get("position")+1,c),d=Math.min(d,b.length));b.length=d;for(d=0;d<a.length;d++){var f=new duo.SessionElement(a[d]);b.push(f)}})},throttledExtendSession:function(){var a=this.model.get("position");_.contains(["submitted","grading","graded"],this.model.get("state"))&&(a+=1);a<this.last_extension_pos+7?this.extend_session_throttled=!0:this.extendSession()},failed:function(){b("#app").removeClass("leave-warning");window.onbeforeunload=null;var a=this;this.model.save({failed:!0},
{success:function(){a.showFailView()}});return this},showFailView:function(){var a={failed:this.model.get("failed"),type:this.model.get("type"),num_hearts:this.model.get("num_hearts"),position:this.model.get("position"),times_up:this.model.get("times_up"),timed:this.model.isTimed(),lesson_number:this.model.get("lesson_number"),skill_name:this.model.get("skill_name"),skill_id:this.model.get("skill_id"),global_practice:this.model.get("global_practice"),from_email:this.model.get("from_email"),num_word_hints:this.getNumHoveredWords(this.model),
skill_tree_id:this.model.get("skill_tree_id"),fluency_gain:this.model.get("fluency_gain")};"lesson"===this.model.get("type")&&(a.lesson=this.model.get("skill_name")+"--"+this.model.get("lesson_number"));duo.track("session_end",a);a=new duo.SessionFailedView({model:this.model,appClasses:b("#app").attr("class"),hearts_view:this.hearts_view,explanation_view:this.explanation_view,progress_view:this.progress_view,grade_view:this.grade_view,elementView:this.element_view,used_refill:this.used_refill});b(this.el).replaceWith(a.render().el);
return this},ready:function(){this.$("#submit_button, #speller_button").removeAttr("disabled");this.changeState("check",!1)},notReady:function(){this.$("#submit_button, #speller_button").attr("disabled","disabled").show();this.$("#continue_button").attr("disabled","disabled");this.changeState("check",!0);b("#app").removeClass("correct").removeClass("incorrect")},submit:function(){this.$(".hint-popover").hide();!1!==this.element_view.submit()&&("graded"!=this.model.get("state")&&this.changeState("grading",
!0),this.$("#submit_button").attr("disabled","disabled").twipsy("hide"));if("welcome"!==this.model.get("type")&&("Basics-1"==this.model.get("skill_name")||"Basics"==this.model.get("skill_name")||this.model.get("position")===this.model.get("session_elements").length-1))b("#app").addClass("leave-warning"),window.onbeforeunload=function(){return translate_text("Are you sure you want to quit? All progress in this session will be lost.")};return!1},graded:function(a){a=this.model.getSubmittedSolution();
a.isDone()&&(this.$("#continue_button").removeAttr("disabled").show(),this.$("#skip_button").hide());a.get("try_again")?(this.changeState("next",!0),this.$(".col-left").addClass("retry"),this.$("#skip_button").show()):(this.$(".col-left").removeClass("retry"),this.$("#skip_button").hide(),this.changeState("next",!1));this.$("#no-mic-link").hide();var c=this.model.currentElement();this.$("#submit_button").attr("disabled","disabled").toggle(c&&!_.contains(["title","hover"],c.get("type")));this.model.get("answer_feedback")||
a.get("try_again")?(a.get("correct")&&b("#app").removeClass("incorrect").addClass("correct"),a.get("incorrect")&&b("#app").removeClass("correct").addClass("incorrect"),this.soundEffectsEnabled&&(a.get("try_again")?(soundManager.stopAll(),soundManager.retrySound&&soundManager.retrySound.play()):a.get("correct")?(soundManager.stopAll(),soundManager.rightSound&&soundManager.rightSound.play()):a.get("incorrect")&&(soundManager.stopAll(),soundManager.wrongSound&&soundManager.wrongSound.play()))):(b("#app").removeClass("incorrect correct").addClass("covert correct"),
this.soundEffectsEnabled&&(soundManager.stopAll(),soundManager.testSound&&soundManager.testSound.play()),this.grade_view.next());this.adaptive_lessons&&this.model.get("use_strength")&&(a=this.model.getSubmittedSolution(),(!a||!a.get("correct")||this.extend_session_throttled)&&this.throttledExtendSession())},getNumHoveredWords:function(a){return a.get("session_elements").reduce(function(a,b){return b.has("hovered_words")?a+b.get("hovered_words").length:a},0)},checkSound:function(){try{if(soundManager){var a=
soundManager.createSound({id:"sm2TestSound",url:"https://s3.amazonaws.com/duolingo-data/s3/quartersec.mp3"});soundManager._disabled?this.showNoSound():(a.play(),soundManager._disabled&&this.showNoSound())}else this.showNoSound()}catch(b){this.showNoSound()}},showNoSound:function(){try{if(!0==duo.user.get("speaker")&&"welcome"!=this.model.get("type")){var a=FlashDetect.installed?FlashDetect.major:"";duo.track("no sound",{user_agent:navigator.userAgent,flash_version:a});var b=this.$("#no-sound-modal");
(new duo.NoSoundModal({el:b.find(".modal-body"),version_too_low:8>a})).render();b.removeClass("hidden");b.appendTo("body").modal("show");this.$("a").click(function(){b.modal("hide")})}"welcome"==this.model.get("type")&&(this.soundNotReady=!0)}catch(d){}},refillHeart:function(){var a=this;b.post("/store/use_item",{item_name:"heart_refill"},function(c){"ok"===c.response?(a.hearts_view.adjustHearts(1),b("#heart-refill-container").fadeOut(1E3)):b("#heart-refill-container").hide();c=duo.user.get("inventory");
delete c.heart_refill});this.used_refill=!0},quitSession:function(){b("#app").addClass("leave-warning");duo.homeRouter.navigate("/",!0)},changeState:function(a,c){var d=this.model.currentElement();d&&"title"!=d.get("type")&&!("select"==d.get("type")&&"grading"==a&&c)&&(d=this.$("#next_button"),"check"==a||"grading"==a?(d.removeAttr("disabled"),d.addClass("redesign-check"),d.removeClass("redesign-next"),d.text("grading"==a?translate_text("Grading..."):translate_text("Check")),d.attr("data-original-title",
translate_text("Press Enter to Check"))):"wait"==a?(d.removeAttr("disabled"),d.removeClass("redesign-check"),d.addClass("redesign-next"),d.text(translate_text("Wait..."))):"next"==a&&(d.removeAttr("disabled"),d.removeClass("redesign-check"),d.addClass("redesign-next"),d.text(translate_text("Continue")),d.attr("data-original-title",translate_text("Press Enter to Continue"))),!0==c?d.attr("disabled","disabled"):d.removeAttr("disabled"),!0==c?(b("#next_button").tooltip("disable"),b("#next_button").tooltip("hide")):
duo.mobile_web_view||b("#next_button").tooltip("enable"))},cleanUp:function(){this.modal_notif_view&&(this.modal_notif_view.remove(),b(".modal-backdrop").remove())}});duo.NoSoundModal=Backbone.View.extend({template:duo.templates["no-sound-modal"],initialize:function(a){this.version_too_low=a.version_too_low},render:function(){b(this.el).html(b.duostache(this.template,{version_too_low:this.version_too_low},duo.templates));return this.el}});duo.TimingModule=Backbone.View.extend({template:duo.templates.timer,
initialize:function(a){_.bindAll(this,"render","stop");this.total_time=1E3*a.total_time||this.getTotalTime();this.original_total_time=1E3*a.shown_max_time||this.total_time;this.count_up=a.count_up;this.extra=a.extra_time;this.long_sentence_bonus=a.long_sentence_bonus;this.soundEffectsEnabled=duo.user.playEffects()&&soundManager;this.interval_id=setInterval(this.render,1E3);this.model.bind("grade",this.graded,this);this.model.bind("retry",this.graded,this);this.model.bind("submit",this.pause,this);
this.model.bind("end",this.stop);this.model.bind("fail",this.stop);this.model.bind("loading_tts",this.pause,this);this.model.bind("loaded_tts",this.resume,this);this.model.bind("loading_recorder",this.pause,this);this.model.bind("loaded_recorder",this.resume,this);duo.topbar.bind("navigate",this.stop);_.bindAll(this,"drawTimer")},render:function(){var a=this.getSecondsLeft();b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{running_out:6>=a,seconds:a}),duo.templates,!0));0>=
a?this.model.set({times_up:!0}):6>=a&&this.soundEffectsEnabled&&soundManager.timerSound&&soundManager.timerSound.play();this.$arc_data?(this.$(".counter").replaceWith(this.$counter),this.$counter.data(this.$arc_data).arc({animate:!0,value:Math.min(this.original_total_time/1E3,a),total:this.original_total_time/1E3})):_.defer(this.drawTimer)},drawTimer:function(){var a=this.$(".counter");a.arc({stroke:"#5b9700",fill:"#7ec200",strokewidth:1,value:this.total_time,total:this.original_total_time,width:5});
this.$counter=a;this.$arc_data=a.data()},getTotalTime:function(){var a=0;this.model.get("type");this.model.get("session_elements").each(function(b){a+=5});return 1E3*a},getSecondsLeft:function(){if(!this.model.has("start_time"))return this.count_up?0:this.total_time/1E3;var a=(this.paused||new Date)-this.model.get("start_time");return Math.max(0,(this.count_up?a:this.total_time-a)/1E3)},padNumber:function(a){return 10>a?"0"+a:a},pause:function(){this.paused=new Date},resume:function(){var a=new Date;
this.model.get("start_time").setMilliseconds(this.model.get("start_time").getMilliseconds()+(a-this.paused));this.paused=null},graded:function(){this.resume();var a=this.model.getSubmittedSolution(),b=a.get("session_element");this.extra&&a.get("correct")&&(this.total_time+=1E3*this.model.calculateExtraTime(b))},stop:function(){clearInterval(this.interval_id);this.model.unbind("grade",this.graded,this);this.model.unbind("submit",this.pause,this);this.model.unbind("end",this.stop);this.model.unbind("fail",
this.stop);this.model.unbind("loading_tts",this.pause,this);this.model.unbind("loaded_tts",this.resume,this);duo.topbar.unbind("navigate",this.stop)}});duo.PointCountModule=Backbone.View.extend({template:duo.templates["point-count"],initialize:function(){this.model.bind("grade",this.render,this)},render:function(){var a=this.model.getNumberCorrectOnFirstTry();b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{points:a}),duo.templates))}});duo.TimedSessionView=duo.SessionView.extend({events:_.extend({},
duo.SessionView.prototype.events,{"click .ready-panel #start-button":"startSession","click .ready-panel #untimed-button":"startUntimedSession","click .show-shortcuts":"showShortcuts"}),bindEvents:function(){duo.SessionView.prototype.bindEvents.call(this,!1);this.model.bind("change:times_up",this.timesUp,this)},initialize:function(a){this.die_on_time=!!a.die;this.points_per_correct=!!a.points;this.auto_timed=!!a.auto_timed;this.long_sentence_bonus=3;b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),
{owned_timed_practice:duo.user.toJSON().inventory.hasOwnProperty("timed_practice"),requires_ready:!this.auto_timed,points_per_correct:this.points_per_correct,allow_opt_out:this.die_on_time,timed:!0}),duo.templates));this.bindEvents();this.initializeSubViews(a);this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},initializeSubViews:function(a){this.progress_view=new duo.ProgressView({model:this.model});this.$("#progress-bar").replaceWith(this.progress_view.render().el);if(!a.points||"practice"!==
this.model.get("type")&&"skill_practice"!==this.model.get("type")){var b=this.getNumHearts();this.hearts_view=new duo.HeartsView({model:this.model,el:this.$("#hearts"),num_hearts:b});this.hearts_view.render();this.explanation_view=new duo.ExplanationView({model:this.model});this.$("#explanation").replaceWith(this.explanation_view.render().el)}else(new duo.PointCountModule({model:this.model,el:this.$("#point-count")})).render();this.grade_view=new duo.GradeView({model:this.model,points:!!a.points,
extra_time:a.extra,long_sentence_bonus:this.long_sentence_bonus});this.$("#grade").replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.timer_view=new duo.TimingModule({model:this.model,el:this.$("#timer"),count_up:"up"===a.count,extra_time:a.extra,total_time:a.total_time,shown_max_time:a.shown_max_time,long_sentence_bonus:this.long_sentence_bonus});this.timer_view.render()},renderElementView:function(){if(this.ready_to_start)return duo.SessionView.prototype.renderElementView.call(this);
b("body").addClass("player");this.$("#session-element-container").html(b.duostache(duo.templates["timed-session-intro"],_.extend(this.model.toJSON(),{owned_timed_practice:duo.user.toJSON().inventory.hasOwnProperty("timed_practice"),mobile_web_view:duo.mobile_web_view})));var a=Math.floor(4*Math.random())+1;this.$("#st_"+a).removeClass("hidden")},render:function(){duo.SessionView.prototype.render.call(this);return this},rendered:function(){if(this.ready_to_start)return duo.SessionView.prototype.rendered.call(this)},
startSession:function(){this.ready_to_start=!0;this.$(".ready-panel").remove();this.$(".action-panel").show();this.model.set({start_time:new Date,timed:!0});this.render();this.checkSound();var a={type:this.model.get("type"),timed:!0,lesson_number:this.model.get("lesson_number"),skill_name:this.model.get("skill_name"),skill_id:this.model.get("skill_id"),global_practice:this.model.get("global_practice"),from_email:this.model.get("from_email"),skill_tree_id:this.model.get("skill_tree_id")};"lesson"===
this.model.get("type")&&(a.lesson=this.model.get("skill_name")+"--"+this.model.get("lesson_number"));if("practice"===this.model.get("type")||"skill_practice"===this.model.get("type"))a.bonus_round=this.model.has("path_node_index");duo.track("session_start",a)},graded:function(a,b){if(!this.model.get("times_up"))return duo.SessionView.prototype.graded.call(this,a,b)},startUntimedSession:function(){this.model.unbind("input");this.model.unbind("clear");this.model.unbind("grade");this.model.unbind("render");
this.model.unbind("fail");this.model.unbind("continue");this.model.unbind("submit");this.model.unbind("end");this.timer_view.stop();this.model.set({untimed:!0,position:-1});duo.track("untimed mode",{global_practice:this.model.get("global_practice"),bonus_round:this.model.has("path_node_index"),skill_name:this.model.get("skill_name")});b(this.el).unbind();(new duo.SessionView({model:this.model,el:b(this.el)})).render()},timesUp:function(){this.$("#submit_button, #next_button").attr("disabled","disabled");
this.die_on_time&&(this.points_per_correct?0>=this.model.getNumberCorrectOnFirstTry()?(this.model.set({none_correct:!0}),this.model.trigger("fail")):(this.model.trigger("end"),this.renderEnd()):this.model.trigger("fail"))},keyCheck:function(a){return 13==a.which&&this.$("#start-button").is(":visible")?(this.$("#start-button").click(),!1):duo.SessionView.prototype.keyCheck.call(this,a)},renderEnd:function(){this.die_on_time&&this.points_per_correct&&0>=this.model.getNumberCorrectOnFirstTry()?(this.model.set({none_correct:!0}),
this.model.trigger("fail")):duo.SessionView.prototype.renderEnd.call(this)},showShortcuts:function(){b("#show-shortcuts").click()}});duo.BigTestSessionView=duo.SessionView.extend({getNumHearts:function(){var a=this.model.get("more_lenient")?4:3;duo.user.get("ab_options").hover_heart_experiment&&(a+=1);return a},failed:function(){this.model.save({failed:!0},{success:function(){duo.user.fetch()}});var a=new duo.SessionFailedView({model:this.model,appClasses:b("#app").attr("class"),hearts_view:this.hearts_view,
progress_view:this.progress_view,grade_view:this.grade_view,elementView:this.element_view});b(this.el).replaceWith(a.render().el);return this}});duo.PlacementTestProgressView=duo.ProgressView.extend({template:duo.templates["exam-progress-bar"],initialize:function(){this.started=!1;duo.ProgressView.prototype.initialize.call(this);this.model.bind("change:confidence",this.render,this)},render:function(){var a=this.model.get("confidence")||0;b(this.el).html(b.duostache(this.template,{confidence:a,done:100<=
a}));return this}});duo.PlacementTestSessionView=duo.SessionView.extend({events:_.extend({},duo.SessionView.prototype.events,{"click .ready-panel #start-button":"startSession"}),initialize:function(a){duo.sessionURL=document.URL.slice((window.location.protocol+"//"+window.location.host+Backbone.history.root).length);this.model.set({placement:!0});this.challengeHistory=[];this.ready_to_start=!1;b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{requires_ready:!0,placement_test:"placement_test"==
this.model.get("type"),certification_test:"certification_test"==this.model.get("type")}),duo.templates));this.bindEvents();this.initializeSubViews(a);this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},render:function(){b("body").addClass("player");this.ready_to_start?duo.SessionView.prototype.render.call(this):this.$("#session-element-container").html(b.duostache(duo.templates["placement-intro"],this.model.toJSON()));return this},rendered:function(){if(this.ready_to_start)return duo.SessionView.prototype.rendered.call(this)},
startSession:function(){this.ready_to_start=!0;this.$(".ready-panel").remove();this.$(".action-panel").show();this.model.set({start_time:new Date});this.render();this.checkSound();var a={type:this.model.get("type"),skill_tree_id:this.model.get("skill_tree_id")};duo.track("session_start",a)},initializeSubViews:function(a){this.progress_view=new duo.PlacementTestProgressView({model:this.model});this.$("#progress-bar").replaceWith(this.progress_view.render().el);this.grade_view=new duo.GradeView({model:this.model});
this.$("#grade").replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},graded:function(){duo.SessionView.prototype.graded.call(this,!1);var a=this.model.get("position"),c=this.model.get("session_elements").length,d=this.model.getSubmittedSolution();if(!d.get("try_again")){var f=d.get("session_element"),g=f.get("type"),h=f.get("solution_key"),k=f.get("depth"),d=d.get("correct"),f={type:g,solution_key:h,depth:k,correct:d,
total_times_correct:f.get("total_times_correct"),total_times_asked:f.get("total_times_asked")};this.challengeHistory.push(f);a==c-1&&(b("#continue_button").attr("disabled","disabled"),b("#continue_button").text(translate_text("Wait...")),this.changeState("wait",!0),this.getNextElements(0))}},getNextElements:function(a){if(3<a)window.alert(translate_text("We're sorry, Duolingo is experiencing problems now. Please try this test again later."));else{var c=this;b.ajax({url:"/next_session_elements",data:JSON.stringify({type:this.model.get("type"),
language:this.model.get("language"),history:this.challengeHistory}),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(a){c.model.set({confidence:a.confidence});_.each(a.session_elements,function(a){c.model.get("session_elements").add(new duo.SessionElement(a))});b("#continue_button").removeAttr("disabled");b("#continue_button").text(translate_text("Continue"));c.changeState("next",!1)},error:function(b){c.getNextElements(a+1)}})}},renderEnd:function(){var a=
this;b(document).unbind(this.getEventClass());this.model.save({end_time:new Date},{success:function(){0<a.model.get("learned_skills").length?a.showEndView():(a.model.set({no_placement:!0}),a.showFailView())}});b("#app").removeClass("leave-warning");window.onbeforeunload=null;return this}});duo.CertificationTestSessionView=duo.PlacementTestSessionView.extend({events:_.extend({},duo.SessionView.prototype.events,{"click .ready-panel #start-button":"startSession","click #preview":"preview"}),render:function(){if(this.ready_to_start)duo.SessionView.prototype.render.call(this);
else{var a=duo.user.toJSON(),c=this;a.recent_score=_.find(duo.user.get("certificates"),function(a){return a.language==c.model.get("language")});b("body").addClass("player");this.$("#session-element-container").html(b.duostache(duo.templates["certification-intro"],_.extend(this.model.toJSON(),a)))}return this},startSession:function(){this.checkForm()&&(this.model.set({realname:this.$("#realname").val()}),duo.PlacementTestSessionView.prototype.startSession.call(this))},initializeSubViews:function(a){this.grade_view=
new duo.GradeView({model:this.model});this.$("#grade").replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},checkForm:function(){var a=!1,a=""==this.$("#realname").val();return!a},renderEnd:function(){var a=this;b(document).unbind(this.getEventClass());this.model.save({end_time:new Date},{success:function(){a.showEndView()}});b("#app").removeClass("leave-warning");window.onbeforeunload=null;return this},preview:function(){var a=
"/certs/preview?language="+this.model.get("language")+"&fullname="+encodeURIComponent(this.$("#realname").val());window.open(a,"_blank")}});duo.VocabSessionView=duo.SessionView.extend({getNumHearts:function(){var a=3;4>this.model.get("session_elements").length&&(a=2);3>this.model.get("session_elements").length&&(a=1);duo.user.get("ab_options").hover_heart_experiment&&(a+=1);return a}});duo.WelcomeLessonSessionView=duo.SessionView.extend({initialize:function(){duo.SessionView.prototype.initialize.call(this);
this.backgrounds={hover:"intro-hover",translate:"hover-reminder"};this.background_counts={translate:1,hover:1};this.model.set({first_translate:!0})},renderElementView:function(){this.model.get("position");var a=this.model.currentElement(),c=duo.SessionView.prototype.renderElementView.call(this),a=a.get("type");a in this.background_counts&&0<this.background_counts[a]?(this.$(".intro").replaceWith(b.duostache(duo.templates[this.backgrounds[a]],this.model.toJSON())),this.background_counts[a]--,this.$("#session-element-container").css("minHeight",
280),this.$(".owl-standing-big").css("top",105),this.$(".owl-standing-big").removeClass("pointing"),this.$(".intro .top").css("top",95),"translate"==a&&0==this.background_counts[a]?(this.$("#bubble-hover-reminder").delay(1E3).fadeIn(),this.$(".owl-standing-big").delay(1E3).removeClass("pointing"),this.model.set({first_translate:!1})):"hover"==a&&(this.$("#session-element-container").css("minHeight",250),this.$(".owl-standing-big").removeClass("pointing"),this.$(".intro .top").css("top",40),this.$(".owl-standing-big").css("top",
130))):this.$(".intro").empty();return c},ready:function(){duo.SessionView.prototype.ready.call(this);var a=this.model.currentElement().get("type");"translate"==a&&1==this.background_counts[a]&&this.$("#bubble-enter-reminder").fadeIn()}});duo.blinky=function(a,c,d){a=b(a);a.css("border-top-color")==c?a.css("border-color",d):a.css("border-color",c)};duo.WelcomeSessionView=duo.SessionView.extend({id:"app",className:"player",template:duo.templates.session,events:{"click #submit_button":"submit","click .redesign-check":"submit",
"click #continue_button":"next","click .redesign-next":"next","click #skip_button":"skip","change #learning-language":"pickedLanguage","keyup #learning-language":"pickedLanguage","click #quit-button":"leaveWelcome"},initialize:function(a){var c=this.options.observer_data;a=c?c.observer_email:void 0;c=c?c.observed_section:void 0;b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{welcome:!0,no_direction:this.options.no_direction,email:a,section:c}),duo.templates));this.bindEvents();
a&&duo.user.confirmObserver(a,c);this.progress_view=new duo.WelcomeProgressView({model:this.model});this.$("#progress-bar").replaceWith(this.progress_view.render().el);this.grade_view=new duo.GradeView({model:this.model});this.$("#grade").replaceWith(this.grade_view.render().el);this.model.incrementPosition();this.model.bind("hover",this.hover,this);var d=this;b("#duolingo_menu_logo").bind("click.session",function(a){d.welcomeLog({duolingo_logo:!0,activity_uuid:d.model.get("activity_uuid")});if(!duo.user.get("learning_language"))return!1;
b(document).unbind(".session");b("#duolingo_menu_logo").unbind("click.session")});duo.track("welcome_start");this.backgrounds=["intro-1","intro-hover","intro-translate"];this.soundEffectsEnabled=duo.user.playEffects()&&soundManager},renderElementView:function(){var a=this.model.get("position"),c=this.model.currentElement();duo.track("welcome_"+a);0===a&&c.set({hover_instruction:!0});var d=duo.SessionView.prototype.renderElementView.call(this);this.backgrounds[a]&&this.$(".intro").replaceWith(b.duostache(duo.templates[this.backgrounds[a]],
this.model.toJSON()));var f=this;"speak"===c.get("type")?(this.$("#skip_button").show(),duo.updateGrade=_.wrap(duo.updateGrade,function(a,b){a(b);f.speak(b)})):this.$("#skip_button").hide();var g="contextTranslate"==c.get("type")&&"contextTranslate"!=this.model.previousElement().get("type");0===a?this.startTour():1===a&&this.showHeader();"title"==c.get("type")?(this.$("#next_button").text(translate_text("Start tour")),this.$("#next_button").removeAttr("disabled").addClass("redesign-next").removeClass("redesign-check"),
this.$("#next_button").removeAttr("data-toggle")):this.$("#next_button").attr("data-toggle","tooltip");"info"==c.get("type")?(this.$("#continue_button").text(translate_text("Continue")),this.$("#continue_button").show(),this.$("#submit_button").text(translate_text("Submit")),this.$("#submit_button").show()):"hover"===c.get("type")?(this.$("#continue_button").text(translate_text("Continue")),this.$("#continue_button").show(),this.$("#submit_button").hide()):"contextTranslate"===c.get("type")&&g?(this.$("#continue_button").text(translate_text("Continue")),
this.$("#continue_button").show(),this.$("#submit_button").text(translate_text("Check")),this.$("#submit_button").show()):"contextTranslate"===c.get("type")&&!g?(this.$("#continue_button").text(translate_text("Continue")),this.$("#continue_button").show(),this.$("#submit_button").text(translate_text("Check")),this.$("#submit_button").show(),this.showHoverReminder()):"translate"===c.get("type")?(this.$("#continue_button").text(translate_text("Continue")),this.$("#continue_button").show(),this.$("#submit_button").text(translate_text("Check")),
this.$("#submit_button").show()):"microphone_activation"===c.get("type")&&this.$("#no-mic-link").show();return d},startTour:function(){this.$("#submit_button").hide();this.options.no_direction?this.$("#continue_button, #next_button").text(translate_text("Save")):this.$("#continue_button, #next_button").text(translate_text("Start tour"));this.$("#continue_button").addClass("primary").removeClass("success");this.$(".player-header").addClass("transparent")},showHeader:function(){this.$(".player-header").removeClass("transparent");
this.$("#progress-bar").show();this.$("#continue_button").removeClass("primary").addClass("success");this.$("#continue_button").text(translate_text("Continue"));this.$("#submit_button").show()},showHoverReminder:function(){this.$("#bubble-hover-reminder").delay(1E3).fadeIn();this.$(".owl-standing-big").delay(1E3).removeClass("pointing")},getViewName:function(a){return"translate"===a.get("type")?"StackTranslateElementView":"contextTranslate"===a.get("type")?"ContextTranslateElementView":(a.get("example")?
"Example":"")+a.get("type").toTitleCase()+"ElementView"},renderEnd:function(){var a=this;b(document).unbind(".session");this.model.save(null,{success:function(){var c=new duo.WelcomeSessionEndView({model:a.model,hearts_view:a.hearts_view,progress_view:a.progress_view,className:"player"});b(a.el).replaceWith(c.render().el);duo.user.fetch();b("#app").addClass("player");b(".player-container").css({opacity:1})}});return this},ready:function(){duo.SessionView.prototype.ready.call(this);var a=this.model.currentElement(),
c="contextTranslate"==a.get("type")&&"contextTranslate"!=this.model.previousElement().get("type");("contextTranslate"===a.get("type")&&c||"translate"==a.get("type"))&&b("#bubble-enter-reminder").addClass("slide-in-left-right")},next:function(){var a=this.model.get("position"),c=this.model.currentElement();this.welcomeLog({continued:a,type:c.get("type"),activity_uuid:this.model.get("activity_uuid")});if(0===a&&(!duo.user.get("learning_language")||this.options.no_direction)){a=this.$("#learning-language").val();
if(!this.$('#learning-language option[value="'+a+'"]').data("language"))return!1;a=0<a.indexOf("-")?a.replace("-","_"):duo.user.get("ui_language")+"_"+a;b.ajax({url:"/users/"+duo.user.get("username"),data:JSON.stringify({language_direction:a}),success:function(a){"ok"==a.response?window.location.reload(!0):b("#continue_button").removeAttr("disabled")},type:"PUT",dataType:"json",contentType:"application/json; charset=utf-8"})}else duo.SessionView.prototype.next.call(this);return!1},failed:function(){},
graded:function(a){duo.SessionView.prototype.graded.call(this,a);this.model.currentElement();0===this.model.get("position")&&!duo.user.get("learning_language")&&this.$("#continue_button").attr("disabled","disabled")},hover:function(a){this.welcomeLog({hover:a,activity_uuid:this.model.get("activity_uuid")})},speak:function(a){this.welcomeLog({speak:a,activity_uuid:this.model.get("activity_uuid")})},pickedLanguage:function(){this.$("#continue_button").removeAttr("disabled")},welcomeLog:function(a){a.activity_uuid=
this.model.get("activity_uuid");b.post("/welcome/log",a)},leaveWelcome:function(){"welcome"==this.model.get("type")&&duo.homeRouter.navigate("/",!0)}});duo.WelcomeProgressView=duo.ProgressView.extend({initialize:function(){duo.ProgressView.prototype.initialize.call(this);this.model.bind("change",this.render,this)},render:function(){var a=_.size(this.model.get("session_elements"));duo.user.get("facebook_id");var c=a+2;b(this.el).html(b.duostache(this.template,{elements:_.range(1,c)}));for(c=0;c<this.model.get("position");c++)this.$(".nothing:first").removeClass("nothing").addClass("done");
1<a&&(this.model.unbind("change",this.render,this),this.model.get("session_elements").unbind("remove",this.elementRemoved,this),this.model.get("session_elements").bind("remove",this.elementRemoved,this));return this}});duo.WelcomeSessionEndView=Backbone.View.extend({id:"app",template:duo.templates["welcome-session-end-fb"],events:{"click #facebook-connect":"loginFB","click .follow-button":"follow","click #skip-button":"skipFB","click #next-button":"showCoachEnd","click #show-more-friends":"showMoreFriends",
"click .invite-friend":"inviteFriend","click #quit-button":"leaveWelcome","click .goal-chooser label":"selectCoachGoal","click .continue-home":"continueHome","keyup .coach-goal-chooser":"changeSelected",'keyup input[name="coach-email-address"]':"clearErrors"},initialize:function(a){this.progress_view=a.progress_view;this.model.bind("change",this.render,this);this.show_facebook=!duo.user.get("facebook_id")},render:function(){duo.track("welcome_end");if(duo.user.get("trial_account"))return this.showCoachEnd(),
this;if(!this.show_facebook){this.registered_with_facebook=!0;var a=FB.getAuthResponse();_.toArray(arguments).slice(2);if(a)this.fetchFromFB(a);else{var c=this;FB.login(function(a){a.authResponse&&c.fetchFromFB.call(c,a.authResponse)},{scope:"publish_actions"})}return this}b(this.el).html(b.duostache(this.template,_.extend(this.model.toJSON(),{welcome:!0}),duo.templates));this.$("#progress-bar").replaceWith(this.progress_view.el);this.renderSkills();_.defer(function(){window.twttr&&twttr.widgets&&
twttr.widgets.load()});return this},renderFBFriends:function(){var a=this.duo_friends.length;b(this.el).html(b.duostache(duo.templates["welcome-fb-friends"],{show_friends:this.duo_friends,num_show_friends:Math.min(6,a),num_more_friends:Math.max(0,a-6),singular:1===a,num_friends:a,other_friends:_.values(this.other_friends).slice(0,6),registered_with_facebook:this.registered_with_facebook},duo.templates));this.$(".search").typeahead({source:_.keys(this.other_friends),render:this.renderSearch,lookup:this.typeaheadLookup,
data:{friends:this.other_friends}});_.defer(function(){self.$("label").inFieldLabels()});this.progress_view&&this.$("#progress-bar").replaceWith(this.progress_view.el);duo.track("welcome_end facebook_friends")},loginFB:function(){var a=this;duo.track("welcome facebook connect click",{facebook_available:!!window.FB});window.FB&&FB.login(function(b){b.authResponse&&(duo.track("welcome facebook connected"),a.fetchFromFB.call(a,b.authResponse))},{scope:"publish_actions"})},fetchFromFB:function(a){var c=
a.userID;a=a.accessToken;var d=this;duo.user.set({facebook_id:c});duo.user.fetchAvatar("http://graph.facebook.com/"+c+"/picture?type=large");FB.api("/me/friends?access_token="+a+"&fields=picture,installed,name",function(a){d.duo_friends=_.filter(a.data,function(a){return a.installed});d.other_friends={};_(a.data).chain().filter(function(a){return!a.installed}).each(function(a){d.other_friends[a.name]=a});b.post("/facebook_connect",{facebook_id:c,facebook_friends:JSON.stringify(d.duo_friends),auto_follow:!d.model.get("one_click")},
function(a){for(var b=0;b<d.duo_friends.length;b++)a.friends[d.duo_friends[b].id]&&(a.friends[d.duo_friends[b].id].user_id=a.friends[d.duo_friends[b].id].id),_.extend(d.duo_friends[b],a.friends[d.duo_friends[b].id]);d.duo_friends=_(d.duo_friends).chain().filter(function(a){return a.user_id}).map(function(a,b){a.not_shown=6<=b;return a}).value();d.renderFBFriends();duo.user.set(a.user_following.data);_.extend(duo.user.getSkills(),a.user_following.skill_rank_data)})});FB.api("/me?fields=name&access_token="+
a,function(a){duo.user.set({facebook_name:a.name})});this.model.get("one_click")||(a={language:"http://www.duolingo.com/"+(duo.debug?"og_debug":"og")+"/"+this.model.get("language")},duo.postFacebookAction(duo.fb_app,"start_learning",a))},follow:function(a){a=b(a.target);var c=a.data("user");a.hasClass("success")?(duo.user.unfollow(c),a.removeClass("success").text(translate_text("Follow"))):(duo.user.follow(c),a.addClass("success").text(translate_text("Following")))},skipFB:function(){this.showCoachEnd()},
showCoachEnd:function(){duo.track("welcome_end skills_summary");b(this.el).html(b.duostache(duo.templates["welcome-session-end-coach"],_.extend(this.model.toJSON(),{fb_connected:duo.user.has("facebook_id")}),duo.templates));b(".player-container").css({opacity:1});this.show_facebook&&(this.progress_view.graded(),this.$("#progress-bar").replaceWith(this.progress_view.el));this.renderSkills();_.defer(function(){window.twttr&&twttr.widgets&&twttr.widgets.load()});return this},showMoreFriends:function(){this.$("#followed-friends li").show();
this.$(".more-friends-on-duo").hide()},typeaheadLookup:function(a){this.query=this.$element.val();return!this.query?(a=this.options.data.friends,b("#invite-friends").html(b.duostache(duo.templates["other-fb-friends"],{other_friends:_.values(a).slice(0,this.options.items)},duo.templates)),this):this.search(this.query).hide()},renderSearch:function(a){var c=this.options.data.friends;a=_.map(a,function(a){return c[a]});b("#invite-friends").html(b.duostache(duo.templates["other-fb-friends"],{other_friends:a},
duo.templates));return this},inviteFriend:function(a){var c=b(a.currentTarget);a=c.data("user");duo.track("facebook invite click");FB.ui({method:"send",link:"http://duolingo.com/#/register?ib="+duo.user.id,to:a,name:translate_text("You're Invited to Join Duolingo!"),description:translate_text("With Duolingo you learn a language for free, while helping to translate the web."),picture:"http://static.duolingo.com/images/facebook/owl.png"},function(a){a&&(duo.track("facebook invited"),c.attr("disabled",
"disabled").text(translate_text("Invited")))})},welcomeLog:function(a){b.post("/welcome/log",a)},renderSkills:function(){var a=this;this.model.has("end_event")&&_.each(this.model.get("end_event").skills,function(b){b.skill&&(new duo.SkillItemView({model:new duo.Skill(duo.Skill.prototype.parse.call(a,b.skill)),improvement:b.improvement,el:this.$("#skill-"+b.skill.id)})).render()},this)},leaveWelcome:function(){"welcome"==this.model.get("type")&&duo.homeRouter.navigate("/",!0)},selectCoachGoal:function(a){this.$(".daily-goal-option").removeClass("active");
b(a.currentTarget).addClass("active");a.stopPropagation();this.$(".continue-home").removeAttr("disabled","")},continueHome:function(){var a=this.$('input[name="daily-goal"]:checked').data("goal"),c=b.trim(b('input[name="coach-email-address"]').val()),d={daily_goal:a};0<c.length&&(d.email=c);b.ajax({url:"/users/"+duo.user.username,data:JSON.stringify(d),success:function(b){"ok"==b.response?(duo.user.set({daily_goal:a}),"email"in d&&duo.user.set({email:c}),duo.homeRouter.navigate("/",!0)):("invalid email address"==
b.message&&self.$("#invalid-email-error").show(),"email address already taken"==b.message&&self.$("#taken-email-error").show())},type:"PUT",dataType:"json",contentType:"application/json; charset=utf-8"})},changeSelected:function(a){if(38==a.which||40==a.which||37==a.which||39==a.which)this.$(".daily-goal-option").removeClass("active"),this.$(".coach-goal-chooser input:checked").closest(".daily-goal-option").addClass("active")},clearErrors:function(){this.$(".error-flag").hide()}})})(window.jQuery);
duo.StaticDirectory=Backbone.View.extend({id:"app",events:{"click .nav-tabs li":"onTabSwitch"},template:duo.templates["static"],initialize:function(){this.termsView=new duo.TermsView({id:"tab-container"});this.helpView=new duo.HelpView({id:"tab-container"});this.privacyView=new duo.PrivacyView({id:"tab-container"});this.guidelinesView=new duo.GuidelinesView({id:"tab-container"});this.studyView=new duo.StudyView({id:"tab-container"});this.infoView=new duo.InfoView({id:"tab-container"});this.pressView=
new duo.PressView({id:"tab-container"});var b=this;$.get("/jobs_list",function(a){b.jobsView=new duo.JobsView({id:"tab-container",data:a})},"json");this.jobsView=new duo.JobsView({id:"tab-container"});this.mobileView=new duo.MobileView({id:"tab-container"})},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));return this},tab:function(b){this.$("#"+this.current_tab+"_tab").parent().removeClass("active");this.$("#"+b+"_tab").parent().addClass("active");this.$("#tab-container").replaceWith(this[b+
"View"].render().el);this[b+"View"].delegateEvents();this.current_tab=b;this.switchToTab(b+"_tab");this.$(".tabs").toggle("mobile"!=b);var a=_.contains(["mobile","terms","privacy","help","guidelines"],b);this.$(".about-banner").toggle(!a);this.$(".tabs.nav-tabs").toggle(!a);this.$(".mobile-banner").toggle("mobile"==b)},clear:function(){this.model.unbind("change",this.saved)},onTabSwitch:function(b){b=$(b.currentTarget);this.switchToTab(b.data("tab"))},switchToTab:function(b){this.$(".tabs li").removeClass("active");
this.$('.tabs li[data-tab="'+b+'"]').addClass("active")}});duo.StaticTab=Backbone.View.extend({id:"tab-container",initialize:function(){this.model.bind("change",this.render,this)},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));this.postRender();return this},postRender:function(){},submit:function(b){b(!1)},success:function(){}});
duo.TermsView=Backbone.View.extend({id:"tab-container",template:duo.templates.terms,render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this}});
duo.HelpView=Backbone.View.extend({template:duo.templates.help,events:{"click .switch-troubleshoot":"switchToTroubleshoot"},initialize:function(){var b=this;$.get("/comments/troubleshooting_id",function(a){b.troubleshoot_id=a})},render:function(){var b=[];b["learning_language_"+duo.browser_language]=!0;b.hide_zendesk=duo.hide_zendesk;$(this.el).html($.duostache(this.template,b,duo.templates));return this},switchToTroubleshoot:function(){duo.commentRouter.navigate("/topic/"+(this.troubleshoot_id||
"647"),{trigger:!0})}});duo.PrivacyView=Backbone.View.extend({template:duo.templates.privacy,render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this}});duo.GuidelinesView=Backbone.View.extend({template:duo.templates.guidelines,render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this}});
duo.StudyView=Backbone.View.extend({template:duo.templates.study,render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this}});
duo.InfoView=Backbone.View.extend({template:duo.templates.info,events:{"click .arrow.prev":"previousSlide","click .arrow.next":"nextSlide"},initialize:function(){this._slide_number=0;this.employee_dict=[{title:"The Design Team",people:["Beth|justbeth","Greg|gregoryhartman","Tyler|tylrmurphy","Sean|sean__chin"]},{title:"Our Engineers",people:["Cody|captaincody","Brooke|bchan","Max|maxtp","David|davidk"]},{title:"Our Engineers",people:["Matt|mstreeter","Karin|karint","DTA|a_david","Tony|tony","Hideki|hideki"]},
{title:"Our Engineers",people:["Antonia|erdnuss","Burr|tatou","Art|artnc","Caitlin|parakeet","Franklin|senax"]},{title:"Our QA Team",people:["Pam|pamec","Hector|hector"]},{title:"Our Community Team",people:["Myra|myra","Kristine|kristinemc","R\u00e9my|remy"]},{title:"Business and Marketing",people:["Rogelio|roger","Gina|ginafrombrazil","Ling|iammaling"]},{title:"Finance and Executive Support",people:["Denis|dmeinert","Alicia|aledden"]},{title:"Leadership",people:["Luis|luis","Severin|severin"]}];
_.each(this.employee_dict,function(b,a){b.index=a;_.each(b.people,function(a,d){var f=b.people[d].split("|");b.people[d]={name:f[0].toLowerCase(),upper_name:f[0],username:f[1]}})})},render:function(){$(this.el).html($.duostache(this.template,{employee_dict:this.employee_dict,ui_language:duo.user?duo.user.get("ui_language"):duo.browser_language},duo.templates));this.$('.group[data-index="'+this._slide_number+'"]').css({left:"0px"});return this},goToSlide:function(b,a){b=(b%9+9)%9;var c=this.$(".team-slide").width(),
d=this.$('.group[data-index="'+b+'"]');b!=this._slide_number&&!this.$(".group").is(":animated")&&(d.css({left:(a?"":"-")+c+"px"}),d.animate({left:"0px"}),this.$('.group[data-index="'+this._slide_number+'"]').animate({left:(a?"-":"")+c+"px"}),this._slide_number=b)},previousSlide:function(){this.goToSlide(this._slide_number-1,!1)},nextSlide:function(){this.goToSlide(this._slide_number+1,!0)}});
duo.MobileView=Backbone.View.extend({template:duo.templates.mobile,events:{"click #email-app-link":"showLinkPopover","click #get-app-link":"getAppLink","keyup #email":"keyCheckEmail","click input":"enableSend","keyup #email":"enableSend"},initialize:function(){this.launch=new Date(2012,10,13);duo.topbar.bind("navigate",this.stop)},render:function(){var b=(this.launch-new Date)/1E3;parseInt(b%60);parseInt(Math.floor(b/60));parseInt(Math.floor(b/3600));parseInt(Math.floor(b/86400));$(this.el).html($.duostache(this.template,
{ui_language:duo.user?duo.user.get("ui_language"):duo.browser_language,email:duo.user&&!duo.user.get("trial_account")?duo.user.get("email"):""},duo.templates));window.scrollTo(0,0);this.send_iphone=!1;var a=this;_.defer(function(){a.$("label").inFieldLabels()});return this},showLinkPopover:function(){this.$("#app-link-popover").fadeToggle()},keyCheckEmail:function(b){13===b.which&&this.getAppLink()},getAppLink:function(){var b=$.trim(this.$("#email").val()),a=duo.user?duo.user.get("ui_language"):
duo.browser_language,c=this,d=this.$('input[name="device-choice"]:checked').val();if(!d)return!1;$.post("/app_link",{email:b,lang:a,iphone:"apple"==d},function(a){"ok"===a.response?c.$("#app-link-popover").hide():c.$("#message").fadeIn().delay(1E3).fadeOut()})},enableSend:function(){var b=$.trim(this.$("#email").val()),a=this.$('input[name="device-choice"]:checked').val();""!=b&&a?this.$("#get-app-link").removeAttr("disabled"):this.$("#get-app-link").attr("disabled","disabled")},closeModal:function(){this.$(".modal").modal("hide")}});
duo.StudyView=Backbone.View.extend({template:duo.templates.study,render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));window.scrollTo(0,0);return this}});duo.JobsView=Backbone.View.extend({template:duo.templates.jobs,initialize:function(b){this.data=b},render:function(b){$(this.el).html($.duostache(this.template,this.data,duo.templates));this.$("#nav-"+b).addClass("active");window.scrollTo(0,0);return this}});
duo.PressView=Backbone.View.extend({template:duo.templates.press,render:function(){var b=duo.user?duo.user.get("ui_language"):duo.browser_language;$(this.el).html($.duostache(this.template,{pt_ui_language:"pt"==b,es_ui_language:"es"==b,num_users_total:80},duo.templates));window.scrollTo(0,0);return this}});
duo.UnsupportedLanding=Backbone.View.extend({template:duo.templates["unsupported-landing"],id:"app",render:function(){$("#zendesk-wrapper").hide();$(this.el).html($.duostache(this.template,{logged_in:duo.user},duo.templates));window.scrollTo(0,0);return this}});
duo.AlertModal=Backbone.View.extend({template:duo.templates["alert-modal"],events:{"click .modal-close":"closeModal","click .modal-success":"triggerCallback"},render:function(){var b=this.options;b[this.options.type]=!0;b[this.options.message_type]=!0;$(this.el).html($.duostache(this.template,b,duo.templates));this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});this.$(".modal").modal("show")},closeModal:function(){this.$(".modal").modal("hide");this.undelegateEvents()},triggerCallback:function(){this.$(".modal").modal("hide");
this.options.callback()}});
duo.User=Backbone.Model.extend({url:function(){return"/users/"+this.get("username")},toJSON:function(){var b=Backbone.Model.prototype.toJSON.call(this);this.has("language_data")&&(b.learning_language_points=this.getSkills().points);this.has("ab_options")&&(b.ab={},_.each(this.get("ab_options"),function(a,c){b.ab[c+"_"+a]=!0}));delete b.language_data;return b},parse:function(b){if(b.language_data)for(var a in b.language_data){b.language_data[a].skills=new duo.SkillList(duo.SkillList.prototype.parse(b.language_data[a].skills));b.language_data[a].bonus_skills=
new duo.SkillList(duo.SkillList.prototype.parse(b.language_data[a].bonus_skills));var c=b.language_data[a].tc_estimate;b.language_data[a].fluency_score=c&&0.2<c?10*c:void 0}b.events&&(a=b.events.p_view,c=new duo.EventList,c.reset(b.events,{parse:!0}),c.user_id=this.id||b.id,c.before=b.before,c.more_events=b.more_events,c.p_view=a,c.error=b.events_error,b.events=c);return b},getSkills:function(){return this.get("language_data")[this.get("learning_language")]},getOwnedBonusSkills:function(){for(var b=
duo.user.getSkills().bonus_skills,a=[],c=0;c<b.models.length;c++){current=b.models[c];var d=current.get("name").toLowerCase()+"_"+duo.user.get("learning_language");d in duo.user.get("inventory")&&(d={short_name:current.get("short"),date:duo.user.get("inventory")[d]},a.push(d))}return a},getStrengths:function(){var b={},a=duo.user.getSkills().skills.where({learned:!0});a.push.apply(a,duo.user.getSkills().bonus_skills.where({learned:!0}));_.each(a,function(a){b[a.get("name")]=a.get("strength")});return b},
trialExpired:function(){var b=duo.getCookie();return duo.user.get("ab_options").web_delayed_wall_experiment?"skill_finished_"+duo.user.get("learning_language")in b:1<duo.user.getSkills().max_tree_level},switchLanguage:function(b){var a=this;duo.prebeta_experimental_mode||(duo.track("switch_language",{learning_language:b,from_language:duo.user.get("ui_language")}),$.post("/switch_language",{learning_language:b},function(c){duo.immersion_enabled=c.immersion_enabled;a.get("language_data")[b]=c;a.get("language_data")[b].skills=
new duo.SkillList(duo.SkillList.prototype.parse(c.skills));a.get("language_data")[b].bonus_skills=new duo.SkillList(duo.SkillList.prototype.parse(c.bonus_skills));for(var d=a.get("languages"),f=0;f<d.length;f++)d[f].language==b?(!1===d[f].learning&&duo.user.get("auto_facebook_post")&&FB.getAuthResponse()&&duo.postFacebookAction(duo.fb_app,"start_learning",{language:"http://duolingo.com/"+(duo.debug?"og_debug":"og")+"/"+b}),d[f].learning=!0,d[f].current_learning=!0):d[f].current_learning=!1;a.set({learning_language:b,
learning_language_string:c.language_string});mixpanel.register({learning_language:a.get("learning_language")});duo.topbar.render();duo.userRouter.navigate("",!0);duo.user&&window.Zenbox.update({dropboxID:duo.zendesk_ids[duo.user.get("ui_language")]});"rtl"==duo.script_direction&&$("body").removeClass("compact-enabled")}))},switchDirection:function(b,a,c){duo.prebeta_experimental_mode||$.post("/api/1/me/switch_language",{learning_language:b,from_language:a},function(d){duo.trackAndReload("switch_language",
{learning_language:b,from_language:a},c)})},updateActivity:function(b,a,c){var d=this;$.ajax({url:"/activity/"+this.id,data:c?{home_view:!0}:void 0,success:function(c){c.events=c.events||[];d.set(d.parse(c),a);b&&b()},error:function(c,g,h){d.set(d.parse({events:[],events_error:h}),a);b&&b()}})},fetchTranslationTiers:function(b){var a=this;$.ajax({url:"/translation_tiers/"+this.id,success:function(c){a.set(c,{silent:!0});b&&b()}})},follow:function(b,a){$.post("/follow",{user_id:b},function(b){b.user_following&&
(_.extend(duo.user.getSkills(),b.user_following.skill_rank_data),duo.user.set(b.user_following.data,{silent:a}))});duo.track("follow")},unfollow:function(b,a){$.post("/unfollow",{user_id:b},function(b){b.user_following&&(_.extend(duo.user.getSkills(),b.user_following.skill_rank_data),duo.user.set(b.user_following.data,{silent:a}))});duo.track("unfollow")},block:function(){$.post("/api/1/users/block",{user_id:this.id});duo.track("block",{blocked_user_id:this.id});duo.user.get("blocking").push(this.id);
this.set("is_blocking",!0);this.set("is_following",!1);this.set("is_followed_by",!1)},unblock:function(){$.post("/api/1/users/unblock",{user_id:this.id});duo.track("unblock",{blocked_user_id:this.id});duo.user.set("blocking",_.without(duo.user.get("blocking"),this.id));this.set("is_blocking",!1)},hasFriendshipsLoaded:function(){return this.get("num_followers")==this.get("followers").length&&this.get("num_following")==this.get("following").length},getFriendships:function(b,a,c){var d=this;$.getJSON("/friendships/"+
this.id,function(f){d.set(f,{silent:b});a&&(c=c||this,a.call(c,f))})},fetchAvatar:function(b){duo.debug||$.post("/avatars",{user_id:this.id,fetch:!0,image:b},function(a){console.log("avatar fetched from ",b)})},dismissNotification:function(b){$.post("/dismiss_notification",{message:b},function(a){"ok"===a.response&&(duo.user.getSkills().notifications[b]=!1)})},setObserver:function(b,a,c){$.ajax({type:"POST",url:"/api/1/observers/set_observer",async:!1,contentType:"application/json; charset=utf-8",
data:JSON.stringify({email_address:b,tag:a}),dataType:"json",success:function(a){c&&c(a)},error:function(a){try{var b=JSON.parse(a.responseText),c;"invalid email"==b.error?c="invalid_email":"too many observees"==b.error&&(c="observee_limit");duo.modalAlert({custom_title:!0,type:"alert",message_type:c})}catch(h){console.log("Failed to parse error response.")}}})},confirmObserver:function(b,a){var c=function(){duo.track("add_observer",{from_settings:!1})};duo.modalAlert({type:"custom_type",custom_title:!1,
message_type:"add_observer",okay_text:translate_text("Continue"),cancel_text:translate_text("Not now"),observer_email:b,callback:function(){duo.user.setObserver(b,a,c)}})},updatePreferredDashboardVersion:function(b){var a=this;$.post("/api/1/observers/update_preferred_version",{prefers_v2:b},function(){a.set({prefers_v2:b},{silent:!0})})},shouldAutoPlay:function(){return this.get("autoplay")&&this.get("speaker")},playEffects:function(){return this.get("sound_effects")&&this.get("speaker")},incrementSkillPoints:function(b){var a=
this.getSkills();a.points+=b;a.level_progress+=b;a.level_progress=Math.min(Math.max(0,a.level_progress),a.level_points);0<b&&(!duo.user.get("ab_options").coach_web_experiment&&!duo.user.get("daily_goal"))&&this.extendStreak()},extendStreak:function(){this.get("streak_extended_today")||this.set({streak_extended_today:!0,site_streak:1+this.get("site_streak")})},isBlocking:function(b){return _.contains(this.get("blocking"),b)},isBlockedBy:function(b){return _.contains(this.get("blockers"),b)}});
duo.UserList=Backbone.Collection.extend({model:duo.User,parse:function(b){return"users"in b?(this.more=b.more,this.page=b.page,b.users):b},fetch:function(b){b=b||{};b.data=b.data||{};b.data.per_page=this.per_page;Backbone.Collection.prototype.fetch.call(this,b)},nextPage:function(){this.fetch({data:{page:this.page+1},update:!0,remove:!1})}});
duo.StoreInfo=Backbone.Model.extend({url:"/api/1/store/get_items",initialize:function(){this.allowed_misc_items=["streak_freeze","rupee_wager","certification","timed_practice"];this.total_bonus_slots=3},parse:function(b){this.price_dict=_.object(_.pluck(b.misc_items,"name"),_.pluck(b.misc_items,"price"));this.bonus_skills=b.bonus_skills;b.prices=this.price_dict;return b=this.updateStoreInfoForUser(b)},updateStoreInfoForUser:function(b){var a=duo.user.get("rupees"),c=duo.user.get("inventory");data=
b||{};data.bonus_skills=this.bonus_skills;var d=this;_.each(this.allowed_misc_items,function(b){data["afford_"+b]=a>=d.price_dict[b];data["own_"+b]="certification"==b?b+"_"+duo.user.get("learning_language")in c:b in c});_.each(data.bonus_skills,function(b){var d=b.name+"_"+duo.user.get("learning_language");b.afford=a>=b.price;d in c&&(b.own=!0)});data.slots=Math.max(this.total_bonus_slots-duo.user.getOwnedBonusSkills().length,0);return data}});
duo.FormView=duo.View.extend({gatherInput:function(b){b=this.$(b+" :input");var a={};$.each(b,function(){var b=$(this).val();"radio"===this.type||"checkbox"===this.type?$(this).prop("checked")&&(a[this.name]="true"===b||"false"===b?"true"===b:b):a[this.name]=b});return a}});
duo.RegisterFormView=duo.FormView.extend({template:duo.templates["register-form"],events:{"keydown #register-form":"registerKeyInput","blur #fullname":"suggestUsernames","click #login":"suggestUsernames","click .suggested-name":"useSuggestion","click .direction-option":"changeDirection"},register_route:"/register",initialize:function(b){this._prefilled={};this._ui_location=b.ui_location},render:function(){this._suggestion_base="";var b=duo.user&&duo.user.get("trial_account")&&!duo.isTrialEmail(duo.user.get("email"))?
duo.user.get("email"):void 0;$(this.el).html($.duostache(this.template,_.extend({available_languages:this.options.magic_link_view?_.filter(duo.available_languages,function(a){return a.from_ui}):duo.available_languages,learning_language:duo.available_languages[0].learning_language,ui_language:duo.available_languages[0].from_language,hide_language_select:this.options.hide_language_select,email:b||this.options.email,splash_skip_delayed:this.options.splash_skip_delayed,hide_social_signup:this.options.magic_link_view},
this._prefilled),duo.templates));this.delegateEvents();var a=this;_.defer(function(){a.$("label").inFieldLabels({periodic:!0})});_.defer(function(){var b=a._prefilled.learning_language?a._prefilled.learning_language:$(".language-list li").first().data("value");a.$("#direction .prompt").text($("#opt-"+b).text());a.$("#direction").attr("data-value",b)});this.suggestUsernames();return this},registerKeyInput:function(b){this.$(".error").removeClass("error");this.$(".error-flag").hide();if(13===b.which)return this.register(),
!1},changeDirection:function(b){var a=$(b.currentTarget).data("value"),c=a,d=duo.browser_language,f=a.split("-");1<f.length&&(c=f[1],d=f[0]);this.options.magic_link_view||Backbone.history.navigate("/register$target_language="+c);d!=duo.browser_language?duo.switchLanguage(d):(this.$('input[name="learning_language"]').val($(b.currentTarget).data("value")),this.$("#direction .prompt").text($("#opt-"+a).text()))},suggestUsernames:function(){var b=this,a=$.trim(b.$("#fullname").val());""==a?b.$(".suggest-box").hide():
a!=this._suggestion_base&&(this._suggestion_base=a,b.$(".suggest-box").show(),b.$(".suggest1, .suggest2").text("").fadeTo(0,0).fadeTo(800,1),$.get("/api/1/users/suggest_username",{name:a},function(a){0<a.length?(b.$(".suggest1").text(a[0]),1<a.length&&b.$(".suggest2").text(a[1])):b.$(".suggest-box").hide()}))},useSuggestion:function(b){b=$(b.currentTarget).text();this.$("#login").val(b);this.$(".error").removeClass("error");this.$(".error-flag").hide()},fillWithFacebook:function(b,a,c){var d=this;
duo.loginWithFacebook(this._ui_location,function(){b&&b()},function(b){d.prefill({facebook_username:b.username,profile_image:b.profile_image_url,facebook_id:b.id,facebook_name:b.name,fullname:b.name,email:b.email});a&&a()},function(){d.clearSocialLogin();c&&c()})},hasFacebook:function(){return Boolean(this._prefilled.facebook_id)},clearSocialLogin:function(){this.prefill({facebook_id:null,profile_image:null,facebook_name:null})},prefill:function(b){_.extend(this._prefilled,b)},register:function(){var b=
this;args=this.gatherInput("#register-form");mixpanel.get_property&&(args.mixpanel_id=mixpanel.get_property("distinct_id"));this.$(".error-flag").hide();this.$(".error").removeClass("error");var a=(new Date).getTime();$.post(this.register_route,args,function(c){var d=(new Date).getTime()-a,f="email";"facebook_id"in args&&(f="facebook");"OK"===c.response?duo.track("register",{learning_language:args.learning_language,with_facebook:"facebook_id"in args,ui_location:b._ui_location,through:f,successful:!0,
latency_ms:d,from_magic_link:b.options.magic_link_view,from_dashboard:!b.options.magic_link_view&&b.options.splash_skip_delayed},function(){if(b.options.magic_link_view){var a=b.options.section,a=a?encodeURIComponent(a):"";if($.browser.mobile)window.location.reload();else if(duo.user)window.location.reload(!0);else{var c="/welcome$email="+b.options.observer_email;a&&(c+="&section="+a);window.location=c}}else window.location=b.options.splash_skip_delayed?"https://dashboard.duolingo.com":duo.user?"/":
"/welcome"},300):(_.each(c.failures,function(a,b){this.$("#"+b).addClass("error");this.$("#"+a+"-"+b+"-error").show()},b),duo.track("register",{learning_language:args.learning_language,successful:!1,through:f,ui_location:b._ui_location,error:_.keys(c.failures).join(", "),latency_ms:d}))},"json");return!1}});
duo.DelayedRegisterFormView=duo.RegisterFormView.extend({register_route:"/register_delayed",gatherInput:function(b){b=duo.RegisterFormView.prototype.gatherInput.call(this,b);b.username=b.register_login;b.password=b.register_password;delete b.register_login;delete b.register_password;return b}});
duo.RegisterView=duo.View.extend({events:{"click .signup-trial":"showForm","click .signup-language":"showForm","click .signup-facebook":"signupFacebook","click .signup-google":"signupGoogle","click #register-button":"register","click .language-select td":"signupTrial","click .expand-english":"toggleEnglishCourses","click .existing-login":"existingLogin","click .have-account":"existingLoginMobile"},initialize:function(b){this._form=this._createForm(b.ui_location);this._form_hidden=!0;this._single_learning_language=
this.options.single_learning_language;this.section=b.section;this.observer_email=b.observer_email;this.show_magic_register_modal=b.show_magic_register_modal},_createForm:function(b){return new duo.RegisterFormView({ui_location:b,splash_skip_delayed:this.options.splash_skip_delayed,magic_link_view:this.options.magic_link_view,observer_email:this.options.observer_email,section:this.options.section,hide_language_select:this.options.hide_language_select,email:this.options.email})},render:function(){$(this.el).html($.duostache(this.template,
{show_form:!this._form_hidden,has_facebook:this._form.hasFacebook(),single_learning_language:this._single_learning_language,languages_from_ui:_.filter(duo.available_languages,function(a){return a.from_ui}),languages_from_en:_.filter(duo.available_languages,function(a){return"en"==a.from_language}),splash_skip_delayed:this.options.splash_skip_delayed,show_mobile_view:$.browser.mobile,hide_social_signup:this.options.magic_link_view||this.options.hide_social_signup,google_only:this.options.google_only,
magic_link_view:this.options.magic_link_view,show_magic_register_modal:this.show_magic_register_modal},duo.templates));if(this.options.magic_link_view){var b=duo.browser_language,a=_.filter(duo.available_languages,function(a){return a.from_language==b})[0];this._form.prefill({ui_language:b,learning_language:a?a.learning_language:void 0})}this.show_magic_register_modal&&this._form.prefill({ui_language:duo.user.get("ui_language"),learning_language:duo.user.get("learning_language"),selectable_learning_language:!1});
this._form.render();this.$("#register-form-container").append(this._form.el);return this},doNotAnimate:function(){this._form_hidden=!1},doAnimate:function(){this._form_hidden=!0},showForm:function(){},hideForm:function(){},showPrefilled:function(b){this._form.prefill(b);this.showForm()},signupTrial:function(b){var a=$(b.currentTarget).hasClass("from-ui-language")?duo.browser_language:"en";$.post("/register",{trial_account:!0,one_click:!0,ui_language:a,learning_language:$(b.currentTarget).find(".choose-language").data("language")},
function(a){duo.track("$create_alias",{alias:String(a.user_id)},function(){window.location="/welcome"},300)})},showForm:function(b){this._form.clearSocialLogin();this.showForm()},signupFacebook:function(b){var a=this;a._form.fillWithFacebook(function(){window.location.href="/"},function(){a.showForm()})},signupGoogle:function(){},register:function(){this._form.register()},toggleEnglishCourses:function(){this.$(".english-courses").slideToggle("600")},existingLogin:function(){$("#signup-modal").modal("hide");
$(".login-popover").show();$(".login-popover #top_login").focus()},existingLoginMobile:function(){this._form_hidden=!0;$("#signup-main:visible, #signup-language:visible").fadeOut(250,function(){$(".login").fadeIn()})}});
duo.SplashRegisterView=duo.RegisterView.extend({template:duo.templates["small-register"],initialize:function(b){duo.RegisterView.prototype.initialize.call(this,_.extend({ui_location:"splash registration"},b));duo.vent.bind("closeRegister",this.closeForm,this);duo.vent.bind("logInClicked",this.existingLoginMobile,this)},showForm:function(){var b=this;if(this._form_hidden){Backbone.history.navigate("/register");var a=b.$("#signup-main"),c=b.$("#signup-language");a.fadeOut(250,function(){$(b.el);c.hide();
$("body").animate({scrollTop:0},250,function(){c.fadeIn(250)})})}else b.render();b._form_hidden=!1;$(".featured-languages").fadeOut()},closeForm:function(){this._form_hidden||($(this.el).css("height",""),$(this.el).css("overflow",""));var b=this.$("#signup-main");this.$("#signup-language:visible, .login:visible").fadeOut(250,function(){b.hide();b.fadeIn();$(".featured-languages").fadeIn()});this._form_hidden=!0},signupGoogle:function(b){duo.loginWithGoogle("splash registration",function(){window.location.reload(!0)},
function(){window.location.href="/welcome"})}});
duo.MagicLinkRegisterView=duo.RegisterView.extend({template:duo.templates["small-register-container"],events:_.extend({},duo.RegisterView.prototype.events,{"click .confirm-teacher":"confirmTeacher"}),register:function(){this._form.observer_email=this.observer_email;this._form.section=this.section;this._form.hide_social_signup=!0;this._form.register()},showTeacherConfirmation:function(){this.$("#signup-email").hide();this.$("#teacher-confirmation").fadeIn()},confirmTeacher:function(){this._form.observer_email=
this.observer_email;this._form.section=this.section;this._form.hide_social_signup=!0;this._form.register()}});
duo.RegisterModalView=duo.RegisterView.extend({id:"register-view",template:duo.templates["registration-modal"],events:_.extend({},duo.RegisterView.prototype.events,{"hidden #signup-modal":"doAnimate"}),showForm:function(){this._form_hidden?(this.render(),this.$("#signup-modal").modal("show")):(this.$("#signup-modal").removeClass("fade").modal("hide"),this.render(),this.$("#signup-modal").removeClass("fade").modal("show").addClass("fade"));this._form_hidden=!1}});
duo.DelayedRegisterModalView=duo.RegisterModalView.extend({initialize:function(b){duo.RegisterModalView.prototype.initialize.call(this,_.extend({ui_location:"delayed modal"}),b)},_createForm:function(b){return new duo.DelayedRegisterFormView({ui_location:b})},signupGoogle:function(){duo.loginWithGoogle("delayed_modal",function(){window.location.reload(!0)},function(){window.location.reload(!0)})}});
duo.NewUserModalView=Backbone.View.extend({template:duo.templates["new-user-modal"],events:{"click .existing-login":"switchToLoginView","click .create-profile":"switchToCreateView"},render:function(){$(this.el).html($.duostache(this.template,{},duo.templates));var b=_.extend({el:this.$("#register-view")},this.options);this.register_view=duo.user?new duo.DelayedRegisterModalView(b):this.options.learning_language?new duo.CourseRegisterModalView(b):new duo.RegisterModalView(b);this.login_view=new duo.LoginModalView({el:this.$("#login-view")});
this.register_view.render();this.login_view.render();return this},switchToLoginView:function(){duo.user||duo.ab_options.login_modal_experiment?(this.$("#register-view").hide(),this.$("#login-view").show(),this.$("#user-login").hide(),this.$("#create-account").show()):(this.$("#signup-modal").modal("hide"),$(".topbar #sign-in-btn").click())},switchToCreateView:function(){this.$("#login-view").hide();this.$("#register-view").show();this.$("#create-account").hide();this.$("#user-login").show()}});
duo.LoginView=duo.FormView.extend({id:"app",className:"page-login",template:duo.templates.login,events:{"click #login-button":"login"},login:function(){var b=this;args=this.gatherInput("#login-form");$.post("/login",args,function(a){"OK"===a.response?(duo.trackAndReload("login old id",{login_method:"email",ui_location:"login page"}),console.debug("logged in1",window.location.hash),b.$("input[type!=submit]").removeClass("error")):(b.$("#message").text(translate_text("Wrong username or password")),
b.$("#message").show(),b.$("input[type!=submit]").addClass("error"))},"json");return!1},render:function(b){this.delegateEvents();$("#topbar-menu").hide();$(this.el).html($.duostache(this.template,{came_from:b,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));var a=this;_.defer(function(){a.$("label").inFieldLabels({periodic:!0})});return this}});duo.LoginModalView=duo.LoginView.extend({id:"login-view",template:duo.templates["login-modal"]});
duo.ForgotView=duo.FormView.extend({id:"app",className:"page-forgot",template:duo.templates.forgot,events:{"click input[type=submit]":"submit","click .input-block":"hideErrors"},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));var b=this;_.defer(function(){b.$("label").inFieldLabels()});return this},submit:function(){var b=$("#email").val();!/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$$/.test(b)||
-1==b.indexOf("@")?($("#email").addClass("error"),$("#form_txt_good").hide(),this.$("#email-error").show()):(duo.track("forgot password"),$.post("/forgot",{email:b},function(a){a.success?($("#form_txt_good").show(),$("#email").removeClass("error"),$("#forgot-form").hide()):($("#email").addClass("error"),$("#form_txt_good").hide(),$("#not-found-email").show())},"json"));return!1},hideErrors:function(){this.$(".warning-message").hide()}});
duo.ResetView=Backbone.View.extend({id:"app",className:"page-reset",template:duo.templates.reset,events:{"click input[type=submit]":"submit"},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{email:this.options.email,token:this.options.token}));var b=this;_.defer(function(){b.$("label").inFieldLabels()});return this},submit:function(){var b=$("#email").val(),a=$("#token").val(),c=$("#new-password").val(),d=$("#confirm-new-password").val(),f=this;$.post("/reset",{email:b,
token:a,new_password:c,confirm_new_password:d},function(a){"OK"===a.response?(f.$("input[type=text]").removeClass("error"),f.$("#reset-message").text(""),$("#form_txt_good").show(),$("#reset-form").hide()):(f.$("#reset-message").text(translate_text(a.response)),f.$("#reset-message").show(),console.debug(a),a.fields&&f.$("input[type=password]").addClass("error"))},"json");return!1}});
duo.OneClickLanding=duo.FormView.extend({id:"app",className:"one-click-landing",template:duo.templates["one-click-landing"],events:{"click input[type=submit]":"submit"},initialize:function(){var b=this;$.get("/one_click/get_username",{email:this.options.email},function(a){b.username=a;b.render()})},render:function(){$(this.el).html($.duostache(this.template,{email:this.options.email,token:this.options.token,username:this.username}));var b=this;_.defer(function(){b.$("label").inFieldLabels()});return this},
submit:function(){var b=this.gatherInput("#gplus-form");b.one_click=!0;var a=this;$.post("/reset",b,function(b){"OK"===b.response?window.location.href="/":(a.$("#reset-message").text(translate_text(b.response)),a.$("#reset-message").show(),b.fields&&a.$("input[type=password]").addClass("error"))},"json");return!1}});
duo.SplashView=duo.FormView.extend({id:"app",template:duo.templates.splash,events:{"click #subscribe-button":"subscribe","click #language-dropdown":"languageList","click .language-selector li":"hideLanguageList","click #video-toggle":"showVideo","click .bottom-signup-btn":"redirectClick","click .testing":"showRegistration","click #login-button":"login"},initialize:function(){this.removeTrialCookies()},render:function(){var b=_.filter(duo.available_languages,function(a){return a.from_ui});"en"==duo.browser_language&&
(_.findWhere(b,{learning_language:"dn"}).base_learning_language_name="Dutch");$(this.el).html($.duostache(this.template,{ui_language:duo.browser_language,ui_language_lang_id:duo.browser_language_id,languages_from_ui:b,single_learning_language:2>b.length,en_ui_language:"en"==duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages},duo.templates));this.signup_view=new duo.SplashRegisterView({el:this.$(".signup"),single_learning_language:2>b.length,splash_skip_delayed:this.options.splash_skip_delayed,
google_only:this.options.google_only,email:this.options.email});this.signup_view.render();var a=this;_.defer(function(){a.$("label").inFieldLabels({periodic:!0});a.$("option[value="+duo.learning_language+"]").attr("selected",!0);Backbone.history.once("route",a.cleanUp,a);a.onScroll();$(window).bind("scroll",a.onScroll);var b;$(window).resize(function(){clearTimeout(b);b=setTimeout(a.checkForSlider,500)});setTimeout(a.checkForSlider,0)});return this},removeTrialCookies:function(){var b=Object.keys(duo.getCookie());
_.each(b,function(a){0===a.indexOf("skill_finished_")&&duo.removeCookie(a)})},checkForSlider:function(){"en"==duo.browser_language&&(1400>Math.max(document.documentElement.clientWidth,window.innerWidth||0)?(this.$(".featured-languages").addClass("slider"),this.slider&&0<this.$(".bx-wrapper").length?this.slider.reloadSlider():this.slider=$(".bxslider").bxSlider({minSlides:6,maxSlides:7,slideWidth:115,slideMargin:0,moveSlides:2,pager:!1})):(this.slider&&this.slider.destroySlider(),this.$(".featured-languages").removeClass("slider")))},
onScroll:function(){$(".topbar").toggleClass("no-shadow",0>=$(window).scrollTop());this.$(".scroll-animate").each(function(b,a){a=$(a);a.visible(!0)&&a.addClass("slide-in")})},languageList:function(){$(".language-selector").show()},hideLanguageList:function(){$(".language-selector").hide()},cleanUp:function(){$(window).unbind("scroll",this.onScroll);$(".topbar").removeClass("no-shadow")},subscribe:function(){var b=$("#email").val(),a=$("#learning_language").val();!/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$$/.test(b)||
-1==b.indexOf("@")?($("#email").addClass("error"),$("#form_txt_good").hide(),$("#form_txt_bad").hide()):""==a?($("#learning_language").addClass("error"),$("#form_txt_good").hide(),$("#form_txt_bad").hide()):$.post("/subscribe",{email:b,learning_language:a},function(a){"1"==a?(duo.track("subscribe"),$("#form_txt_good").show()):$("#form_txt_bad").show();$("#email").removeClass("error");$("#subscribe-form").hide()},"json");return!1},showRegistration:function(b){this.signup_view.doNotAnimate();this.signup_view.showPrefilled(b)},
showVideo:function(){duo.showIntroVideo(duo.browser_language)},redirectClick:function(b){b=$(b.currentTarget).data("id");this.$(".login").hide();this.signup_view.$("#"+b).click();$("html, body").animate({scrollTop:0},1E3)},login:function(){var b=this;args=this.gatherInput("#login-form");$.post("/login",args,function(a){"OK"===a.response?(duo.trackAndReload("login old id",{login_method:"email",ui_location:"login page"}),console.debug("logged in1",window.location.hash),b.$("input[type!=submit]").removeClass("error")):
(b.$("#message").text(translate_text("Wrong username or password")),b.$("#message").show(),b.$("input[type!=submit]").addClass("error"))},"json")}});
duo.NotifyView=duo.SplashView.extend({id:"app",className:"page-notify",template:duo.templates.notify_me,events:{"click #subscribe-button":"subscribe"},initialize:function(){},render:function(b){$(this.el).html($.duostache(this.template,{email:b,ui_language:duo.browser_language,ui_language_name:duo.ui_language_name,ui_languages:duo.ui_languages},duo.templates));_.defer(function(){self.$("label").inFieldLabels()});return this}});
duo.TopbarViewBase=duo.FormView.extend({template:duo.templates.menu,events:{"click #login-button":"login","click #sign-in-btn":"toggleLogin","click #facebook-login":"facebookLogin","keyup #login-form input":"onInput","click .signup-gplus":"signUpGplus","click .signup-facebook":"facebookLogin","click .hamburger":"showMobileMenu","click .topbar-right":"showMobileMenu"},login:function(b){var a=this;args=this.gatherInput("#login-form");mixpanel.get_property&&(args.mixpanel_id=mixpanel.get_property("distinct_id"));
$.post("/login",args,function(b){"OK"===b.response?(0==window.location.hash.indexOf("#/register")&&(window.location.hash="#"),duo.trackAndReload("login old id",{login_method:"email",ui_location:"topbar login"}),a.$("input[type=text], input[type=password]").removeClass("error")):(a.$("#message").text(translate_text("Wrong username or password")),a.$("#message").show(),a.$("input[type=text], input[type=password]").addClass("error"))},"json");b.preventDefault()},toggleLogin:function(){var b=this.$("#login-modal");
b.toggle();b.find("#top_login").focus();b.is(":visible")&&_.defer(function(){$(document).unbind("click.topbar").one("click.topbar",function(a){0<$(a.target).closest(".sign-in").size()||b.hide()})})},facebookLogin:function(){var b=this;b.$("#message").hide();duo.loginWithFacebook("topbar login",function(){window.location.reload(!0)},function(a){Backbone.history.navigate("/register",{trigger:!0});duo.loginRouter.showRegistration({facebook_username:a.username,profile_image:a.profile_image_url,facebook_id:a.id,
facebook_name:a.name,fullname:a.name,email:a.email})},function(){b.$("#message").text(translate_text("Unable to connect to Facebook. Please try again later or use a different method to sign in."));b.$("#message").show()})},signUpGplus:function(b){var a=this;a.$("#message").hide();duo.loginWithGoogle("topbar login",function(){window.location.reload(!0)},function(){window.location.href="/welcome"},function(){a.$("#message").text(translate_text("Unable to sign in with Google+. Please try again later or use a different method to sign in."));
a.$("#message").show()})},onInput:function(b){13!==b.which&&(this.$("#message").hide(),this.$("input[type=text], input[type=password]").removeClass("error"))},showMobileMenu:function(b){this.$(".mobile-menu").hasClass("open")?this.closeMobileMenu():(this.$(".mobile-menu").addClass("open"),$('<div id="mobile-menu-backdrop"></div>').appendTo(document.body),$("#mobile-menu-backdrop").hide().fadeIn(100));b.stopPropagation()},closeMobileMenu:function(){this.$(".mobile-menu").removeClass("open");$("#mobile-menu-backdrop").delay(500).fadeOut(300,
function(){$(this).remove()})}});
duo.LoginTopbarView=duo.TopbarViewBase.extend({events:function(){return _.extend({},duo.TopbarViewBase.prototype.events,{"click #site-language-btn":"toggleLanguages","click .ui-language-option":"switchLanguage","click .navigate-home":"goToSplash","click .show-languages":"showLanguages","click .back-to-menu":"backToMenu","click .show-log-in":"goToLogIn"})},start:function(){duo.loginRouter.bind("all",this.navigate,this);duo.commentRouter.bind("all",this.navigate,this);duo.courseRouter.bind("all",this.navigate,
this);duo.staticRouter.bind("all",this.navigate,this)},render:function(){var b=navigator.userAgent,a=b.match(/(iPad|iPhone|iPod)/g)?!0:void 0,c=-1<b.toLowerCase().indexOf("android"),b=b.match(/iemobile/i)?!0:void 0;$(this.el).html($.duostache(this.template,{ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages,show_login:!0,zs_branding:"zs"==duo.browser_language,can_download_app:a||c||b,ios:a,android:c,windows:b}));var d=this;_.defer(function(){d.$("label").inFieldLabels({periodic:!0})});
return this},noTab:function(){this.$(".nav li").removeClass("active")},navigate:function(b){this.$(".nav li").removeClass("active");0===b.indexOf("route:register")||"route:splash"===b||"route:splashLanguage"===b||"route:magicLink"===b?(this.$(".hide-in-splash").hide(),this.$(".topbar").addClass("topbar-blue-dark").removeClass("topbar-blue"),this.$(".nav-footer .icon").addClass("white")):"route"!=b&&(this.$(".hide-in-splash").show(),this.$(".topbar").addClass("topbar-blue").removeClass("topbar-blue-dark"),
this.$(".nav-footer .icon").removeClass("white"),"route:mobile"===b?this.$("#mobile-nav").addClass("active"):"route:listComments"===b&&this.$("#questions-nav").addClass("active"));$(document).unbind(".session, .infinite_scroll");this.$("#login-modal").hide();"route"==b&&this.trigger("navigate")},toggleLanguages:function(){this.$("#site-language-modal").toggle();_.defer(function(){$(document).unbind("click.topbar-languages").bind("click.topbar-languages",function(b){0<$(b.target).closest(".dropdown").size()||
$("#site-language-modal").hide()})})},switchLanguage:function(b){duo.switchLanguage($(b.currentTarget).data("abbrev"));b.preventDefault()},goToLogIn:function(){this.closeMobileMenu();Backbone.history.navigate("/");duo.vent.trigger("logInClicked")},goToSplash:function(){0<$("body").scrollTop()&&$("html, body").animate({scrollTop:0},1E3);$("#signup-language, .login").is(":visible")&&duo.vent.trigger("closeRegister");this.closeMobileMenu();Backbone.history.navigate("/","/register"==window.location.pathname?
void 0:{trigger:!0})},showLanguages:function(){$(".mobile-menu-listing").addClass("hide-ul")},backToMenu:function(){$(".mobile-menu-listing").removeClass("hide-ul")}});
duo.MagicLinkView=duo.FormView.extend({id:"app",template:duo.templates["progress-magic-link"],events:{"click .sign-up-btn":"switchToSignup","click .log-in":"switchToLogin","click .log-out":"logOutUser","click .add-observer":"addObserver","click #login-button":"login"},initialize:function(b){this.current_view=duo.user?"confirmation":"login";this.observer_email=this.options.email;this.section=this.options.section},render:function(){var b=navigator.userAgent;this.$el.html($.duostache(this.template,{signup:"signup"==
this.current_view,login:"login"==this.current_view,confirmation:"confirmation"==this.current_view,success:"success"==this.current_view,show_mobile_view:$.browser.mobile,user_email:duo.user?duo.user.get("email"):void 0,observer_email:this.observer_email,ios:b.match(/(iPad|iPhone|iPod)/g)?!0:void 0,android:-1<b.toLowerCase().indexOf("android")},duo.templates));this.signup_view=new duo.MagicLinkRegisterView({el:this.$(".signup"),splash_skip_delayed:!0,hide_language_select:!1,magic_link_view:!0,show_mobile_view:$.browser.mobile,
observer_email:this.observer_email,section:this.section});this.signup_view.render();$(".topbar").addClass("no-shadow");this.$(".user-login").removeClass("hidden");return this},login:function(){var b=this;args=this.gatherInput("#login-form");$.post("/login",args,function(a){"OK"===a.response?(duo.trackAndReload("login old id",{login_method:"email",ui_location:"login page"}),console.debug("logged in1",window.location.hash),b.$("input[type!=submit]").removeClass("error")):(b.$("#message").text(translate_text("Wrong username or password")),
b.$("#message").show(),b.$("input[type!=submit]").addClass("error"))},"json")},switchToSignup:function(){this.current_view="signup";this.render()},switchToLogin:function(){this.current_view="login";this.render()},switchToSuccess:function(){this.current_view="success";this.render()},logOutUser:function(){duo.logout()},addObserver:function(){var b=this;$.post("/api/1/observers/set_observer",{email_address:this.observer_email,tag:this.section},function(){b.switchToSuccess()})}});
(function(b){duo.UserTopbarView=duo.TopbarViewBase.extend({id:"topbar",events:function(){return _.extend({},duo.TopbarViewBase.prototype.events,{"click .languages li":"switchLanguage","mouseenter .dropdown":"showMenu","mouseleave .dropdown":"hideMenu","click .dropdown .dropdown-menu":"hideMenu","keyup .search-input":"keycheckSearch","focus .search-input":"onFocusSearch","blur .search-input":"onBlurSearch","click .toggle-notifications":"showNotificationsModal","click .show-notifications":"showNotificationsModal",
"click .see-all-results":"showStream","click .follow":"follow","click #show-shortcuts":"showShortcuts","click #home-nav":"goHome","click .register-delayed":"registerDelayed","click .login-delayed":"loginDelayed","click #header_userdrop_logout":"logout","click #see-full-site":"showFullSite","click .topbar-brand":"clickBrand","click .register-delayed":"registerDelayed","click .sign-in-existing":"loginDelayed"})},template:duo.templates.menu,initialize:function(){this.lazySearch=this.debounce(this._search,
1500,!0);this.listenTo(this.model,"change:site_streak change:rupees",this.render);this.player=!1;duo.vent.bind("registerDelayed",this.registerDelayed,this);duo.vent.bind("loginDelayed",this.loginDelayed,this)},debounce:function(a,b,d){var f;return function(){var g=this,h=arguments;d&&!f&&a.apply(g,h);clearTimeout(f);f=setTimeout(function(){f=null;d||a.apply(g,h)},b)}},_search:function(){var a=b.trim(this.$(".search-input").val());0<a.length?(this.$(".top-search .loading-indicator").show(),b.get("/users/search",
{q:a,per_page:7},function(c){c.q=a;b(".top-search .hybrid-modal").html(b.duostache(duo.templates["menu-search-popup"],c,duo.templates)).show();b(document).unbind(".menu-search").bind("click.menu-search",function(a){0<b(a.target).closest(".top-search").size()||(b(".top-search .hybrid-modal, .top-search .loading-indicator").hide(),b(document).unbind(".menu-search"))});b(".top-search .loading-indicator").hide()})):this.$(".top-search .hybrid-modal").hide()},search:function(){this.lazySearch()},keycheckSearch:function(a){13===
a.which&&this.search()},onFocusSearch:function(){var a=this.$(".search-label");a.data("blurText")||a.data("blurText",a.text());a.text(a.data("focusText"))},onBlurSearch:function(){var a=this.$(".search-label");a.text(a.data("blurText"))},start:function(){var a=b("html").is(".ie6, ie7, .ie8, .safari5");duo.user.get("learning_language")&&(!a&&0<duo.checkValidDirection(duo.user.get("ui_language"),duo.user.get("learning_language")))&&(duo.loggedOutTranslationRouter.bind("route:translations",this.translationTab,
this),duo.loggedOutTranslationRouter.bind("route:translation",this.noTab,this),duo.commentRouter.bind("route:listComments",this.commentsTab,this),duo.homeRouter.bind("all",this.homeRoutes,this),duo.userRouter.bind("all",this.homeRoutes,this),duo.skillRouter.bind("all",this.skillRoutes,this),duo.settingsRouter.bind("all",this.noTab,this),duo.adminRouter.bind("all",this.adminTab,this),duo.staticRouter.bind("all",this.homeRoutes,this),duo.streamRouter.bind("route:stream",this.streamTab,this),duo.courseRouter.bind("all",
this.homeRoutes,this),duo.vocabRouter.bind("route:listVocab",this.vocabTab,this));this.model.bind("change:learning_language",this.changeLanguage,this);this.model.bind("change:username",this.render,this);this.model.bind("change:speaker",this.render,this);this.model.bind("change:microphone",this.render,this)},render:function(){var a={};duo.user.get("learning_language")?(a=_.extend(this.model.toJSON(),this.model.getSkills()),a.language_string||(a.language_string=this.model.get("learning_language_string")),
a.any_other_learning=_.any(this.model.get("languages"),function(a){return a.learning}),a.any_other_not_learning=_.any(this.model.get("languages"),function(a){return!a.learning}),a.num_notifications=a.notif_event_ids?a.notif_event_ids.length:0,a.has_certificates="certificates"in a&&0<a.certificates.length,a.in_player=this.player,a.show_vocab=_.contains(duo.vocab_languages,duo.user.get("ui_language"))&&_.contains(duo.vocab_languages,duo.user.get("learning_language"))&&!duo.user.get("trial_account")&&
duo.feature_flags.show_vocab_page):a=_.extend(this.model.toJSON());"zs"==duo.user.get("ui_language")&&"zt"!=duo.user.get("locale")&&(a.zs_branding=!0);a.show_login=duo.user.get("trial_account");b(this.el).html(b.duostache(this.template,a,duo.templates));440<this.$(".topbar-right").width()&&this.$(".topbar-right .name").addClass("hidden");this.notifications_view&&this.$("#popover-notifications").replaceWith(this.notifications_view.el);var c=this;_.defer(function(){c.$("label").inFieldLabels();duo.user.get("learning_language")||
c.$(".topbar-language").hide()});this.$("#global-loading-indicator").ajaxStart(function(){b(this).show()}).ajaxStop(function(){b(this).hide()});duo.user.get("inventory").heart_refill&&b.post("/api/1/store/refund_item",{item_name:"heart_refill"},function(a){a=duo.user.get("rupees")+4;duo.user.set({rupees:a},{silent:!0});b("#num_lingots").text(a)});return this},showMenu:function(a){b(a.currentTarget).find(".dropdown-menu").show()},hideMenu:function(a){a=b(a.currentTarget);a.is(".dropdown-menu")?a.hide():
a.find(".dropdown-menu").hide()},clickBrand:function(){this.closeMobileMenu()},switchLanguage:function(a){a=b(a.currentTarget);a.data("value")&&"more"!==a.data("value")&&this.model.switchLanguage(a.data("value"))},changeLanguage:function(){var a=this.$("li.active").attr("id");this.render();this.$("#"+a).addClass("active")},noTab:function(){b("body").removeClass("player");b("#app").removeClass("leave-warning");window.onbeforeunload=null;b(document).unbind(".session, .infinite_scroll");this.$(".nav li").removeClass("active").show();
this.$(".speaker-micro-toggle").show();b("#box_feedback #activity_uuid").val("");this.$(".user-nav, .top-search").show();this.trigger("navigate");b.tts.cleanAll();this.$(".top-search .hybrid-modal").hide();this.$(".search-input").val("").blur();this.$(".topbar-nav-main li").removeClass("active")},homeTab:function(){this.noTab();this.$("#home-nav").addClass("active")},vocabTab:function(){duo.track("Topbar Vocabulary");this.noTab();this.$("#vocab-nav").addClass("active")},mobileTab:function(){this.noTab();
this.$("#mobile-nav").addClass("active")},adminTab:function(){this.noTab();this.$("#admin-nav").addClass("active")},commentsTab:function(){duo.track("Topbar Questions");this.noTab();this.$("#questions-nav").addClass("active")},teamsTab:function(){this.noTab();this.$("#teams-nav").addClass("active")},hideTabs:function(a){a||this.noTab();this.$(".nav li").hide().removeClass("active");this.$(".user-nav, .top-search").hide()},profileTab:function(a){this.noTab();(!a||a===duo.user.get("username"))&&this.$("#home-nav").addClass("active")},
friendsTab:function(){duo.track("Topbar Follow");this.noTab();this.$("#friends-nav").addClass("active")},translationTab:function(){duo.track("Topbar Translations");this.noTab();this.$("#translations-nav").addClass("active")},streamTab:function(){duo.track("Topbar Stream");this.noTab();this.$("#stream-nav").addClass("active")},sessionStart:function(){this.noTab();this.$(".speaker-micro-toggle").hide()},homeRoutes:function(a,b){"route:home"===a?this.homeTab():"route:profile"===a?this.noTab():"route:welcome"===
a?this.hideTabs():"route:mobile"===a?this.mobileTab():"route:stream"===a?this.streamTab():"route:findFriends"===a?this.friendsTab():"practiceLanguage"===a||"route:practice"===a||"practiceTimed"===a?(this.sessionStart(),this.$("#practice-nav").addClass("active")):"bigTest"===a?this.sessionStart():0===a.indexOf("route:")&&this.noTab()},skillRoutes:function(a){"route:skill"!==a?this.sessionStart():this.noTab()},showNotificationsModal:function(a){var c=this,d=!duo.user.has("notifs_expire")||duo.user.get("notifs_expire")<
new Date,f="rtl"==duo.script_direction;this.$(".count").fadeOut(600);var g=function(a){a=b(a.target);if(a.is("a")||a.hasClass("close")||0==a.closest("#popover-notifications").size())c.$("#popover-notifications").hide();else b(document).one("click",g)};!c.notifications_view||d?(f?b("#popover-notifications").css({right:b(window).innerWidth()/1.75+"px"}):b("#popover-notifications").css({left:b(window).innerWidth()+"px"}),b.getJSON("/notifications",function(d){duo.user.set({notification_events:d},{silent:!0});
c.notifications_view=new duo.TopbarNotificationsView({el:c.$("#popover-notifications")});b(window).innerWidth()<b(".toggle-notifications").offset().left+b("#popover-notifications").width()/2&&(f?(d=b(window).innerWidth()/1.75-b("#popover-notifications").width()-10+"px",b("#popover-notifications").animate({right:d},500)):(d=b(window).innerWidth()-b("#popover-notifications").width()-10+"px",b("#popover-notifications").animate({left:d},500)));c.notifications_view.render();b(".toggle-notifications").target_popover({trigger:"manual",
target:b("#popover-notifications"),placement:"bottom"});c.$("#popover-notifications").is(":visible")?b(".toggle-notifications").target_popover({method:"hide"}):(b(".toggle-notifications").target_popover({method:"show"}),b(document).one("click",g),a.stopPropagation())}),d=new Date,d.setMinutes(d.getMinutes()+1),duo.user.set({notifs_expire:d},{silent:!0})):c.$("#popover-notifications").is(":visible")?b("#popover-notifications").hide():(b("#popover-notifications").show(),b(document).one("click",g),a.stopPropagation())},
showShortcuts:function(){this.shortcuts_view=new duo.KeyboardShortcutsView({el:this.$("#keyboard-shortcuts")});this.shortcuts_view.render();this.$("#keyboard-shortcuts").modal("show")},showStream:function(){this.noTab();this.$("#home-nav").addClass("active")},follow:function(a){a=b(a.target);var c=a.data("user");a.hasClass("success")?(duo.user.unfollow(c,!0),a.removeClass("success").text(translate_text("Add friend"))):(duo.user.follow(c,!0),a.addClass("success").text(translate_text("Following")))},
goHome:function(){b(".back-home").click()},registerDelayed:function(a){this.closeMobileMenu();this._registerDelayed(!1,a?a.magic_data:void 0)},_registerDelayed:function(a,c){this.delayed_modal||(this.delayed_modal=c?new duo.MagicLinkRegisterView({splash_skip_delayed:!0,hide_language_select:!1,magic_link_view:!0,observer_email:c.email,section:c.section,show_magic_register_modal:!0}):new duo.NewUserModalView,this.delayed_modal.render(),b("body").append(this.delayed_modal.el));b("#signup-modal").modal({backdrop:"static",
keyboard:!1},"show");this.delayed_modal.register_view&&(this.delayed_modal.register_view.showPrefilled({ui_language:duo.user.get("ui_language"),learning_language:duo.user.get("learning_language"),selectable_learning_language:!1}),a?this.delayed_modal.switchToLoginView():this.delayed_modal.switchToCreateView())},loginDelayed:function(){this.closeMobileMenu();this._registerDelayed(!0)},logout:function(){duo.logout()},showFullSite:function(){b("body").removeClass("compact-enabled")}});duo.TrialOverlayView=
Backbone.View.extend({template:duo.templates["trial-overlay"],events:{"click .register-delayed":"registerDelayed","click .existing-login":"loginDelayed"},render:function(){var a={num_rupees:duo.user?duo.user.get("rupees"):0};a[this.options.type+"_overlay"]=!0;b(this.el).html(b.duostache(this.template,a,duo.templates,!0));return this},registerDelayed:function(){duo.vent.trigger("registerDelayed")},loginDelayed:function(){duo.vent.trigger("loginDelayed")}});duo.TopbarNotificationsView=Backbone.View.extend({template:duo.templates["notifications-view"],
render:function(){b(this.el).html(b.duostache(this.template,duo.user.toJSON(),duo.templates,!0));return this}});duo.KeyboardShortcutsView=Backbone.View.extend({template:duo.templates["keyboard-shortcuts"],events:{"click .close":"closeModal"},render:function(){b(this.el).html(b.duostache(this.template,duo.user.toJSON(),duo.templates,!0));return this},closeModal:function(){b("#keyboard-shortcuts").modal("hide")}});duo.MenuSearchResults=Backbone.View.extend({template:duo.templates["user-search-results"],
render:function(){b(this.el).html(b.duostache(this.template,duo.user.toJSON(),duo.templates));return this}});duo.FriendFindView=Backbone.View.extend({id:"app",template:duo.templates["friend-find"],events:{"keyup .search-input":"keycheckSearch"},initialize:function(){this.lazySearch=this.debounce(this._search,1500,!0);this.search_results=new duo.UserList;this.search_results.per_page=20;this.search_results.bind("sync",this.render,this);this.last_request_length=0},debounce:function(a,b,d){var f;return function(){var g=
this,h=arguments;d&&!f&&a.apply(g,h);clearTimeout(f);f=setTimeout(function(){f=null;d||a.apply(g,h)},b)}},render:function(){b(this.el).html(b.duostache(this.template,{q:this.q,users:this.search_results.toJSON()},duo.templates));var a=this;_.defer(function(){a.$("label").inFieldLabels()});this.preload_q&&(this.setQuery(this.preload_q),this.preload_q=void 0);a=this;_.defer(function(){b(document).unbind(".friend_find_scroll").bind("scroll.friend_find_scroll.infinite_scroll",function(c){c=b(document).height()-
b(document).scrollTop();var d=b(window).height();c<1.5*d&&a.search_results.length>a.last_request_length&&(a.$("#more-stream").hide(),a.last_request_length=a.search_results.length,a.loadNextPage())})});return this},_search:function(){var a=b.trim(this.$("#search-learners").val());this.last_request_length=0;this.q=a;0<a.length?(this.search_results.url="/users/search?q="+a,this.search_results.fetch()):this.search_results.reset()},search:function(){this.lazySearch()},keycheckSearch:function(a){13===a.which&&
this.search();this.old_scroll=0},setQuery:function(a){this.$("#search-learners").val(a);this.search()},loadNextPage:function(){this.search_results.nextPage()}});duo.LeaderSearchView=duo.FriendFindView.extend({events:{"keyup .search-input":"keycheckSearch","click .search-for-friends":"search"},initialize:function(){duo.FriendFindView.prototype.initialize.call(this);this.search_results.per_page=15;this.old_scroll=0},render:function(){b(this.el).html(b.duostache(this.template,{q:this.q,users:_.map(this.search_results.toJSON(),
function(a){return!duo.user?a:_.extend({},a,{is_being_blocked:duo.user.isBlocking(a.id),is_a_blocker:duo.user.isBlockedBy(a.id)})})},duo.templates));var a=this;_.defer(function(){a.$("label").inFieldLabels()});this.preload_q&&(this.setQuery(this.preload_q),this.preload_q=void 0);a=this;_.defer(function(){this.$("#list-results").unbind(".friend_find_scroll").bind("scroll.friend_find_scroll.infinite_scroll",function(b){b=a.$("#search-learners-results").height()-a.$("#list-results").scrollTop();var d=
a.$("#list-results").innerHeight();a.old_scroll=a.$("#list-results").scrollTop();b<d&&a.search_results.length>a.last_request_length&&(a.last_request_length=a.search_results.length,a.loadNextPage())})});a=this;_.defer(function(){a.$("#list-results").scrollTop(a.old_scroll)});return this}});duo.LoggedOutMessage=Backbone.View.extend({template:duo.templates["logged-out-message"],events:{"click #join":"join"},initialize:function(a){this.language=a.language||void 0},render:function(){var a={};this.model&&
(a=this.model.toJSON());a.language=this.language;b(this.el).html(b.duostache(this.template,a,duo.templates));b("#app").addClass("logged-out-shown");b("#join").show();return this},join:function(){duo.track("join")}})})(window.jQuery);
duo.ProfileView=Backbone.View.extend({id:"app",template:duo.templates.profile,events:{"click #profile-context-menu":"showContextMenu","click #block-toggle":"blockOrUnblock","focus .post-activity textarea, .post-activity input":"onStreamPost","click .post-activity #stream-post-btn":"makeStreamPost","keyup #stream-post":"enablePosting","input #stream-post":"enablePosting","propertychange #stream-post":"enablePosting","click #shadowban-user":"showShadowbanModal"},initialize:function(){this.model.bind("change",
this.render,this);duo.user&&(this.current_user=this.model.id==duo.user.id);this.model.updateActivity(_.bind(this.updateActivity,this),{silent:!0},!1);var b=this;this.model.fetchTranslationTiers(function(){b.render()})},render:function(){this.delegateEvents();var b=this.model.getSkills(),a=0;_.each(this.model.get("languages"),function(b){b.learning&&a++;b.stripped_language_string=b.language_string.split(" ")[0]});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),b,{current_user:!1,
current_user_profile:this.current_user,following_short:this.model.get("following").slice(-3),followers_short:this.model.get("followers").slice(-3),num_ranked:this.model.get("num_following")+1,next_level:b.level+1,points_languages:_.sortBy(this.model.get("languages"),function(a){return-a.points}),language_badge_fill:_.range((3+-a%3)%3),viewing_self:duo.user&&duo.user.id==this.model.id,viewer_trial_account:duo.user&&duo.user.get("trial_account"),new_profile_sidebar:duo.user&&duo.user.get("ab_options").web_profile_sidebar_experiment&&
"en"==duo.user.get("ui_language"),can_shadowban:duo.user&&(duo.user.get("global_moderator")||duo.user.get("admin"))}),duo.templates));var c=this;duo.user&&(this.$("#search-box").wordLookup({templates:duo.templates,source_language:duo.user.get("ui_language"),target_language:duo.user.get("learning_language"),id:this.model.get("username"),callback:this.lookedupWord,callback_context:this}),this.$("#stream-post").vkeyboard({language:duo.user.get("learning_language"),placeholder:this.$("#vkeyboard-placeholder"),
toggle_button:this.$("#toggle_vkeyboard"),shown:!1,caps:!1}));_.defer(function(){c.$(".post-activity label, #invite-box label").inFieldLabels();c.$(".post-activity textarea").autosize();duo.topbar.bind("navigate",c.cleanUp,c)});this.model.hasFriendshipsLoaded()?(new duo.ProfileFriendsView({model:this.model,el:this.$("#friends"),show_add_friends:!1})).render():this.model.getFriendships(!0,function(){(new duo.ProfileFriendsView({model:this.model,el:this.$("#friends"),show_add_friends:!1})).render()},
this);this.events_view&&(this.$("#stream-container").replaceWith(this.events_view.el),this.events_view.render());(new duo.ProfileStatsView({model:this.model,el:this.$("#stats")})).render();_.defer(function(){duo.topbar.bind("navigate",c.cleanUp,c)});return this},switchToTab:function(b){this.$(".home-panel").hide();this.$(".tabs li").removeClass("active");this.$('.tabs li[data-tab="'+b+'"]').addClass("active");this.$("#"+b+"-panel").removeClass("hidden").show();"activity"===b?(this.model.updateActivity(_.bind(this.updateActivity,
this),{silent:!0},!1),this.$(".counter").hide(),duo.track("present stream",{own_wall:this.current_user})):this.cleanUp(!0)},updateActivity:function(){this.model.get("events").profile_view=!1;this.model.get("events").user_id=this.model.id;this.events_view=new duo.EventsView({el:this.$("#stream-container"),collection:this.model.get("events"),model:this.model,home_view:!1});this.events_view.render();this.model.set({new_activities:0},{silent:!0})},showContextMenu:function(){var b=this.$("#profile-context-menu>ul");
b.toggle();$(document).one("click.event",function(){b.hide()});return!1},blockOrUnblock:function(){this.model.get("is_blocking")?this.model.unblock(this.model.id):this.model.block(this.model.id);return!1},onStreamPost:function(){this.$(".post-activity .post-footer").show();this.$(".post-activity .post-footer").removeClass("wrong");this.$(".post-activity #wrong-language-box").hide();this.$(".post-activity #search-box").show();this.$(".post-activity .post").addClass("focus");""==$.trim(this.$(".post-activity .post").val())&&
this.$("#stream-post-btn").attr("disabled","disabled");return!1},makeStreamPost:function(){var b=$.trim(this.$(".post-activity .post").val());if(""==b)return!1;var a=new duo.StreamPost({for_user_id:this.model.id,text:b}),c=this;a.save(null,{success:function(b,f){if("empty comment"==b.get("response"))return!1;c.model.get("events").add(a,{at:0});c.$(".post-activity .post").val("").blur();duo.track("post_on_stream",{own_wall:c.current_user})}});return!1},enablePosting:function(){""==$.trim(this.$(".post-activity .post").val())?
this.$("#stream-post-btn").attr("disabled","disabled"):this.$("#stream-post-btn").removeAttr("disabled")},showShadowbanModal:function(){this.shadowban_view||(this.shadowban_view=new duo.ShadowbanUserView({model:this.model}));this.shadowban_view.render();$("body").append(this.shadowban_view.el);$("#shadowban-form").on("hidden",function(){$("#shadowban-form").remove()}).modal("show")}});
duo.ShadowbanUserView=Backbone.View.extend({template:duo.templates["shadowban-form"],events:{"click .cancel-ban":"closeModal","click .ban-user":"submitBan","change #file-upload":"changeFile","input .description":"removeError","click label":"removeError","click .close":"closeModal"},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));return this},changeFile:function(){var b=this.$("#file-upload").val().match(/([^\/\\]+)$/)[1];$("#filename").html(b);$("#filename").css("color",
"#3c3c3c");this.file_uploaded=!0},closeModal:function(){this.$("#shadowban-form").modal("hide")},submitBan:function(){var b=!1;100>$(".description").val().length&&(this.$(".description").addClass("error"),b=!0);this.file_uploaded||(this.$("#filename").addClass("error"),b=!0);if(!b){var a=this;this.$("#shadowban-submit").ajaxSubmit({success:function(b){a.closeModal()},error:function(b){a.$(".error-placeholder").text(b.responseText);a.$(".modal-body").addClass("error")}})}},removeError:function(){this.$(".error").removeClass("error")}});
duo.ProfileFriendsView=Backbone.View.extend({template:duo.templates["profile-friends"],events:{"click .more":"showMore","click .switch-friends":"switchFriends"},render:function(){var b=8===this.model.get("num_following")?8:7,a=8===this.model.get("num_followers")?8:7;$(this.el).html($.duostache(this.template,{fb_friends:duo.user?duo.user.fb_friends:null,invite_fb_friends:"fb"===this.board,invite_friends:"invite"===this.board,following:this.model.get("following").slice(-b),followers:this.model.get("followers").slice(-a),
show_more_following:this.model.get("num_following")>b,num_show_more_following:this.model.get("num_following")-b,show_more_followers:this.model.get("num_followers")>a,num_show_more_followers:this.model.get("num_followers")-a,num_following:this.model.get("num_following"),num_followers:this.model.get("num_followers"),username:this.model.get("username"),list_friends:"fb"===this.board?duo.user.fb_friends:this.search_results,show_add_friends:this.options.show_add_friends||0==this.model.get("num_following")},
duo.templates));if(duo.user&&this.model.get("id")==duo.user.get("id")&&this.options.show_add_friends||0==this.model.get("num_following"))this.addFriends?(this.$("#add-friends").replaceWith(this.addFriends.render().el),this.addFriends.delegateEvents()):(this.addFriends=new duo.AddFriendsView({model:this.model,el:this.$("#add-friends"),parent_view:this}),this.addFriends.render()),this.search_view?(this.$("#search-list-results").replaceWith(this.search_view.render().el),this.search_view.delegateEvents()):
(this.search_view=new duo.LeaderSearchView({model:this.model,el:this.$("#search-list-results")}),this.search_view.render());return this},showMore:function(b){var a=$(b.currentTarget).data("type"),c=this.$("#"+a+"-modal");(new duo.FriendshipListModal({friends:this.model.get(a),el:c.find(".modal-body")})).render();c.appendTo("body").modal("show");var d=this;c.bind("hidden",function(){d.model.hasChanged("num_followers")||d.model.hasChanged("num_following");$("#"+a+"-modal").appendTo(d.$("#"+a));d.$(".list-users-small").remove();
c.find(".modal-body").unbind();c.unbind()}).delegate("a.user, a.username","click",function(a){$(this).closest(".modal").modal("hide")})},switchFriends:function(b){b=$(b.currentTarget).data("tab");this.$(".avatar-grid").hide();this.$(".switch-friends").removeClass("active");this.$("#"+b).show();this.$("#switch-"+b).addClass("active")}});
duo.FriendshipListModal=Backbone.View.extend({template:duo.templates["friendship-list"],events:{scroll:"onScroll","click .username":"goToProfile","click .follow-button":"toggleFollow"},initialize:function(b){this.friends=b.friends;this.num_shown=10},render:function(){$(this.el).html($.duostache(this.template,{shown_friends:_.map(this.friends.slice(0,this.num_shown),function(b){return!duo.user?b:_.extend({},b,{is_being_blocked:duo.user.isBlocking(b.id),is_a_blocker:duo.user.isBlockedBy(b.id)})})},
duo.templates))},onScroll:function(b){b=this.$("ul").height()-$(this.el).scrollTop();var a=$(this.el).innerHeight();b<a&&this.num_shown<this.friends.length&&(this.num_shown+=10,this.render())},goToProfile:function(){},toggleFollow:function(b){var a=$(b.target),c=a.data("user"),d=a.hasClass("success");d?(duo.user.unfollow(c,!0),a.removeClass("success").text(a.data("follow-text"))):(duo.user.follow(c,!0),a.addClass("success").text(a.data("unfollow-text")));_.find(this.friends,function(a){return a.id==
c}).is_following=!d;b.stopPropagation()}});
duo.AddFriendsView=Backbone.View.extend({template:duo.templates["invite-more"],events:{"click .email":"inviteByEmail","click .facebook":"fbConnect","click .search":"search","click .go-back":"goBack","click .send-invite":"sendInvite","keyup #invite-email":"inviteKeyCheck","click #invite-box .close":"closeInviteBox"},initialize:function(b){this.parent_view=b.parent_view},render:function(){var b=this.model.get("invites")?this.model.get("invites").invited.length:0,a=this.model.get("invites")?this.model.get("invites").invited:
[];$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),{fb_friends:duo.user?duo.user.fb_friends:null,invite_fb_friends:"fb"===this.board,invite_friends:"invite"===this.board,num_accepted:b,one_invited:1==b,two_invited:2==b,three_invited:3==b,friend_one:0<b?a[0]:void 0,friend_two:1<b?a[1]:void 0,friend_three:2<b?a[2]:void 0,more_invited:3<b,num_left:b-2}),duo.templates,!0));return this},inviteByEmail:function(b){this.$("#invite-box").slideToggle()},closeInviteBox:function(){this.$("#invite-box").slideUp()},
fbConnect:function(){void 0===duo.user.fb_friends?this.loginFB():this.showFB()},showFB:function(){this.parent_view.board="fb";this.parent_view.render();this.switchList();$("#fb-friends").show();$(".friends-title").text($(".friends-title").data("fb"))},goBack:function(){this.parent_view.board="ranking";this.parent_view.render();this.render();$("#points-ranking").show()},loginFB:function(){var b=this;window.FB&&FB.login(function(a){a.authResponse&&b.fetchFromFB.call(b,a.authResponse)},{scope:"publish_actions"})},
fetchFromFB:function(b){var a=b.userID;b=b.accessToken;var c=this;duo.user.set({facebook_id:a},{silent:!0});FB.api("/me/friends?access_token="+b+"&fields=picture,installed,name",function(b){var f=_.filter(b.data,function(a){return a.installed});$.post("/facebook_connect",{facebook_id:a,facebook_friends:JSON.stringify(f),auto_follow:!1,return_points:!1},function(a){for(var f=0;f<b.data.length;f++){var k=b.data[f];k.id in a.friends&&(a.friends[k.id].user_id=a.friends[k.id].id,_.extend(k,a.friends[k.id]))}duo.user.fb_friends=
_.sortBy(b.data,function(a){return a.name});c.showFB();duo.user.set(a.user_following.data,{silent:!0});_.extend(duo.user.getSkills(),a.user_following.skill_rank_data)})})},inviteKeyCheck:function(b){this.$("#invite-box p.error").hide();this.$("#invite-box #invite-email").removeClass("error");13===b.which&&this.sendInvite()},sendInvite:function(){var b=$.trim(this.$("#invite-email").val()),a=this;0!==b.length&&$.post("/invite",{email:b},function(c){"OK"===c.response?(duo.user.get("invites").invites_left=
c.invites_left,a.$("#invite-email").val(""),a.$("#invited-email").text(b),a.$(".send-notification").slideDown().delay(3E3).slideUp()):"user has already joined"===c.response?(a.$("#already-joined .user-link").attr("href","/#/"+c.user.username).text(c.user.username),a.$("#already-joined").slideDown().delay(3E3).slideUp()):"user has already been invited"===c.response?a.$("#already-invited").slideDown().delay(3E3).slideUp():"not an email"===c.response&&(a.$("#not-email").slideDown().delay(3E3).slideUp(),
a.$("#invite-email").addClass("error"));duo.track("invited friend",{valid:!1})})},search:function(){this.parent_view.board="search";this.parent_view.render();this.switchList();$("#search-friends").show();$("#search-learners").focus();$("#list-results").hide();$(".friends-title").text($(".friends-title").data("search"))},switchList:function(){$(".board, .invite-action").hide();$(".go-back").show();$("#followers").hide();$("#following").hide();$(".following-switch").hide()}});
duo.ProfileStatsView=Backbone.View.extend({template:duo.templates["profile-stats"],initialize:function(b){this.streak=0},render:function(){var b=0,a=0;_.each(this.model.get("languages"),function(c){b+=c.points;a+=c.sentences_translated;this.streak=this.streak<c.streak?c.streak:this.streak},this);$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{loading_word_count:!this.model.has("vocab_size"),total_points:b,total_sentences_translated:a,longest_streak:this.streak,points_languages:_.sortBy(this.model.get("languages"),
function(a){return-a.points}),sentences_translated_languages:_.sortBy(this.model.get("languages"),function(a){return-a.sentences_translated}),streak_languages:_.sortBy(this.model.get("languages"),function(a){return-a.streak})}),duo.templates));var c=this;this.model.has("vocab_size")||$.getJSON("/vocabularies/size",{user_id:this.model.id,language:"all"},function(a){a.vocab_size.languages=_.sortBy(a.vocab_size.languages,function(a){return-a.count});c.model.set({vocab_size:a.vocab_size},{silent:!0});
c.render()});return this}});
duo.HomeRoutes=duo.Router.extend({routes:{"practice/timed":"practiceTimed","practice/:language":"practiceLanguage","bigtest/:language/:test":"bigTest","placement/:language":"placementTest","certification/:language":"certificationTest","debug/:language/:words":"debugWords","debug/:source_language/:target_language/:sentence":"debugSentence","debug/:source_language/:target_language/:sentence/:se_type":"debugSentence","practice($from_email=:from_email)":"practice",real_world_practice:"realWorldPractice","welcome$email=:email&section=:section":"welcome",
"welcome$email=:email":"welcome",welcome:"welcome","notify_me$email=:email&ui_language=:ui_language":"notify_me","notify_me$email=:email":"notify_me",notify_me:"notify_me","one_click?email=:email&token=:token":"one_click","reset_password$email=:email&token=:token":"reset_password","reset_password$email=:email%26token=:token":"reset_password",translate:"translate",forgot_password:"forgotPassword","register($:extra)":"loggedIn","o$o=:email&s=:section":"magicLink","o$o=:email":"magicLink",o:"magicLink",
redirect:"redirectClosePopup"},initialize:function(){duo.topbar=new duo.UserTopbarView({model:duo.user});$("#topbar").replaceWith(duo.topbar.render().el)},redirectClosePopup:function(){this.navigate("",!0);window.close()},forgotPassword:function(){$(".modal").modal("hide");var b=new duo.ForgotView;this.switchView(b,"page-forgot")},welcome:function(b,a){var c=this,d=new duo.WelcomeSession;d.fetch({success:function(f,g){try{if(0===g.session_elements.length)duo.homeRouter.navigate("/",!0);else{document.title=
"Duolingo: "+translate_text("Welcome");a=a?decodeURIComponent(a):"";var h=new duo.WelcomeSessionView({model:d,observer_data:{observer_email:b,observed_section:a}});duo.track("welcome");c.switchView(h,"player")}}catch(k){$.post("/welcome/log",{fetched:!0,stack:k.stack,description:k.description,err:k.toString()})}}})},practice:function(b){b&&duo.track("email button click",{from_email:b});this.practiceLanguage(duo.user.get("learning_language"),!1,b)},practiceTimed:function(){this.practiceLanguage(duo.user.get("learning_language"),
!0)},practiceLanguage:function(b,a,c){var d=this,f=new duo.GlobalPracticeSession({language:b,from_email:c});f.fetch({success:function(b,c){if(0===c.session_elements.length)duo.modalAlert({type:"alert",message_type:"custom_message",message:translate_text("You have practiced all of your words. Try doing some lessons or translations.")}),duo.homeRouter.navigate("",!0);else{b.get("js_version")!=duo.js_version&&window.location.reload(!0);document.title="Duolingo: "+translate_text("Practice");var k=new duo.TimedSessionView({model:f,
extra:7,die:!0,total_time:30,points:!0,shown_max_time:60,auto_timed:a});d.switchView(k,"player")}}})},realWorldPractice:function(){$.getJSON("/real_world_practice",function(b){b.translation_id?(duo.loggedOutTranslationRouter.translationFromRealWorldPractice(b.translation_id),duo.loggedOutTranslationRouter.navigate("/translation/"+b.translation_id,!1),duo.track("real_world_practice")):alert("Sorry, there are no translations available right now!")})},bigTest:function(b,a){var c=this,d=new duo.BigTestSession;
d.fetch({data:{language:b,big_test:a},success:function(a,b){if(0===b.session_elements.length)duo.homeRouter.navigate("/",!0);else{a.get("js_version")!=duo.js_version&&window.location.reload(!0);document.title="Duolingo: "+translate_text("Test");var h=new duo.BigTestSessionView({model:d});c.switchView(h,"player")}}})},placementTest:function(b){console.log("placement test: "+b);var a=this,c=new duo.PlacementTestSession;c.fetch({data:{language:b},success:function(b,f){document.title="Duolingo: "+translate_text("Test");
var g=new duo.PlacementTestSessionView({model:c});a.switchView(g,"player")}})},certificationTest:function(b){console.log("certification test: "+b);var a=this,c=new duo.CertificationTestSession;delete duo.user.get("inventory")["certification_"+b];c.fetch({data:{language:b},success:function(b,f){document.title="Duolingo: "+translate_text("Test");var g=new duo.CertificationTestSessionView({model:c});a.switchView(g,"player")}})},debugWords:function(b,a){var c=new duo.DebugSession;c.fetch({data:{language:b,
words:decodeURIComponent(a)},success:function(a,b){if(0===b.session_elements.length)duo.homeRouter.navigate("/",!0);else{a.get("js_version")!=duo.js_version&&window.location.reload(!0);document.title="Duolingo: Debug";var g=new duo.SessionView({model:c});$("#app").replaceWith(g.render().el);$("#app").removeClass(duo.view)}}})},debugSentence:function(b,a,c,d){var f=new duo.DebugSession;f.fetch({data:{source_language:b,target_language:a,sentence:decodeURIComponent(c),se_type:d},success:function(a,b){if(0===
b.session_elements.length)duo.homeRouter.navigate("/",!0);else{a.get("js_version")!=duo.js_version&&window.location.reload(!0);document.title="Duolingo: Debug";var c=new duo.SessionView({model:f});$("#app").replaceWith(c.render().el);$("#app").removeClass(duo.view)}}})},reset_password:function(b,a){var c=new duo.ResetView({email:decodeURIComponent(b),token:a});this.switchView(c,"page-reset")},help:function(){document.title="Duolingo: "+translate_text("Help");var b=new duo.HelpView;this.switchView(b,
"help")},translate:function(){document.title="Duolingo: Translate";var b=new duo.TranslateView;$("#app").replaceWith(b.render().el);$("#app").removeClass(duo.view);duo.view=null},notify_me:function(b,a){duo.courseRouter.navigate("/courses",!0)},one_click:function(b,a){var c=new duo.OneClickLanding({email:decodeURIComponent(b),token:a});this.switchView(c,"one-click-landing");$("#logged-out-message").hide()},magicLink:function(b,a){duo.track("magic_link_click",{logged_out:!1});a=a?decodeURIComponent(a):
"";if(duo.user.get("trial_account"))duo.vent.trigger("registerDelayed",{magic_data:{email:b,section:a}});else if($.browser.mobile){document.title="Duolingo";var c=new duo.MagicLinkView({email:b,section:a});this.switchView(c,"magic-link","magic-link-body")}else duo.homeRouter.navigate("/",!0),_.defer(function(){duo.user.confirmObserver(unescape(b),a)})}});
duo.LoginRouter=duo.Router.extend({routes:{"register$email=:email&invite=:invite&ui_language=:ui_language&invited_via=:invited_via":"register_ui","register$email=:email&invite=:invite&ui_language=:ui_language":"register_ui","register$email=:email&invite=:invite&target_language=:target_language&ui_language=:ui_language":"register","register$email=:email&invite=:invite&target_language=:target_language":"register","register$email=:email&invite=:invite":"register","register$fbid=:fbid":"registerWithFB",
"register$twttrid=:twttrid":"registerWithTwttr","register$ib=:user_id&invited_via=:invited_via":"registerWithInvite","register$ib=:user_id":"registerWithInvite","register$target_language=:target_language":"registerLanguage",register:"register","register_user$email=:email":"registerSkipDelayed",register_user:"registerSkipDelayed","o$o=:email&s=:section":"magicLink","o$o=:email":"magicLink",o:"magicLink","notify_me$email=:email&ui_language=:ui_language":"notify_me","notify_me$email=:email":"notify_me",
notify_me:"notify_me",forgot_password:"forgot_password","one_click$email=:email&token=:token":"oneClickLanding","reset_password$email=:email&token=:token":"reset_password","reset_password$email=:email%26token=:token":"reset_password","$from_email=:from_email":"splash",":username":"profile","!/:username":"profile","":"splash","*path":"login"},initialize:function(){duo.topbar=new duo.LoginTopbarView({el:$("#topbar")});duo.topbar.render();$("footer .change-language-dark").remove();_.each(["en/learn-german-online",
"en/learn-italian-online","en/learn-french-online","en/learn-spanish-online","en/learn-portuguese-online"],function(b){this.route(b,"splash")},this);_.each(duo.ui_languages,function(b){this.route(b.id,"changeLanguage",function(){duo.switchLanguage(b.language)})},this);this.route(duo.browser_language_id,"splashLanguage",function(){Backbone.history.navigate("/",{trigger:!0,replace:!0})})},login:function(b){duo.loggedOutRootRouter.login()},registerLanguage:function(b){this.showRegistration({learning_language:b},
!0)},register:function(b,a,c,d,f){if(null!=d&&d!=duo.browser_language)duo.switchLanguage(d);else{var g={};b&&(g.email=b);a&&(g.invite=a,duo.track("present registration with invite",{invite_type:"code",invited_via:f}));c&&(g.learning_language=c);d&&(g.ui_language=d);f&&(g.invited_via=f);this.showRegistration(g)}},registerSkipDelayed:function(b){duo.track("teacher_without_account_email_click");this.splashView=new duo.SplashView({splash_skip_delayed:!0,email:b,google_only:!0});this.switchView(this.splashView,
null,"splash-2014")},registerWithFB:function(b){window.FB?FB.api("/me?fields=picture,email,username,name,locale",function(a){this.showRegistration({email:a.email,profile_image:a.picture,facebook_username:a.username,facebook_id:a.id})}):this.register()},registerWithTwttr:function(b){b.idStr?(b={twitter_username:b.data("screen_name"),profile_image:b.data("profile_image_url"),twitter_id:b.idStr},this.showRegistration(b)):this.register()},registerWithInvite:function(b,a){this.showRegistration({invited_by:b,
invited_via:a});duo.track("present registration with invite",{invite_type:"invited_by",invited_via:a})},register_ui:function(b,a,c,d){this.register(decodeURIComponent(b),a,null,c,d)},showRegistration:function(b){this.splashView=new duo.SplashView;this.switchView(this.splashView,null,"splash-2014");this.splashView.showRegistration(b)},splash:function(b){0<window.location.href.indexOf("_escaped_fragment_")||(b&&duo.track("email button click",{from_email:b}),$(".mobile-splash").show(),$(".hidden-by-app").hide(),
this.splashView=new duo.SplashView,this.switchView(this.splashView,null,"splash-2014"))},notify_me:function(b,a){null!=a&&a!=duo.browser_language?duo.switchLanguage(a):duo.courseRouter.navigate("/courses",{replace:!0,trigger:!0})},forgot_password:function(){var b=new duo.ForgotView;this.switchView(b,"page-forgot");$("#logged-out-message").hide()},reset_password:function(b,a){var c=new duo.ResetView({email:decodeURIComponent(b),token:a});this.switchView(c,"page-reset")},profileFromEmail:function(){var b=
_.toArray(arguments);duo.track("email button click",{from_email:b[b.length-1]});this.profile.apply(this,b.slice(0,b.length-1))},profile:function(b){var a=new duo.User({username:b}),c=this;a.fetch({success:function(b){b.get("js_version")!=duo.js_version&&window.location.reload(!0);c.show(a)},error:function(){c.login()}})},show:function(b){document.title="Duolingo: "+b.get("username");var a=new duo.ProfileView({model:b}),c=new duo.LoggedOutMessage({model:b,el:$(".logged-out-message")});this.switchView(a,
"home other-user",null,b.get("username")+" "+translate_text("is using Duolingo to learn languages for free while helping to translate the web."));c.render();$("head").append('<meta name="robots" content="noindex" />')},upload:function(){var b=this,a=new duo.TranslateJobList;a.fetch({success:function(){document.title="Duolingo: "+translate_text("Translate");var c=new duo.TranslateView({collection:a});b.switchView(c,"upload-page")}})},oneClickLanding:function(b,a){var c=new duo.OneClickLanding({email:decodeURIComponent(b),
token:a});this.switchView(c,"one-click-landing");$("#logged-out-message").hide()},magicLink:function(b,a){duo.track("magic_link_click",{logged_out:!0});document.title="Duolingo: "+translate_text("Magic Link");a=a?decodeURIComponent(a):"";var c=new duo.MagicLinkView({email:unescape(b),section:a});this.switchView(c,"magic-link",$.browser.mobile?"magic-link-body":"splash-2014")}});
duo.SettingsRoutes=duo.Router.extend({routes:{settings:"account","settings/account":"account","settings/sound":"sound","settings/profile":"profile","settings/password":"password","settings/progress":"progress","settings/notifications":"notifications","settings/deactivate":"deactivate_account","settings/direction":"direction","settings/reset_lang":"reset_lang","settings/coach":"coach","settings/observer":"observer"},initialize:function(){},toSettingsTab:function(b){duo.user?duo.user.get("trial_account")&&
!_.contains(["sound","direction","coach"],b)?duo.show404():(this.settings||(this.settings=new duo.SettingsView),"settings"!=duo.view&&this.switchView(this.settings,"settings"),this.settings.tab(b)):duo.show404()},account:function(){document.title="Duolingo: "+translate_text("Account Settings");this.toSettingsTab("account")},profile:function(){document.title="Duolingo: "+translate_text("Profile Settings");this.toSettingsTab("profile")},password:function(){document.title="Duolingo: "+translate_text("Password Settings");
this.toSettingsTab("password")},notifications:function(){document.title="Duolingo: "+translate_text("Notifications Settings");this.toSettingsTab("notifications")},progress:function(){document.title="Duolingo: "+translate_text("Track Your Progress");this.toSettingsTab("progress")},deactivate_account:function(){document.title="Duolingo: "+translate_text("Deactivate Account");this.toSettingsTab("deactivate")},reset_lang:function(){document.title="Duolingo: "+translate_text("Reset or remove languages");
this.toSettingsTab("reset")},direction:function(){document.title="Duolingo: "+translate_text("Change language");this.toSettingsTab("direction")},sound:function(){document.title="Duolingo: "+translate_text("Sound Settings");this.toSettingsTab("sound")},coach:function(){document.title="Duolingo: "+translate_text("Coach Settings");this.toSettingsTab("coach")},observer:function(){document.title="Duolingo: "+translate_text("Progress Sharing Settings");this.toSettingsTab("observer")}});
duo.SkillRoutes=duo.Router.extend({routes:{"skill/:language/:name$from_email=:from_email":"skill","skill/:language/:name":"skill","skill/:language/:name/practice":"practice","skill/:language/:name/practice/timed":"practiceTimed","skill/:language/:name/test":"test","skill/:language/:name/practice/:index":"practice","skill/:language/:name/translation/:index":"translation","skill/:language/:name/:lesson/:debug_type?:param":"lesson_debug","skill/:language/:name/:lesson$from_email=:from_email":"lesson",
"skill/:language/:name/:lesson":"lesson","skill/:language/:name/:lesson/:debug_type":"lesson_debug"},skill:function(b,a,c){var d=this,f=new duo.Skill({name:a,language:b});f.fetch({success:function(a){if(a.get("js_version")!=duo.js_version)window.location.reload(!0);else{document.title="Duolingo: "+translate_text(f.get("title"));var b=duo.user.getSkills().skills.get(a.id),k=!1;b&&(k=b.get("recommended"));duo.track("skill",{id:a.id,language:f.get("language"),title:f.get("title"),name:f.get("name"),
recommended:k,from_email:c});a=new duo.SkillView({model:f});d.switchView(a,"skill skill-page-path")}}});c&&duo.track("email button click",{from_email:c})},practiceTimed:function(b,a,c){this.practice(b,a,c,!0)},practice:function(b,a,c,d){var f=this,g=new duo.SkillPracticeSession({name:a,language:b,path_node_index:c});g.fetch({data:{name:decodeURIComponent(a),language:b},success:function(a,b){if(0===b.session_elements.length)duo.homeRouter.navigate("/",!0);else{a.get("js_version")!=duo.js_version&&
window.location.reload(!0);document.title="Duolingo: "+translate_text("Refresh");var c=new duo.TimedSessionView({model:g,extra:7,die:!0,total_time:30,points:!0,shown_max_time:60,auto_timed:d});f.switchView(c,"player")}}})},test:function(b,a){var c=this,d=new duo.TestSession({name:a,language:b});d.fetch({data:{name:decodeURIComponent(a),language:b},success:function(a,b){if(0===b.session_elements.length)duo.homeRouter.navigate("/",!0);else{a.get("js_version")!=duo.js_version&&window.location.reload(!0);
document.title="Duolingo: "+translate_text("Test");var h=new duo.SessionView({model:d});c.switchView(h,"player")}}})},lesson:function(b,a,c,d){var f=this,g=new duo.LessonSession({name:a,lesson_number:c,language:b,from_email:d});g.fetch({data:{name:decodeURIComponent(a),language:b},success:function(a,b){a.get("js_version")!=duo.js_version&&window.location.reload(!0);if(0===b.session_elements.length)duo.homeRouter.navigate("/",!0);else{document.title="Duolingo: "+translate_text("Lesson");var c=null,
c=g.get("first_lesson")?new duo.WelcomeLessonSessionView({model:g}):new duo.SessionView({model:g});f.switchView(c,"player")}}});d&&duo.track("email button click",{from_email:d})},lesson_debug:function(b,a,c,d,f){var g=this,h=new duo.LessonSession({name:a,lesson_number:c,language:b});b={debug_type:d,name:decodeURIComponent(a),language:b};f&&(b[f]=!0);console.log(b);h.fetch({success:function(a){a.get("js_version")!=duo.js_version&&window.location.reload(!0);a=new duo.SessionView({model:h});g.switchView(a,
"player")},data:b})},translation:function(b,a,c){$.getJSON("/skills/"+b+"/"+a+"/translation/"+c,function(a){a.id&&duo.translationRouter.navigate("/translation/"+a.id+"?index="+a.start_index+"&skill="+a.skill_id,!0)})}});duo.TranslationRoutes=duo.Router.extend({routes:{"translations/upload":"uploadTranslation"},uploadTranslation:function(){var b=new duo.TranslationUploadView({model:new Backbone.Model});this.switchView(b,"paid-upload")}});
duo.LoggedOutTranslationRoutes=duo.Router.extend({routes:{translations:"translations","translations/:source/:target":"translations","translations$from_email=:from_email":"translationsFromEmail","translated/:id":"translation","translation/:id$trusted":"trustedTranslation","translation/:id$from_username=:username":"translationFromUsername","translation/:id$max_timestamp=:max_timestamp":"translationWithMaxTimestamp","translation/:id$revision_number=:revision_number":"translationWithRevisionNumber","translation/:id$index=:index":"translationFromEmail",
"translation/:id$from_skill=:skill_id":"translationFromSkill","translation/:translation_id$accept_edit_suggestion=:edit_suggestion_id":"acceptEditSuggestion","translation/:translation_id$reject_edit_suggestion=:edit_suggestion_id":"rejectEditSuggestion","translation/:id":"translation"},translations:function(b,a){if(!1!=duo.feature_flags.show_translations){var c=this;(new duo.TranslationsOverview).fetch({data:{source:b,target:a},success:function(a){a.get("js_version")!==duo.js_version&&window.location.reload(!0);
document.title="Duolingo: "+translate_text("Translations");a=new duo.RedditTranslationsView({model:a});c.switchView(a,"translations reddit-translations")}})}},translationsFromEmail:function(b){duo.track("email button click",{from_email:b});Backbone.history.navigate("/translations",{trigger:!0,replace:!0})},translation:function(b){this.wikiTranslation(b,void 0,!1,void 0,!1,void 0)},trustedTranslation:function(b){this.wikiTranslation(b,void 0,!0,void 0,!1,void 0)},translationFromUsername:function(b,
a){this.wikiTranslation(b,void 0,!1,void 0,!1,a)},translationWithMaxTimestamp:function(b,a){this.wikiTranslation(b,void 0,!1,void 0,!1,void 0,a)},translationWithRevisionNumber:function(b,a){this.wikiTranslation(b,void 0,!1,void 0,!1,void 0,void 0,a)},translationFromEmail:function(b,a){"user"in duo?this.wikiTranslation(b,a,!1,void 0,!1,void 0):duo.loginRouter.showLoginWindow()},translationFromSkill:function(b,a){"user"in duo?this.wikiTranslation(b,-1,!1,a,!1,void 0):duo.loginRouter.showLoginWindow()},
translationFromRealWorldPractice:function(b){"user"in duo?this.wikiTranslation(b,-1,!1,void 0,!0,void 0):duo.loginRouter.showLoginWindow()},acceptEditSuggestion:function(b,a){this.replyToEditSuggestion(b,a,!0)},rejectEditSuggestion:function(b,a){this.replyToEditSuggestion(b,a,!1)},replyToEditSuggestion:function(b,a,c){if("user"in duo){var d=this;$.post("/wiki_translations/"+(c?"accept":"reject")+"_edit_suggestion/"+a,{},function(a){d.navigate("/translation/"+b+"$index="+a.sentence_index,!0);duo.track("reply_to_edit_suggestion",
{accept:c})}).fail(function(){alert("An error has occurred.  If you have multiple accounts, make you're logged in under the right one.")})}else duo.loginRouter.showLoginWindow()},wikiTranslation:function(b,a,c,d,f,g,h,k){var l=this,m=new duo.WikiTranslation({id:b}),n=(new Date).getTime();m.fetch({data:{trusted:!0==c,from_skill:d,from_real_world_practice:!0==f,from_username:g,max_timestamp:h,revision_number:k},success:function(b,c){document.title="Duolingo: "+m.get("title");var g=!m.get("logged_in")||
duo.user&&duo.user.get("trial_account")?new duo.LoggedOutWikiTranslationView({model:m,view_both:!0}):new duo.WikiTranslationView({model:m});l.switchView(g,"wiki-translation wide","static-background");a&&0<=a&&g.openSentenceView(a);m.get("logged_in")||$("#app").addClass("wide");g=(new Date).getTime()-n;duo.track("view_translation",{translation_id:m.get("translation_id"),source_language:m.get("source_language"),target_language:m.get("target_language"),latency_ms:g,from_real_world_practice:f,skill_id:d,
backend_latency_ms:c.backend_latency_ms})},error:function(){duo.show404()}})}});
duo.SettingsTab=Backbone.View.extend({id:"tab-container",initialize:function(){this.model.bind("change",this.render,this)},render:function(){var b={};b["ui_"+this.model.get("ui_language")]=!0;b.experimental=duo.prebeta_experimental_mode;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),b),duo.templates));this.postRender();return this},postRender:function(){this.$("#submit_button").prop("disabled","disabled")},submit:function(b){b(!1)},success:function(){}});
duo.AccountView=duo.SettingsTab.extend({template:duo.templates.account,events:{"change #image-file":"imagePreview","change .testbed-experiments input":"onExperimentChange","click .toggle-localization-debug":"toggleLocalizationDebug"},render:function(){var b=_.map(duo.testbed_experiments,function(a){return _.extend({},a,{options:_.map(a.options,function(b,f){return{value:b,current:duo.user.get("ab_options")[a.name]==b,name:a.name,index:f}})})}),a=this.model.get("microphone");$(this.el).html($.duostache(this.template,
_.extend(this.model.toJSON(),{microphone:a,experimental:duo.prebeta_experimental_mode,testbed_experiments:b,can_debug_localization:duo.debug||duo.prebeta_experimental_mode,localization_debug_on:duo.localization_debug_on}),duo.templates));this.postRender();return this},submit:function(b){this.$("#image-file").val()?this.$("#avatar-upload").ajaxSubmit(function(){b(!0)}):b(!1)},postRender:function(){src=this.$(".avatar-large .avatar").attr("src");var b=new Date;this.$(".avatar-large .avatar").attr("src",
src+"?"+b.getTime());this.$("#submit_button").prop("disabled","disabled")},imagePreview:function(){var b=this.$("#image-file")[0];if(window.FileReader&&b.files&&b.files[0]){var a=new FileReader,c=this;a.onload=function(a){c.$(".avatar-large .avatar").attr("src",a.target.result).css("width",60)};a.readAsDataURL(b.files[0])}this.$("#avatar-submit").prop("disabled",!1)},onExperimentChange:function(b){b=$(b.currentTarget);$.post("/diagnostics/switch_experiment",{name:b.attr("name"),index:b.data("index")},
function(a){window.location.reload(!0)});return!1},toggleLocalizationDebug:function(b){$.post("/diagnostics/toggle_localization_debug",function(){window.location.reload()})}});duo.SoundSettingsTabView=duo.SettingsTab.extend({template:duo.templates.sound,render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));this.postRender();return this},postRender:function(){this.$("#submit_button").prop("disabled","disabled")}});
duo.SettingsProfileView=duo.SettingsTab.extend({template:duo.templates.settings_profile,events:{"click #facebook-connect":"loginFB","click #facebook-disconnect":"disconnectFB","click #gplus-disconnect":"disconnectGplus","click #twitter-disconnect":"disconnectTwttr"},render:function(){var b={};b["ui_"+this.model.get("ui_language")]=!0;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{ui_bool:b,formatted_creation:this.model.get("creation_date").slice(0,-9)}),duo.templates));this.postRender();
return this},postRender:function(){this.delegateEvents();this.$("#facebook_name").text(this.facebook_name);this.$("#bio-count").text(140-this.model.get("bio").length);this.$("textarea").characterLimit(140,this.$("#bio-count"));this.$("#submit_button").prop("disabled","disabled")},loginFB:function(){var b=this;window.FB&&(duo.prebeta_experimental_mode||FB.login(function(a){var c=a.authResponse.userID;$.post("/facebook_connect",{facebook_id:c,facebook_friends:"[]"});FB.api("/me?access_token="+a.authResponse.accessToken+
"&fields=picture,name",function(a){b.facebook_name=a.name;duo.user.set({facebook_id:c,facebook_name:a.name})})},{scope:"publish_actions"}))},disconnectFB:function(){window.FB&&(duo.prebeta_experimental_mode||FB.api("/me/permissions","delete",function(b){console.log(b);duo.user.set({facebook_id:null,facebook_name:null})}))},disconnectGplus:function(){var b=this;gapi.auth.getToken()?$.ajax({type:"GET",url:"https://accounts.google.com/o/oauth2/revoke?token="+gapi.auth.getToken().access_token,async:!1,
contentType:"application/json",dataType:"jsonp",success:function(a){$.post("/gplus/disconnect",{user_id:b.model.get("id")},function(){duo.user.set({gplus_id:null})})},error:function(a){b.$("#gplus-error").show()}}):$.post("/gplus/disconnect",{user_id:this.model.get("id")},function(){duo.user.set({gplus_id:null})})},disconnectTwttr:function(){$.post("/twitter_disconnect");duo.user.set({twitter_id:null})}});
duo.PasswordView=duo.SettingsTab.extend({template:duo.templates.password,events:{},initialize:function(){this.model.bind("change",this.render,this)},success:function(){this.model.set({no_password:!1})}});
duo.NotificationsView=duo.SettingsTab.extend({template:duo.templates.notifications,events:{"change #notify_practice":"togglePractice"},initialize:function(){this.model.bind("change",this.render,this)},render:function(){var b={};b["ui_"+this.model.get("ui_language")]=!0;var a=_.chain(this.model.get("languages")).filter(function(a){return a.learning}).map(function(a){var b=this.model.get("language_settings");b&&(b=b[a.language]);return{language:a.language,language_string:a.language_string,notify_practice:b?
b.notify_practice:null,notify_time:b?b.notify_time:null,practice_times:duo.generatePracticeTimes(b?b.notify_time:null)}},this).value();b.languages_data=a;$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),this.model.getSkills(),b),duo.templates,!0));this.postRender();return this},success:function(){if(this.model.has("language_settings")){var b=this.model.get("language_settings")[this.model.get("learning_language")];this.model.getSkills().notify_practice=b.notify_practice;this.model.getSkills().notify_time=
b.notify_time}},togglePractice:function(){this.$(".send-time").toggle(this.$("#notify_practice").prop("checked"))}});
duo.QuizProgressView=duo.SettingsTab.extend({template:duo.templates.certificates,events:{},initialize:function(){this.model.bind("change",this.render,this)},render:function(){var b={};b["ui_"+this.model.get("ui_language")]=!0;var a=_.groupBy(duo.user.get("certificates"),function(a){return a.language});b.quiz_scores=_.map(a,function(a){return{language:a[0].language,language_string:a[0].language_string,scores:a}});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),b),duo.templates));
this.postRender();return this},success:function(){}});
duo.SetLanguageView=duo.SettingsTab.extend({template:duo.templates.direction,events:{"change #language_direction":"onLanguageDirectionChange"},render:function(){var b={};b["ui_"+this.model.get("ui_language")]=!0;var a=[],c=!1;_.each(duo.available_languages,function(b){var f=duo.user.get("ui_language")==b.from_language&&duo.user.get("learning_language")==b.learning_language,g=b.from_language+"_"+b.learning_language;f&&"zs"===b.from_language&&(c=!0);a.push({value:g,selected:f,language:b.learning_language_name,
prompt:b.prompt})});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),b,{language_directions:a,traditional:"zt"===duo.user.get("locale"),experimental:duo.prebeta_experimental_mode,is_chinese:c}),duo.templates));this.postRender();return this},initialize:function(){this.model.bind("change",this.render,this)},success:function(){},onLanguageDirectionChange:function(b){"zs_en"==$(b.currentTarget).val()?this.$("#chinese-script-choice").removeClass("hidden"):this.$("#chinese-script-choice").addClass("hidden")}});
duo.DeactivateView=duo.SettingsTab.extend({events:{"click #deactivate_submit_button":"deactivate","click #submit_button":"deactivate","click #cancel_button":"cancel","click #deactivate_cancel_button":"cancel"},template:duo.templates.deactivate,initialize:function(){},render:function(){this.delegateEvents();$(this.el).html($.duostache(this.template,{},duo.templates));return this},deactivate:function(){},cancel:function(){Backbone.history.navigate("/settings",!0)}});
duo.ResetLangView=duo.SettingsTab.extend({events:{"click #cancel_button":"cancel","click #reset_cancel_button":"cancel","click .reset-lang":"resetLang"},template:duo.templates.reset_lang,initialize:function(){},render:function(){this.delegateEvents();var b=this.model.get("languages"),a=_.filter(b,function(a){return a.learning}),b=_.sortBy(b,function(a){return a.points}),b={languages:b,allow_delete:1<a.length};$(this.el).html($.duostache(this.template,b,duo.templates));return this},cancel:function(){Backbone.history.navigate("/settings/direction",
!0)},resetLang:function(b){this.$(".btn-enabled").prop("disabled",!0);b=$(b.currentTarget);var a=b.data("delete");window.confirm(translate_text("Are you sure? "+(a?"Removing":"Resetting")+" a language is a permanent change that cannot be undone."))?duo.prebeta_experimental_mode||(b={language:b.data("value"),"delete":a},$.post("/users/"+this.model.id+"/reset_language",b,function(a){window.location.reload(!0)})):this.$(".btn-enabled").prop("disabled",!1)}});
duo.CoachSettingsView=duo.SettingsTab.extend({template:duo.templates.coach_settings,postRender:function(){this.$("input[data-goal="+duo.user.get("daily_goal")+"]").prop("checked",!0)},submit:function(b){var a=$('input[name="daily_goal"]:checked').data("goal");if(0!=a%1||0>=a)return!1;duo.user.get("daily_goal")?b(!1):duo.modalAlert({type:"custom_type",title:translate_text("The way your streak works is about to change"),message_type:"coach_warning",okay_text:translate_text("Got it"),cancel_text:translate_text("Never mind"),
coach_goal:a,callback:function(){b(!1)}})}});
duo.ObserverSettingsView=duo.SettingsTab.extend({events:{"click #stop-sharing":"removeObserver"},template:duo.templates.observer_settings,postRender:function(){this.delegateEvents();var b=this;$.get("/api/1/observers/get_observer",function(a){a&&2<=a.length&&(b.observer_email=a[0],b.observed_section=a[1])});this.setDataAndButtons()},setDataAndButtons:function(){this.$("#observer-email").val(this.observer_email);this.$("#hashtag").val(this.observed_section);this.$("#submit_button").prop("disabled",
!0);this.$("#stop-sharing").toggleClass("hidden",!this.observer_email)},setObserver:function(b,a){var c=this;duo.user.setObserver(b,a,function(){c.observer_email=b;c.observed_section=a;c.setDataAndButtons();duo.track("add_observer",{from_settings:!0})})},removeObserver:function(b){var a=this;duo.modalAlert({type:"custom_type",message_type:"remove_observer",okay_text:translate_text("Got it"),cancel_text:translate_text("Never mind"),observer_email:$.trim(this.$("#observer-email").val()),callback:function(){a.setObserver("",
"")}})},submit:function(b){var a=this,c=$.trim(this.$("#observer-email").val()),d=$.trim(this.$("#hashtag").val());!a.observer_email&&c?duo.modalAlert({type:"custom_type",message_type:"add_observer",okay_text:translate_text("Got it"),cancel_text:translate_text("Never mind"),observer_email:c,from_settings:!0,callback:function(){a.setObserver(c,d)}}):a.setObserver(c,d)}});
duo.SettingsView=Backbone.View.extend({id:"app",events:{"click #submit_button":"submit","click #cancel_button":"cancel","keyup input, select, textarea":"inputChange","change input, select, textarea":"inputChange"},template:duo.templates.settings,initialize:function(){this.model=duo.user;this.accountView=new duo.AccountView({model:this.model});this.profileView=new duo.SettingsProfileView({model:this.model});this.passwordView=new duo.PasswordView({model:this.model});this.notificationsView=new duo.NotificationsView({model:this.model});
this.directionView=new duo.SetLanguageView({model:this.model});this.progressView=new duo.QuizProgressView({model:this.model});this.deactivateView=new duo.DeactivateView({model:this.model});this.resetView=new duo.ResetLangView({model:this.model});this.coachView=new duo.CoachSettingsView({model:this.model});this.observerView=new duo.ObserverSettingsView({model:this.model});this.soundView=new duo.SoundSettingsTabView({model:this.model});_.bindAll(this,"update","getSettings")},render:function(){this.delegateEvents();
$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{has_certificates:this.model.has("certificates")&&0<this.model.get("certificates").length}),duo.templates));this.$("#submit_button, #cancel_button").prop("disabled",!0);this.model.has("has_password")||$.getJSON("/users/"+this.model.id+"/settings",function(b){duo.user.set(b)});return this},getSettings:function(){var b=this.$(":input"),a={};$.each(b,function(){var b=$(this).val();if("locale"===this.name&&$(this).prop("checked"))a.locales=
a.locales||{},a.locales[$(this).data("language")]=$(this).val();else if("daily_goal"===this.name&&$(this).prop("checked"))a.daily_goal=$(this).data("goal");else{if("checkbox"===this.type)b=$(this).prop("checked");else if("radio"==this.type)if($(this).prop("checked"))b="true"===$(this).val();else return;for(var d=a,f=this.name.split("."),g=0;g<f.length-1;g++)f[g]in d||(d[f[g]]={}),d=d[f[g]];d[f[f.length-1]]=b}});return a},inputChange:function(){this.$("#submit_button, #cancel_button").prop("disabled",
!1)},submit:function(){this[this.current_tab+"View"].submit(this.update)},update:function(b){var a=this.getSettings(),c=this.model.get("username"),d=this,f=void 0!==a.language_direction&&a.language_direction!=this.model.get("ui_language")+"_"+this.model.get("learning_language"),g=void 0!==a.locales&&duo.user.get("locale")!=a.locales[this.model.get("ui_language")];$.ajax({url:"/users/"+c,data:JSON.stringify(a),success:function(c){"ok"==c.response?(d.$("#error-message").hide(),d.$("#confirmation-message").show().delay(1E3).fadeOut(1E3),
d.model.set(a),d[d.current_tab+"View"].success(),(b||f||g)&&_.defer(function(){window.location.reload(!0)})):d.$("#error-message").text(c.message).show();d.$("#submit_button, #cancel_button").prop("disabled",!0)},type:"PUT",dataType:"json",contentType:"application/json; charset=utf-8"})},cancel:function(){this[new_tab+"View"].render();this.$("#submit_button, #cancel_button").prop("disabled",!0)},tab:function(b){this.$("#"+this.current_tab+"_tab").parent().removeClass("active");this.$("#"+b+"_tab").parent().addClass("active");
this.$("#tab-container").replaceWith(this[b+"View"].render().el);this.current_tab=b;this.$("#submit_button, #cancel_button").prop("disabled",!0)},clear:function(){this.model.unbind("change",this.saved)}});
duo.UserRoutes=duo.Router.extend({routes:{"":"home",show_stream:"showStream",show_store:"showStore","show_store$scroll=:skill":"showStoreSkill","$from_email=:from_email":"homeFromEmail","event/:id$from_email:from_email":"showEventFromEmail","event/:id":"showEvent","reset_password?email=:email&token=:token":"home",":username$from_email=:from_email":"profileFromEmail",":username$follow_if=:follow_if&from_email=:from_email":"followFromEmail",":username":"profile","!/:username":"profile",":username/:tab$from_email=:from_email":"profileFromEmail",
":username/:tab":"profile"},initialize:function(){},ownProfile:function(b){duo.user.get("trial_account")&&duo.show404();var a="/"+duo.user.get("username");b&&(a+="/"+b);this.navigate(a,!1);this.show(duo.user,b)},followFromEmail:function(b,a,c){this.profileFromEmail.call(this,b,null,duo.user&&duo.user.id==Number(a),c)},profileFromEmail:function(){var b=_.toArray(arguments);duo.track("email button click",{from_email:b[b.length-1]});this.profile.apply(this,b.slice(0,b.length-1))},homeFromEmail:function(){var b=
_.toArray(arguments);duo.track("email button click",{from_email:b[b.length-1]});this.home.apply(this,b.slice(0,b.length-1))},profile:function(b,a,c){"activity"!==a&&(a=null);if(!b||b==duo.user.get("username"))$.getJSON("/version",function(a){a.js_version!=duo.js_version&&window.location.reload(!0)}),this.ownProfile(a);else if(b&&0<=_.pluck(duo.available_languages,"from_language").indexOf(b))Backbone.history.navigate("/",{trigger:!0,replace:!0});else{var d=new duo.User({username:b}),f=this;d.fetch({success:function(b){b.get("js_version")!=
duo.js_version&&window.location.reload(!0);b.get("trial_account")&&duo.show404();c&&!d.get("is_following")&&(d.set("is_following",!0),duo.user.follow(d.get("id")));f.show(d,a)},error:function(){duo.show404()}})}},show:function(b,a){document.title="Duolingo: "+b.get("username");var c=new duo.ProfileView({model:b});this.switchView(c,"profile")},home:function(b,a){$.getJSON("/version",function(a){a.js_version!=duo.js_version&&window.location.reload(!0)});!window.location.hostname.match(duo.local_host_re)&&
("https:"!=window.location.protocol&&!duo.from_internet_org)&&window.location.replace("https://"+window.location.host+window.location.pathname);document.title="Duolingo: "+translate_text("Home");var c=new duo.HomeView({model:duo.user,scroll:a});duo.track("show home");this.switchView(c,"home");"stream"==b?c.$(".show-stream").click():"store"==b&&c.switchToTab("store",!0)},showStore:function(){this.home("store")},showStoreSkill:function(b){this.home("store",b)},showStream:function(){this.home("stream")},
showEvent:function(b){var a=this;(new duo.Event({id:b})).fetch({success:function(b){b.get("js_version")!=duo.js_version&&window.location.reload(!0);b=new duo.StandaloneEventView({model:b});a.switchView(b,"standalone-event")}})},showEventFromEmail:function(b,a){duo.track("email button click",{from_email:a});this.showEvent(b)}});duo.RootRoutes=duo.Router.extend({routes:{login:"loggedIn",logout:"logout"},loggedIn:function(){this.navigate("",!0)},logout:function(){duo.logout()}});
duo.LoggedOutRootRoutes=duo.Router.extend({routes:{login:"login",logout:"loggedOut"},initialize:function(){this.login_view=new duo.LoginView},login:function(b){this.showLoginWindow()},showLoginWindow:function(){this.switchView(this.login_view,"page-login");$(".logged-out-message").empty()},loggedOut:function(){this.navigate("",{trigger:!0,replace:!0})}});
duo.initializeRoutes=function(){0===document.domain.indexOf("dashboard")?duo.progressRouter=new duo.ProgressRoutes:0===document.domain.indexOf("schools")?duo.schoolsRouter=new duo.SchoolsRoutes:(0===document.domain.indexOf("translations")?duo.selfServiceRouter=new duo.SelfServiceRoutes:(duo.userRouter=new duo.UserRoutes,duo.homeRouter=new duo.HomeRoutes,duo.skillRouter=new duo.SkillRoutes,duo.settingsRouter=new duo.SettingsRoutes,duo.uiStringRouter=new duo.UIStringRoutes,duo.adminRouter=new duo.AdminRoutes,
duo.streamRouter=new duo.StreamRoutes,duo.vocabRouter=new duo.VocabRoutes),duo.translationRouter=new duo.TranslationRoutes);duo.rootRouter=new duo.RootRoutes};
duo.initializeLoggedOutRoutes=function(){duo.loggedOutRootRouter=new duo.LoggedOutRootRoutes;0===document.domain.indexOf("dashboard")?duo.loggedOutProgressRouter=new duo.LoggedOutProgressRoutes:0===document.domain.indexOf("schools")?duo.schoolsRouter=new duo.SchoolsRoutes:0===document.domain.indexOf("translations")?duo.loggedOutSelfServiceRouter=new duo.LoggedOutSelfServiceRoutes:duo.loginRouter=new duo.LoginRouter};
(function(b){duo.getFlashMovieObject=function(a){return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]};duo.switchLanguage=function(a){var c=_.indexBy(duo.ui_languages,"language")[a].id;duo.debug||0===document.domain.indexOf("schools")||0===document.domain.indexOf("dashboard")?b.post("/switch_ui_language",{language:a},function(a){window.location.reload(!0)}):window.location.host=c+".duolingo.com"};duo.getSpeechRecognition=function(){if(null!=duo._webSpeechEnabled)return duo._webSpeechEnabled?
duo._speechRecognition:null;try{return duo._speechRecognition=new webkitSpeechRecognition,duo._webSpeechEnabled=!0,duo._speechRecognition}catch(a){return duo._webSpeechEnabled=!1,null}};duo.isWebSpeechEnabled=function(){return null!=duo._webSpeechEnabled?duo._webSpeechEnabled:null!=duo.getSpeechRecognition()};duo.kcStrengthModelVersion=function(){var a=duo.feature_flags.sg_within_lesson_learning_model_experiment&&duo.user.get("ab_options").sg_within_lesson_learning_model_experiment,b=duo.feature_flags.sg_simpler_algorithm_experiment&&
duo.user.get("ab_options").sg_simpler_algorithm_experiment;return a||b?2:0};duo.getCookie=function(){return _.object(_.map(document.cookie.split(";"),function(a){a=a.split("=");var b=a[0].trim(),c="";1<a.length&&(c=a[1].trim());2<=c.length&&('"'==c[0]&&'"'==c[c.length-1])&&(c=decodeURIComponent(c.substring(1,c.length-1)));return[b,c]}))};duo.setCookie=function(a,b,c){b=encodeURIComponent(b);if(_.contains(b,"(")||_.contains(b,")"))b='"'+b+'"';a=a+"="+b;"undefined"!==typeof c&&(a+="; path=/; max-age="+
c);c=location.hostname;/.*[.].*[.].*/.test(c)&&(a+="; domain="+c.substring(c.indexOf(".")));document.cookie=a};duo.removeCookie=function(a){duo.setCookie(a,"",1)};var a=-1<navigator.userAgent.indexOf("Chrome"),c=-1<navigator.userAgent.indexOf("Safari");c&&!a&&b("html").addClass("safari");c&&-1<navigator.userAgent.indexOf("Version/5")&&b("html").addClass("safari5");b(document).ready(function(){console.log("");timing.start("duolingo.js ready");b("html").is(".ie6, .ie7, .ie8, .safari5")?(b.tts.setupSoundManager(),
duo.unsupportedRouter=new duo.UnsupportedRoutes):"user"in duo?(!duo.user.get("learning_language")||0==duo.checkValidDirection(duo.user.get("ui_language"),duo.user.get("learning_language")))&&!(0===document.domain.indexOf("schools")||0===document.domain.indexOf("dashboard"))?(b.tts.setupSoundManager(),duo.selectLanguageRouter=new duo.SelectLanguageRoutes):(duo.initializeRoutes(),timing.mark("conf loggedin routes"),duo.view="home",b.tts.setupSoundManager(),timing.mark("set up SM"),null===duo.user.get("timezone")&&
duo.user.save({timezone:b.getTimezone()})):duo.initializeLoggedOutRoutes();duo.unsupportedRouter||(duo.commentRouter=new duo.CommentRoutes,duo.staticRouter=new duo.StaticRoutes,duo.loggedOutTranslationRouter=new duo.LoggedOutTranslationRoutes,duo.courseRouter=new duo.CourseRoutes);var a=window.location.href;-1!==a.indexOf("#")&&a.indexOf("?")>a.indexOf("#")&&(window.location.href=window.location.href.replace("?","$"));duo.topbar&&duo.topbar.start();Backbone.history.start({pushState:!0,root:"/"});
b(document).on("click","a[href]:not([data-bypass])",function(a){var c=b(this).prop("href"),d=b(this).attr("href"),f=location.protocol+"//"+location.host+Backbone.history.root,d=d.replace("#/",""),d=d.replace(f,"");c.slice(0,f.length)===f&&(a.preventDefault(),Backbone.history.navigate(d,{trigger:!0}))});b(document).on("focus, click",".textarea-autogrow",function(a){b(a.currentTarget).css({"min-height":"90px"});b(a.currentTarget).autosize({append:"\n"})});b(document).on("blur",".textarea-autogrow",
function(a){""==b(a.currentTarget).val()&&b(a.currentTarget).css({"min-height":"40px",height:"40px"});return!0});a=window.location.pathname;1<a.length&&Backbone.history.navigate(a,{trigger:!0});a=window.location.search;-1!==a.indexOf("fb_verifier")&&Backbone.history.navigate(a,{trigger:!0});duo.user&&!duo.user.get("learning_language")&&duo.selectLanguageRouter.navigate("/welcome",!0);b.browser.mobile&&b("html").addClass("mobile");navigator.userAgent.match(/Trident\/7.0;/)&&b("html").addClass("ie11");
navigator.userAgent.match(/Trident\/6.0;/)&&b("html").addClass("ie10");navigator.userAgent.match(/5.0.6 Safari/)&&b("html").addClass("safari506");(a=window.matchMedia&&window.matchMedia("(max-width: 700px)").matches)||b("body").tooltip({selector:'[data-toggle="tooltip"]',placement:function(a,c){return b(c).data("placement")||"top"}});var c=duo.user?duo.user.get("ab_options").web_responsive_site_experiment:duo.ab_options.web_logged_out_responsive_experiment;if((duo.from_internet_org||c)&&"rtl"!=duo.script_direction)b("body").addClass("compact-enabled"),
a&&(duo.mobile_web_view=!0);timing.stop("duolingo.js ready")});var d=Backbone.History.prototype.loadUrl;Backbone.History.prototype.loadUrl=function(){if(!b("#app").hasClass("leave-warning")||window.confirm(translate_text("Are you sure you want to quit? All progress in this session will be lost.")))return d.apply(this,arguments);duo.skillRouter.navigate(duo.sessionURL);return!0}})(window.jQuery);
duo.AdminDashboard=Backbone.Model.extend({url:"/admin_tools",parse:function(b){var a=b.banned_users;this.moderation_log=new duo.ModerationLog;"deletes"==b.log_type?(this.moderation_log.reset(duo.ModerationLog.prototype.parse.call(this.moderation_log,b)),b.moderation_log=this.moderation_log):"comments"==b.log_type&&(this.comment_log.reset(duo.ModerationLog.prototype.parse.call(this.comment_log,b)),b.comment_log=this.comment_log);b.banned_users=a;return b},getComments:function(){this.comment_log=new duo.ModerationLog;
var b=this;this.fetch({data:{page:0,log_type:"comments"},success:function(a){(new duo.ModerationLogView({el:this.$("#comment-log"),collection:b.get("comment_log"),model:b,type:"comments"})).render()}})},getShadowBannedUsers:function(){var b=this;$.post("/admin_tools/shadow_banned",function(a){b.set(duo.AdminDashboard.prototype.parse.call(b,a));return a})},addShadowBannedUser:function(b){var a=this;$.post("/admin_tools/shadow_banned/add",{username:b},function(b){if("user not found"==b.error)alert("username not found");
else return a.set(duo.AdminDashboard.prototype.parse.call(a,b)),b})},removeShadowBannedUser:function(b){var a=this;$.post("/admin_tools/shadow_banned/remove",{user_id:b},function(b){if(b.error)alert("username not found");else return a.set(duo.AdminDashboard.prototype.parse.call(a,b)),b})}});
duo.ModerationLog=Backbone.Collection.extend({model:duo.Event,url:function(){return"/admin_tools"},fetch:function(b){b=b||{};b.data=b.data||{};b.data.page=b.data.page;b.data.log_type=b.data.log_type;Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){this.more=b.more;return b.mod_log}});duo.LingotStoreActivity=Backbone.Model.extend({url:"/admin_tools/social_currency_stats"});
duo.Course=Backbone.Model.extend({url:function(){return"/api/1/courses/"+this.get("learning_language_id")+"/"+this.get("from_language_id")+"/show"},parse:function(b){b.progress=b.progress;return b}});duo.CourseOverview=Backbone.Model.extend({parse:function(b){b.in_progress=1==b.phase;b.in_beta=2==b.phase;b.released=3==b.phase;b.learning=duo.user&&b.from_language==duo.user.get("ui_language")&&_.where(duo.user.get("languages"),{learning:!0,language:b.learning_language});return b}});
duo.CourseList=Backbone.Collection.extend({model:duo.CourseOverview,url:"/api/1/courses/list",comparator:function(b){return 1<b.get("phase")?-b.get("num_learners"):-b.get("progress")},parse:function(b){this.all_source_languages=[];duo.user&&duo.user.get("ui_language");var a=[],c=this;_.each(b,function(b){var f=b.from_language;f in a||(a[f]=!0,c.all_source_languages.push({abbrev:f,id:b.from_language_id,language_name:b.from_language_name}))});this.all_source_languages.sort(function(a,b){return a.name<
b.name?-1:1});b.progress=Math.round(b.progress);return b}});
duo.Group=Backbone.Model.extend({url:function(){return"/api/1/groups/"+this.id},parse:function(b){3600<b.day_seconds_remaining?b.num_hours=Math.floor(b.day_seconds_remaining/3600):b.num_minutes=Math.floor(b.day_seconds_remaining/60);b.invited_users&&_.each(b.invited_users,function(a){a.is_admin=!1});_.each(b.members,function(a){a.user_id==duo.user.id&&(a.self=!0);!0==a.is_admin&&(a.owner_badge=!0)});return b},checkDailyGoals:function(){var b=this.get("daily_goal");_.each(this.get("members"),function(a){_.each(a.weekly_progress,
function(a,d){a.met_goal=a.day_xp>=b})})},joinGroup:function(){var b=this;$.post("/api/1/groups/"+this.id+"/join",function(a){"in_group"==a.error?duo.switchTeamsWarning(function(){$.post("/api/1/groups/"+b.id+"/join",{force_join:!0},function(a){b.successfulJoin(a)})}):"group_full"==a.error?duo.modalAlert({type:"alert",message_type:"custom_message",message:translate_text("This team is full.")}):b.successfulJoin(a)})},successfulJoin:function(b){b.is_admin&&(b.owner_badge=!0);var a=_.find(this.get("members"),
function(a){return a.weekly_xp<b.weekly_xp});a?this.get("members").splice(a[0],0,b):this.get("members").push(b);if(this.get("is_admin")&&(a=_.find(this.get("admins"),function(a){return a.user_id==duo.user.id})))a.is_member=!0;duo.user.set({group:{id:this.id,icon_index:this.get("icon_index"),name:this.get("name"),color:this.get("color")}});this.trigger("change")},acceptInvite:function(b){var a=this;$.post("/api/1/groups/invitations/"+b+"/accept",function(c){"in_group"==c.error?duo.switchTeamsWarning(function(){$.post("/api/1/groups/invitations/"+
b+"/accept",{force_join:!0},function(c){a.successfulAccept(b,c)})}):"group_full"==c.error?duo.modalAlert({type:"alert",message_type:"custom_message",message:translate_text("This team is full.")}):a.successfulAccept(b,c)})},successfulAccept:function(b,a){var c=this.get("invited_users")?this.get("invited_users").filter(function(a){return a.user_id!==duo.user.id}):void 0;this.show_notification="join_team";this.set({invited_users:c,invitation_id:void 0},{silent:!0});this.successfulJoin(a);c=_.filter(duo.user.get("pending_invites"),
function(a){return a.invitation_id!=b});duo.user.set({pending_invites:c},{silent:!0})},leaveGroup:function(){var b=this;$.post("/api/1/groups/"+this.id+"/leave",function(a){a=b.get("members").filter(function(a){return a.user_id!==duo.user.id});b.get("is_admin")&&(_.where(b.get("admins"),{user_id:duo.user.id})[0].is_member=!1);b.set({members:a});duo.user.unset("group")})},removeMember:function(b){var a=this;$.post("/api/1/groups/"+this.id+"/admin/remove_user",{user_id:b},function(){var c=a.get("members").filter(function(a){return a.user_id!==
b});a.set({members:c})})},promoteUsertoOwner:function(b){var a=this;$.post("/api/1/groups/"+this.id+"/admin/manage_user",{user_id:b,action:"promote_owner"},function(){var c=_.find(a.get("members"),function(a){return a.user_id==b}),d=_.find(a.get("members"),function(a){return a.user_id==duo.user.id});c&&(c.is_admin=!0,c.is_member=!0,c.owner_badge=!0);d&&(d.is_admin=!1,d.owner_badge=!1);a.set({admins:[c],is_owner:!1})})},sendInvite:function(){$.post("/api/1/groups/"+this.id+"/invite",function(b){})},
deactivate:function(){var b=this;$.post("/api/1/groups/"+this.id+"/deactivate",function(a){b.set({is_enabled:!1})})},reactivate:function(){var b=this;$.post("/api/1/groups/"+this.id+"/reactivate",function(a){b.set({is_enabled:!0})})}},{joinGroup:function(b){var a=this;$.post("/api/1/groups/"+b+"/join",function(c){"in_group"==c.error?duo.switchTeamsWarning(function(){$.post("/api/1/groups/"+b+"/join",{force_join:!0},function(b){a.successfulJoin(b)})}):"group_full"==c.error?duo.modalAlert({type:"alert",
message_type:"custom_message",message:translate_text("This team is full.")}):a.successfulJoin(c)})},successfulJoin:function(b){duo.groupRouter.navigate("/team/"+b.id+"/join_team",!0);duo.user.set({group:b})},acceptInvite:function(b){var a=this;$.post("/api/1/groups/invitations/"+b+"/accept",function(c){"in_group"==c.error?duo.switchTeamsWarning(function(){$.post("/api/1/groups/invitations/"+b+"/accept",{force_join:!0},function(c){a.successfulAccept(b,c)})}):"group_full"==c.error?duo.modalAlert({type:"alert",
message_type:"custom_message",message:translate_text("This team is full.")}):a.successfulAccept(b,c)})},successfulAccept:function(b,a){duo.groupRouter.navigate("/team/"+a.id+"/join_team",!0);var c=_.filter(duo.user.get("pending_invites"),function(a){return a.invitation_id!=b});duo.user.set({pending_invites:c,group:a},{silent:!0})},rejectInvite:function(b){var a=this;$.post("/api/1/groups/invitations/"+b+"/reject",function(){$(e.currentTarget).closest("li").remove();0==a.$(".pending-invites-box li").length&&
(a.$(".pending-invites-box").css({"border-top":"none"}),a.$(".pending-invites-box").slideUp(),a.$(".team-up-box").addClass("no-pending-invites"));var c=_.filter(duo.user.get("pending_invites"),function(a){return a.invitation_id!=b});duo.user.set({pending_invites:c},{silent:!0})})}});
duo.GroupManager=Backbone.Collection.extend({url:"/api/1/groups/manage",fetch:function(b){b=b||{};b.data=b.data||{};b.data.page=b.data.page;b.data.log_type=b.data.log_type;Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){_.each(b,function(a){3600<a.day_seconds_remaining?a.num_hours=Math.floor(a.day_seconds_remaining/3600):a.num_minutes=Math.floor(a.day_seconds_remaining/60)});return b}});
duo.GroupList=Backbone.Collection.extend({model:duo.Group,url:"/api/1/groups/list",fetch:function(b){b=b||{};b.data=b.data||{};b.data.page=b.data.page;b.data.log_type=b.data.log_type;Backbone.Collection.prototype.fetch.call(this,b)}});
duo.GroupTree=Backbone.Model.extend({url:function(){return this.id?"/api/1/groups/"+this.id+"/course_progress":"/group"},initialize:function(b){this.member_progress=b.member_progress},fetch:function(b){b=b||{};b.data=b.data||{};Backbone.Model.prototype.fetch.call(this,b)},parse:function(b){var a=this;"tree"in b&&_.each(b.tree,function(c,d){c.skill_names=_.pluck(c.skills,"name").join(", ");c.row_num=d+1;"users"in c&&(_.each(c.users,function(b){var c=_.where(a.member_progress,{user_id:b.user_id})[0];
c&&(b.weekly_xp=c.weekly_xp)}),5<=c.users.length?(c.display_users=c.users.slice(0,4),c.more_users=c.users.slice(4),c.has_more=!0,c.num_more=c.more_users.length):c.display_users=c.users,c.row_num<=b.max_user_depth&&_.each(c.skills,function(a){a.unlocked_row=!0}))});return b}});duo.ProgressOverview=duo.Model.extend({url:"/api/1/observers/progress_dashboard",parse:function(b){return b},fetch:function(b){Backbone.Model.prototype.fetch.call(this,b)}});
duo.TreeRepresentation=Backbone.Model.extend({NUM_VISIBLE_SKILLS:21,findMedian:function(b){b.sort(function(a,b){return a-b});var a=Math.floor(b.length/2);return b.length%2?b[a]:Math.floor((b[a-1]+b[a])/2)}});duo.TreeRepresentationList=Backbone.Collection.extend({model:duo.TreeRepresentation});duo.Observee=Backbone.Model.extend({set_events:function(b){this.set({events:b},{silent:!0})},reset_events:function(){this.unset("events",{silent:!0})}});
duo.ProcessedEvent=Backbone.Model.extend({initialize:function(){var b=this.get("type");this.set({is_practice:"practice"==b,is_test:"test"==b})}});duo.ProcessedEventList=Backbone.Collection.extend({model:duo.ProcessedEvent,url:"/api/1/observers/detailed_events",parse:function(b){return b.events},fetch:function(b){Backbone.Collection.prototype.fetch.call(this,b)}});
duo.Classroom=Backbone.Model.extend({url:"/api/1/observers/progress_dashboard",fetch:function(b){Backbone.Model.prototype.fetch.call(this,b)},parse:function(b){this.students=new duo.ObserveeList(b.observees,{});this.trees=new duo.TreeRepresentationList(b.tree_representations,{});b.sections=b.all_sections;b.v3_enabled=b.tree_view;b.tree_view=b.tree_view&&!duo.user.get("prefers_v2");return b},getWeeklySummaries:function(b,a){var c=this;$.get("/api/1/observers/weekly_summaries",{week:b},function(b){c.students.each(function(a){a.reset_events();
a.set("summary",b[a.id])});a&&a()})},setLearningLanguage:function(b,a){this.set({learning_language:b,learning_language_name:this.get("learning_languages_dict")[b]},{silent:a})},filterClassroom:function(b,a){var c=this.students.models,d=this.trees.models;b&&"all"!=b&&(d=this.trees.where({learning_language:b}),c=this.students.where({learning_language:b}));a&&"all"!=a&&(c=_.filter(c,function(b){return b.get("section")==a}));this.setLearningLanguage(b,!0);this.set({relevant_trees:d,relevant_students:c,
section:a},{silent:!0});this.trigger("filter")},bulkEditSection:function(b,a,c){var d=this,f=JSON.stringify(b);$.post("/api/1/observers/bulk_change_tags",{observee_ids:f,tag:a},function(){c&&c();d.students.each(function(c){_.contains(b,c.get("user_id").toString())&&c.set({section:a});c.trigger("uncheck")});d.set({all_sections:_.uniq(d.students.pluck("section"))})})}});
duo.ObserveeList=Backbone.Collection.extend({model:duo.Observee,comparator:function(b){return[b.get("display_name"),b.get("user_name")]},removeObservees:function(b,a){var c=this;$.post("/api/1/observers/bulk_remove_observees",{observee_ids:JSON.stringify(b)},function(){a&&a();var d=_.filter(c.models,function(a){return-1<b.indexOf(a.get("user_id").toString())});c.remove(d,{silent:!0});c.trigger("remove")})}});
duo.Sentence=Backbone.Model.extend({urlRoot:"/sentence",toJSON:function(){return Backbone.Model.prototype.toJSON.call(this)},parse:function(b){if("comment"in b){b.avatar=b.comment.avatar;b.sentence_id=b.comment.sentence_id;b.sentence_language=b.comment.sentence_language;b.translation=b.comment.translation;b.translation_id=b.comment.translation_id;var a=new duo.Comment;a.set(a.parse(b.comment));b.comment=a}return b},addComment:function(b,a,c){var d=this;$.post("/sentences/comment",{message:b,sentence_id:this.id,
ui_language:a,learning_language:c},function(a){duo.track("Questions reply");d.set(d.parse({comment:a,has_comment:!0}))})},replaceURLs:function(b){return b.replace(/\b(?:(?:https?|ftp):\/\/|www\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gi,function(a){return'<a href="'+a+'" class="underline grayDark" target="_blank">'+a+"</a>"})},reportSentence:function(b){$.post("/sentences/report",{sentence_id:this.id,type:b},function(a){duo.track("Sentence report");
console.log(a)})}});
duo.TranslateJob=Backbone.Model.extend({urlRoot:"/translate_jobs",parse:function(b){return b},cancel:function(){var b=this;$.post(this.urlRoot+"/"+this.get("id")+"/cancel",function(a){b.set(a)})},approve:function(){var b=this;$.post(this.urlRoot+"/"+this.get("id")+"/approve",function(a){b.set(a)})},reject:function(b){var a=this;$.post(this.urlRoot+"/"+this.get("id")+"/reject",{reason:b},function(b){a.set(b)})},save_revision:function(b){var a=this;$.post(this.urlRoot+"/"+this.get("id")+"/revision",
{data:b},function(b){a.set(b)})},export_text:function(){window.location=this.urlRoot+"/"+this.get("id")+"/export"},send_email:function(b){$.post(this.urlRoot+"/"+this.get("id")+"/send",{},function(a){a.sent?(b.html("Done!"),console.debug("Message sent to: "+a.recipients)):b.html("ERROR: "+a.error)})}});
duo.TranslateJobList=Backbone.Collection.extend({model:duo.TranslateJob,url:"/translate_jobs",fetch:function(b){b=b||{};b.data=b.data||{};b.data.sort_by=this.sort_by;b.data.filter=this.filter_option;Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){this.page=b.page;this.more=b.more;this.categories=b.categories;this.directions=b.directions;this.account=b.account;return _.map(b.translate_jobs,function(a){return duo.TranslateJob.prototype.parse(a)})},getMore:function(){this.fetch({data:{page:this.page+
1},update:!0,remove:!1})}});duo.Word=Backbone.Model.extend({});
duo.VocabList=Backbone.Collection.extend({model:duo.Word,url:"/vocabulary/overview",parse:function(b){this.language_string=b.language_string;this.from_language=b.from_language;this.learning_language=b.learning_language;this.language_information=b.language_information;var a={},c=duo.user.getSkills().skills.models;_.each(c,function(b){a[b.get("url_title")]=b.get("locked")});return _.map(b.vocab_overview,function(c){"de"==b.learning_language&&("Noun"==c.pos&&c.word_string)&&(c.word_string=c.word_string.charAt(0).toUpperCase()+
c.word_string.slice(1));c.pos&&(c.pos=translate_text(c.pos));c.gender&&(c.gender=translate_text(c.gender));c.locked=a[c.skill_url_title];return duo.Word.prototype.parse(c)})}});duo.Flashcard=Backbone.Model.extend({parse:function(b){b.word=b.learning_words[0];b.translation=b.ui_words[0];return b}});
duo.FlashcardData=Backbone.Collection.extend({url:"/api/1/flashcards",parse:function(b){this.learning_language=b.learning_language;this.ui_language=b.ui_language;return _.map(b.flashcard_data,function(a){return duo.Flashcard.prototype.parse(a)})},postResults:function(b,a){0<b.length?$.post(this.url,JSON.stringify({flashcard_results:b,learning_language:this.learning_language,ui_language:this.ui_language}),a):a()}});
duo.AdminRoutes=duo.Router.extend({routes:{admin_tools:"admin"},admin:function(){var b=new duo.AdminDashboard;document.title="Duolingo: Admin Dashboard";var a=this;b.fetch({data:{page:0,log_type:"deletes"},success:function(c){if("access denied"==c.get("response"))return duo.show404(),!1;c=new duo.AdminDashboardView({model:b});a.switchView(c,"admin")}})}});
duo.CommentRoutes=duo.Router.extend({routes:{"comment/:id$unfollow":"showCommentUnfollow","comment/:id$from_email=:from_email&comment_id=:comment_id":"showCommentFromEmail","comment/:id$from_email=:from_email":"showCommentFromEmail","comment/:id$comment_id=:comment_id":"scrollToComment","comment/:id":"showComment",discussion:"listComments","discussion/:sort":"listComments","discussion$from_email=:from_email":"listCommentsFromEmail","topic/:id":"showTopic","topic/:id/:sort_by":"showTopic","!/comment/:id":"showComment"},
showComment:function(b,a,c){duo.social_enabled||duo.show404();var d=this,f=new duo.Comment({id:b});duo.track("show_comment",{id:b});f.fetch({data:{ui_language:duo.user?void 0:duo.browser_language},success:function(){0<window.location.href.indexOf("#!")&&duo.track("question search result",{sentence_comment:!0==f.get("sentence_comment"),url:window.location.href});document.title="Duolingo: "+f.get("title");var b=new duo.CommentView({model:f,comment_id:c});d.switchView(b,"comment better-comment community-topic",
null,f.get("message"));duo.user||(data={el:$(".logged-out-message")},f.get("sentence_comment")&&(data.language=f.get("root").name),(new duo.LoggedOutMessage(data)).render());a&&f.unwatch()},error:function(){duo.show404()}})},showCommentFromEmail:function(b,a,c){duo.track("email button click",{from_email:a});this.showComment(b,void 0,c)},scrollToComment:function(b,a){this.showComment(b,void 0,a)},showCommentUnfollow:function(b){this.showComment(b,!0,void 0)},listComments:function(b){this.showTopic(void 0,
b)},listCommentsFromEmail:function(b){duo.track("email button click",{from_email:b});Backbone.history.navigate("/discussion",{trigger:!0,replace:!0})},showTopic:function(b,a){duo.social_enabled||duo.show404();var c=this;"subscriptions"===b&&duo.user&&(b=void 0);var d=new duo.Topic({id:b});duo.track("Show Topic");d.fetch({data:{ui_language:duo.user?void 0:duo.browser_language},success:function(){d.get("js_version")!=duo.js_version&&window.location.reload(!0);document.title="Duolingo: "+translate_text("Questions and Insights");
var b=new duo.TopicView({model:d});c.switchView(b,"comment better-comment");duo.user||(new duo.LoggedOutMessage({el:$(".logged-out-message")})).render();a||(a="hot");b.changeSort(a)}})}});
duo.CourseRoutes=duo.Router.extend({routes:{"course/:learning_language_id/:from_language_id$from_email=:from_email":"courseFromEmail","course/:learning_language_id/:from_language_id(/*text)":"course",courses:"courseList","courses/:from_language_id":"courseList"},initialize:function(){this.setGoBackToAll(!1)},courseList:function(b){var a=this,c=new duo.CourseList;c.fetch({data:{ui_language_abbrev:duo.user?duo.user.get("ui_language"):duo.browser_language},success:function(d){document.title="Duolingo: "+
translate_text("Language Courses");d=new duo.CourseListView({collection:c,from_language_id:b});a.switchView(d)}})},course:function(b,a){var c=new duo.Course({learning_language_id:b,from_language_id:a}),d=this;c.fetch({data:{ui_language_abbrev:duo.user?duo.user.get("ui_language"):duo.browser_language},success:function(a){document.title=$.duostache(duo.templates["course-title"],c.toJSON(),duo.templates);Backbone.history.navigate($.duostache("/course/{{learning_language_id}}/{{from_language_id}}/{{#_i}}Learn-{{#_iv}}{{learning_language_name}}{{/_iv}}-Online{{/_i}}",
c.toJSON()).replace(" ","-"),{replace:!0});a=new duo.CourseView({model:c,from_all:d._go_back_to_all});d.switchView(a)}})},courseFromEmail:function(b,a,c){duo.track("email button click",{from_email:c});Backbone.history.navigate("/course/"+b+"/"+a,{trigger:!0,replace:!0})},setGoBackToAll:function(b){this._go_back_to_all=b}});
duo.GroupRoutes=duo.Router.extend({routes:{team:"teamUp","team/:id":"showTeam","team/:id/join/:invitation_id":"showTeamFromEmailInvite","team/:id/:action":"showTeamWithAction",teams:"listTeams",manageTeams:"manageTeams"},teamUp:function(){if(duo.enabled_groups_experiment){var b=new duo.GroupList;document.title="Duolingo: Teams";var a=this;b.fetch({data:{},success:function(c){c=new duo.GroupIntroView({collection:b});a.switchView(c)}})}else duo.show404()},listTeams:function(){if(duo.enabled_groups_experiment){var b=
new duo.GroupList;document.title="Duolingo: Teams";var a=this;b.fetch({data:{},success:function(c){c=new duo.GroupListView({model:b});a.switchView(c)}})}else duo.show404()},showTeam:function(b,a,c){if(duo.enabled_groups_experiment){var d=new duo.Group({id:b}),f=this;d.fetch({data:{},success:function(b){b=new duo.GroupView({model:d,email_invitation_id:c});a&&(b.model.show_notification=a);f.switchView(b)},error:function(a){duo.show404()}})}else duo.show404()},showTeamWithAction:function(b,a){this.navigate("/team/"+
b,{trigger:!1,replace:!0});this.showTeam(b,a)},showTeamFromEmailInvite:function(b,a){this.navigate("/team/"+b,{trigger:!1,replace:!0});this.showTeam(b,void 0,a)},manageTeams:function(){if(duo.enabled_groups_experiment){var b=new duo.GroupManager,a=this;b.fetch({data:{},success:function(c){c=new duo.ManageGroupsView({model:b});a.switchView(c)}})}else duo.show404()}});
duo.LoggedOutProgressRoutes=duo.Router.extend({routes:{"":"progressSplash",dashboard_help:"showDashboardHelp"},progressSplash:function(){duo.track("teachers_dashboard_splash");this.replaceTopbar();document.title="Duolingo: "+translate_text("Dashboard");var b=new duo.ProgressSplashView;this.switchView(b,"progress-splash","progress-splash-body");this.fixFooterLinks()},fixFooterLinks:function(){$(".footer-main a").each(function(){var b="/help"==$(this).attr("href")&&duo.feature_flags.dashboard_help?
"/dashboard_help":$(this).attr("href").replace(/^\//,"//www.duolingo.com/");$(this).attr("href",b)})},showDashboardHelp:function(){this.replaceTopbar();this.switchView(new duo.DashboardFAQView,"help");this.fixFooterLinks()},replaceTopbar:function(){duo.topbar=new duo.ProgressLoggedOutTopbarView;$("#topbar").replaceWith(duo.topbar.render().el);$('#topbar li[data-id="'+duo.browser_language_id+'"]').remove()}});
duo.ProgressRoutes=duo.LoggedOutProgressRoutes.extend({routes:{"":"progress",dashboard_help:"showDashboardHelp"},progress:function(b,a){duo.track("teachers_dashboard_show_home");if(duo.user.get("trial_account"))this.progressSplash();else{this.replaceTopbar();var c=this;duo.user.get("dashboard_redesign")?(new duo.Classroom).fetch({data:{week:"all"},success:function(a){document.title="Duolingo: "+translate_text("Dashboard");a=new duo.NewProgressDashboardView({model:a});c.switchView(a,"progress","progress");
c.fixFooterLinks();$("li[data-tab=uploaded]").click()}}):(new duo.ProgressOverview).fetch({data:{},success:function(a){document.title="Duolingo: "+translate_text("Dashboard");a=new duo.ProgressDashboardView({model:a});c.switchView(a,"progress","progress");c.fixFooterLinks();$("li[data-tab=uploaded]").click()}})}},replaceTopbar:function(){$("body").css("background-image","none");duo.topbar=new duo.ProgressTopbarView({model:duo.user});$("#topbar").replaceWith(duo.topbar.render().el)}});
duo.SchoolsRoutes=duo.Router.extend({routes:{"":"schools",schools_help:"showSchoolsHelp",instructions:"instructions"},schools:function(b){duo.track("teachers_schools_splash");this.replaceTopbar(b);b=new duo.SchoolsSplashView;this.switchView(b,"schools-splash","schools-splash-body");this.fixFooterLinks()},showSchoolsHelp:function(b){this.replaceTopbar(b);this.switchView(new duo.DashboardFAQView,"help");this.fixFooterLinks()},fixFooterLinks:function(){$(".footer-main a").each(function(){var b="/help"==
$(this).attr("href")&&duo.feature_flags.dashboard_help?"/schools_help":$(this).attr("href").replace(/^\//,"//www.duolingo.com/");$(this).attr("href",b)})},instructions:function(b){console.debug("instructions");duo.topbar=new duo.SchoolsLoggedOutTopbarView(b);$("#topbar").replaceWith(duo.topbar.render().el);$('#topbar li[data-id="'+duo.browser_language_id+'"]').remove();document.title="Duolingo: "+translate_text("Schools");b=new duo.SchoolsInstructionsView;this.switchView(b,"schools-instructions",
"schools-instructions-body")},replaceTopbar:function(b){duo.topbar=new duo.SchoolsLoggedOutTopbarView(b);$("#topbar").replaceWith(duo.topbar.render().el);$('#topbar li[data-id="'+duo.browser_language_id+'"]').remove();document.title="Duolingo: "+translate_text("Schools")}});
duo.SelectLanguageRoutes=duo.Router.extend({initialize:function(){duo.topbar=new duo.UserTopbarView({model:duo.user});$("#topbar").replaceWith(duo.topbar.render().el);duo.topbar.hideTabs(!0)},routes:{"":"welcome","*path":"welcome"},welcome:function(){var b=new duo.WelcomeSession,a=this;b.fetch({data:{force_welcome:!0},success:function(c,d){document.title="Duolingo: "+translate_text("Welcome");var f=new duo.WelcomeSessionView({model:b,no_direction:!0});a.switchView(f,"player")}})}});
duo.LoggedOutSelfServiceRoutes=duo.Router.extend({routes:{"":"selfServiceSplash",en:"selfServiceSplash",es:"selfServiceSplash",fr:"selfServiceSplash",pt:"selfServiceSplash"},selfServiceSplash:function(b){duo.topbar=new duo.SelfServiceLoggedOutTopbarView(b);$("#topbar").replaceWith(duo.topbar.render().el);$('#topbar li[data-id="'+duo.browser_language_id+'"]').remove();document.title="Duolingo: "+translate_text("Translations");b=new duo.SelfServiceSplashView;this.switchView(b,"self-service-splash",
"self-service-splash-body");$(".client-info a").hide();this.fixFooterLinks()},fixFooterLinks:function(){$(".footer-main a").each(function(){var b=$(this).attr("href").replace(/^\//,"//www.duolingo.com/");$(this).attr("href",b)})}});
duo.SelfServiceRoutes=duo.LoggedOutSelfServiceRoutes.extend({routes:{"":"selfService",upload:"uploadSelfService"},selfService:function(b,a){duo.user.get("upload-self-service")?this.selfServiceHome(b,a):this.selfServiceSplash({model:duo.user})},selfServiceHome:function(b,a){this.replaceTopbar();var c=this,d=new duo.TranslationsOverview;d.self_service=!0;d.fetch({data:{source:b,target:a},success:function(a){document.title="Duolingo: "+translate_text("Translations");a=new duo.SelfServiceView({model:a});
c.switchView(a,"self-service","self-service-body");c.fixFooterLinks();$("li[data-tab=uploaded]").click()}})},uploadSelfService:function(){if(duo.user.get("upload-self-service")){this.replaceTopbar();var b=new duo.SelfServiceUploadView({model:new Backbone.Model});this.switchView(b,"self-service-upload","self-service-upload-body");$('a[href*="/"]').click(function(){if("upload"===Backbone.history.fragment&&!confirm($("#confirm-message-link").text()))return!1});b=function(){if("upload"===Backbone.history.fragment)return $("#confirm-message-window").text()};
$(window).on("unload",b);$(window).on("beforeunload",b);this.fixFooterLinks()}else location.href="/"},replaceTopbar:function(){$("body").css("background-image","none");duo.topbar=new duo.SelfServiceTopbarView({model:duo.user});$("#topbar").replaceWith(duo.topbar.render().el)}});
duo.StaticRoutes=duo.Router.extend({routes:{static_page:"staticDir",terms:"terms","effectiveness-study":"study","effectiveness-study$from_email=:from_email":"study","/effectiveness-study":"study",info:"info",contact:"contact",resources:"resources",mobile:"mobile","!/mobile":"mobile",privacy:"privacy",jobs:"jobs",help:"help",guidelines:"guidelines",press:"press"},staticDir:function(b){document.title="Duolingo: "+translate_text("Terms");b=new duo.StaticDirectory;this.switchView(b,"terms")},toStaticPage:function(b,
a){this.staticDirectory||(this.staticDirectory=new duo.StaticDirectory);"staticView"!=duo.view&&(this.switchView(this.staticDirectory,"staticView"),duo.user||(new duo.LoggedOutMessage({el:$("#logged-out-message")})).render());this.staticDirectory.jobsView.data=a;this.staticDirectory.tab(b)},terms:function(){document.title="Duolingo: "+translate_text("Terms");this.toStaticPage("terms")},help:function(){document.title="Duolingo: "+translate_text("Help");this.toStaticPage("help")},guidelines:function(){document.title=
"Duolingo: "+translate_text("Guidelines");this.toStaticPage("guidelines")},about:function(b){new duo.InfoView({id:"app"});this.toStaticPage("info",b)},info:function(){document.title="Duolingo: "+translate_text("Info");this.about("info")},contact:function(){document.title="Duolingo: "+translate_text("Contact");this.about("contacts")},resources:function(){document.title="Duolingo: "+translate_text("Resources");this.about("resources")},study:function(b){document.title="How effective is Duolingo?";this.toStaticPage("study")},
mobile:function(){document.title=translate_text("Duolingo on the go");this.toStaticPage("mobile")},privacy:function(){document.title="Duolingo: "+translate_text("Privacy");this.toStaticPage("privacy")},jobs:function(b){var a=this;$.get("/jobs_list",function(b){document.title="Duolingo: "+translate_text("Jobs");b.id="app";a.toStaticPage("jobs",b)},"json")},press:function(){document.title="Duolingo: "+translate_text("Press");this.toStaticPage("press")}});
duo.StreamRoutes=duo.Router.extend({routes:{activity_stream:"stream"},initialize:function(){},stream:function(){duo.user.get("trial_account")&&duo.show404();document.title="Duolingo: "+translate_text("Activity");var b=new duo.StreamView({model:duo.user});this.switchView(b)}});duo.Document=Backbone.Model.extend({urlRoot:"/documents"});
duo.UIStringRoutes=duo.Router.extend({routes:{"ui_strings/:target_language$search=:keyword":"search","ui_strings/:target_language":"list","ui_strings/:id":"show"},initialize:function(){},show:function(b){var a=this,c=new duo.UIString({id:b});c.fetch({success:function(){document.title="Duolingo: UI String "+b;var d=new duo.UIStringView({model:c});a.switchView(d,"translate_job")}})},list:function(b){if(2<b.length)return this.show(b);var a=this,c=new duo.UIStringList({target_language:b});c.fetch({success:function(){document.title=
"Duolingo: UI Strings";var b=new duo.UIStringOverviewView({collection:c});a.switchView(b,"upload-page")}})},search:function(b,a){var c=this,d=new duo.UIStringList({target_language:b,keyword:a});d.fetch({success:function(){document.title="Duolingo: UI Strings";var a=new duo.UIStringOverviewView({collection:d});c.switchView(a,"upload-page")}})}});
duo.UnsupportedRoutes=duo.Router.extend({routes:{"":"landing","*path":"landing"},landing:function(){document.title="Duolingo";var b=new duo.UnsupportedLanding;this.switchView(b)}});
duo.VocabRoutes=duo.Router.extend({routes:{words:"listVocab"},listVocab:function(){if(!_.contains(duo.vocab_languages,duo.user.get("ui_language"))||!_.contains(duo.vocab_languages,duo.user.get("learning_language"))||duo.user.get("trial_account")||!duo.feature_flags.show_vocab_page)return duo.show404(),!1;var b=new duo.VocabList,a=this;b.fetch({data:{},success:function(){var c=new duo.VocabView({collection:b});document.title="Duolingo: "+translate_text("Words");a.switchView(c)}})}});
var timing=function(){var b={timings:{},splits:[]};b.absolute_start=(new Date).getTime();b.start=function(a){var c=(new Date).getTime(),d=c-b.absolute_start;b.timings[a]={start:c,start_split:c-b.absolute_start};b.splits.push([d,a+" STARTED"])};b.stop=function(a){var c=(new Date).getTime(),d=c-b.timings[a].start,f=c-b.absolute_start;b.timings[a].stop=c;b.timings[a].duration=d;b.splits.push([f,a+" ENDED"]);return d};b.mark=function(a){var c=(new Date).getTime(),d=c-b.absolute_start;b.timings[a]={timestamp:c,
since_load:c-b.absolute_start};b.splits.push([d,a])};return b}();
duo.AdminDashboardView=Backbone.View.extend({id:"app",template:duo.templates["admin-dashboard"],events:{"click .view-option":"showView","click .show-comments":"seeCommentLog","click .show-deletes":"seeDeleteLog","click .show-bans":"showShadowBanned","click .get-summary":"showUserSearch","keyup #search-user":"getSummary"},initialize:function(){this.banned=void 0},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));(new duo.ModerationLogView({el:this.$("#moderation-log"),
collection:this.model.get("moderation_log"),model:this.model,type:"deletes"})).render();this.$(".search-input-box").hide();var b=this;_.defer(function(){b.$("label").inFieldLabels()});return this},showView:function(b){b=$(b.currentTarget).data("view-area");this.$(".view-area").hide();this.$(".view-area#"+b).show();if("lingot-store-activity"==b)this.$("#selected-view-option").text("Lingot Store Activity"),_.isUndefined(this.lingot_store_activity_view)&&(b=new duo.LingotStoreActivityView({model:new duo.LingotStoreActivity,
el:this.$("#lingot-store-activity")}),b.model.fetch({success:_.bind(b.render,b)}));else if("manage-moderators"==b){var a=this;$.post("/diagnostics/topic_moderators/list_topics",function(b){a.$("#selected-view-option").text("Manage Moderators");a.mod_manager||(a.mod_manager=new duo.ManageModeratorsView({topics:b,el:a.$("#manage-moderators")}),a.mod_manager.changeTopic())})}else this.$("#selected-view-option").text("Recent Moderator Activity")},seeCommentLog:function(){_.isUndefined(this.model.comment_log)&&
(this.model.getComments(),this.$(".show-comments").addClass("active"),this.$(".show-deletes").removeClass("active"),this.$("#moderation-log").hide(),this.$("#comment-log").show())},seeDeleteLog:function(){this.$(".show-comments").removeClass("active");this.$(".show-deletes").addClass("active");this.$("#comment-log").hide();this.$("#moderation-log").show()},showShadowBanned:function(){this.model.getShadowBannedUsers();var b=this;void 0===this.banned&&(this.banned=new duo.ShadowBannedModalView({el:this.$("#banned-modal"),
model:this.model}),this.$("#banned-modal").modal({keyboard:!0,backdrop:!0,show:!1}).delegate(".username","click",function(a){b.$("#banned-modal").modal("hide")}));this.banned.render();this.$("#banned-modal").modal("show")},showUserSearch:function(){this.$(".search-input-box").fadeToggle(400)},getSummary:function(b){13===b.which&&(b=this.$("input[id=search-user]").val(),window.location="/diagnostics/user/summary/"+b)}});
duo.ModerationLogView=Backbone.View.extend({template:duo.templates["moderation-log"],events:{"click .load-more":"loadMore","click .undelete":"undelete"},initialize:function(b){this.collection=b.collection;this.page=0;this.more=!0;this.collection.bind("all",this.render,this);this.collection.bind("remove",this.render,this);this.log_type=b.type},render:function(){var b=this.collection.toJSON();_.each(b,function(a,b,d){a.index=b});b=_.extend({events:b,delete_log:"deletes"==this.log_type,comment_log:"comments"==
this.log_type,more:this.collection.more});$(this.el).html($.duostache(this.template,b,duo.templates));return this},loadMore:function(){this.page+=1;this.collection.fetch({data:{page:this.page,log_type:this.log_type},update:!0,remove:!1})},undelete:function(b){var a=$(b.currentTarget).data("id"),c=$(b.currentTarget).data("index"),d=this;$.post("/comments/"+a+"/undelete",function(){var a=d.collection.at(c);d.collection.remove(a)})}});
duo.ShadowBannedModalView=Backbone.View.extend({template:duo.templates["shadow-banned"],events:{"click .add-banned":"addBannedUser","click .unban-user":"removeBannedUser","keypress .add-username-input":"checkKeyup"},initialize:function(b){this.model.bind("change",this.render,this);this.banned_users=b.banned_users},render:function(){$(this.el).html($.duostache(this.template,_.extend({},{users:this.model.get("banned_users")}),duo.templates));var b=this;_.defer(function(){b.$("label").inFieldLabels()});
return this},checkKeyup:function(b){13===b.which&&(b.preventDefault(),this.addBannedUser())},addBannedUser:function(){var b=this.$("input[id=add-username]").val();0<b.length&&this.model.addShadowBannedUser(b)},removeBannedUser:function(b){b=$(b.currentTarget).data("userid");this.model.removeShadowBannedUser(b)}});duo.LingotStoreActivityView=Backbone.View.extend({template:duo.templates["lingot-store-activity"],render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates))}});
duo.ManageModeratorsView=Backbone.View.extend({template:duo.templates["mod-manager"],events:{"click .topic-option":"changeTopic","click .add-user":"addModerator","click .remove-moderator":"removeModerator","click #see-all":"listAllMods"},render:function(){var b=this.options.topics;_.each(b,function(a,b){a.active=a.id===this.topic_id;a.type=!a.learning_language?a.name.toLowerCase():null;a.main="Duolingo"==a.name;a.trouble="Troubleshooting"==a.name;a.flag_abbrev=a.from_language},this);$(this.el).html($.duostache(this.template,
{topics:b,moderators:this.mod_info,has_moderators:0<this.mod_info.length,has_topic:this.topic_id},duo.templates))},listAllMods:function(){this.$(".topic-option.active").removeClass("active");var b=this;$.post("/diagnostics/topic_moderators/list_mods",{},function(a){b.mod_info=a;b.topic_id=void 0;b.render()})},changeTopic:function(b){this.topic_id=b?$(b.currentTarget).data("id"):1;var a=this;$.post("/diagnostics/topic_moderators/list_mods",{topic_id:a.topic_id},function(b){a.mod_info=b;b=a.$(".topic-list").scrollTop();
a.render();a.$(".topic-list").scrollTop(b)})},addModerator:function(){var b=this.$("#add-moderator").val(),a=this;""!=$.trim(b)&&$.post("/diagnostics/topic_moderators/add",{topic_id:a.topic_id,user_id:b},function(b){a.mod_info=b;a.render()})},removeModerator:function(b){b=$(b.currentTarget).data("id");var a=this;$.post("/diagnostics/topic_moderators/remove",{topic_id:a.topic_id,user_id:b},function(b){a.mod_info=b;a.render()})}});
duo.CourseListView=Backbone.View.extend({id:"app",template:duo.templates["course-list"],events:{"change .from-language-dropdown":"newFilterLanguage"},initialize:function(b){this.filter_from_language=b.from_language_id;this.use_abbrev=!1;void 0===this.filter_from_language&&(this.filter_from_language=duo.user?duo.user.get("ui_language"):duo.browser_language,this.use_abbrev=!0)},render:function(){duo.courseRouter.setGoBackToAll("all"==this.filter_from_language);var b=[],b=this.use_abbrev?"all"==this.filter_from_language?
this.collection.models:this.collection.where({from_language:this.filter_from_language}):"all"==this.filter_from_language?this.collection.models:this.collection.where({from_language_id:this.filter_from_language}),a=[];_.each(b,function(b,d){var f=Math.floor(d/3);f in a?a[f].directions.push(b):a[f]={directions:[b]}},this);$(this.el).html($.duostache(this.template,{all_source_languages:this.collection.all_source_languages,course_list:b,rows:a},duo.templates));this.use_abbrev?this.$(".from-language-dropdown option[data-abbrev="+
this.filter_from_language+"]").attr("selected","selected"):this.$(".from-language-dropdown option[data-id="+this.filter_from_language+"]").attr("selected","selected");return this},newFilterLanguage:function(){this.filter_from_language=this.$(".from-language-dropdown").find(":selected").data("id");this.use_abbrev=!1;this.render();duo.courseRouter.navigate("/courses/"+this.filter_from_language);return!0}});
duo.CourseView=Backbone.View.extend({id:"app",template:duo.templates["course-page"],events:{"click .btn-course-notify":"toggleNotify","click .switch-learning-language":"switchLearningLanguage","click .switch-ui-language":"switchDirection","click .register":"showRegistration","click .email-subscribe":"showEmailOption","blur .email-input":"emailInputBlur","keyup .email-input":"emailInputKeyup","keydown .email-input":"emailInputKeydown","mousedown .confirm-email-subscribe":"confirmSubscribeMousedown"},
render:function(){var b=this.model.get("phase"),a=[];this.model.get("contributors").sort(function(a,b){return-(a.contribution-b.contribution)});var c=this.model.get("contributors").length;_.each(this.model.get("contributors"),function(b,d){var f=parseInt(100*b.contribution);1>=f?c-=1:(b.contrib_percent=f,f=Math.floor(d/4),f in a?a[f].contributors.push(b):a[f]={contributors:[b]})},this);var d=(duo.user?duo.user.get("ui_language"):duo.browser_language)==this.model.get("from_language"),f=this.model.get("learning_language"),
f=duo.user&&d&&_.where(duo.user.get("languages"),{learning:!0,language:f});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{phase_1:1==b,phase_2:2==b,phase_3:3==b,in_beta:1<b,released:2<b,num_contributors:c,rows:a,learning:f,curr_learning_language:duo.user&&this.model.get("learning_language")==duo.user.get("learning_language"),ui_language_matches:d,normalized_progress:parseInt(2*this.model.get("progress")),beating_average:0<this.model.get("compare_to_avg"),overall_progress:Math.min(this.model.get("progress")+
(2==b?this.model.get("percent_to_stable")/2:0),95),from_all:this.options.from_all,logged_in:duo.user,has_contributors:0<this.model.get("contributors").length}),duo.templates));var g=this;_.defer(function(){$(".course-page-illustration").parallax();g.$(".contributor-row").each(function(){$(this).absoluteTableCell()});var a=g.model.get("user_subscribed")?"subscribed":"unsubscribed";$(".subscribe-text").text($(".subscribe").data(a))});duo.user||(this.registration_modal||(this.registration_modal=new duo.NewUserModalView({learning_language:this.model.get("learning_language"),
from_language:this.model.get("from_language")}),this.registration_modal.render(),$("body").append(this.registration_modal.el)),this.registration_modal.switchToCreateView());return this},toggleNotify:function(){var b=this.$(".btn-course-notify").hasClass("success"),a=b?"unsubscribed":"subscribed";this.$(".subscribe-text").text($(".btn-course-notify").data(a));this.$(".subscribe").toggleClass("success");var c=parseInt(this.$(".course-notify-count").text());this.$(".course-notify-count").text("unsubscribed"==
a?c-1:c+1);$.post("/api/1/courses/"+this.model.get("learning_language_id")+"/"+this.model.get("from_language_id")+"/"+(b?"unsubscribe":"subscribe"));b||duo.track("course subscribe",{logged_in:!0,learning_language:this.model.get("learning_language"),from_language:this.model.get("from_language")})},switchLearningLanguage:function(){duo.user.switchLanguage(this.model.get("learning_language"))},switchDirection:function(){duo.user.switchDirection(this.model.get("learning_language"),this.model.get("from_language"),
"/")},showEmailOption:function(){var b=this;if(!b.$(".email-input").is(":visible")){b.$(".subscribe").addClass("btn-outline");var a=b.$(".subscribe-text").width();b.$(".subscribe-text").hide();b.$(".email-input").show().css("width",a+"px").stop().animate({width:"250px"},500).focus();b.$(".confirm-email-subscribe").stop();b.$(".course-notify-count").stop().fadeTo(250,0,function(){b.$(".confirm-email-subscribe").fadeTo(250,1)})}},emailInputBlur:function(){this._prevent_blur?(this._prevent_blur=!1,this.$(".email-input").focus()):
this.hideEmailOption()},hideEmailOption:function(b){var a=this;if(!a.$(".email-input").prop("disabled")){var c=a.$(".subscribe-text").width();a.$(".email-input").prop("disabled",!0).stop().animate({width:c+"px"},500,function(){a.$(".subscribe").removeClass("btn-outline");a.$(".subscribe-text").show();a.$(".email-input").prop("disabled",!1).hide();b&&a.$(".subscribe").removeClass("email-subscribe").prop("disabled",!0)});a.$(".course-notify-count").stop();a.$(".confirm-email-subscribe").stop().fadeTo(250,
0,function(){a.$(".course-notify-count").fadeTo(250,1)})}},emailInputKeydown:function(b){9==b.which&&b.preventDefault()},emailInputKeyup:function(b){13==b.which?this.subscribeWithEmail():27==b.which&&this.hideEmailOption()},confirmSubscribeMousedown:function(){this.subscribeWithEmail();this._prevent_blur=!0},showToast:function(b){self.$(".error-toast").text(b).stop(!0).css("opacity",1).show().fadeTo(800,1).fadeOut(800)},subscribeWithEmail:function(){var b=this,a=b.$(".email-input").val();duo.isEmail(a)?
($.post("/api/1/courses/"+b.model.get("learning_language_id")+"/"+b.model.get("from_language_id")+"/subscribe",{email:a},null,"json").done(function(a){a.newly_subscribed?(a=parseInt(b.$(".course-notify-count").text()),b.$(".course-notify-count").text(a+1)):b.showToast(translate_text("Already subscribed!"))}),b.$(".subscribe-text").text(b.$(".subscribe").data("subscribed")),b.hideEmailOption(!0),duo.track("course subscribe",{logged_in:!1,learning_language:b.model.get("learning_language"),from_language:b.model.get("from_language")})):
b.showToast(translate_text("Invalid email address!"))},showRegistration:function(){$.post("/register",{trial_account:!0,one_click:!0,ui_language:this.model.get("from_language"),learning_language:this.model.get("learning_language")},function(b){duo.track("$create_alias",{alias:String(b.user_id)},function(){window.location="/welcome"},300)})}});
duo.CourseRegisterModalView=duo.RegisterModalView.extend({initialize:function(b){duo.RegisterModalView.prototype.initialize.call(this,_.extend({ui_location:"course registration"},b));this._learning_language=b.learning_language;this._from_language=b.from_language},signupFacebook:function(){var b=this;b._form.fillWithFacebook(function(){duo.User.prototype.switchDirection(b._learning_language,b._from_language,"/")},function(){b.showForm()})},signupGoogle:function(){var b=this;duo.loginWithGoogle("course registration",
function(){duo.User.prototype.switchDirection(b._learning_language,b._from_language,"/")},function(){duo.User.prototype.switchDirection(b._learning_language,b._from_language,"/welcome")})}});
(function(b){var a=Backbone.View.extend({id:"app",render:function(){this.$el.html(b.duostache(this.article_template,duo,duo.templates));var a=this;_.defer(function(){a.postRender()});return this},postRender:function(){var a=this;b.get("/api/1/articles/get_article",{domain:a.article_domain,label:a.article_label,language_abbrev:duo.user?duo.user.get("ui_language"):duo.browser_language},function(d){d.article?(a.$("#help").html(d.article),window.location.hash&&b(window.location.hash)[0].scrollIntoView(!0)):
window.location="https://www.duolingo.com/help"},"jsonp")}});duo.DashboardFAQView=a.extend({article_label:"help",article_domain:"schools",article_template:duo.templates["schools-help"]})})(window.jQuery);
duo.GroupIntroView=Backbone.View.extend({id:"app",template:duo.templates["group-intro"],events:{"click .create-group":"showModal","click .find-fb-groups":"fbConnect"},render:function(){$(this.el).html($.duostache(this.template,{no_groups:0==this.collection.length,can_create:duo.user.get("can_create_groups")},duo.templates));this.groupListView=new duo.GroupListView({collection:this.collection,el:this.$(".join-group-pane")});this.groupListView.render();0==this.collection.length&&$(".extra-social-button").hide();
return this},showModal:function(){this.invite_modal||(this.invite_modal=new duo.GroupInviteView({el:self.$("#team-modal")}),this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1}));this.$("#team-modal").modal("show");this.invite_modal.focusGroupName()},fbConnect:function(){this.loginFB()},loginFB:function(){var b=this;window.FB&&FB.login(function(a){a.authResponse&&b.fetchFromFB.call(b,a.authResponse)},{scope:"publish_actions"})},fetchFromFB:function(b){var a=b.userID;b=b.accessToken;var c=this;
duo.user.set({facebook_id:a},{silent:!0});FB.api("/me/friends?access_token="+b+"&fields=picture,installed,name",function(b){b=_.filter(b.data,function(a){return a.installed});$.post("/api/1/groups/facebook_friend_groups",{facebook_id:a,facebook_friends:JSON.stringify(b)},function(a){c.showFB(a)})})},showFB:function(b){b=this.groupListView.collection.parse(b);this.groupListView.collection.reset();this.groupListView.collection.add(b);this.groupListView.render();this.render()}});
duo.ManageGroupsView=Backbone.View.extend({id:"app",template:duo.templates["group-manager"],render:function(){$(this.el).html($.duostache(this.template,{can_create:duo.user.get("can_create_groups")},duo.templates));var b=this;_.each(this.model.models,function(a){a.has("leaderboard_info")&&_.each(a.get("leaderboard_info"),function(b){b.xp_today>a.get("daily_goal")&&(b.met_goal=!0)});var c=new duo.GroupLeaderboardView({leaderboard_info:a.toJSON(),tagName:"li",className:"less-padding white",multiple_boards:!0});
b.$(".list-group-leaderboards").append(c.render().el)});return this}});
duo.GroupInviteView=Backbone.View.extend({template:duo.templates["group-invite-modal"],events:{"click .color-option":"selectColor","click .icon-option":"selectIcon","click .switch-page":"switchTabs","click .next-page":"nextPage",'click input[name="auto_join"]':"checkAutoJoin",'click .invitee[type="checkbox"]':"addUser","click .invite-later":"inviteLater","click .send-invites":"sendInvites",'input .ui-widget-content[type="text"]':"keyCheckSearch","focus .group-name":"hideErrors","click .custom-daily-goal-input":"hideErrors",
"keyup .group-name":"disableTabbing"},initialize:function(){this.inviting_users=[];this.lazySearch=_.debounce(this._search,500);this.current_page=this.options.invite_more?4:this.options.banner_only?2:1;this.getInvitees()},render:function(){this.$el.html($.duostache(this.template,_.extend(duo.user.toJSON(),{invite_more:this.options.invite_more,banner_only:this.options.banner_only,people:this.followers_and_friends,icons:_.range(1,21),lazy_avatars:!0,already_in_group:void 0!==duo.user.get("group"),num_invites_remaining:this.model?
this.model.get("num_invites_remaining"):void 0}),duo.templates));(this.options.invite_more||this.options.banner_only)&&this.goToPage(this.current_page);this.friend_usernames=_.pluck(this.followers_and_friends,"username");this.$("#invite-list").typeahead({source:this.friend_usernames,render:this.renderSearch,lookup:this.typeaheadLookup,renderNone:!0,data:{view:this}});if(!this.options.invite_more){var b=this.model?this.model.get("color"):"blue";this.model&&this.$('.icon-option[data-index="'+this.model.get("icon_index")+
'"]').addClass("active");this.$('.color-option[data-color="'+b+'"]').addClass("active");this.$("#icon-selector").removeClass().addClass("group-icon-list group-color-"+b);this.checkContinue()}var a=this;this.$("#invite-list").tagit({placeholderText:translate_text("Start typing"),afterTagAdded:function(b,d){var f=$(d.tag),g=d.tagLabel;f.addClass("invited-user");duo.isEmail(g)?f.addClass("email-address"):0<a.$('input[data-username="'+g.toLowerCase()+'"]').length?a.$('input[data-username="'+g.toLowerCase()+
'"]').attr("checked","checked"):f.addClass("unknown");f=parseInt($("#num_invites").text())-1;0>=f?a.$("#num_invites").text("0"):a.$("#num_invites").text(f)},beforeTagRemoved:function(b,d){d&&d.tagLabel&&a.$('input[data-username="'+d.tagLabel.toLowerCase()+'"]').removeAttr("checked");if(a.model&&a.$("#invite-list li").length-1<=a.model.get("num_invites_remaining")){var f=parseInt($("#num_invites").text())+1;0>=f?a.$("#num_invites").text("0"):a.$("#num_invites").text(f)}}});b={container:$(".user-list"),
effect:"fadeIn"};this.$("img.lazy").lazyload(b);setTimeout(function(){a.$(".user-list").scroll()},200);return this},getInvitees:function(){var b=this;$.get("/api/1/groups/get_invite_list",this.model?{group_id:this.model.id}:{},function(a){b.followers_and_friends=a;_.each(b.followers_and_friends,function(a){a.lower_username=a.username.toLowerCase()});b.render()})},focusGroupName:function(){var b=this;setTimeout(function(){b.$(".group-name").focus()},200)},checkAutoJoin:function(b){b=$(b.currentTarget).is(":checked");
void 0!==duo.user.get("group")&&b?this.$(".already-in-group").fadeIn():this.$(".already-in-group").fadeOut()},hideErrors:function(b){this.$(".groups-error-flag").fadeOut();$(b.currentTarget).hasClass("custom-daily-goal-input")&&this.$('input[data-goal="custom"]').attr("checked","checked")},keyCheckSearch:function(){this.lazySearch()},_search:function(){var b=this,a=this.$('.ui-widget-content input[type="text"]').val();$.get("/users/search",{q:a,per_page:20},function(a){a=_.filter(a.users,function(a){a.lower_username=
a.username.toLowerCase();return 0>b.friend_usernames.indexOf(a.username)});b.$(".search-results").html($.duostache(duo.templates["group-user-search"],{search_results:a}))})},selectColor:function(b){var a=$(b.currentTarget).data("color");this.$(".color-option").removeClass("active");this.$("#icon-selector").attr("class","group-icon-list").addClass("group-color-"+a);$(b.currentTarget).addClass("active");this.checkContinue()},selectIcon:function(b){$(b.currentTarget).data("index");this.$(".icon-option").removeClass("active");
$(b.currentTarget).addClass("active");this.checkContinue()},disableTabbing:function(){this.$(".nav-tabs li:not(.inactive):not(.active").addClass("inactive");this.$(".page-1 .continue").removeAttr("disabled")},checkContinue:function(){this.$(".color-option.active").length&&this.$(".icon-option.active").length&&this.$(".save-continue").removeAttr("disabled")},switchTabs:function(b){var a=$(b.currentTarget).data("page");$(b.currentTarget).hasClass("inactive")||a==this.current_page||this.goToPage(a)},
nextPage:function(){(this.options.invite_more||this.options.banner_only)&&this.$el.modal("hide");this.goToPage(this.current_page+1)},goToPage:function(b){if(1==this.current_page){var a=$.trim(this.$(".group-name").val());if(0===a.length)this.$(".no-name").fadeIn();else{var c=this;$.post("/api/1/groups/check_group_name",{group_name:a},function(a){a.error?"name_collision"==a.error?c.$(".name-taken").fadeIn():"too_long"==a.error?c.$(".too-long").fadeIn():c.$(".name-invalid").fadeIn():(c.invite_modal=
new duo.GroupInviteView({el:c.$("#team-modal")}),c.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1}),c.$("#team-modal").modal("show"),c.switchPage(b))})}}else this.switchPage(b)},switchPage:function(b){if(3==this.current_page&&"custom"==this.$('input[name="daily_goal_modal"]:checked').data("goal")){var a=$.trim(this.$("#daily_goal").val());if(""===a||!$.isNumeric(a)){this.$(".no-goal").fadeIn();return}}this.$(".modal-page").hide();this.$(".page-"+b).show();this.$('.nav-tabs li[data-page="'+this.current_page+
'"]').removeClass("active");this.$('.nav-tabs li[data-page="'+b+'"]').removeClass("inactive").addClass("active");this.current_page=b;if(4==b){this.$(".ui-widget-content").focus();var c=this;setTimeout(function(){c.$(".user-list").scroll()},200)}},addUser:function(b){var a=$(b.currentTarget).attr("checked");b=$(b.currentTarget).data("username");"checked"==a?this.$("#invite-list").tagit("createTag",b):this.$("#invite-list").tagit("removeTagByLabel",b)},removeUser:function(b){this.$('input[data-username="'+
b.toLowerCase()+'"]').removeAttr("checked")},focusEditable:function(){this.$(".editable-text").focus()},typeaheadLookup:function(b){this.query=this.$element.find('input[type="text"]').val();return!this.query?(this.options.data.view.$(".user-list li").removeClass("filtered-username").show(),this):this.search(this.query).hide()},renderSearch:function(b){var a={};_.each(b,function(b){a[b.toLowerCase()]=!0});this.options.data.view.$(".user-list li").each(function(b,d){$(d).find("input").data("username")in
a?$(d).removeClass("filtered-username"):$(d).addClass("filtered-username")});this.options.data.view.$(".user-list li").show();this.options.data.view.$(".filtered-username").hide();setTimeout(function(){self.$(".user-list").scroll()},200);return this},inviteLater:function(){this.options.invite_more?this.$el.modal("hide"):this.createTeam()},sendInvites:function(){var b=this.$("#invite-list").tagit("assignedTags");this.options.invite_more?(this.$el.modal("hide"),this._sendInvites(b)):this.createTeam(b)},
_sendInvites:function(b,a,c){var d=this;$.post("/api/1/groups/"+(a?a:this.model.id)+"/invite",{invitees:JSON.stringify(b)},function(b){c?(duo.groupRouter.navigate("/team/"+a+"/created",!0),duo.user.fetch()):0<b.invited_users.length&&(d.options.group_view&&(d.options.group_view.model.show_notification=1<b.invited_users.length?"invite_users":"invite_user",d.options.group_view.invited_info=1<b.invited_users.length?b.invited_users.length:b.invited_users[0].username),_.each(b.invited_users,function(a){a.is_admin=
!1}),b=d.model.get("invited_users").concat(b.invited_users),d.model.set({invited_users:b}))});this.$("#invite-list").tagit("removeAll")},createTeam:function(b){var a=this,c=this.$('input[name="daily_goal_modal"]:checked').data("goal"),c="custom"==c?this.$("#daily_goal").val():c;$.post("/api/1/groups/create",{name:this.$(".group-name").val(),color:this.$(".color-option.active").data("color"),icon_index:$(".icon-option.active").data("index"),defaults:this.$('input[name="defaults"]:checked').val(),join_team:this.$("#join_team").is(":checked"),
daily_goal:c},function(c){a.$el.modal("hide");b?a._sendInvites(b,c.id,!0):duo.groupRouter.navigate("/team/"+c.id+"/created",!0)})}});
duo.GroupListView=Backbone.View.extend({id:"app",template:duo.templates["group-list"],events:{"click .page-number":"changePage","click .next":"nextPage","click .previous":"previousPage","click .join-group":"joinGroup","click .more":"showMoreMembers","click .accept-invite":"acceptInvite"},initialize:function(){this.current_page=1},render:function(){var b=[];_.each(this.collection.toJSON(),function(a,c){a.display_members=8<a.member_count?a.members.slice(0,7):a.members;var d=Math.floor(c/3);b[d]?b[d].groups.push(a):
b[d]={groups:[a]}});$(this.el).html($.duostache(this.template,{page:0<b.length?b[this.current_page-1]:{},page_list:_.range(1,this.collection.length+1),no_groups:0===this.collection.length,many_groups:1<b.length,can_create:duo.user.get("can_create_groups")},duo.templates));this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});this.$('.page-number[data-page="'+this.current_page+'"]').addClass("active");1==this.current_page?this.$(".previous").attr({disabled:"disabled"}):this.current_page==this.collection.length&&
this.$(".next").attr({disabled:"disabled"});1>=b.length&&this.$(".group-next").attr("disabled","disabled");0===this.collection.length&&$(".extra-social-button").hide();return this},changePage:function(b){this.current_page=$(b.currentTarget).data("page");this.render()},nextPage:function(){this.current_page+=1;this.render()},previousPage:function(){this.current_page-=1;this.render()},joinGroup:function(b){b=$(b.currentTarget).data("group-id");duo.Group.joinGroup(b)},acceptInvite:function(b){b=$(b.currentTarget).data("invitation-id");
duo.Group.acceptInvite(b)},showMoreMembers:function(b){b=$(b.currentTarget).data("id");this.$(".more-users-"+b).modal("show")}});
duo.GroupView=Backbone.View.extend({id:"app",template:duo.templates.group,events:{"click .join-group":"joinGroup","click .accept-invite":"acceptInvite","click .leave-group":"leaveGroup","click .group-tab":"clickTab","click .invite-players":"invitePlayers"},initialize:function(b){this.model.bind("change",this.render,this);this.model.off("change:day_seconds_remaining");this.current_tab="members";this.model.show_notification=void 0;this.listenTo(this.model,"change:is_owner",this.ownerChanged)},render:function(){var b=
_.pluck(this.model.get("members"),"user_id");this.model.checkDailyGoals();$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{num_members:this.model.get("members").length,in_group:duo.user&&-1<b.indexOf(duo.user.id),show_invite:(this.model.get("is_owner")||this.model.get("users_can_invite"))&&0<this.model.get("num_invites_remaining")&&!this.model.get("group_full"),user_pending_invite:this.model.get("invitation_id"),show_notification:void 0!==this.model.show_notification,join_team:"join_team"==
this.model.show_notification,leave_team:"leave_team"==this.model.show_notification,invite_user:"invite_user"==this.model.show_notification,invite_users:"invite_users"==this.model.show_notification,created:"created"==this.model.show_notification,full:"full"==this.model.show_notification,invited_info:this.invited_info}),duo.templates));var b=parseInt(this.model.get("day_of_week"))+1,a=this.$(".daily-progress-header").data("title");this.$(".daily-progress-header li:nth-child("+b+")").addClass("today").attr("data-toggle",
"tooltip").attr("title",a);this.$('[data-user-id="'+duo.user.id+'"]').addClass("you");this.switchTab(this.current_tab);this.displayNotification();var c=this;this.options.email_invitation_id&&_.defer(function(){c.acceptInvite(c.options.email_invitation_id)});return this},displayNotification:function(){if(!this.displaying_notification&&this.model.show_notification){this.displaying_notification=!0;var b=this;setTimeout(function(){b.$(".notification-box").addClass("slide-in-down")},500);setTimeout(function(){b.$(".notification-box").addClass("slide-out-down")},
3E3);setTimeout(function(){b.$(".notification-box").removeClass("slide-in-down slide-out-down");b.displaying_notification=!1;b.invited_info=void 0;b.model.show_notification=!1;b.$(".notification-container").remove()},3500)}},ownerChanged:function(){this.switchTab("members");$(document).scrollTop(0)},clickTab:function(b){b=$(b.currentTarget).data("tab");b!=this.current_tab&&this.switchTab(b)},switchTab:function(b){this.$(".panel").hide();this.$(".group-tab").removeClass("active");this.$('.group-tab[data-tab="'+
b+'"]').addClass("active");"admin"==b?this.showAdminPanel():"discussion"==b?this.showDiscussionPanel():"trees"==b?this.showTree():this.$("#"+b).show();"discussion"!=b&&this.cleanup();this.current_tab=b},joinGroup:function(){this.model.show_notification="join_team";this.model.joinGroup();this.tree_panel=void 0},acceptInvite:function(b){this.model.get("group_full")?(this.model.show_notification="full",this.options.email_invitation_id=void 0,this.render()):(b=$(b.currentTarget).data("invite-id")||this.options.email_invitation_id,
this.options.email_invitation_id=void 0,this.model.acceptInvite(b))},leaveGroup:function(){this.model.show_notification="leave_team";this.model.leaveGroup();this.tree_panel=void 0},showAdminPanel:function(){if(this.admin_panel)this.$("#admin").append(this.admin_panel.el),this.admin_panel.delegateEvents(),this.$("#admin").show();else{var b=this;$.get("/api/1/groups/"+this.model.id+"/admin",function(a){b.model.set({admins:a.admins},{silent:!0});b.admin_panel=new duo.GroupAdminView({model:b.model,data:a,
el:b.$("#admin-panel")});b.admin_panel.render();b.$("#admin").show()})}},showDiscussionPanel:function(){if(this.discussion_panel)this.$("#discussion-container").replaceWith(this.discussion_panel.el),this.discussion_panel.delegateEvents(),this.discussion_panel.render(),this.$("#discussion").show();else{duo.topbar.bind("navigate",this.cleanup,this);var b=this,a=new duo.Topic({id:1});a.fetch({data:{ui_language:duo.user?void 0:duo.browser_language},success:function(){b.discussion_panel=new duo.GroupTopicView({model:a,
el:b.$("#group-discussion")});b.discussion_panel.render();b.discussion_panel.changeSort("hot");b.$("#discussion").show()}})}},showTree:function(){if(!this.tree_panel||!this.$(".tree-container").length){var b=new duo.GroupTree({id:this.model.id,learning_language:duo.user.get("learning_language"),member_progress:this.model.get("members")}),a=this;b.fetch({data:{learning_language:duo.user.get("learning_language")},success:function(c){a.tree_panel=new duo.GroupTreeView({model:b,el:a.$("#trees")});a.tree_panel.render();
a.$("#trees").show()}})}else this.$("#trees").show()},invitePlayers:function(){if(!this.invite_modal||this.$("#invite-more").is(":empty"))this.invite_modal=new duo.GroupInviteView({invite_more:!0,el:this.$("#invite-more"),model:this.model,group_view:this}),this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});this.$("#invite-more").modal("show")},cleanup:function(){duo.topbar.unbind("navigate",this.cleanUp,this);$(document).unbind(".topic_scroll")}});
duo.GroupTreeView=Backbone.View.extend({template:duo.templates["group-tree"],events:{"change .direction-dropdown":"changeTreeDirection","click .more":"showMoreMembers"},initialize:function(){},render:function(){$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{}),duo.templates));this.$('.direction-dropdown option[data-direction="'+this.model.get("learning_language_abbrev")+'"]').attr("selected","selected");this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1});return this},
changeTreeDirection:function(b){b=$(b.currentTarget).find(":selected");var a=this;this.model.fetch({data:{learning_language:b.data("direction")},success:function(){a.render()}})},showMoreMembers:function(b){b=$(b.currentTarget).data("row");this.$(".more-users-"+b).modal("show")}});
duo.GroupAdminView=Backbone.View.extend({template:duo.templates["group-admin"],events:{"click .remove-user":"kickMember","click .promote-user":"promoteUsertoOwner","click .submit":"submit","click .change-banner":"showModal","click .deactivate":"deactivateGroup","click .reactivate":"reactivateGroup","keyup input":"enableSave","focus #group_name":"hideErrors","click .custom-daily-goal-input":"chooseCustom",'click input[name="join_policy"]':"changeJoinPolicy",'click input[name="visibility"]':"changeVisibility"},
initialize:function(){this.model.bind("change",this.render,this)},render:function(b){this.model.get("admins")&&this.model.get("admins").sort(function(a,b){return a.seniority>b.seniority});_.each(this.model.get("admins"),function(a){a.is_row_owner="owner"==a.role});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{}),duo.templates));var a=this;this.$(".settings-pane input").change(function(b){a.$(".submit").removeAttr("disabled")});this.$(".settings-pane textarea").bind("input propertychange",
function(b){a.$(".submit").removeAttr("disabled")});b=this.$('input[name="daily-goal"][data-goal="'+this.model.get("daily_goal")+'"]');0<b.length?(b.attr("checked","checked"),this.$("#daily_goal").val("50")):this.$('input[name="daily-goal"][data-goal="custom"]').attr("checked","checked");return this},enableSave:function(){this.$(".submit").removeAttr("disabled")},kickMember:function(b){b=$(b.currentTarget).closest("tr").data("userid");this.model.removeMember(b)},promoteUsertoOwner:function(b){var a=
this;duo.modalAlert({type:"confirm",message_type:"promote_warning",callback:function(){var c=$(b.currentTarget).closest("tr").data("userid");a.model.promoteUsertoOwner(c)}})},hideErrors:function(){this.$(".groups-error-flag").fadeOut()},chooseCustom:function(){this.$('input[name="daily-goal"]').attr("checked",!0)},submit:function(){var b={},a=this.$("#group_name").val();if(a!=this.model.get("name")){var c=this;$.post("/api/1/groups/check_group_name",{group_name:a,existing_group_id:this.model.id},
function(d){d.error?"name_collision"==d.error?c.$(".name-taken").fadeIn():"too_long"==d.error?c.$(".too-long").fadeIn():c.$(".name-invalid").fadeIn():(b.name=a,c.checkOtherChanges(b))})}else this.checkOtherChanges(b)},checkOtherChanges:function(b){this.$("#group_color").val()!=this.model.get("color")&&(b.color=this.$("#group_color").val());this.$("#icon_index").val()!=this.model.get("icon_index")&&(b.icon_index=parseInt(this.$("#icon_index").val()));this.$("#location").val()!=this.model.get("location")&&
(b.location=this.$("#location").val());this.$("#invites").is(":checked")!=this.model.get("users_can_invite")&&(b.users_can_invite=this.$("#invites").is(":checked"));this.$("#group_description").val()!=this.model.get("description")&&(b.description=this.$("#group_description").val());var a=this.$('input[name="visibility"]:checked').data("is-visible");a!=this.model.get("is_visible")&&(b.is_visible=a);a=this.$('input[name="join_policy"]:checked').data("is-open");a!=this.model.get("is_open")&&(b.is_open=
a);a=this.$('input[name="daily-goal"]:checked').data("goal");a="custom"==a?this.$("#daily_goal").val():a;a!=this.model.get("daily_goal")&&(b.daily_goal=a);$.isEmptyObject(b)||this.model.save(b,{wait:!0})},showModal:function(){var b=this;this.banner_modal=new duo.GroupInviteView({banner_only:!0,el:this.$("#change-banner"),model:this.model});this.$(".modal").modal({keyboard:!0,backdrop:!0,show:!1}).on("hidden",function(){var a=$(".color-option.active").data("color"),c=$("#icon-selector > li.active").data("index");
(a!=b.model.get("color")||c!=b.model.get("icon_index"))&&b.$(".settings-pane input").trigger("change");b.$("#group_color").val(a);b.$("#banner-preview").removeClass().addClass("group-color-"+a);b.$("#icon_index").val(c);b.$("#banner-icon-preview").removeClass().addClass("group-avatar-icon small group-avatar-icon-"+c)});this.$("#change-banner").modal("show")},deactivateGroup:function(){this.model.deactivate()},reactivateGroup:function(){this.model.reactivate()},changeJoinPolicy:function(){var b=this.$('input[name="join_policy"]:checked').data("is-open"),
a=this.$('input[name="visibility"][data-is-visible="false"]');!0==b?(this.$('input[name="visibility"][data-is-visible="true"]').attr("checked","checked"),a.attr("disabled","disabled"),a.closest("label").addClass("disabled")):(a.removeAttr("disabled"),a.closest("label").removeClass("disabled"));return!0},changeVisibility:function(){var b=this.$('input[name="visibility"]:checked').data("is-visible"),a=this.$('input[name="join_policy"][data-is-open="true"]');!1==b?(this.$('input[name="join_policy"][data-is-open="false"]').attr("checked",
"checked"),a.attr("disabled","disabled"),a.closest("label").addClass("disabled")):(a.removeAttr("disabled"),a.closest("label").removeClass("disabled"));return!0}});
(function(b){duo.ProgressSplashView=Backbone.View.extend({id:"app",events:{"click #signup-link":"showSignupModal"},template:duo.templates["progress-splash"],render:function(){this.$el.html(b.duostache(this.template,{},duo.templates));this.signup_view=new duo.SplashRegisterView({el:this.$(".signup"),splash_skip_delayed:!0,hide_language_select:!0,google_only:!0});this.signup_view.render();duo.user&&duo.user.get("trial_account")&&this.showSignupModal();return this},showSignupModal:function(){this.$("#signup-modal").modal("show");
this.$(".user-login").show()}});duo.ProgressLoggedOutTopbarView=duo.LoginTopbarView.extend({template:duo.templates["progress-logged-out-menu"],render:function(){var a={ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages};this.model&&_.extend(a,this.model.toJSON());this.$el.html(b.duostache(this.template,a));var c=this;_.defer(function(){c.$("label").inFieldLabels({periodic:!0})});return this}});duo.ProgressTopbarView=Backbone.View.extend({id:"topbar",events:{"click #create-new-section":"showInvitationModal"},
template:duo.templates["progress-menu"],initialize:function(){this.model.bind("change",this.removeInviteButton,this)},render:function(){this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),{observee_limit:this.model.get("num_observees")>=duo.feature_flags.observee_limit}),duo.templates));this.$("#global-loading-indicator").ajaxStart(function(){b(this).show()}).ajaxStop(function(){b(this).hide()});return this},removeInviteButton:function(){this.$("#create-new-section").addClass("hidden")},
showInvitationModal:function(){var a=new duo.MagicLinkModalView({email:duo.user.get("email")});this.$el.append(a.render().el)}});duo.ProgressDashboardView=Backbone.View.extend({id:"app",events:{"click #send-invitation":"sendInvitationModal","click #create-new-section":"sendInvitationModal","change #tag-selector":"changeTagOrWeek","change #week-selector":"changeTagOrWeek","click .remove-button":"removeObserver","click #show-link":"showShare","click .update-section":"updateSection","click .save-edit":"saveSectionUpdate",
"keydown #section-editor":"saveSectionKey","keyup #section-editor":"inputChange","change #section-editor":"inputChange","click .cancel-edit":"cancelSectionUpdate"},template:duo.templates["progress-dashboard"],initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.$("#tag-selector").val(this.model.get("tag"));this.$("#week-selector").val(this.model.get("week"));_.defer(function(){ZeroClipboard.config({swfPath:"https://www.duolingo.com/swf/ZeroClipboard.swf"});
(new ZeroClipboard(b("#copy-link"))).on("aftercopy",function(a){b("#copy-link").slideDown(function(){b("#magic-link").css("background-color","#def0a5");b("#magic-link").animate({"background-color":"#fff"},500);b(".link-area .tooltip").show().delay(2E3).fadeOut(500)})})});duo.progressRouter.fixFooterLinks();return this},showShare:function(){var a=b.trim(this.$("#section").val()),c="https://www.duolingo.com/o$o="+self.$("#observer-email").val();a?(c+="&s="+encodeURIComponent(a),this.$("#section-name").text(a),
this.$(".share-header-section").fadeIn(1E3),this.$(".share-header").hide()):(this.$(".share-header-section").hide(),this.$(".share-header").fadeIn(1E3));this.$(".section-header").hide();this.$("#magic-link").val(c);this.$(".section-area").hide();this.$(".share-area").fadeIn(1E3)},sendInvitationModal:function(){this.$(".share-area").hide();this.$(".section-area").show();this.$("#section").val("");this.$(".share-header-section").hide();this.$(".section-header").show();this.$("#invite-students").modal("show")},
changeTagOrWeek:function(){this.model.fetch({data:b.param({tag:this.$("#tag-selector").val(),week:this.$("#week-selector").val()})})},removeObserver:function(a){var c=this,d=b(a.target).data("id");duo.modalAlert({type:"custom_type",custom_title:!0,message_type:"untrack_student",okay_text:translate_text("Stop tracking"),cancel_text:translate_text("Cancel"),student_email:b(a.target).data("email"),callback:function(){b.post("/api/1/observers/remove_observee",{observee_id:d},function(){c.changeTagOrWeek()})}})},
updateSection:function(a){a=b(a.target).closest(".student-info");a.find("#static-section, #editable-section").toggleClass("hidden");a.find("#section-editor").focus();a.find(".save-edit").addClass("disabled")},saveSectionUpdate:function(a){var c=this,d=b(a.target).closest(".student-info"),f=b.trim(d.find("#section-editor").val()),g=b.trim(d.find("#section-display-name").text());a=d.data("id");b.post("/api/1/observers/change_tag",{observee_id:a,tag:f},function(){d.find("#section-display-name").text(f);
d.find("#static-section, #editable-section").toggleClass("hidden");(""===g||""===f)&&g!=f&&d.find("#update-existing-section, #add-section").toggleClass("hidden");c.changeTagOrWeek()})},cancelSectionUpdate:function(a){a=b(a.target).closest(".student-info");a.find("#static-section, #editable-section").toggleClass("hidden");var c=b.trim(a.find("#section-display-name").text());a.find("#section-editor").val(c)},saveSectionKey:function(a){13===a.which&&b(a.target).closest(".student-info").find(".save-edit").click()},
inputChange:function(a){b(a.target).closest(".student-info").find(".save-edit").removeClass("disabled")}});duo.NewProgressDashboardView=duo.ProgressDashboardView.extend({id:"app",template:duo.templates["progress-dashboard-v2"],SPINNER_THRESHOLD:25,events:function(){return _.extend({},duo.ProgressDashboardView.prototype.events,{"change #language-selector":"changeTagOrWeek","click .bulk-remove":"bulkRemove","click .edit":"showBulkEdit","click #send-invitation":"showInvitationModal","click .switch-lenses":"switchLenses",
"click .trigger-modal":"getStudentDetails"})},initialize:function(){this.students=this.model.students;this.students.bind("remove",this.removeStudents,this);this.classroom=this.model;this.classroom.get("most_common")&&this.classroom.filterClassroom(this.classroom.get("most_common"),"all");this.classroom.bind("change:all_sections",this.render,this);this.classroom.bind("change:relevant_students",this.render,this);this.classroom.bind("change:relevant_trees",this.render,this);this.classroom.bind("change:tree_view",
this.render,this);this.classroom.bind("filter",this.render,this);this.classroom.bind("check_boxes",this.onCheck,this);this.all_languages=_.map(this.classroom.get("learning_languages_dict"),function(a,b){return{language_abbrev:b,language_name:a}})},onCheck:function(){var a=this.$("input:checkbox:checked").length;this.$(".bulk-actions").toggleClass("hidden",!a);this.$(".tab-switch").toggleClass("hidden",0<a)},render:function(){var a=this,b=this.classroom.get("has_students")?this.classroom.get("relevant_students").length:
0;this.classroom.get("tree_view")&&b>this.SPINNER_THRESHOLD?(this.makeSpinner(),_.delay(function(){a.renderCallback()},0.1*b)):this.renderCallback();return this},renderCallback:function(){var a=this.classroom.get("section"),c=this.classroom.get("relevant_students"),d=_.map(c,function(a){return a.get("user_id")}),c=this.students.length,d=_.uniq(d).length;this.$el.html(b.duostache(this.template,_.extend(this.classroom.toJSON(),{all_languages:this.all_languages,num_students:d,has_students:c,time_tracking_true:duo.feature_flags.time_tracking,
section_selected:a&&"all"!=a}),duo.templates));this.$("#tag-selector").val(a);this.$("#week-selector").val(this.classroom.get("week"));this.$("#language-selector").val(this.classroom.get("learning_language"));d&&(this.classroom.get("tree_view")?(this.tree_view||(this.tree_view=new duo.TreeProgressView({model:this.classroom})),this.tree_view.setElement(this.$("#dashboard-v3-wrapper")),this.tree_view.render()):(this.table_view||(this.table_view=new duo.ProgressTableView({model:this.classroom,num_students:d})),
this.table_view.setElement(this.$("#dashboard-v2-wrapper")),this.table_view.render()));duo.progressRouter.fixFooterLinks();this.stopSpinner();return this},makeSpinner:function(){if(!this.spinner){var a=document.getElementById("spinner-container");this.spinner=(new Spinner({lines:9,length:6,width:5,radius:11,corners:1,rotate:0,direction:1,color:"#999999",speed:1.5,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2E9,top:"50%",left:"50%"})).spin(a)}b("#spinner-container").show()},stopSpinner:function(){this.spinner&&
b("#spinner-container").hide()},changeTagOrWeek:function(){var a=this.$("#week-selector").val();if(a&&this.classroom.get("week")!=a)this.localized_week_string=b("#week-selector option:selected").data("string"),this.classroom.set({week:a},{silent:!0}),this.classroom.getWeeklySummaries(a),this.$(".table-header").removeClass("sorttable_sorted");else{var a=this.$("#language-selector").val(),c=this.$("#tag-selector").val();this.classroom.filterClassroom(a,c)}},removeStudents:function(){this.classroom.set({relevant_students:_.intersection(this.classroom.get("relevant_students"),
this.students.models)},{silent:!0});this.render()},showBulkEdit:function(){var a=[];this.$(".student-checkbox:checked").map(function(){a.push(b(this).val())});var a=_.uniq(a),c=new duo.SectionEditModalView({students:a,classroom:this.classroom});this.$el.append(c.render().el)},bulkRemove:function(){var a=this,c=[];this.$(".student-checkbox:checked").map(function(){c.push(b(this).val())});c=_.uniq(c);duo.modalAlert({type:"custom_type",message_type:"bulk_untrack_students",okay_text:translate_text("Stop tracking"),
cancel_text:translate_text("Cancel"),callback:function(){a.model.students.removeObservees(c)}})},showInvitationModal:function(){var a=new duo.MagicLinkModalView({email:this.classroom.get("email")});this.$el.append(a.render().el)},showStudentModal:function(a){a=new duo.StudentModalView({model:a,week:this.classroom.get("week"),localized_week_string:this.localized_week_string});this.$el.append(a.render().el)},switchLenses:function(a){a=b(a.target).closest(".switch-lenses").hasClass("v3");this.$(".switch-lenses .v3").toggleClass("active",
a);this.$(".switch-lenses .v2").toggleClass("active",!a);a&&"all"==this.classroom.get("learning_language")?(this.classroom.set({tree_view:!0},{silent:!0}),this.classroom.filterClassroom(this.classroom.get("most_common"),this.classroom.get("section"))):this.classroom.set({tree_view:a});duo.user.get("prefers_v2")==a&&duo.user.updatePreferredDashboardVersion(!a)},getStudentDetails:function(a){var c=this;a=b(a.target).closest(".student-row").data("id");var d=this.students.get(a);(a=d.get("events"))||
!d.get("summary").total_lessons?this.showStudentModal(d):(a=new duo.ProcessedEventList([],{}),a.fetch({data:{student_id:d.get("user_id"),ui_language:duo.user.get("ui_language"),learning_language:d.get("learning_language"),from_language:d.get("from_language"),week:this.classroom.get("week")},success:function(a){d.set_events(a);c.showStudentModal(d)}}))}});duo.StudentModalView=Backbone.View.extend({template:duo.templates["progress-student-modal"],events:{"click .single-remove":"removeSingleStudent"},
render:function(){var a=this.model.get("events");this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),{has_events:void 0!==a,events:a?a.toJSON():a,localized_week_string:this.options.localized_week_string}),duo.templates));this.$(".modal").modal("show").on("hidden.bs.modal",_.bind(this.onHidden,this));return this},onRoute:function(){this.$(".modal").modal("hide")},onHidden:function(){this.remove()},removeSingleStudent:function(a){a=[this.model.get("user_id").toString()];this.model.collection.removeObservees(a,
function(){self.$(".modal").modal("hide")})}});duo.NotificationModalView=Backbone.View.extend({template:duo.templates["progress-notification-modal"],render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.$(".modal").modal("show").on("hidden.bs.modal",_.bind(this.onHidden,this));return this},onRoute:function(){this.$(".modal").modal("hide")},onHidden:function(){duo.user.dismissNotification("dashboard_v3");this.model.set({needs_notification:!1},{silent:!0})}});
duo.SectionEditModalView=Backbone.View.extend({template:duo.templates["section-edit-modal"],events:{"click #save-bulk-edit":"onBulkEdit","keydown #section-editor":"saveSectionKey"},initialize:function(){this.students=this.options.students;this.classroom=this.options.classroom},render:function(){this.$el.html(b.duostache(this.template,{}),duo.templates);this.$(".modal").modal("show").on("hidden.bs.modal",_.bind(this.onHidden,this));return this},onRoute:function(){this.$(".modal").modal("hide")},onHidden:function(){this.remove()},
saveSectionKey:function(a){if(13===a.which)this.onBulkEdit()},onBulkEdit:function(){var a=this,c=b.trim(this.$("#section-editor").val());this.classroom.bulkEditSection(this.students,c,function(){a.$(".modal").modal("hide")})}});duo.MagicLinkModalView=Backbone.View.extend({template:duo.templates["progress-magic-link-modal"],events:{"click #show-link":"showShare"},render:function(){this.$el.html(b.duostache(this.template,{email:this.options.email}),duo.templates);this.$(".modal").modal("show").on("hidden.bs.modal",
_.bind(this.onHidden,this));this.$(".share-area").hide();this.$(".section-area").show();this.$("#section").val("");this.$(".share-header-section").hide();this.$(".section-header").show();_.defer(function(){ZeroClipboard.config({swfPath:"https://www.duolingo.com/swf/ZeroClipboard.swf"});(new ZeroClipboard(b("#copy-link"))).on("aftercopy",function(a){b("#copy-link").slideDown(function(){b("#magic-link").css("background-color","#def0a5");b("#magic-link").animate({"background-color":"#fff"},500);b(".link-area .tooltip").show().delay(2E3).fadeOut(500)})})});
return this},onRoute:function(){this.$(".modal").modal("hide")},onHidden:function(){this.remove()},showShare:function(){var a=b.trim(this.$("#section").val()),c="https://www.duolingo.com/o$o="+self.$("#observer-email").val();a?(c+="&s="+encodeURIComponent(a),this.$("#section-name").text(a),this.$(".share-header-section").fadeIn(1E3),this.$(".share-header").hide()):(this.$(".share-header-section").hide(),this.$(".share-header").fadeIn(1E3));this.$(".section-header").hide();this.$("#magic-link").val(c);
this.$(".section-area").hide();this.$(".share-area").fadeIn(1E3)}});duo.StudentRowView=Backbone.View.extend({template:duo.templates["progress-student-row"],initialize:function(){this.model.bind("change",this.render,this);this.model.bind("uncheck",this.uncheckBoxes,this)},uncheckBoxes:function(){this.$("input:checkbox").prop("checked",!1)},render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON()),duo.templates);return this}});duo.ProgressTableView=Backbone.View.extend({template:duo.templates["progress-table-view"],
events:{'click [type="checkbox"]':"onCheck"},render:function(){var a=this,c=this.model.get("relevant_students"),d=_.pluck(c,"id");this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),{num_students:this.options.num_students,course_students:d}),duo.templates));_.each(c,function(b){var c=a.$('.student-row[data-id="'+b.id+'"]');(new duo.StudentRowView({model:b,el:c})).render()});_.defer(function(){c.length&&sorttable.makeSortable(document.getElementById("dashboard-table"),!0)});return this},
onCheck:function(a){a=b(a.target);"all"==a.val()&&this.$(".student-checkbox").prop("checked",a.prop("checked"));this.model.trigger("check_boxes")}});duo.TreeProgressView=Backbone.View.extend({template:duo.templates["progress-tree-view"],render:function(){var a=this,c=_.pluck(this.model.get("relevant_students"),"id"),d=_.filter(this.model.get("relevant_trees"),function(a){var b=_.intersection(a.get("students"),c);if(0<b.length)return a.relevant_student_ids=b,a.from_language=a.get("from_language"),
a.learning_language=a.get("learning_language"),a}),f=d.length;this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),{tree_representations:d,num_trees:f}),duo.templates));_.each(d,function(b){var c="#tree-"+b.get("learning_language")+"-"+b.get("from_language"),c=a.$(c);(new duo.DirectionTreeView({model:b,relevant_student_ids:b.relevant_student_ids,classroom:a.model,el:c})).render();a.$("#tree-table-"+b.get("learning_language")+"-"+b.get("from_language"))});b(window).scrollTop(0);this.$(".tree-container:first").addClass("fixed");
_.defer(function(){if(a.model.get("needs_notification")){var c=new duo.NotificationModalView({model:a.model});a.$el.append(c.render().el)}1<d.length?a.makeFixedHeaders():b(window).unbind()});return this},makeFixedHeaders:function(){_.each(this.$(".fixed-template"),function(a){a=b(a);a.data("pos",a.offset().top)});b(window).on("scroll",function(){_.each(self.$(".fixed-template"),function(a,c){var d=b(a),f=d.closest(".tree-container"),g=self.$(".fixed-template").eq(c+1),h=self.$(".fixed-template").eq(c-
1),k=d.data("pos"),l=b(window).scrollTop()+144;k<=l?(f.addClass("fixed"),h=g.closest(".scroller").scrollLeft(),g.find(".tree-skill-container").scrollLeft(h),h=g.data("pos"),0<g.length&&d.offset().top>=h-d.outerHeight()&&(f.addClass("absolute"),d.css("top",h-d.outerHeight()-144))):(f.removeClass("fixed"),f=h.closest(".tree-container"),0<h.length&&l<=d.data("pos")-h.outerHeight()&&(f.removeClass("absolute"),h.removeAttr("style")))})})}});duo.DirectionTreeView=Backbone.View.extend({template:duo.templates["progress-tree"],
events:{'click [type="checkbox"]':"onCheck","click .nav-tree":"onNavButtonClick"},ANIMATE_THRESHOLD:25,render:function(){var a=this;this.direction_students=this.options.classroom.students.filter(function(b){return _.contains(a.options.relevant_student_ids,b.id)});this.$el.html(b.duostache(this.template,_.extend(this.model.toJSON(),{students:this.direction_students}),duo.templates));_.each(this.direction_students,function(b){var d=a.$('.student-row[data-id="'+b.id+'"]');(new duo.TreeRowView({model:b,
el:d})).render()});this.$("#nav-prev").addClass("disabled");_.defer(function(){a.rightmost=a.$(".scroller, .tree-skill-container")[0].scrollWidth-a.$(".scroller, .tree-skill-container")[0].offsetWidth;var b=_.map(a.direction_students,function(a){return a.get("tree_depth")}),b=a.model.findMedian(b),d=Math.floor(a.model.NUM_VISIBLE_SKILLS/2);b>d&&(a.scroll_left=40*(b-d),a.$(".scroller, .tree-skill-container").scrollLeft(a.scroll_left),a.$("#nav-prev").removeClass("disabled"))});return this},onNavButtonClick:function(a){a=
b(a.target).hasClass("previous");this.horizontalScroll(a)},horizontalScroll:function(a){var b=this,d=a?-160:160;if(this.direction_students.length>this.ANIMATE_THRESHOLD){var f=this.$(".scroller, .tree-skill-container").scrollLeft();this.$(".scroller, .tree-skill-container").scrollLeft(f+d);this.manageScrollButtons(a)}else d=a?"-=160px":"+=160px",this.$(".scroller, .tree-skill-container").animate({scrollLeft:d},function(){b.manageScrollButtons(a)})},manageScrollButtons:function(a){this.scroll_left=
this.$(".scroller, .tree-skill-container").scrollLeft();a?(this.$("#nav-next").removeClass("disabled"),0===this.scroll_left&&this.$("#nav-prev").addClass("disabled")):(this.$("#nav-prev").removeClass("disabled"),this.scroll_left==this.rightmost&&this.$("#nav-next").addClass("disabled"))},onCheck:function(a){a=b(a.target);"all"==a.val()&&this.$(".student-checkbox").prop("checked",a.prop("checked"));this.options.classroom.trigger("check_boxes")}});duo.TreeRowView=duo.StudentRowView.extend({template:duo.templates["progress-tree-row"],
render:function(){var a=this;this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));_.defer(function(){a.$(".overlay-progress").pie({only_colors:["#eeeeee","#ffffff"],proportion:1.01});a.$(".overlay-progress path").css({opacity:1});a.$(".overlay-progress circle").css({opacity:0});a.$('.overlay-progress path[fill="#999999"]').css({opacity:1});a.$('.overlay-progress path[fill="#ffffff"]').css({opacity:0})});return this}})})(window.jQuery);
(function(b){duo.SchoolsSplashView=Backbone.View.extend({id:"app",events:{"click #video-toggle":"showVideo"},template:duo.templates["schools-splash"],render:function(){this.$el.html(b.duostache(this.template,{},duo.templates));this.$(".carousel").carousel();return this},showVideo:function(){duo.showIntroVideo(duo.user?duo.user.get("ui_language"):duo.browser_language)}});duo.SchoolsInstructionsView=Backbone.View.extend({id:"app",events:{},template:duo.templates["schools-instructions"],render:function(){this.$el.html(b.duostache(this.template,
{},duo.templates));return this}});duo.SchoolsLoggedOutTopbarView=duo.LoginTopbarView.extend({template:duo.templates["schools-logged-out-menu"],render:function(){var a={ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages};this.model&&_.extend(a,this.model.toJSON());this.$el.html(b.duostache(this.template,a));var c=this;_.defer(function(){c.$("label").inFieldLabels({periodic:!0})});return this}})})(window.jQuery);
(function(b){duo.SelfServiceSplashView=Backbone.View.extend({id:"app",events:{"change #available-languages select":"showAvailableLanguages","click .welcome button":"openRequestForm","click .bottom button":"scrollTop","click .request-form button":"requestInvite","change .request-form td *":"checkFields","keyup .request-form td *":"checkFields"},template:duo.templates["self-service-splash"],render:function(){this.$el.html(b.duostache(this.template,{},duo.templates));this.request_button_text=this.$(".welcome button").html();
return this},showAvailableLanguages:function(){var a=this.$("#available-languages option:selected").val();this.$("#available-languages table").hide();this.$("#available-languages .available-"+a).show()},openRequestForm:function(){var a=this;this.checkFields();this.$(".welcome").fadeOut(function(){a.$(".request-form").fadeIn();a.$(".request-form input").eq(0).focus()})},scrollTop:function(){this.openRequestForm();b("html, body").animate({scrollTop:0},"slow")},checkFields:function(){var a=!0;this.$(".request-form input, .request-form textarea").each(function(){if(!b.trim(b(this).val()))return a=
!1});a?this.$(".request-form button").removeAttr("disabled"):this.$(".request-form button").attr("disabled","disabled")},requestInvite:function(){var a=JSON.stringify({company:this.$("#request-company").val(),email:this.$("#request-email").val(),sample:this.$("#request-sample").val(),description:this.$("#request-description").val()}),c=this.$(".request-form button");c.html(c.data("wait"));c.attr("disabled","disabled");var d=this;b.post("/translate_jobs/request_invite",{data:a}).done(function(){d.$(".request-form").fadeOut(function(){d.$("#thankyou").fadeIn()})}).fail(function(){c.html(c.data("fail"));
c.removeAttr("disabled")})}});duo.SelfServiceLoggedOutTopbarView=duo.LoginTopbarView.extend({template:duo.templates["self-service-logged-out-menu"],render:function(){var a={ui_language_name:duo.ui_language_name,ui_languages_list:duo.ui_languages};this.model&&_.extend(a,this.model.toJSON());this.$el.html(b.duostache(this.template,a));var c=this;_.defer(function(){c.$("label").inFieldLabels({periodic:!0})});return this}});duo.SelfServiceTopbarView=Backbone.View.extend({id:"topbar",events:{},template:duo.templates["self-service-menu"],
render:function(){this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.$("#global-loading-indicator").ajaxStart(function(){b(this).show()}).ajaxStop(function(){b(this).hide()});return this}});duo.SelfServiceView=duo.View.extend({id:"app",template:duo.templates["self-service"],events:{'click .translate-main .tabs li[data-tab="uploaded"]':"clickTab","change input[type=checkbox]":"changeFiltering","change .tabs select":"changeMonth","click #upload-document":"uploadDocument"},
initialize:function(){this.listenTo(this.model,"change",this.render);Backbone.history.once("route",this.close,this)},render:function(){this.closeChildViews();this.$el.html(b.duostache(this.template,this.model.toJSON(),duo.templates));this.uploaded_translations=new duo.SelfServiceTranslationsView({el:this.$("#uploaded-tab"),collection:this.model.get("uploaded_translations"),category_label:this.model.get("category_label"),uploaded:!0,parent_view:this});this.addChildView(this.uploaded_translations);
this.monthly_translations=new duo.SelfServiceTranslationsView({el:this.$("#monthly-tab"),collection:this.model.get("monthly_translations"),category_label:this.model.get("category_label"),uploaded:!0,parent_view:this});this.addChildView(this.monthly_translations);var a=(new Date).getFullYear(),c=(new Date).getMonth()+1,d=this.model.get("first_year"),f=this.model.get("first_month")-1;1>f&&(f+=12,d-=1);for(;d!==a||f!==c;)this.$(".tabs select").append('<option value="'+a+"-"+c+'">'+c+" / "+a+"</option>"),
c-=1,1>c&&(c=12,a-=1);return this},clickTab:function(a){a=b(a.currentTarget);this.switchTab(a)},changeMonth:function(a){"none"!==a.currentTarget.value&&(this.switchTab(b('li[data-tab="monthly"]')),this.$('li option[value="none"]').hide())},switchTab:function(a){var b=a.data("tab");"monthly"!==b&&this.$("li select").val("none");var d=this.$("#"+b+"-tab");this.$(".panel").hide();d.show();this.$(".translate-main .tabs li").removeClass("active");a.addClass("active");a=b+"_translations";d=this.getFilterOptions();
d.none_selected?this.model.get(b+"_translations").reset([]):(this.setEmptyMessage(),"monthly"===b&&(d.year=parseInt(this.$("li select").val().split("-")[0],10),d.month=parseInt(this.$("li select").val().split("-")[1],10)),this.model.get(a).fetch({data:d}))},getFilterOptions:function(){var a=[],c=this.model.get("filters")[0].options,d=!1;0<b("#progress_pending:checked").length&&(a.push(c[0].id),a.push(c[1].id),d=!0);0<b("#progress_finished:checked").length&&(a.push(c[2].id),d=!0);if(!d)return{none_selected:"true"};
a={document_types:a.join("|")};"monthly"===this.$("#translation-tabs li.active").data("tab")&&(a.year=parseInt(this.$("li select").val().split("-")[0],10),a.month=parseInt(this.$("li select").val().split("-")[1],10));return a},changeFiltering:function(){var a=this.getFilterOptions();a.none_selected||(a.per_page=10,this.setEmptyMessage(),this.model.get(this.$("#translation-tabs li.active").data("tab")+"_translations").fetch({data:a}))},setEmptyMessage:function(){this.uploaded_translations.all_shown=
0<b("#progress_pending:checked").length&&0<b("#progress_finished:checked").length},uploadDocument:function(){duo.selfServiceRouter.navigate("/upload",!0)}});duo.SelfServiceTranslationsView=duo.RankedTranslationsView.extend({addOne:function(a){a=new duo.SelfServiceTranslationView({model:a});this.addChildView(a);this.$(".ranked-translations").append(a.render().el)}});duo.SelfServiceTranslationView=duo.View.extend({tagName:"li",className:"list-document-item",template:duo.templates["self-service-item"],
events:{"click .list-document-item-right a":"downloadTranslation"},initialize:function(a){this.listenTo(this.model,"change",this.render);this.draft=a.draft},render:function(){this.closeChildViews();var a=_.extend(this.model.toJSON(),{draft:this.draft});100===a.percent_high_quality&&(a.finished=!0);this.$el.html(b.duostache(this.template,a,duo.templates));return this},downloadTranslation:function(a){location.href="/translate_jobs/"+b(a.currentTarget).data("job")+"/export?trusted"}});duo.SelfServiceUploadView=
Backbone.View.extend({id:"app",template:duo.templates["self-service-upload"],events:{"click .step-tab":"changeStep","click .paste-submit":"pasteSubmitToPreview","click .url-submit":"urlSubmitToPreview","click .edit-preview":"editPreview","click .cancel-preview":"cancelPreview","click #continue-preview":"submitToPay","click #stripe-button":"clickStripe"},initialize:function(){this.currentPage="input";duo.user.set({word_price:4});b.get("/translate_jobs/get_word_price",function(a){duo.user.set({word_price:a.word_price})})},
render:function(){3783191===duo.user.id&&this.model.set({can_prioritize:!0,charged_monthly:!0});var a=this.model.toJSON();a.input_enabled="pay"==this.currentPage;this.$el.html(b.duostache(this.template,a,duo.templates));this.input_view=new duo.SelfServiceInputView({model:this.model,el:this.$("#self-service-input-step")});this.input_view.render();this.preview_view=new duo.SelfServicePreviewView({model:this.model,el:this.$("#self-service-prev-step")});this.pay_view=new duo.SelfServicePayView({model:this.model,
el:this.$("#self-service-pay-step")});return this},switchTo:function(a,b){this.$("#self-service-"+a+"-step").hide();this.$("#self-service-"+b+"-step").show();this.$("."+a+"-step").removeClass("active");this.$("."+b+"-step").addClass("active").removeClass("inactive");this.currentPage=b},changeStep:function(a){!b(a.currentTarget).hasClass("inactive")&&!b(a.currentTarget).hasClass("active")&&this.switchTo(this.currentPage,b(a.currentTarget).prop("id"))},countWords:function(){var a=0,c=b.trim(this.$("#article-headline").val()+
" "+this.$("#article-body").val());c&&(a=c.split(/\s+/g).length);c=(0.01*a*duo.user.get("word_price")).toFixed(2);this.$("#word-count").html(b.duostache("{{count}}",{count:a}));this.$("#cost").html(b.duostache("{{cost}}",{cost:c}));this.model.set({words:a,cost:c})},editPreview:function(){this.switchTo(this.currentPage,"input");this.input_view.changeType("paste")},cancelPreview:function(){this.switchTo(this.currentPage,"input")},fileSubmitToPreview:function(){},pasteSubmitToPreview:function(){if(b("#prev").hasClass("inactive")){var a=
b.trim(this.$("#article-body").val()),c=b.trim(this.$("#article-headline").val()),d=this.$("#image-url").val(),f=this.$("#document-url").val(),g=b("#continue-input").html(),h=this;this.$("#continue-input").html(b("#continue-input").data("wait"));this.$("#continue-input").attr("disabled","disabled");b.when(b.post("/translate_jobs/manual_preview",{text:a,title:c,user_id:duo.user.id}),b.post("/translate_jobs/manual_parse",{text:a,title:c})).always(function(){h.$("#continue-input").html(g);h.$("#continue-input").removeAttr("disabled")}).done(function(a,
b){h.stripe_customer=a[0].stripe_customer;h.stripe_publishable_key=a[0].stripe_publishable_key;h.countWords();25<=h.model.get("words")?(h.model.set(a[0]),h.model.set(b[0]),h.model.set({custom_html:null,image_url:d,document_url:f}),h.preview_view.data_source="text",h.preview_view.render(),h.switchTo("input","prev")):h.$("#input-errors").html(translate_text("Document contains too few words.")).show()}).fail(function(){h.$("#input-errors").html("Unable to parse text.").show()})}else this.switchTo("input",
"prev")},urlSubmitToPreview:function(){if(b("#prev").hasClass("inactive")){var a=b.trim(this.$("#url").val());if(""===a)return!1;var c=b("#continue-input").html(),d=this;this.$("#continue-input").html(b("#continue-input").data("wait"));this.$("#continue-input").attr("disabled","disabled");var f=translate_text("This web address is invalid or the page could not be loaded.");b.post("/translate_jobs/preview",{url:a,user_id:duo.user.id}).always(function(){d.$("#continue-input").html(c);d.$("#continue-input").removeAttr("disabled")}).done(function(b){b.success?
(d.stripe_customer=b.stripe_customer,d.stripe_publishable_key=b.stripe_publishable_key,d.$("#article-body").val(b.text),d.$("#article-headline").val(b.title),d.$("#image-url").val(b.image_url),d.$("#document-url").val(b.document_url),d.$("#continue-input").html(c),d.$("#continue-input").removeAttr("disabled"),d.model.set(b),d.countWords(),25<=d.model.get("words")?(duo.track("preview_document",{document_url:a}),d.preview_view.data_source="url",d.preview_view.render(),d.model.get("text")?d.$("#edit").show():
d.$("#edit").hide(),d.switchTo("input","prev")):d.$("#input-errors").html("Document contains too few words.").show()):d.$("#input-errors").html(f).show()}).fail(function(){d.$("#input-errors").html(f).show()})}else this.switchTo("input","prev")},submitToPay:function(){this.model.set({category:this.$("#category option:selected").text(),target_language:this.$("#language option:selected").text()});this.pay_view.render();b("#confirm-cost").html(b.duostache("{{cost}}",{cost:this.model.get("cost")}));b("#confirm-words").html(b.duostache("{{words}}",
{words:this.model.get("words")}));b("#confirm-headline").text(this.model.get("title"));b("#confirm-category").text(this.model.get("category"));b("#confirm-language").text(this.model.get("target_language"));if(null!==this.stripe_customer){var a=this.stripe_customer.cards.data;5<=a.length&&this.$("#cards option").remove();for(var c=0;c<a.length;++c)this.$("#cards").prepend('<option value="'+a[c].id+'">'+a[c].type+" ****"+a[c].last4+" (Exp. "+a[c].exp_month+"/"+a[c].exp_year+")</option>");b("#cards").val(this.stripe_customer.default_card)}this.pay_view.toggleCardFields();
this.switchTo("prev","pay")},clickStripe:function(){Stripe.setPublishableKey(this.stripe_publishable_key);var a=this.$("#stripe-button").html();this.$("#payment-errors").hide();b(".input-step, .prev-step").addClass("inactive");this.$("#stripe-button").attr("disabled","disabled").html(b("#stripe-button").data("wait"));if(0<=this.$("#cards").val().indexOf("card_"))this.submitUpload(a,this.$("#cards").val());else{var c=this;Stripe.card.createToken(b("#payment-form"),function(b,f){f.error?c.showUploadError(a,
f.error.message):c.submitUpload(a,f.id)})}},submitUpload:function(a,c){var d={url:this.model.get("document_url"),target_language:this.$("#language").val(),category:this.$("#category").val(),cost:this.model.get("cost"),stripe_object:c};this.model.get("can_prioritize")&&(d.priority=parseInt(this.$("#priority").val(),10));null===this.model.get("custom_html")&&(b.extend(d,{plaintext:this.model.get("text"),title:this.model.get("title"),image_url:this.model.get("image_url"),url:this.model.get("document_url")}),
this.model.image_url&&(d.image_url=this.model.image_url));var f=this,g=new duo.TranslateJob(d);g.save(d,{success:function(c,d){g.get("success")?(duo.track("upload_document",{translation_id:d.translation_id,source_language:d.source_language,target_language:d.target_language}),duo.selfServiceRouter.navigate("",!0)):g.get("translation_id")?f.showUploadError(a,translate_text("This translation job already exists.")):(f.model.set({upload_failed:!0,upload_failure_reason:g.get("failure_reason")}),f.showUploadError(a,
b.duostache("{{#_ivar}}upload_failure_reason{{/_ivar}}",{upload_failure_reason:g.get("failure_reason")})))},error:function(){f.showUploadError(a,translate_text("Upload interrupted."))}})},showUploadError:function(a,b){this.$(".input-step, .prev-step").removeClass("inactive");this.$("#stripe-button").removeAttr("disabled").html(a);this.$("#payment-errors").html(b+" "+translate_text("(You have not been charged.)")).show()}});duo.SelfServiceInputView=duo.SelfServiceUploadView.extend({template:duo.templates["self-service-input"],
events:{"change #input-type":"clickType","keyup #article-headline":"checkInputContinue","change #article-headline":"checkInputContinue","keyup #article-body":"checkInputContinue","change #article-body":"checkInputContinue","keyup #url":"checkInputContinue","change #url":"checkInputContinue"},initialize:function(){},render:function(){var a=this.model.toJSON();this.$el.html(b.duostache(this.template,a,duo.templates));this.changeType("url");return this},clickType:function(a){this.changeType(a.currentTarget.value)},
changeType:function(a){this.currentType=a;this.$("#input-type").val(this.currentType);this.$(".self-service-type-input").hide();this.$("#self-service-"+this.currentType).show();this.$("#continue-input").removeClass("file-submit paste-submit url-submit").addClass(this.currentType+"-submit");this.$(".step-number span:visible").each(function(a){b(this).text(a+1)});this.checkInputContinue()},checkInputContinue:function(){this.$("#input-errors").hide();b(".prev-step").addClass("inactive");b(".pay-step").addClass("inactive");
this.countWords();if("file"!==this.currentType)if("paste"===this.currentType){if(this.$("#article-headline").val()&&this.$("#article-body").val()){this.$("#continue-input").removeAttr("disabled");return}}else if("url"===this.currentType&&this.$("#url").val()){this.$("#continue-input").removeAttr("disabled");return}this.$("#continue-input").attr("disabled","disabled")}});duo.SelfServicePreviewView=duo.SelfServiceUploadView.extend({template:duo.templates["self-service-preview"],events:{"change select":"checkPreviewContinue"},
initialize:function(){},render:function(){var a=this.model.toJSON();this.$el.html(b.duostache(this.template,a,duo.templates));var c=a.language;c&&b("option[value="+c+"]").attr("selected","selected");(a=a.category)&&b('option[value="'+a+'"]').attr("selected","selected");this.checkPreviewContinue();return this},checkPreviewContinue:function(){"None"!==this.$("#category").val()&&"None"!==this.$("#language").val()?this.$("#continue-preview").removeAttr("disabled"):this.$("#continue-preview").attr("disabled",
"disabled")}});duo.SelfServicePayView=duo.SelfServiceUploadView.extend({template:duo.templates["self-service-pay"],events:{"keyup input":"checkPayButton","change input":"checkPayButton","change #cards":"toggleCardFields"},initialize:function(){},render:function(){var a=this.model.toJSON();this.$el.html(b.duostache(this.template,a,duo.templates));this.$("#card-number").payment("formatCardNumber");this.$("#card-expiry").payment("formatCardExpiry");this.$("#card-cvc").payment("formatCardCVC");this.checkPayButton();
return this},checkPayButton:function(){var a=this.$("#card-number").val(),c=this.$("#card-expiry").payment("cardExpiryVal"),d=b.payment.cardType(a),a=b.payment.validateCardNumber(a),f=b.payment.validateCardExpiry(c.month,c.year),d=b.payment.validateCardCVC(this.$("#card-cvc").val(),d);a&&f&&d?(this.$("#card-month").val(c.month),this.$("#card-year").val(c.year),this.$("#stripe-button").removeAttr("disabled")):b("#stripe-button").attr("disabled","disabled")},toggleCardFields:function(){0<=b("#cards").val().indexOf("card_")?
(this.$("#card-fields").hide(),this.$("#submit-container").prependTo("#payment-choice"),this.$("#stripe-button").removeAttr("disabled")):(this.$("#card-fields").show(),this.$("#submit-container").appendTo("#card-fields"),this.checkPayButton())}})})(window.jQuery);
duo.StreamView=Backbone.View.extend({id:"app",template:duo.templates.stream,events:{},initialize:function(){duo.user.updateActivity(_.bind(this.updateActivity,this),{silent:!0},!0)},render:function(){$(this.el).html($.duostache(this.template,_.extend(duo.user.toJSON(),{}),duo.templates));this.$("#no-friends").hide();this.model.hasFriendshipsLoaded()?(new duo.ProfileFriendsView({model:this.model,el:this.$("#friends"),show_add_friends:!0})).render():this.model.getFriendships(!0,function(){(new duo.ProfileFriendsView({model:this.model,
el:this.$("#friends"),show_add_friends:!0})).render()},this);this.leader_view?(this.$("#ranking").replaceWith(this.leader_view.el),this.leader_view.delegateEvents()):(this.leader_view=new duo.LeaderBoard({model:this.model,el:this.$("#ranking")}),this.leader_view.render());$(this).fixedSidebar();return this},updateActivity:function(){duo.user.get("events").profile_view=!1;duo.user.get("events").user_id=duo.user.id;(new duo.EventsView({el:this.$("#stream-container"),collection:duo.user.get("events"),
model:this.model,home_view:!0})).render();0==duo.user.get("events").length&&this.$("#no-friends").show()}});duo.UIString=Backbone.Model.extend({urlRoot:"/ui_strings",parse:function(b){return b},update:function(b){var a=this;$.post(this.urlRoot+"/"+this.get("id")+"/update",{new_target_text:b},function(b){a.set(b)})}});
duo.UIStringList=Backbone.Collection.extend({model:duo.UIString,urlRoot:"/ui_strings",initialize:function(b){this.target_language=b.target_language;void 0!==b.keyword&&(this.keyword=b.keyword)},url:function(){return this.keyword?this.urlRoot+"/search/"+this.target_language+"/"+this.keyword:this.urlRoot+"/list/"+this.target_language},fetch:function(b){b=b||{};b.data=b.data||{};Backbone.Collection.prototype.fetch.call(this,b)},parse:function(b){this.target_language_string=b.target_language_string;return _.map(b.ui_strings,
function(a){return duo.UIString.prototype.parse(a)})}});duo.UIStringView=Backbone.View.extend({id:"app",template:duo.templates["ui-string"],events:{"click #save-button":"update"},initialize:function(b){this.model.bind("change",this.render,this)},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));return this},update:function(){new_target_text=this.$("#target-text").val();console.debug(new_target_text);this.model.update(new_target_text)}});
duo.CompactUIStringView=Backbone.View.extend({template:duo.templates["compact-ui-string"],events:{},render:function(){$(this.el).html($.duostache(this.template,this.model.toJSON(),duo.templates));return this}});
duo.UIStringListView=Backbone.View.extend({template:duo.templates["ui-string-list"],events:{},initialize:function(b){this.collection=b.collection;this.collection.bind("add",this.render,this);this.collection.bind("change",this.render,this);this.collection.bind("reset",this.render,this)},render:function(){0<this.collection.length&&$(this.el).html($.duostache(this.template,{ui_strings:this.collection.toJSON()},duo.templates));var b=this;this.collection.each(function(a,c){a.set({index:c});(new duo.CompactUIStringView({model:a,
el:b.$("#ui-string-"+a.id)})).render()});return this}});duo.UIStringOverviewView=Backbone.View.extend({id:"app",template:duo.templates["all-ui-string-list"],events:{},initialize:function(b){this.collection=b.collection},render:function(b){b={target_language_string:this.collection.target_language_string};$(this.el).html($.duostache(this.template,b),duo.templates);(new duo.UIStringListView({el:this.$("#ui-strings"),collection:this.collection})).render();return this}});
(function(){duo.VocabView=Backbone.View.extend({id:"app",template:duo.templates["vocab-overview"],events:{"click #start-flashcards":"startFlashcards","duo:vocab:openWord":"openWord","duo:vocab:closeWord":"closeWord"},render:function(){$(this.el).html($.duostache(this.template,{has_vocab:0<this.collection.length},duo.templates,!0));this.vocab_list=new duo.VocabListView({collection:this.collection,el:this.$("#vocabulary-list")});this.vocab_list.render();this.word_view=new duo.WordView({el:this.$("#word-sidebar")});
$(this).fixedSidebar();this.flashcardsModalView?this.flashcardsModalView.setElement(this.$("#flashcards-container")):this.flashcardsModalView=new duo.FlashcardsModalView({el:this.$("#flashcards-container")});return this},startFlashcards:function(){duo.vent.bind("closeFlashcardsModal",this.refreshVocabList,this);this.flashcardsModalView.beginNewFlashcards()},refreshVocabList:function(){var b=this;this.collection.fetch({success:function(){b.vocab_list.render()}});duo.vent.unbind("closeFlashcardsModal")},
openWord:function(b,a){this.$("#default-sidebar").hide();this.$("#word-sidebar").show();this.vocab_list.selectRow(a);this.word_view.model=this.collection.get(a);this.word_view.render()},closeWord:function(){this.$("#default-sidebar").show();this.$("#word-sidebar").hide();this.vocab_list.unselectRow()}});duo.VocabListView=Backbone.View.extend({id:"vocabulary-list",template:duo.templates["vocab-list"],events:{"mouseenter .needs-hint":"delayShowTranslation","click .word-cell":"clickRow"},initialize:function(){this.delayShowTranslation=
_.debounce(this.showTranslation,500)},render:function(){var b=duo.user.getSkills();$(this.el).html($.duostache(this.template,{language_string:this.collection.language_string,vocab_overview:this.collection.toJSON(),has_vocab:0<this.collection.length,word_count:b.word_count,loading_word_count:!("word_count"in duo.user.getSkills())},duo.templates,!0));"word_count"in b||$.getJSON("/vocabularies/size",{user_id:duo.user.id,language:b.language},function(a){self.$("#word-count").text(a.vocab_size.total);
duo.user.getSkills().word_count=a.vocab_size.total;mixpanel.register({word_count:a.vocab_size.total})});_.defer(function(){sorttable.makeSortable(document.getElementById("vocab-list"))});return this},showTranslation:function(b){var a=$(b.currentTarget),c=a.find("td").data("lexeme");this.collection.get(c);var c=a.closest("tr").index(),c=$("#vocab-rows tr.word-cell").slice(Math.max(0,c-5),c+5),d=c.find(".word");d.find(".hoverable-word").tokenHints({templates:duo.templates,source_language:this.collection.learning_language,
target_language:this.collection.from_language,word_only:!0});d.removeClass("word");c.removeClass("needs-hint");0<this.$(".hoverable-word:hover").length&&setTimeout(function(){wrapper=a.find(".hoverable-word .token-wrapper");wrapper.trigger({type:"mouseenter",pageX:12,pageY:12});wrapper.trigger({type:"mousemove",pageX:13,pageY:13})},200);b.stopPropagation();return!1},selectRow:function(b){this.$(".word-cell").removeClass("active");this.$('.word-cell td[data-lexeme="'+b+'"]').closest(".word-cell").addClass("active")},
unselectRow:function(){this.$(".word-cell").removeClass("active")},clickRow:function(b){if($(b.currentTarget).hasClass("active"))this.$el.trigger("duo:vocab:closeWord");else{var a=$(b.currentTarget).find("td").data("lexeme"),c=this.collection.get(a);this.$(".word-cell").removeClass("active");var d=_.bind(this.$el.trigger,this.$el,"duo:vocab:openWord",[a]);0<$(b.currentTarget).find(".hint-table").length?(c.set("top_hint",$(b.currentTarget).find(".hint-table tbody tr:first").text()),d()):(b=[window.location.protocol,
"//"+DictionarySettings.HOST_PHASE2+"api/1/dictionary/hints",this.collection.learning_language,this.collection.from_language].join("/"),$.ajax({url:b,dataType:"jsonp",data:{tokens:JSON.stringify([c.get("word_string")])},type:"GET",success:function(a){c.set("top_hint",a[c.get("word_string")][0]);d()}}))}}});duo.WordView=Backbone.View.extend({template:duo.templates["word-overview"],events:{"click .open-word-modal":"openWordModal","click .with-back-arrow":"closeWordView","click .nav-skill":"navigateToSkill"},
render:function(){var b=this,a=_.compact(_.map(this.model.get("related_lexemes"),function(a){return b.model.collection.get(a)?b.model.collection.get(a).toJSON():null}));$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{related_words:a,has_related:0<a.length}),duo.templates,!0));var c=this.model.collection.learning_language;_.defer(function(){b.$(".listen-button-small").tts({language:c,tts_type:"token",tts_id:encodeURIComponent(b.model.get("word_string")),visible:!1,play_trigger:"click",
autoplay:!1})});return this},openWordModal:function(){var b=this,a=_.filter(this.model.get("related_lexemes"),function(a){a=b.model.collection.get(a);return!a||_.isUndefined(a.get("ex_sentence"))});_.isUndefined(this.model.get("ex_sentence"))&&a.unshift(this.model.id);0<a.length?(lexeme_ids_to_request_str=a.join(),$.get("/api/1/vocab/example_sentences",{lexeme_ids:lexeme_ids_to_request_str},function(c){_.each(c,function(c,f){var g=b.model.collection.get(a[f]);g&&g.set({ex_sentence:c})});b.showWordModal()})):
this.showWordModal()},showWordModal:function(){this.word_modal?this.word_modal.model=this.model:this.word_modal=new duo.WordModalView({el:$("#word-modal"),model:this.model,parent:self});this.word_modal.render();$("#word-modal").modal("show")},navigateToSkill:function(b){var a=$(b.currentTarget).data("url");duo.skillRouter.navigate("/skill/"+this.model.collection.learning_language+"/"+a,{trigger:!0});b.stopPropagation()},closeWordView:function(){this.$el.trigger("duo:vocab:closeWord")}});duo.WordModalView=
Backbone.View.extend({template:duo.templates["word-modal"],events:{"click .close":"closeModal","click .related-word-link":"goToRelated"},render:function(){var b=this,a=_.compact(_.map(this.model.get("related_lexemes"),function(a){return(a=b.model.collection.get(a))&&a.has("ex_sentence")?a.toJSON():null})),c=_.some(a,function(a){return a?"gender"in a&&null!==a.gender:!1});$(this.el).html($.duostache(this.template,_.extend(this.model.toJSON(),{related_words:a,show_gender_column:this.model.has("gender")||
c,has_verb_table:this.model.has("infinitive")}),duo.templates,!0));_.defer(function(){b.model.has("infinitive")&&b.$("#verb-table").verbTable({source_language:b.model.collection.learning_language,language_information:b.model.collection.language_information,infinitive:b.model.get("infinitive"),templates:duo.templates});b.$(".listen-button-small").tts({language:b.model.collection.learning_language,tts_type:"token",tts_id:encodeURIComponent(b.model.get("word_string")),visible:!1,play_trigger:"click",
autoplay:!1})});return this},goToRelated:function(b){b=$(b.currentTarget).data("lexeme");$("body").scrollTop($('.word-cell td[data-lexeme="'+b+'"]').offset().top-300);var a=$('.word-cell td[data-lexeme="'+b+'"]').closest(".word-cell");a.click();_.defer(function(){a.addClass("active")});$("#word-modal").modal("hide")},closeModal:function(){$("#word-modal").modal("hide")}});duo.FlashcardsModalView=Backbone.View.extend({id:"flashcards-container",template:duo.templates["flashcards-modal"],render:function(){if(this.flashcards_view&&
this.flashcards_view.reuse)this.$("#current-container .card").removeClass("flipper"),this.$("#flashcards").modal("show");else{$(this.el).html($.duostache(this.template,{}),duo.templates,!0);var b=this;this.flashcard_data.fetch({data:{n:15,allow_partial_deck:!0},success:function(a){b.flashcards_view.beginNewFlashcards();a=b.$("#flashcards");b.flashcards_view.setElement(a).render();a.off("hidden.bs.modal.hidFlashcardsModal");a.on("hidden.bs.modal.hidFlashcardsModal",_.bind(b.hidFlashcardsModal,b));
a.modal("show")}})}return this},beginNewFlashcards:function(){var b;switch(window.location.pathname){case "/":b="Home";break;case "/words":b="Vocab";break;default:b=window.location.pathname}duo.track("start flashcards",{flashcards_origin:b});this.flashcard_data||(this.flashcard_data=new duo.FlashcardData);this.flashcards_view||(this.flashcards_view=new duo.FlashcardsView({collection:this.flashcard_data,el:this.$("#flashcards")}));this.render()},hidFlashcardsModal:function(){if(0<this.flashcards_view.position){var b=
this;this.flashcard_data.postResults(this.flashcards_view.results,function(){duo.track("finish flashcards",{num_cards:b.flashcards_view.position});b.flashcards_view.cleanup();duo.vent.trigger("closeFlashcardsModal")});this.flashcards_view.reuse=!1}else this.flashcards_view.reuse=!0}});duo.FlashcardsView=Backbone.View.extend({id:"flashcards",template:duo.templates.flashcards,events:{"click .card-container":"flipCard","click .response a":"clickNextCard"},initialize:function(){this.keysBound=!1;Backbone.history.once("route",
this.cleanup,this)},render:function(){this.finished=this.position>this.collection.length-1;$(this.el).html($.duostache(this.template,_.extend({},{card:!this.finished?this.collection.at(this.position).toJSON():void 0,dots:_.range(this.collection.length),incorrect_words:this.incorrect_words,num_incorrect:this.incorrect_words.length,learning_language:this.collection.learning_language,ui_language:this.collection.ui_language}),duo.templates,!0));this.$(".dot:lt("+this.position+")").addClass("seen");return this},
beginNewFlashcards:function(){this.results=[];this.position=0;this.incorrect_words=[];this.finished=!1;this.bindKeys()},bindKeys:function(){this.keysBound||($(document).bind("keydown",_.bind(this.checkKey,this)),this.keysBound=!0)},checkKey:function(b){32==b.which&&!this.finished&&this.flipCard();if(!this.finished&&!this.animating)if(37==b.which)this.nextCard("left");else if(39==b.which)this.nextCard("right");else if(32!=b.which)return!0;this.$el.is(":visible")&&b.stopPropagation();return!1},flipCard:function(b){this.finished?
b.stopPropagation():this.$("#current-container .card").toggleClass("flipper")},clickNextCard:function(b){if(!this.animating){var a=$(b.currentTarget).hasClass("wrong")?"left":"right";this.nextCard(a);b.stopPropagation()}},nextCard:function(b){if(this.$(".card").hasClass("flipper")){this.results.push({id:this.collection.at(this.position).id,correct:"left"!=b});duo.user.playEffects()&&soundManager&&("left"==b?soundManager.wrongSound&&soundManager.wrongSound.play():soundManager.rightSound&&soundManager.rightSound.play());
if("left"==b){var a=this.collection.at(this.position);this.incorrect_words.push({word:a.get("word"),translation:a.get("translation")})}this.animating=!0;a=this.$(".card").clone();this.incrementPosition();this.render();var c=this.$("#old-container"),d=this.$("#current-container"),f=this.$("#current-container .card");c.html(a);f.addClass("no-animate").removeClass("flipper");d.hide();d.fadeIn(500,"easeOutExpo");f.removeClass("no-animate");var g=this;c.animate({left:"left"==b?"-360px":"810px"},800,"easeOutExpo",
function(){c.html("");c.css({left:"225px"});g.animating=!1})}},incrementPosition:function(){this.position+=1;this.position>=this.collection.length-1&&(this.finished=!0,this.animating=!1)},cleanup:function(){this.keysBound&&($(document).unbind("keydown"),this.keysBound=!1)}})})();
